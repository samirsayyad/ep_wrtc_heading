{"version":3,"sources":["getUserMediaPolyfill.js","RTCMultiConnection.min.js","adapter.js","getHTMLMediaElement.js","CodecsHandler.js","getStats.min.js","BandwidthHandler.js","copyPasteEvents.js","jquery.tmpl.min.js","clientShare.js","textChat.js","videoChat.js","webrtcRoom.js","webrtc.js"],"names":["navigator","mediaDevices","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","constraints","Promise","resolve","reject","stream","error","e","window","RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer","Error","name","RTCMultiConnection","roomid","forceOptions","SocketConnection","connection","connectCallback","isData","session","audio","video","screen","data","updateExtraBackup","remoteUserId","extra","peersBackup","userid","parameters","sessionid","socketMessageEvent","socketCustomEvent","autoCloseEntireSession","broadcast","maxParticipantsAllowed","enableScalableBroadcast","maxRelayLimitPerUser","JSON","stringify","socketCustomParameters","io","sockets","socketURL","substr","length","enableLogs","console","info","location","origin","socket","connect","socketOptions","mPeer","multiPeersHandler","on","peers","onExtraDataUpdated","onMessageEvent","message","sender","streamSyncNeeded","streamEvents","streamid","action","onstreamended","type","deletePeer","allParticipants","indexOf","push","forEach","participant","localPeerSdpConstraints","OfferToReceiveAudio","sdpConstraints","mandatory","OfferToReceiveVideo","remotePeerSdpConstraints","oneway","isOneWay","direction","isDataOnly","newParticipant","createNewPeer","userPreferences","readyForOffer","attachStreams","waitingForLocalMedia","setTimeout","newParticipationRequest","dontGetRemoteStream","dontAttachLocalStream","connectionDescription","successCallback","onNewParticipant","changedUUID","oldUUID","newUUID","userLeft","onUserLeft","leave","addNegotiatedMessage","alreadyConnected","resetProps","emit","event","onSocketDisconnect","onSocketError","onUserStatusChanged","status","onEntireSessionClosed","useridAlreadyTaken","yourNewUserId","onUserIdAlreadyTaken","log","debug","onNumberOfBroadcastViewersUpdated","isInitiator","MultiPeers","initFileBufferReader","fbr","FileBufferReader","onProgress","chunk","onFileProgress","onBegin","file","onFileStart","onEnd","onFileEnd","self","this","skipPeers","getLength","numberOfPeers","peer","selectFirst","firstPeer","getAllParticipants","allPeers","callbcak","send","that","isNull","size","enableFileSharing","shareFile","ArrayBuffer","DataView","remoteUser","channels","channel","createDataChannel","renegotiate","TextSender","text","uuid","getLocalConfig","remoteSdp","streamsToShare","rtcMultiConnection","renegotiatingPeer","peerRef","onLocalSdp","localSdp","onNegotiationNeeded","onLocalCandidate","localCandidate","OnIceCandidateHandler","processCandidates","onDataChannelMessage","convertToObject","object","readyForNextChunk","getNextChunk","nextChunk","isLastChunk","chunkMissing","addChunk","promptNextChunk","onDataChannelError","onDataChannelOpened","onDataChannelClosed","onRemoteStream","streams","onGettingRemoteMedia","onRemoteStreamRemoved","onRemovingRemoteMedia","onPeerStateChanged","states","iceConnectionState","onNegotiationStarted","onNegotiationCompleted","search","disconnectWith","enableMedia","setUserPreferences","localConfig","PeerInitiator","createAnsweringPeer","renegotiatePeer","replaceTrack","track","isVideoTrack","getSenders","rtpSender","kind","lastVideoTrack","lastAudioTrack","warn","sdp","addRemoteSdp","candidate","addRemoteCandidate","isAudio","isVideo","isScreen","onReadyForOffer","onGettingLocalMedia","localStream","onLocalMediaError","onMediaError","readAsArrayBuffer","arrayOfUsers","chunkSize","DetectRTC","browser","textReceiver","TextReceiver","receive","parse","onclose","onerror","onopen","state","getRemoteStreams","fireEvent","obj","eventName","args","CustomEvent","arguments","__exposedProps__","dispatchEvent","setMuteHandlers","streamEvent","addEventListener","muteType","onmute","unmuteType","onunmute","getRandomString","crypto","getRandomValues","userAgent","a","Uint32Array","token","i","l","toString","Math","random","Date","getTime","replace","getRMCMediaElement","callback","autoCreateMediaElement","isAudioOnly","getTracks","mediaElement","document","createElement","srcObject","setAttribute","streamEndedEvent","currentUserMediaRequest","remove","idInstance","StreamsHandler","onSyncNeeded","aStream","idx","newStreamsArray","parentNode","removeChild","played","play","cbFired","then","listenEventHandler","eventHandler","removeEventListener","removeNullEntries","array","newArray","item","isAudioPlusTab","audioPlusTab","version","filter","t","isUnifiedPlanSupportedDefault","canAddTransceiver","RTCRtpTransceiver","prototype","tempPc","addTransceiver","close","isUnifiedPlanSupported","pc","sdpSemantics","config","getConfiguration","isUnifiedPlanSuppored","setCordovaAPIs","cordova","plugins","iosrtc","RTCSessionDescription","RTCIceCandidate","MediaStream","MediaStreamTrack","enable","selectAudioOutput","iOSDefaultAudioOutputDevice","registerGlobals","setSdpConstraints","setChannelEvents","binaryType","onmessage","internalSend","readyState","createOfferOrAnswer","_method","defaults","processSdp","setLocalDescription","trickleIce","onSettingLocalDescription","mozRTCSessionDescription","mozRTCIceCandidate","addStream","removeStream","allRemoteStreams","localStreams","iceTransports","candidates","turn","relay","stun","reflexive","host","params","iceServers","iceTransportPolicy","iceCandidatePoolSize","bundlePolicy","rtcpMuxPolicy","optionalArgument","getReceivers","receiver","addTrack","getLocalStreams","onicecandidate","sdpMid","sdpMLineIndex","localDescription","beforeAddingStream","id","oniceconnectionstatechange","onsignalingstatechange","iceGatheringState","signalingState","Array","dontDuplicate","ontrack","onended","onremovestream","streamToShare","onremovetrack","removeTrack","remoteCandidate","addIceCandidate","cb","setRemoteDescription","isOfferer","ondatachannel","enableDisableVideoEncoding","rtcp","getParameters","encodings","active","setParameters","nativeClose","getUserMediaHandler","options","streaming","returnBack","chromeMediaSource","mozMediaSource","mediaSource","setStreamType","localMediaConstraints","mutex","queueRequests","shift","test","getUserMediaStream","getUserMediaError","getUserMediaFailure","hints","getUserMediaSuccess","successCB","failureCB","getDisplayMedia","content","last","join","isobject","latency","sendingTime","autoTranslateText","original","Translator","TranslateText","translatedText","global","captureStream","mozCaptureStream","getContext","pause","drawImage","toDataURL","HTMLVideoElement","HTMLMediaElement","protocol","href","hash","width","height","URL","createObjectURL","revokeObjectURL","retry","isDone","next","currentTrial","isTimeout","setInterval","clearInterval","browserFakeUserAgent","isNodejs","process","versions","node","ua","match","isMobileDevice","isEdge","msSaveOrOpenBlob","msSaveBlob","isOpera","opera","isFirefox","InstallTrigger","isSafari","isChrome","chrome","isIE","documentMode","isMobile","Android","BlackBerry","iOS","Opera","Windows","any","getOsName","osName","osVersion","osInfo","cs","nVer","appVersion","nAgt","os","clientStrings","s","r","exec","detectDesktopOS","toLowerCase","isCanvasSupportsStreamCapturing","isVideoSupportsStreamCapturing","regexIpv4Local","regexIpv4","regexIpv6","MediaDevices","audioInputDevices","audioOutputDevices","videoInputDevices","enumerateDevices","canEnumerate","hasMicrophone","hasSpeakers","hasWebcam","isWebsiteHasMicrophonePermissions","isWebsiteHasWebcamPermissions","nameOffset","verOffset","ix","browserName","appName","fullVersion","parseFloat","majorVersion","parseInt","split","substring","lastIndexOf","toUpperCase","isNaN","isPrivateBrowsing","getBrowserInfo","isPrivate","webkitRequestFileSystem","TEMPORARY","indexedDB","db","open","result","isIE10OrLater","localStorage","setItem","removeItem","detectPrivateMode","isWebRTCSupported","isORTCSupported","isScreenCapturingSupported","domain","webAudio","isSupported","isCreateMediaStreamSourceSupported","isAudioContextSupported","isRtpDataChannelsSupported","isSCTPSupportd","isSctpDataChannelsSupported","isGetUserMediaSupported","w","h","displayResolution","displayAspectRatio","gcd","b","toFixed","DetectLocalIPAddress","isPublic","isIpv4","handleCandidate","ipAddress","ipDuplicates","afterCreateOffer","line","getElementById","iframe","win","contentWindow","peerConfig","optional","RtpDataChannels","urls","isPromisesSupported","createOffer","getIPs","ip","isWebSocketsSupported","WebSocket","CLOSING","isWebSocketsBlocked","checkWebSocketsSupport","starttime","websocket","WebsocketLatency","load","getSources","bind","alreadyUsedDevices","devices","_device","device","d","deviceId","label","isCustomLabel","checkDeviceSupport","isSetSinkIdSupported","isRTPSenderReplaceTracksSupported","isRemoteStreamProcessingSupported","isApplyConstraintsSupported","isMultiMonitorScreenCapturingSupported","webkitMediaStream","Object","keys","module","exports","define","amd","el","attachEvent","attachEventListener","listener","useCapture","stop","CodecsHandler","preferCodec","codecName","splitLines","videoCodecNumbers","vp8LineNumber","vp9LineNumber","h264LineNumber","preferCodecHelper","codec","ignore","preferCodecNumber","newLine","videoCodecNumbersOriginal","newOrder","codecNumber","trim","findLine","sdpLines","prefix","startLine","endLine","realEndLine","findLineInRange","getCodecPayloadType","sdpLine","pattern","RegExp","removeVPX","disableNACK","prioritize","codecMimeType","codecs","mimeType","unshift","splice","removeNonG722","setApplicationSpecificBandwidth","bandwidth","setBAS","setVideoBitrates","vp8Payload","xgoogle_min_bitrate","min","xgoogle_max_bitrate","max","vp8Index","rtxPayload","rtxIndex","rtxFmtpLineIndex","appendrtxNext","concat","setOpusAttributes","opusPayload","opusIndex","opusFmtpLineIndex","appendOpusNext","stereo","maxaveragebitrate","maxplaybackrate","cbr","useinbandfec","usedtx","maxptime","preferVP9","forceStereoAudio","fmtpLineIndex","extractSdp","BandwidthHandler","icePair","iceRestrictions","iceProtocols","udp","tcp","IceServersHandler","getIceServers","currentUserMediaRequestOptions","handleType","setHandlers","syncAction","graduallyIncreaseVolume","volume","afterEach","setTimeoutInteval","numberOfTimes","startedTimes","mute","isSyncAction","enabled","isAudioMuted","unmute","looper","times","initialText","packetSize","textToTransfer","sendText","textMessage","packets","slice","chunkInterval","FileProgressBarHandler","handle","progressHelper","div","title","innerHTML","filesContainer","body","documentElement","insertBefore","firstChild","progress","querySelector","maxChunks","helper","value","currentPosition","position","updateLabel","url","TranslationHandler","language","googKey","newScript","sourceText","encodeURIComponent","randomNumber","response","translations","source","src","getElementsByTagName","appendChild","getListOfLanguages","xhr","XMLHttpRequest","onreadystatechange","DONE","responseText","languages","connectSocket","socketAutoReConnect","FirebaseConnection","PubNubConnection","joinRoom","mediaConstraints","getStreamInfoForAdmin","password","isRoomJoined","openRoom","identifier","publicRoomIdentifier","isRoomOpened","selectAll","map","tracks","beforeJoin","dontCaptureUserMedia","invokeGetUserMedia","applyConstraints","useDefaultDevices","preventDuplicateOnStreamEvents","setStreamEndHandler","muted","onspeaking","onsilence","hark","onvolumechange","threshold","merge","setHarkEvents","onstream","messageToDeliver","transport","openOrJoin","checkPresence","isRoomExist","captureUserMedia","eventObject","onleave","rejoin","onReConnecting","sessionForced","nonScreenSession","onbeforeunload","arg1","dontCloseSocket","closeBeforeUnload","closeSocket","ignoreBeforeUnload","changeUserId","newUserId","facingMode","lastAudioDevice","lastVideoDevice","sourceId","VoiceActivityDetection","DtlsSrtpKeyAgreement","googImprovedWifiBwe","googScreencastMinBitrate","googIPv6","googDscp","googCpuUnderuseThreshold","googCpuOveruseThreshold","googSuspendBelowMinBitrate","googCpuOveruseDetection","disconnect","closeEntireSession","videosContainer","user","gumCallback","streamCallback","videoConstraints","alert","resetTrack","remoteUsersIds","isRemote","alreadySetEndHandler","participantId","acceptParticipationRequest","invokeSelectFileDialog","selector","FileSelector","accept","selectSingleFile","paused","poster","snapshot","getSocket","skipStreams","local","remote","key","setCustomSocketEvent","customEvent","getNumberOfBroadcastViewers","broadcastId","numberOfBroadcastViewers","dontWriteLogs","setCustomSocketHandler","customSocketHandler","SSEConnection","_roomid","dontAttachStream","updateExtraData","beforeRemovingStream","isChromeExtensionAvailable","checkIfChromeExtensionAvailable","isFirefoxExtensionAvailable","getChromeExtensionStatus","modifyScreenConstraints","screen_constraints","isOnline","isLowBandwidth","opt","getExtraData","autoOpenOrJoin","resetScreen","setPassword","errors","ROOM_NOT_AVAILABLE","INVALID_PASSWORD","USERID_NOT_AVAILABLE","ROOM_PERMISSION_DENIED","ROOM_FULL","DID_NOT_JOIN_ANY_ROOM","INVALID_SOCKET","PUBLIC_IDENTIFIER_MISSING","INVALID_ADMIN_CREDENTIAL","f","adapter","n","o","c","require","u","code","p","call","1","adapterFactory","undefined","./adapter_factory.js","2","defineProperty","_ref","shimChrome","shimFirefox","shimEdge","shimSafari","logging","utils","browserDetails","detectBrowser","commonShim","extractVersion","disableLog","disableWarnings","chromeShim","shimPeerConnection","browserShim","shimGetUserMedia","shimMediaStream","shimOnTrack","shimAddTrackRemoveTrack","shimGetSendersWithDtmf","shimGetStats","shimSenderReceiverGetStats","fixNegotiationNeeded","shimRTCIceCandidate","shimConnectionState","shimMaxMessageSize","shimSendThrowTypeError","removeAllowExtmapMixed","firefoxShim","shimRemoveStream","shimSenderGetStats","shimReceiverGetStats","shimRTCDataChannel","shimAddTransceiver","shimGetParameters","shimCreateOffer","shimCreateAnswer","edgeShim","shimGetDisplayMedia","shimReplaceTrack","safariShim","shimRTCIceServerUrls","shimCreateOfferLegacy","shimCallbacksAPI","shimLocalStreamsAPI","shimRemoteStreamsAPI","shimTrackEventTransceiver","shimAudioContext","_interopRequireWildcard","__esModule","newObj","hasOwnProperty","default","./chrome/chrome_shim","./common_shim","./edge/edge_shim","./firefox/firefox_shim","./safari/safari_shim","./utils","3","_typeof","Symbol","iterator","constructor","_getusermedia","enumerable","get","_getdisplaymedia","_ontrack","set","configurable","origSetRemoteDescription","_this","_ontrackpoly","te","find","Event","transceiver","apply","wrapPeerConnectionEvent","shimSenderWithDtmf","dtmf","_dtmf","createDTMFSender","_pc","_senders","origAddTrack","origRemoveTrack","origAddStream","_this2","origRemoveStream","_this3","RTCRtpSender","origGetSenders","_this4","senders","origGetStats","getStats","_this5","_arguments","onSucc","onErr","fixChromeStats_","standardReport","report","standardStats","timestamp","localcandidate","remotecandidate","names","stat","makeMapStats","stats","Map","successCallbackWrapper_","RTCRtpReceiver","_this6","filterStats","origGetReceivers","_this7","receivers","srcElement","err","DOMException","shimAddTrackRemoveTrackWithNative","origGetLocalStreams","_this11","nativeStreams","_reverseStreams","_this12","_streams","newStream","replaceInternalStreamId","description","internalId","externalStream","internalStream","replaceExternalStreamId","_this13","alreadyExists","oldStream","method","nativeMethod","methodObj","_defineProperty","_this14","isLegacyCall","desc","origSetLocalDescription","origLocalDescription","getOwnPropertyDescriptor","_this15","addIceCandidateNullSupported","nativeAddIceCandidate","target","writable","_this8","_shimmedLocalStreams","streamId","_this9","existingSenders","newSenders","newSender","_this10","../utils.js","./getdisplaymedia","./getusermedia","4","getSourceId","widthSpecified","heightSpecified","frameRateSpecified","frameRate","chromeMediaSourceId","maxFrameRate","maxWidth","maxHeight","5","constraintsToChrome_","cc","ideal","exact","oldname_","charAt","oc","mix","advanced","shimConstraints_","func","remap","face","getSupportedFacingModeLies","getSupportedConstraints","matches","dev","some","includes","shimError_","PermissionDeniedError","PermissionDismissedError","InvalidStateError","DevicesNotFoundError","ConstraintNotSatisfiedError","TrackStartError","MediaDeviceFailedDueToShutdown","MediaDeviceKillSwitchOn","TabCaptureError","ScreenCaptureError","DeviceCaptureError","constraint","constraintName","onSuccess","onError","origGetUserMedia","getAudioTracks","getVideoTracks","6","NativeRTCIceCandidate","nativeCandidate","parsedCandidate","_sdp2","parseCandidate","augmentedCandidate","assign","toJSON","usernameFragment","_sctp","sctpInDescription","sections","splitSections","mediaSection","mLine","parseMLine","getRemoteFirefoxVersion","getCanSendMaxMessageSize","remoteIsFirefox","canSendMaxMessageSize","getMaxMessageSize","maxMessageSize","matchPrefix","_getConfiguration","canSendMMS","remoteMMS","Number","POSITIVE_INFINITY","sctp","wrapDcSend","dc","origDataChannelSend","byteLength","TypeError","origCreateDataChannel","dataChannel","proto","completed","checking","_onconnectionstatechange","origMethod","_connectionstatechangepoly","_lastConnectionState","connectionState","newEvent","nativeSRD","_sdp","7","origMSTEnabled","ev","RTCDtmfSender","RTCDTMFSender","RTCPeerConnectionShim","_rtcpeerconnectionShim2","_filtericeservers","filterIceServers","setTrack","_rtcpeerconnectionShim","../utils","./filtericeservers","rtcpeerconnection-shim","8","edgeVersion","hasTurn","server","deprecated","isString","validTurn","startsWith","9","10","catch","11","RTCTrackEvent","modernStatsTypes","inboundrtp","outboundrtp","candidatepair","nativeGetStats","DataChannel","RTCDataChannel","origAddTransceiver","setParametersPromises","initParameters","shouldPerformCheck","sendEncodings","encodingParam","rid","scaleResolutionDownBy","RangeError","maxFramerate","origGetParameters","origCreateOffer","_arguments2","all","finally","origCreateAnswer","createAnswer","_arguments3","12","preferredMediaSource","13","nativeGetUserMedia","getSettings","nativeGetSettings","nativeApplyConstraints","14","_localStreams","_addTrack","_len","_key","index","_remoteStreams","_onaddstream","_onaddstreampoly","failureCallback","promise","withCallback","_getUserMedia","shimConstraints","errcb","OrigPeerConnection","pcConfig","pcConstraints","newIceServers","generateCertificate","offerOptions","offerToReceiveAudio","audioTransceiver","getTransceivers","setDirection","offerToReceiveVideo","videoTransceiver","AudioContext","webkitAudioContext","compactObject","15","eventNameToWrap","wrapper","nativeAddEventListener","nativeEventName","wrappedCallback","modifiedEvent","handleEvent","_eventMap","nativeRemoveEventListener","has","unwrappedCb","delete","bool","logDisabled_","deprecationWarnings_","oldMethod","newMethod","isSecureContext","supportsUnifiedPlan","isObject","reduce","accumulator","isObj","isEmptyObject","walkStats","outbound","streamStatsType","filteredResult","trackStats","trackIdentifier","trackStat","trackId","uastring","expr","pos","val","base","resultSet","endsWith","16","SDPUtils","writeMediaSection","caps","dtlsRole","writeRtpDescription","writeIceParameters","iceGatherer","getLocalParameters","writeDtlsParameters","dtlsTransport","mid","rtpReceiver","_initialTrackId","msid","sendEncodingParameters","ssrc","rtx","localCName","getCommonCapabilities","localCapabilities","remoteCapabilities","commonCapabilities","headerExtensions","fecMechanisms","findCodecByPayloadType","pt","payloadType","preferredPayloadType","rtxCapabilityMatches","lRtx","rRtx","lCodecs","rCodecs","lCodec","apt","rCodec","clockRate","numChannels","rtcpFeedback","fb","j","parameter","lHeaderExtension","rHeaderExtension","uri","isActionAllowedInSignalingState","offer","answer","maybeAddCandidate","iceTransport","alreadyAdded","getRemoteCandidates","foundation","port","priority","makeError","NotSupportedError","InvalidAccessError","OperationError","addTrackToStreamAndFireEvent","MediaStreamTrackEvent","fireAddTrack","trackEvent","_dispatchEvent","_eventTarget","createDocumentFragment","canTrickleIceCandidates","needNegotiation","remoteStreams","_localDescription","_remoteDescription","usingBundle","_iceGatherers","gatherPolicy","_config","transceivers","_sdpSessionId","generateSessionId","_sdpSessionVersion","_dtlsRole","_isClosed","onaddstream","onconnectionstatechange","onicegatheringstatechange","onnegotiationneeded","_emitGatheringStateChange","_createTransceiver","doNotAdd","hasBundleTransport","recvEncodingParameters","associatedRemoteMediaStreams","wantReceive","transports","_createIceAndDtlsTransports","_maybeFireNegotiationNeeded","clonedStream","clone","clonedTrack","_createIceGatherer","bufferedCandidateEvents","bufferCandidates","end","_gather","onlocalcandidate","evt","cand","component","ufrag","serializedCandidate","writeCandidate","getMediaSections","getDescription","complete","every","RTCIceTransport","onicestatechange","_updateIceConnectionState","_updateConnectionState","RTCDtlsTransport","ondtlsstatechange","_disposeIceAndDtlsTransports","_transceive","recv","cname","compound","rtcpParameters","sessionpart","parseRtpParameters","isIceLite","isRejected","rejected","remoteIceParameters","getIceParameters","remoteDtlsParameters","getDtlsParameters","role","start","_updateSignalingState","receiverList","iceOptions","lines","getKind","getDirection","remoteMsid","parseMsid","getMid","generateIdentifier","parseRtpEncodingParameters","parseRtcpParameters","isComplete","cands","setTransport","setRemoteCandidates","getCapabilities","isNewTrack","nativeTrack","removeTrackFromStreamAndFireEvent","sid","newState","new","closed","connected","disconnected","failed","connecting","numAudioTracks","numVideoTracks","writeSessionBoilerplate","remoteCodec","hdrExt","rHdrExt","getLocalCandidates","mediaSectionsInOffer","localTrack","reducedSize","candidateString","senderOrReceiver","promises","allStats","results","ortcObjectName","nativeGetstats","nativeStats","mapStats","methods","17","blob","part","parts","address","relatedAddress","relatedPort","tcpType","parseIceOptions","parseRtpMap","parsed","writeRtpMap","parseExtmap","writeExtmap","headerExtension","preferredId","parseFmtp","kv","writeFmtp","param","parseRtcpFb","writeRtcpFb","parseSsrcMedia","sp","colon","attribute","parseSsrcGroup","semantics","ssrcs","parseFingerprint","algorithm","fingerprints","setupType","fp","parseCryptoLine","tag","cryptoSuite","keyParams","sessionParams","writeCryptoLine","writeCryptoKeyParams","parseCryptoKeyParams","keyMethod","keySalt","lifeTime","mkiValue","mkiLength","getCryptoParameters","pwd","mline","rtpmapline","fmtps","extension","secondarySsrc","encodingParameters","hasRed","hasUlpfec","primarySsrc","flows","encParam","codecPayloadType","fec","mechanism","maxBitrate","remoteSsrc","rsize","mux","spec","planB","msidParts","parseSctpDescription","maxSizeLine","sctpPort","fmt","writeSctpDescription","media","output","sessId","sessVer","sessUser","parseOLine","username","sessionId","sessionVersion","netType","addressType","isValidSDP","getHTMLMediaElement","nodeName","getAudioElement","mediaStream","setAttributeNode","createAttribute","webkitURL","buttons","element","toggle","mediaElementContainer","className","mediaControls","muteAudio","onclick","onUnMuted","onMuted","muteVideo","takeSnapshot","onTakeSnapshot","style","opacity","onStopped","volumeControl","recordAudio","onRecordingStopped","onRecordingStarted","recordVideo","volumeSlider","slider","onchange","zoom","screenStateChange","isFullScreeMode","webkitIsFullScreen","mozFullScreen","fullscreen","innerWidth","display","mediaBox","innerHeight","onZoomout","onZoomin","adjustControls","exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","exitFullScreen","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","h2","marginLeft","clientWidth","marginTop","clientHeight","showOnMouseEnter","onmouseenter","onmousedown","onmouseleave","clasName","overflow","mediaStreamTrack","interval","getStatsLooper","getStatsWrapper","getStatsParser","stack","nomore","getStatsResult","datachannel","ended","speed","bytesSent","audioBytesSent","videoBytesSent","res","items","systemNetworkType","encryption","availableBandwidth","framerateMean","bitrateMean","bytesReceived","packetsLost","systemBandwidth","sentPerSecond","encodedPerSecond","videoBytestSent","connectionType","systemIpAddress","candidateType","networkType","resolutions","internal","checkIfOfferer","googInitiator","googCertificate","googFingerprintAlgorithm","fingerprintAlgorithm","checkAudioTracks","mediaType","sendrecvType","pop","googCodecName","kilobytes","prevBytesSent","bytes","prevBytesReceived","googTrackId","googCurrentDelayMs","prevGoogCurrentDelayMs","prevPacketsLost","checkVideoTracks","googFrameHeightReceived","googFrameWidthReceived","googFrameHeightSent","googFrameWidthSent","prevFramerateMean","prevBitrateMean","bweforvideo","availableSendBandwidth","googAvailableSendBandwidth","googActualEncBitrate","googAvailableReceiveBandwidth","googRetransmitBitrate","googTargetEncBitrate","googBucketDelay","googTransmitBitrate","candidatePair","googActiveConnection","cid","googLocalAddress","googRemoteAddress","googTransportType","localCandidateId","remoteCandidateId","selected","nominated","mozLocalTransport","mozRemoteTransport","availableOutgoingBitrate","prevAvailableOutgoingBitrate","availableIncomingBitrate","prevAvailableIncomingBitrate","LOCAL_candidateType","LOCAL_transport","LOCAL_ipAddress","LOCAL_networkType","portNumber","REMOTE_candidateType","REMOTE_transport","REMOTE_ipAddress","REMOTE_networkType","dataSentReceived","remoteSource","frameWidth","frameHeight","SSRC","videoCodec","_","randomString","events","padInner","getFirstColumnOfSelection","rep","firstLineOfSelection","selStart","getLastColumnOfSelection","lastLineOfSelection","nextLine","startLineOffset","offsetOfIndex","selEnd","hasCommentOnLine","lineNumber","firstColumn","lastColumn","attributeManager","foundHeadOnLine","headId","column","getAttributesOnPosition","headingTagId","getSelectionHtml","html","getSelection","sel","contents","rangeCount","container","len","getRangeAt","cloneContents","selection","createRange","htmlText","freeze","addTextOnClipboard","aces","inner","removeSelection","headerId","hTag","callWithAce","ace","ace_hasHeaderOnSelection","hasVideoHeader","hasMultipleLine","rawHtml","$","append","removeClass","css","addClass","selectionMultipleLine","closest","eq","prop","originalEvent","clipboardData","setData","preventDefault","execCommand","hasHeaderOnSelection","documentAttributeManager","selectionOfMultipleLine","hasMultipleLineSelected","foundLineWithComment","hasCommentOnMultipleLineSelection","fn","domManip","q","g","_wrap","tmpl","parent","nodes","calls","nest","wrap","x","v","update","extend","_ctnt","m","makeArray","childNodes","Function","_default","k","$1","$2","isArray","nodeType","getAttribute","removeAttribute","template","wrapped","innerText","textContent","outerHTML","cloneNode","each","appendTo","prependTo","insertAfter","replaceAll","pushStack","tmplItem","afterManip","encode","if","else","=","!","jQuery","avatarUrl","share","scrollDownToLastChatText","$element","animate","scrollTop","scrollHeight","duration","queue","getUserFromId","userId","pad","collabClient","getConnectedUsers","slugify","$body_ace_outer","wrtcStore","wrtcPubsub","off","inlineAvatar","ROOM","room","inlineAvatarLimit","clientVars","webrtc","left","WRTC_Room","getHeaderRoomX","userInList","colorId","ep_profile_list","imageUrl","img","hide","show","TEXT","list","VIDEO","requestUser","roomInfo","USERS","users","actions","$headingRoom","$btnVideo","$btnText","$btnPlus","newAction","attr","data-action","appendUserList","empty","roomBoxIconActive","textActive","videoActive","notifyNewUserJoined","msg","btnJoin","headerTitle","roomCounter","userCount","VIDEOCHATLIMIT","authorClass","charCodeAt","minutes","time","getMinutes","hours","getHours","timeStr","userName","addTextChatMessage","createShareLink","headerText","pathname","getUserId","stopStreaming","textChat","padId","currentRoom","$joinBtn","createAndAppendMessage","tim","class","padutils","escapeHtmlWithClickableLinks","data-authorid","author","eventTextChatInput","keyCode","which","incomMsg","deactivateModal","$TextChatWrapper","removeAttr","$btn","activateModal","headTitle","existTextChat","data-id","textChatBox","headingId","addUserToRoom","present","data-text","removeUserFromRoom","$textChatUserList","socketBulkUpdateRooms","rooms","roomsInfo","postAceInit","hook","context","webSocket","docId","getPadId","chatBox","transform","userJoin","userData","$joinButton","userLeave","bulkUpdateRooms","hTagList","videoChat","data-video","WRTC","activate","prepend","data-active","hasClass","createSession","userInfo","gateway_userJoin","_userData","gateway_userLeave","reachedVideoRoomSize","showAlert","isBulkUpdate","gritter","add","sticky","class_name","bulkUpdate","$videoChatUserList","deactivate","removeListener","videoChatLimit","videoSettings","getItem","microphone","speaker","camera","audioInputSelect","audioOutputSelect","videoSelect","deviceInfo","option","reloadSession","scroll2Header","scrollIntoView","behavior","closeTextChat","trigger","roomBtnHandler","joinChatRoom","leaveChatRoom","pathName","link","$temp","select","shareRoomsLink","getHeaderRoomY","outerHeight","paddingTop","aceOuterPadding","ceil","offset","top","outerWidth","paddingLeft","$wbrtc_roomBox","headerURI","toggleClass","$box","urlParams","URLSearchParams","joinByQueryString","aceSetAuthorStyle","border-color","adoptHeaderYRoom","$padOuter","$el","hClassId","$headingEl","findTags","hTags","children","aceInnerOffset","newHTagAdded","newY","newX","positionTop","positionLeft","box","avatarBox","videoSizes","large","small","remoteStream","enlargedVideos","Set","localVideoElement","gState","_pad","credential","sizes","async","payload","receiveMessage","audioVideoInputChange","changeAudioDestination","hangupAll","siblings","appendInterfaceLayout","werc_toolbar","$wrtc_modal","$parent","videoBox","userID","$this","isActive","$modal","bytesToSize","floor","pow","toPrecision","statistic","send.codecs","$btnInfo","removeVideoInterface","hangup","showUserMediaError","reason","sendErrorStat","hostname","toggleMuted","audioTrack","toggleVideo","videoTrack","appendNewVideoInterface","isLocal","videoId","videoContainer","max-height","loadedmetadata","addInterface","autoplay","attachMediaStream","setStream","$video","videoEnabled","videoEnlarged","$mute","click","$disableVideo","$largeVideo","videoSize","statName","sendMessage","to","client","from","createPeerConnection","logError","cleanupSdp","attachSinkId","sinkId","setSinkId","errorMessage","selectedIndex","audioDestination","videoElement","_headerId","notify","targetCreate","cons1","cons2","merged","mergeConstraints","audioSource","videoSource","audioOutput","canI","userList","mozSrcObject","minVideo","maxVideo","functionName"],"mappings":"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","file":"wrtc.heading.mini.js","sourcesContent":["(function() {\r\n  if (!navigator.mediaDevices) navigator.mediaDevices = {};\r\n  if (!navigator.mediaDevices.getUserMedia) {\r\n    var getUserMedia =\r\n      navigator.webkitGetUserMedia ||\r\n      navigator.mozGetUserMedia ||\r\n      navigator.msGetUserMedia ||\r\n      navigator.getUserMedia;\r\n\r\n    if (getUserMedia) {\r\n      navigator.mediaDevices.getUserMedia = function(constraints) {\r\n        return new Promise(function(resolve, reject) {\r\n          getUserMedia(\r\n            constraints,\r\n            function(stream) {\r\n              resolve(stream);\r\n            },\r\n            function(error) {\r\n              reject(error);\r\n            }\r\n          );\r\n        });\r\n      };\r\n    } else {\r\n      navigator.mediaDevices.getUserMedia = function() {\r\n        // A missing `getUserMedia` seemingly can mean one of two things:\r\n        //\r\n        // 1) WebRTC is unsupported or disabled on this browser\r\n        // 2) This is an insecure connection\r\n        //   * This handling of insecure connections happens only on certain browsers.\r\n        //     It was observed in Chromium 80 and Firefox 75, but not Firefox 68. I suspect it's the new behavior.\r\n        //   * In other browsers, it handles insecure connections by throwing `NotAllowedError`.\r\n        //     We still handle this case in the calling function.\r\n        //   * See: https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\r\n        //     As of this writing, this claims that the browser does *both* of these things for\r\n        //     insecure connections, which is of course impossible and thus confusing.\r\n        //\r\n        // We will attempt to distinguish these two cases by checking for various webrtc-related fields on\r\n        // `window` (inspired by github.com/muaz-khan/DetectRTC). If none of those fields exist, we assume\r\n        // that WebRTC is not supported on this browser.\r\n        return new Promise(function(resolve, reject) {\r\n          if (!(window.RTCPeerConnection || window.webkitRTCPeerConnection || window.mozRTCPeerConnection || window.RTCIceGatherer)) {\r\n            var e = new Error(\"getUserMedia is not supported in this browser.\");\r\n            // I'd use NotSupportedError but I'm afraid they'll change the spec on us again\r\n            e.name = 'CustomNotSupportedError';\r\n            reject(e);\r\n          } else {\r\n            var e = new Error(\"insecure connection\");\r\n            // I'd use NotAllowedError but I'm afraid they'll change the spec on us again\r\n            e.name = 'CustomSecureConnectionError';\r\n            reject(e);\r\n          }\r\n        });\r\n      };\r\n    }\r\n  }\r\n})();","'use strict';\r\n\r\n// Last time updated: 2019-06-15 4:26:11 PM UTC\r\n\r\n// _________________________\r\n// RTCMultiConnection v3.6.9\r\n\r\n// Open-Sourced: https://github.com/muaz-khan/RTCMultiConnection\r\n\r\n// --------------------------------------------------\r\n// Muaz Khan     - www.MuazKhan.com\r\n// MIT License   - www.WebRTC-Experiment.com/licence\r\n// --------------------------------------------------\r\n\r\n\"use strict\";var RTCMultiConnection=function(roomid,forceOptions){function SocketConnection(connection,connectCallback){function isData(session){return!session.audio&&!session.video&&!session.screen&&session.data}function updateExtraBackup(remoteUserId,extra){connection.peersBackup[remoteUserId]||(connection.peersBackup[remoteUserId]={userid:remoteUserId,extra:{}}),connection.peersBackup[remoteUserId].extra=extra}function onMessageEvent(message){if(message.remoteUserId==connection.userid){if(connection.peers[message.sender]&&connection.peers[message.sender].extra!=message.message.extra&&(connection.peers[message.sender].extra=message.extra,connection.onExtraDataUpdated({userid:message.sender,extra:message.extra}),updateExtraBackup(message.sender,message.extra)),message.message.streamSyncNeeded&&connection.peers[message.sender]){var stream=connection.streamEvents[message.message.streamid];if(!stream||!stream.stream)return;var action=message.message.action;if(\"ended\"===action||\"inactive\"===action||\"stream-removed\"===action)return connection.peersBackup[stream.userid]&&(stream.extra=connection.peersBackup[stream.userid].extra),void connection.onstreamended(stream);var type=\"both\"!=message.message.type?message.message.type:null;return void(\"function\"==typeof stream.stream[action]&&stream.stream[action](type))}if(\"dropPeerConnection\"===message.message)return void connection.deletePeer(message.sender);if(message.message.allParticipants)return message.message.allParticipants.indexOf(message.sender)===-1&&message.message.allParticipants.push(message.sender),void message.message.allParticipants.forEach(function(participant){mPeer[connection.peers[participant]?\"renegotiatePeer\":\"createNewPeer\"](participant,{localPeerSdpConstraints:{OfferToReceiveAudio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:connection.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:connection.session.oneway?!!connection.session.audio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:connection.session.oneway?!!connection.session.video||!!connection.session.screen:connection.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!connection.session.oneway||\"one-way\"===connection.direction,isDataOnly:isData(connection.session)})});if(message.message.newParticipant){if(message.message.newParticipant==connection.userid)return;if(connection.peers[message.message.newParticipant])return;return void mPeer.createNewPeer(message.message.newParticipant,message.message.userPreferences||{localPeerSdpConstraints:{OfferToReceiveAudio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:connection.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:connection.session.oneway?!!connection.session.audio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:connection.session.oneway?!!connection.session.video||!!connection.session.screen:connection.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!connection.session.oneway||\"one-way\"===connection.direction,isDataOnly:isData(connection.session)})}if(message.message.readyForOffer&&(connection.attachStreams.length&&(connection.waitingForLocalMedia=!1),connection.waitingForLocalMedia))return void setTimeout(function(){onMessageEvent(message)},1);if(message.message.newParticipationRequest&&message.sender!==connection.userid){connection.peers[message.sender]&&connection.deletePeer(message.sender);var userPreferences={extra:message.extra||{},localPeerSdpConstraints:message.message.remotePeerSdpConstraints||{OfferToReceiveAudio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:connection.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:message.message.localPeerSdpConstraints||{OfferToReceiveAudio:connection.session.oneway?!!connection.session.audio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:connection.session.oneway?!!connection.session.video||!!connection.session.screen:connection.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:\"undefined\"!=typeof message.message.isOneWay?message.message.isOneWay:!!connection.session.oneway||\"one-way\"===connection.direction,isDataOnly:\"undefined\"!=typeof message.message.isDataOnly?message.message.isDataOnly:isData(connection.session),dontGetRemoteStream:\"undefined\"!=typeof message.message.isOneWay?message.message.isOneWay:!!connection.session.oneway||\"one-way\"===connection.direction,dontAttachLocalStream:!!message.message.dontGetRemoteStream,connectionDescription:message,successCallback:function(){}};return void connection.onNewParticipant(message.sender,userPreferences)}return message.message.changedUUID&&connection.peers[message.message.oldUUID]&&(connection.peers[message.message.newUUID]=connection.peers[message.message.oldUUID],delete connection.peers[message.message.oldUUID]),message.message.userLeft?(mPeer.onUserLeft(message.sender),void(message.message.autoCloseEntireSession&&connection.leave())):void mPeer.addNegotiatedMessage(message.message,message.sender)}}var parameters=\"\";parameters+=\"?userid=\"+connection.userid,parameters+=\"&sessionid=\"+connection.sessionid,parameters+=\"&msgEvent=\"+connection.socketMessageEvent,parameters+=\"&socketCustomEvent=\"+connection.socketCustomEvent,parameters+=\"&autoCloseEntireSession=\"+!!connection.autoCloseEntireSession,connection.session.broadcast===!0&&(parameters+=\"&oneToMany=true\"),parameters+=\"&maxParticipantsAllowed=\"+connection.maxParticipantsAllowed,connection.enableScalableBroadcast&&(parameters+=\"&enableScalableBroadcast=true\",parameters+=\"&maxRelayLimitPerUser=\"+(connection.maxRelayLimitPerUser||2)),parameters+=\"&extra=\"+JSON.stringify(connection.extra||{}),connection.socketCustomParameters&&(parameters+=connection.socketCustomParameters);try{io.sockets={}}catch(e){}if(connection.socketURL||(connection.socketURL=\"/\"),\"/\"!=connection.socketURL.substr(connection.socketURL.length-1,1))throw'\"socketURL\" MUST end with a slash.';connection.enableLogs&&(\"/\"==connection.socketURL?console.info(\"socket.io url is: \",location.origin+\"/\"):console.info(\"socket.io url is: \",connection.socketURL));try{connection.socket=io(connection.socketURL+parameters)}catch(e){connection.socket=io.connect(connection.socketURL+parameters,connection.socketOptions)}var mPeer=connection.multiPeersHandler;connection.socket.on(\"extra-data-updated\",function(remoteUserId,extra){connection.peers[remoteUserId]&&(connection.peers[remoteUserId].extra=extra,connection.onExtraDataUpdated({userid:remoteUserId,extra:extra}),updateExtraBackup(remoteUserId,extra))}),connection.socket.on(connection.socketMessageEvent,onMessageEvent);var alreadyConnected=!1;connection.socket.resetProps=function(){alreadyConnected=!1},connection.socket.on(\"connect\",function(){alreadyConnected||(alreadyConnected=!0,connection.enableLogs&&console.info(\"socket.io connection is opened.\"),setTimeout(function(){connection.socket.emit(\"extra-data-updated\",connection.extra)},1e3),connectCallback&&connectCallback(connection.socket))}),connection.socket.on(\"disconnect\",function(event){connection.onSocketDisconnect(event)}),connection.socket.on(\"error\",function(event){connection.onSocketError(event)}),connection.socket.on(\"user-disconnected\",function(remoteUserId){remoteUserId!==connection.userid&&(connection.onUserStatusChanged({userid:remoteUserId,status:\"offline\",extra:connection.peers[remoteUserId]?connection.peers[remoteUserId].extra||{}:{}}),connection.deletePeer(remoteUserId))}),connection.socket.on(\"user-connected\",function(userid){userid!==connection.userid&&connection.onUserStatusChanged({userid:userid,status:\"online\",extra:connection.peers[userid]?connection.peers[userid].extra||{}:{}})}),connection.socket.on(\"closed-entire-session\",function(sessionid,extra){connection.leave(),connection.onEntireSessionClosed({sessionid:sessionid,userid:sessionid,extra:extra})}),connection.socket.on(\"userid-already-taken\",function(useridAlreadyTaken,yourNewUserId){connection.onUserIdAlreadyTaken(useridAlreadyTaken,yourNewUserId)}),connection.socket.on(\"logs\",function(log){connection.enableLogs&&console.debug(\"server-logs\",log)}),connection.socket.on(\"number-of-broadcast-viewers-updated\",function(data){connection.onNumberOfBroadcastViewersUpdated(data)}),connection.socket.on(\"set-isInitiator-true\",function(sessionid){sessionid==connection.sessionid&&(connection.isInitiator=!0)})}function MultiPeers(connection){function initFileBufferReader(){connection.fbr=new FileBufferReader,connection.fbr.onProgress=function(chunk){connection.onFileProgress(chunk)},connection.fbr.onBegin=function(file){connection.onFileStart(file)},connection.fbr.onEnd=function(file){connection.onFileEnd(file)}}var self=this,skipPeers=[\"getAllParticipants\",\"getLength\",\"selectFirst\",\"streams\",\"send\",\"forEach\"];connection.peers={getLength:function(){var numberOfPeers=0;for(var peer in this)skipPeers.indexOf(peer)==-1&&numberOfPeers++;return numberOfPeers},selectFirst:function(){var firstPeer;for(var peer in this)skipPeers.indexOf(peer)==-1&&(firstPeer=this[peer]);return firstPeer},getAllParticipants:function(sender){var allPeers=[];for(var peer in this)skipPeers.indexOf(peer)==-1&&peer!=sender&&allPeers.push(peer);return allPeers},forEach:function(callbcak){this.getAllParticipants().forEach(function(participant){callbcak(connection.peers[participant])})},send:function(data,remoteUserId){var that=this;if(!isNull(data.size)&&!isNull(data.type)){if(connection.enableFileSharing)return void self.shareFile(data,remoteUserId);\"string\"!=typeof data&&(data=JSON.stringify(data))}if(!(\"text\"===data.type||data instanceof ArrayBuffer||data instanceof DataView))return void TextSender.send({text:data,channel:this,connection:connection,remoteUserId:remoteUserId});if(\"text\"===data.type&&(data=JSON.stringify(data)),remoteUserId){var remoteUser=connection.peers[remoteUserId];if(remoteUser)return remoteUser.channels.length?void remoteUser.channels.forEach(function(channel){channel.send(data)}):(connection.peers[remoteUserId].createDataChannel(),connection.renegotiate(remoteUserId),void setTimeout(function(){that.send(data,remoteUserId)},3e3))}this.getAllParticipants().forEach(function(participant){return that[participant].channels.length?void that[participant].channels.forEach(function(channel){channel.send(data)}):(connection.peers[participant].createDataChannel(),connection.renegotiate(participant),void setTimeout(function(){that[participant].channels.forEach(function(channel){channel.send(data)})},3e3))})}},this.uuid=connection.userid,this.getLocalConfig=function(remoteSdp,remoteUserId,userPreferences){return userPreferences||(userPreferences={}),{streamsToShare:userPreferences.streamsToShare||{},rtcMultiConnection:connection,connectionDescription:userPreferences.connectionDescription,userid:remoteUserId,localPeerSdpConstraints:userPreferences.localPeerSdpConstraints,remotePeerSdpConstraints:userPreferences.remotePeerSdpConstraints,dontGetRemoteStream:!!userPreferences.dontGetRemoteStream,dontAttachLocalStream:!!userPreferences.dontAttachLocalStream,renegotiatingPeer:!!userPreferences.renegotiatingPeer,peerRef:userPreferences.peerRef,channels:userPreferences.channels||[],onLocalSdp:function(localSdp){self.onNegotiationNeeded(localSdp,remoteUserId)},onLocalCandidate:function(localCandidate){localCandidate=OnIceCandidateHandler.processCandidates(connection,localCandidate),localCandidate&&self.onNegotiationNeeded(localCandidate,remoteUserId)},remoteSdp:remoteSdp,onDataChannelMessage:function(message){if(!connection.fbr&&connection.enableFileSharing&&initFileBufferReader(),\"string\"==typeof message||!connection.enableFileSharing)return void self.onDataChannelMessage(message,remoteUserId);var that=this;return message instanceof ArrayBuffer||message instanceof DataView?void connection.fbr.convertToObject(message,function(object){that.onDataChannelMessage(object)}):message.readyForNextChunk?void connection.fbr.getNextChunk(message,function(nextChunk,isLastChunk){connection.peers[remoteUserId].channels.forEach(function(channel){channel.send(nextChunk)})},remoteUserId):message.chunkMissing?void connection.fbr.chunkMissing(message):void connection.fbr.addChunk(message,function(promptNextChunk){connection.peers[remoteUserId].peer.channel.send(promptNextChunk)})},onDataChannelError:function(error){self.onDataChannelError(error,remoteUserId)},onDataChannelOpened:function(channel){self.onDataChannelOpened(channel,remoteUserId)},onDataChannelClosed:function(event){self.onDataChannelClosed(event,remoteUserId)},onRemoteStream:function(stream){connection.peers[remoteUserId]&&connection.peers[remoteUserId].streams.push(stream),self.onGettingRemoteMedia(stream,remoteUserId)},onRemoteStreamRemoved:function(stream){self.onRemovingRemoteMedia(stream,remoteUserId)},onPeerStateChanged:function(states){self.onPeerStateChanged(states),\"new\"===states.iceConnectionState&&self.onNegotiationStarted(remoteUserId,states),\"connected\"===states.iceConnectionState&&self.onNegotiationCompleted(remoteUserId,states),states.iceConnectionState.search(/closed|failed/gi)!==-1&&(self.onUserLeft(remoteUserId),self.disconnectWith(remoteUserId))}}},this.createNewPeer=function(remoteUserId,userPreferences){if(!(connection.maxParticipantsAllowed<=connection.getAllParticipants().length)){if(userPreferences=userPreferences||{},connection.isInitiator&&connection.session.audio&&\"two-way\"===connection.session.audio&&!userPreferences.streamsToShare&&(userPreferences.isOneWay=!1,userPreferences.isDataOnly=!1,userPreferences.session=connection.session),!userPreferences.isOneWay&&!userPreferences.isDataOnly)return userPreferences.isOneWay=!0,void this.onNegotiationNeeded({enableMedia:!0,userPreferences:userPreferences},remoteUserId);userPreferences=connection.setUserPreferences(userPreferences,remoteUserId);var localConfig=this.getLocalConfig(null,remoteUserId,userPreferences);connection.peers[remoteUserId]=new PeerInitiator(localConfig)}},this.createAnsweringPeer=function(remoteSdp,remoteUserId,userPreferences){userPreferences=connection.setUserPreferences(userPreferences||{},remoteUserId);var localConfig=this.getLocalConfig(remoteSdp,remoteUserId,userPreferences);connection.peers[remoteUserId]=new PeerInitiator(localConfig)},this.renegotiatePeer=function(remoteUserId,userPreferences,remoteSdp){if(!connection.peers[remoteUserId])return void(connection.enableLogs&&console.error(\"Peer (\"+remoteUserId+\") does not exist. Renegotiation skipped.\"));userPreferences||(userPreferences={}),userPreferences.renegotiatingPeer=!0,userPreferences.peerRef=connection.peers[remoteUserId].peer,userPreferences.channels=connection.peers[remoteUserId].channels;var localConfig=this.getLocalConfig(remoteSdp,remoteUserId,userPreferences);connection.peers[remoteUserId]=new PeerInitiator(localConfig)},this.replaceTrack=function(track,remoteUserId,isVideoTrack){if(!connection.peers[remoteUserId])throw\"This peer (\"+remoteUserId+\") does not exist.\";var peer=connection.peers[remoteUserId].peer;return peer.getSenders&&\"function\"==typeof peer.getSenders&&peer.getSenders().length?void peer.getSenders().forEach(function(rtpSender){isVideoTrack&&\"video\"===rtpSender.track.kind&&(connection.peers[remoteUserId].peer.lastVideoTrack=rtpSender.track,rtpSender.replaceTrack(track)),isVideoTrack||\"audio\"!==rtpSender.track.kind||(connection.peers[remoteUserId].peer.lastAudioTrack=rtpSender.track,rtpSender.replaceTrack(track))}):(console.warn(\"RTPSender.replaceTrack is NOT supported.\"),void this.renegotiatePeer(remoteUserId))},this.onNegotiationNeeded=function(message,remoteUserId){},this.addNegotiatedMessage=function(message,remoteUserId){if(message.type&&message.sdp)return\"answer\"==message.type&&connection.peers[remoteUserId]&&connection.peers[remoteUserId].addRemoteSdp(message),\"offer\"==message.type&&(message.renegotiatingPeer?this.renegotiatePeer(remoteUserId,null,message):this.createAnsweringPeer(message,remoteUserId)),void(connection.enableLogs&&console.log(\"Remote peer's sdp:\",message.sdp));if(message.candidate)return connection.peers[remoteUserId]&&connection.peers[remoteUserId].addRemoteCandidate(message),void(connection.enableLogs&&console.log(\"Remote peer's candidate pairs:\",message.candidate));if(message.enableMedia){connection.session=message.userPreferences.session||connection.session,connection.session.oneway&&connection.attachStreams.length&&(connection.attachStreams=[]),message.userPreferences.isDataOnly&&connection.attachStreams.length&&(connection.attachStreams.length=[]);var streamsToShare={};connection.attachStreams.forEach(function(stream){streamsToShare[stream.streamid]={isAudio:!!stream.isAudio,isVideo:!!stream.isVideo,isScreen:!!stream.isScreen}}),message.userPreferences.streamsToShare=streamsToShare,self.onNegotiationNeeded({readyForOffer:!0,userPreferences:message.userPreferences},remoteUserId)}message.readyForOffer&&connection.onReadyForOffer(remoteUserId,message.userPreferences)},this.onGettingRemoteMedia=function(stream,remoteUserId){},this.onRemovingRemoteMedia=function(stream,remoteUserId){},this.onGettingLocalMedia=function(localStream){},this.onLocalMediaError=function(error,constraints){connection.onMediaError(error,constraints)},this.shareFile=function(file,remoteUserId){initFileBufferReader(),connection.fbr.readAsArrayBuffer(file,function(uuid){var arrayOfUsers=connection.getAllParticipants();remoteUserId&&(arrayOfUsers=[remoteUserId]),arrayOfUsers.forEach(function(participant){connection.fbr.getNextChunk(uuid,function(nextChunk){connection.peers[participant].channels.forEach(function(channel){channel.send(nextChunk)})},participant)})},{userid:connection.userid,chunkSize:\"Firefox\"===DetectRTC.browser.name?15e3:connection.chunkSize||0})};var textReceiver=new TextReceiver(connection);this.onDataChannelMessage=function(message,remoteUserId){textReceiver.receive(JSON.parse(message),remoteUserId,connection.peers[remoteUserId]?connection.peers[remoteUserId].extra:{})},this.onDataChannelClosed=function(event,remoteUserId){event.userid=remoteUserId,event.extra=connection.peers[remoteUserId]?connection.peers[remoteUserId].extra:{},connection.onclose(event)},this.onDataChannelError=function(error,remoteUserId){error.userid=remoteUserId,event.extra=connection.peers[remoteUserId]?connection.peers[remoteUserId].extra:{},connection.onerror(error)},this.onDataChannelOpened=function(channel,remoteUserId){return connection.peers[remoteUserId].channels.length?void(connection.peers[remoteUserId].channels=[channel]):(connection.peers[remoteUserId].channels.push(channel),void connection.onopen({userid:remoteUserId,extra:connection.peers[remoteUserId]?connection.peers[remoteUserId].extra:{},channel:channel}))},this.onPeerStateChanged=function(state){connection.onPeerStateChanged(state)},this.onNegotiationStarted=function(remoteUserId,states){},this.onNegotiationCompleted=function(remoteUserId,states){},this.getRemoteStreams=function(remoteUserId){return remoteUserId=remoteUserId||connection.peers.getAllParticipants()[0],connection.peers[remoteUserId]?connection.peers[remoteUserId].streams:[]}}function fireEvent(obj,eventName,args){if(\"undefined\"!=typeof CustomEvent){var eventDetail={arguments:args,__exposedProps__:args},event=new CustomEvent(eventName,eventDetail);obj.dispatchEvent(event)}}function setHarkEvents(connection,streamEvent){if(streamEvent.stream&&getTracks(streamEvent.stream,\"audio\").length){if(!connection||!streamEvent)throw\"Both arguments are required.\";if(connection.onspeaking&&connection.onsilence){if(\"undefined\"==typeof hark)throw\"hark.js not found.\";hark(streamEvent.stream,{onspeaking:function(){connection.onspeaking(streamEvent)},onsilence:function(){connection.onsilence(streamEvent)},onvolumechange:function(volume,threshold){connection.onvolumechange&&connection.onvolumechange(merge({volume:volume,threshold:threshold},streamEvent))}})}}}function setMuteHandlers(connection,streamEvent){streamEvent.stream&&streamEvent.stream&&streamEvent.stream.addEventListener&&(streamEvent.stream.addEventListener(\"mute\",function(event){event=connection.streamEvents[streamEvent.streamid],event.session={audio:\"audio\"===event.muteType,video:\"video\"===event.muteType},connection.onmute(event)},!1),streamEvent.stream.addEventListener(\"unmute\",function(event){event=connection.streamEvents[streamEvent.streamid],event.session={audio:\"audio\"===event.unmuteType,video:\"video\"===event.unmuteType},connection.onunmute(event)},!1))}function getRandomString(){if(window.crypto&&window.crypto.getRandomValues&&navigator.userAgent.indexOf(\"Safari\")===-1){for(var a=window.crypto.getRandomValues(new Uint32Array(3)),token=\"\",i=0,l=a.length;i<l;i++)token+=a[i].toString(36);return token}return(Math.random()*(new Date).getTime()).toString(36).replace(/\\./g,\"\")}function getRMCMediaElement(stream,callback,connection){if(!connection.autoCreateMediaElement)return void callback({});var isAudioOnly=!1;getTracks(stream,\"video\").length||stream.isVideo||stream.isScreen||(isAudioOnly=!0),\"Firefox\"===DetectRTC.browser.name&&(connection.session.video||connection.session.screen)&&(isAudioOnly=!1);var mediaElement=document.createElement(isAudioOnly?\"audio\":\"video\");if(mediaElement.srcObject=stream,mediaElement.setAttribute(\"autoplay\",!0),mediaElement.setAttribute(\"playsinline\",!0),mediaElement.setAttribute(\"controls\",!0),mediaElement.setAttribute(\"muted\",!1),mediaElement.setAttribute(\"volume\",1),\"Firefox\"===DetectRTC.browser.name){var streamEndedEvent=\"ended\";\"oninactive\"in mediaElement&&(streamEndedEvent=\"inactive\"),mediaElement.addEventListener(streamEndedEvent,function(){if(currentUserMediaRequest.remove(stream.idInstance),\"local\"===stream.type){streamEndedEvent=\"ended\",\"oninactive\"in stream&&(streamEndedEvent=\"inactive\"),StreamsHandler.onSyncNeeded(stream.streamid,streamEndedEvent),connection.attachStreams.forEach(function(aStream,idx){stream.streamid===aStream.streamid&&delete connection.attachStreams[idx]});var newStreamsArray=[];connection.attachStreams.forEach(function(aStream){aStream&&newStreamsArray.push(aStream)}),connection.attachStreams=newStreamsArray;var streamEvent=connection.streamEvents[stream.streamid];if(streamEvent)return void connection.onstreamended(streamEvent);this.parentNode&&this.parentNode.removeChild(this)}},!1)}var played=mediaElement.play();if(\"undefined\"!=typeof played){var cbFired=!1;setTimeout(function(){cbFired||(cbFired=!0,callback(mediaElement))},1e3),played.then(function(){cbFired||(cbFired=!0,callback(mediaElement))})[\"catch\"](function(error){cbFired||(cbFired=!0,callback(mediaElement))})}else callback(mediaElement)}function listenEventHandler(eventName,eventHandler){window.removeEventListener(eventName,eventHandler),window.addEventListener(eventName,eventHandler,!1)}function removeNullEntries(array){var newArray=[];return array.forEach(function(item){item&&newArray.push(item)}),newArray}function isData(session){return!session.audio&&!session.video&&!session.screen&&session.data}function isNull(obj){return\"undefined\"==typeof obj}function isString(obj){return\"string\"==typeof obj}function isAudioPlusTab(connection,audioPlusTab){return(!connection.session.audio||\"two-way\"!==connection.session.audio)&&(\"Firefox\"===DetectRTC.browser.name&&audioPlusTab!==!1||!(\"Chrome\"!==DetectRTC.browser.name||DetectRTC.browser.version<50)&&(typeof audioPlusTab===!0||!(\"undefined\"!=typeof audioPlusTab||!connection.session.audio||!connection.session.screen||connection.session.video)&&(audioPlusTab=!0,!0)))}function getTracks(stream,kind){return stream&&stream.getTracks?stream.getTracks().filter(function(t){return t.kind===(kind||\"audio\")}):[]}function isUnifiedPlanSupportedDefault(){var canAddTransceiver=!1;try{if(\"undefined\"==typeof RTCRtpTransceiver)return!1;if(!(\"currentDirection\"in RTCRtpTransceiver.prototype))return!1;var tempPc=new RTCPeerConnection;try{tempPc.addTransceiver(\"audio\"),canAddTransceiver=!0}catch(e){}tempPc.close()}catch(e){canAddTransceiver=!1}return canAddTransceiver&&isUnifiedPlanSuppored()}function isUnifiedPlanSuppored(){var isUnifiedPlanSupported=!1;try{var pc=new RTCPeerConnection({sdpSemantics:\"unified-plan\"});try{var config=pc.getConfiguration();isUnifiedPlanSupported=\"unified-plan\"==config.sdpSemantics||(\"plan-b\"==config.sdpSemantics,!1)}catch(e){isUnifiedPlanSupported=!1}}catch(e){isUnifiedPlanSupported=!1}return isUnifiedPlanSupported}function setCordovaAPIs(){if(\"undefined\"!=typeof cordova&&\"undefined\"!=typeof cordova.plugins&&\"undefined\"!=typeof cordova.plugins.iosrtc){var iosrtc=cordova.plugins.iosrtc;window.webkitRTCPeerConnection=iosrtc.RTCPeerConnection,window.RTCSessionDescription=iosrtc.RTCSessionDescription,window.RTCIceCandidate=iosrtc.RTCIceCandidate,window.MediaStream=iosrtc.MediaStream,window.MediaStreamTrack=iosrtc.MediaStreamTrack,navigator.getUserMedia=navigator.webkitGetUserMedia=iosrtc.getUserMedia,iosrtc.debug.enable(\"iosrtc*\"),\"function\"==typeof iosrtc.selectAudioOutput&&iosrtc.selectAudioOutput(window.iOSDefaultAudioOutputDevice||\"speaker\"),iosrtc.registerGlobals()}}function setSdpConstraints(config){var sdpConstraints={OfferToReceiveAudio:!!config.OfferToReceiveAudio,OfferToReceiveVideo:!!config.OfferToReceiveVideo};return sdpConstraints}function PeerInitiator(config){function setChannelEvents(channel){channel.binaryType=\"arraybuffer\",channel.onmessage=function(event){config.onDataChannelMessage(event.data)},channel.onopen=function(){config.onDataChannelOpened(channel)},channel.onerror=function(error){config.onDataChannelError(error)},channel.onclose=function(event){config.onDataChannelClosed(event)},channel.internalSend=channel.send,channel.send=function(data){\"open\"===channel.readyState&&channel.internalSend(data)},peer.channel=channel}function createOfferOrAnswer(_method){peer[_method](defaults.sdpConstraints).then(function(localSdp){\"Safari\"!==DetectRTC.browser.name&&(localSdp.sdp=connection.processSdp(localSdp.sdp)),peer.setLocalDescription(localSdp).then(function(){connection.trickleIce&&(config.onLocalSdp({type:localSdp.type,sdp:localSdp.sdp,remotePeerSdpConstraints:config.remotePeerSdpConstraints||!1,renegotiatingPeer:!!config.renegotiatingPeer||!1,connectionDescription:self.connectionDescription,dontGetRemoteStream:!!config.dontGetRemoteStream,extra:connection?connection.extra:{},streamsToShare:streamsToShare}),connection.onSettingLocalDescription(self))},function(error){connection.enableLogs&&console.error(\"setLocalDescription error\",error)})},function(error){connection.enableLogs&&console.error(\"sdp-error\",error)})}if(\"undefined\"!=typeof window.RTCPeerConnection?RTCPeerConnection=window.RTCPeerConnection:\"undefined\"!=typeof mozRTCPeerConnection?RTCPeerConnection=mozRTCPeerConnection:\"undefined\"!=typeof webkitRTCPeerConnection&&(RTCPeerConnection=webkitRTCPeerConnection),RTCSessionDescription=window.RTCSessionDescription||window.mozRTCSessionDescription,RTCIceCandidate=window.RTCIceCandidate||window.mozRTCIceCandidate,MediaStreamTrack=window.MediaStreamTrack,!RTCPeerConnection)throw\"WebRTC 1.0 (RTCPeerConnection) API are NOT available in this browser.\";var connection=config.rtcMultiConnection;this.extra=config.remoteSdp?config.remoteSdp.extra:connection.extra,this.userid=config.userid,this.streams=[],this.channels=config.channels||[],this.connectionDescription=config.connectionDescription,this.addStream=function(session){connection.addStream(session,self.userid)},this.removeStream=function(streamid){connection.removeStream(streamid,self.userid)};var self=this;config.remoteSdp&&(this.connectionDescription=config.remoteSdp.connectionDescription);var allRemoteStreams={};defaults.sdpConstraints=setSdpConstraints({OfferToReceiveAudio:!0,OfferToReceiveVideo:!0});var peer,renegotiatingPeer=!!config.renegotiatingPeer;config.remoteSdp&&(renegotiatingPeer=!!config.remoteSdp.renegotiatingPeer);var localStreams=[];if(connection.attachStreams.forEach(function(stream){stream&&localStreams.push(stream)}),renegotiatingPeer)peer=config.peerRef;else{var iceTransports=\"all\";(connection.candidates.turn||connection.candidates.relay)&&(connection.candidates.stun||connection.candidates.reflexive||connection.candidates.host||(iceTransports=\"relay\"));try{var params={iceServers:connection.iceServers,iceTransportPolicy:connection.iceTransportPolicy||iceTransports};\"undefined\"!=typeof connection.iceCandidatePoolSize&&(params.iceCandidatePoolSize=connection.iceCandidatePoolSize),\"undefined\"!=typeof connection.bundlePolicy&&(params.bundlePolicy=connection.bundlePolicy),\"undefined\"!=typeof connection.rtcpMuxPolicy&&(params.rtcpMuxPolicy=connection.rtcpMuxPolicy),connection.sdpSemantics&&(params.sdpSemantics=connection.sdpSemantics||\"unified-plan\"),connection.iceServers&&connection.iceServers.length||(params=null,connection.optionalArgument=null),peer=new RTCPeerConnection(params,connection.optionalArgument)}catch(e){try{var params={iceServers:connection.iceServers};peer=new RTCPeerConnection(params)}catch(e){peer=new RTCPeerConnection}}}!peer.getRemoteStreams&&peer.getReceivers&&(peer.getRemoteStreams=function(){var stream=new MediaStream;return peer.getReceivers().forEach(function(receiver){stream.addTrack(receiver.track)}),[stream]}),!peer.getLocalStreams&&peer.getSenders&&(peer.getLocalStreams=function(){var stream=new MediaStream;return peer.getSenders().forEach(function(sender){stream.addTrack(sender.track)}),[stream]}),peer.onicecandidate=function(event){if(event.candidate)connection.trickleIce&&config.onLocalCandidate({candidate:event.candidate.candidate,sdpMid:event.candidate.sdpMid,sdpMLineIndex:event.candidate.sdpMLineIndex});else if(!connection.trickleIce){var localSdp=peer.localDescription;config.onLocalSdp({type:localSdp.type,sdp:localSdp.sdp,remotePeerSdpConstraints:config.remotePeerSdpConstraints||!1,renegotiatingPeer:!!config.renegotiatingPeer||!1,connectionDescription:self.connectionDescription,dontGetRemoteStream:!!config.dontGetRemoteStream,extra:connection?connection.extra:{},streamsToShare:streamsToShare})}},localStreams.forEach(function(localStream){config.remoteSdp&&config.remoteSdp.remotePeerSdpConstraints&&config.remoteSdp.remotePeerSdpConstraints.dontGetRemoteStream||config.dontAttachLocalStream||(localStream=connection.beforeAddingStream(localStream,self),localStream&&(peer.getLocalStreams().forEach(function(stream){localStream&&stream.id==localStream.id&&(localStream=null)}),localStream&&localStream.getTracks&&localStream.getTracks().forEach(function(track){try{peer.addTrack(track,localStream)}catch(e){}})))}),peer.oniceconnectionstatechange=peer.onsignalingstatechange=function(){var extra=self.extra;connection.peers[self.userid]&&(extra=connection.peers[self.userid].extra||extra),peer&&(config.onPeerStateChanged({iceConnectionState:peer.iceConnectionState,iceGatheringState:peer.iceGatheringState,signalingState:peer.signalingState,extra:extra,userid:self.userid}),peer&&peer.iceConnectionState&&peer.iceConnectionState.search(/closed|failed/gi)!==-1&&self.streams instanceof Array&&self.streams.forEach(function(stream){var streamEvent=connection.streamEvents[stream.id]||{streamid:stream.id,stream:stream,type:\"remote\"};connection.onstreamended(streamEvent)}))};var sdpConstraints={OfferToReceiveAudio:!!localStreams.length,OfferToReceiveVideo:!!localStreams.length};config.localPeerSdpConstraints&&(sdpConstraints=config.localPeerSdpConstraints),defaults.sdpConstraints=setSdpConstraints(sdpConstraints);var dontDuplicate={};peer.ontrack=function(event){if(event&&\"track\"===event.type){if(event.stream=event.streams[event.streams.length-1],event.stream.id||(event.stream.id=event.track.id),dontDuplicate[event.stream.id]&&\"Safari\"!==DetectRTC.browser.name)return void(event.track&&(event.track.onended=function(){peer&&peer.onremovestream(event)}));dontDuplicate[event.stream.id]=event.stream.id;var streamsToShare={};config.remoteSdp&&config.remoteSdp.streamsToShare?streamsToShare=config.remoteSdp.streamsToShare:config.streamsToShare&&(streamsToShare=config.streamsToShare);\r\nvar streamToShare=streamsToShare[event.stream.id];streamToShare?(event.stream.isAudio=streamToShare.isAudio,event.stream.isVideo=streamToShare.isVideo,event.stream.isScreen=streamToShare.isScreen):(event.stream.isVideo=!!getTracks(event.stream,\"video\").length,event.stream.isAudio=!event.stream.isVideo,event.stream.isScreen=!1),event.stream.streamid=event.stream.id,allRemoteStreams[event.stream.id]=event.stream,config.onRemoteStream(event.stream),event.stream.getTracks().forEach(function(track){track.onended=function(){peer&&peer.onremovestream(event)}}),event.stream.onremovetrack=function(){peer&&peer.onremovestream(event)}}},peer.onremovestream=function(event){event.stream.streamid=event.stream.id,allRemoteStreams[event.stream.id]&&delete allRemoteStreams[event.stream.id],config.onRemoteStreamRemoved(event.stream)},\"function\"!=typeof peer.removeStream&&(peer.removeStream=function(stream){stream.getTracks().forEach(function(track){peer.removeTrack(track,stream)})}),this.addRemoteCandidate=function(remoteCandidate){peer.addIceCandidate(new RTCIceCandidate(remoteCandidate))},this.addRemoteSdp=function(remoteSdp,cb){cb=cb||function(){},\"Safari\"!==DetectRTC.browser.name&&(remoteSdp.sdp=connection.processSdp(remoteSdp.sdp)),peer.setRemoteDescription(new RTCSessionDescription(remoteSdp)).then(cb,function(error){connection.enableLogs&&console.error(\"setRemoteDescription failed\",\"\\n\",error,\"\\n\",remoteSdp.sdp),cb()})[\"catch\"](function(error){connection.enableLogs&&console.error(\"setRemoteDescription failed\",\"\\n\",error,\"\\n\",remoteSdp.sdp),cb()})};var isOfferer=!0;config.remoteSdp&&(isOfferer=!1),this.createDataChannel=function(){var channel=peer.createDataChannel(\"sctp\",{});setChannelEvents(channel)},connection.session.data!==!0||renegotiatingPeer||(isOfferer?this.createDataChannel():peer.ondatachannel=function(event){var channel=event.channel;setChannelEvents(channel)}),this.enableDisableVideoEncoding=function(enable){var rtcp;if(peer.getSenders().forEach(function(sender){rtcp||\"video\"!==sender.track.kind||(rtcp=sender)}),rtcp&&rtcp.getParameters){var parameters=rtcp.getParameters();parameters.encodings[1]&&(parameters.encodings[1].active=!!enable),parameters.encodings[2]&&(parameters.encodings[2].active=!!enable),rtcp.setParameters(parameters)}},config.remoteSdp&&(config.remoteSdp.remotePeerSdpConstraints&&(sdpConstraints=config.remoteSdp.remotePeerSdpConstraints),defaults.sdpConstraints=setSdpConstraints(sdpConstraints),this.addRemoteSdp(config.remoteSdp,function(){createOfferOrAnswer(\"createAnswer\")})),\"two-way\"!=connection.session.audio&&\"two-way\"!=connection.session.video&&\"two-way\"!=connection.session.screen||(defaults.sdpConstraints=setSdpConstraints({OfferToReceiveAudio:\"two-way\"==connection.session.audio||config.remoteSdp&&config.remoteSdp.remotePeerSdpConstraints&&config.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio,OfferToReceiveVideo:\"two-way\"==connection.session.video||\"two-way\"==connection.session.screen||config.remoteSdp&&config.remoteSdp.remotePeerSdpConstraints&&config.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio}));var streamsToShare={};peer.getLocalStreams().forEach(function(stream){streamsToShare[stream.streamid]={isAudio:!!stream.isAudio,isVideo:!!stream.isVideo,isScreen:!!stream.isScreen}}),isOfferer&&createOfferOrAnswer(\"createOffer\"),peer.nativeClose=peer.close,peer.close=function(){if(peer){try{peer.nativeClose!==peer.close&&peer.nativeClose()}catch(e){}peer=null,self.peer=null}},this.peer=peer}function setStreamType(constraints,stream){constraints.mandatory&&constraints.mandatory.chromeMediaSource?stream.isScreen=!0:constraints.mozMediaSource||constraints.mediaSource?stream.isScreen=!0:constraints.video?stream.isVideo=!0:constraints.audio&&(stream.isAudio=!0)}function getUserMediaHandler(options){function streaming(stream,returnBack){setStreamType(options.localMediaConstraints,stream);var streamEndedEvent=\"ended\";\"oninactive\"in stream&&(streamEndedEvent=\"inactive\"),stream.addEventListener(streamEndedEvent,function(){delete currentUserMediaRequest.streams[idInstance],currentUserMediaRequest.mutex=!1,currentUserMediaRequest.queueRequests.indexOf(options)&&(delete currentUserMediaRequest.queueRequests[currentUserMediaRequest.queueRequests.indexOf(options)],currentUserMediaRequest.queueRequests=removeNullEntries(currentUserMediaRequest.queueRequests))},!1),currentUserMediaRequest.streams[idInstance]={stream:stream},currentUserMediaRequest.mutex=!1,currentUserMediaRequest.queueRequests.length&&getUserMediaHandler(currentUserMediaRequest.queueRequests.shift()),options.onGettingLocalMedia(stream,returnBack)}if(currentUserMediaRequest.mutex===!0)return void currentUserMediaRequest.queueRequests.push(options);currentUserMediaRequest.mutex=!0;var idInstance=JSON.stringify(options.localMediaConstraints);if(currentUserMediaRequest.streams[idInstance])streaming(currentUserMediaRequest.streams[idInstance].stream,!0);else{var isBlackBerry=!!/BB10|BlackBerry/i.test(navigator.userAgent||\"\");if(isBlackBerry||\"undefined\"==typeof navigator.mediaDevices||\"function\"!=typeof navigator.mediaDevices.getUserMedia)return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,void navigator.getUserMedia(options.localMediaConstraints,function(stream){stream.streamid=stream.streamid||stream.id||getRandomString(),stream.idInstance=idInstance,streaming(stream)},function(error){options.onLocalMediaError(error,options.localMediaConstraints)});if(\"undefined\"==typeof navigator.mediaDevices){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;var getUserMediaStream,getUserMediaError,getUserMediaSuccess=function(){},getUserMediaFailure=function(){};navigator.mediaDevices={getUserMedia:function(hints){return navigator.getUserMedia(hints,function(getUserMediaSuccess){getUserMediaSuccess(stream),getUserMediaStream=stream},function(error){getUserMediaFailure(error),getUserMediaError=error}),{then:function(successCB){return getUserMediaStream?void successCB(getUserMediaStream):(getUserMediaSuccess=successCB,{then:function(failureCB){return getUserMediaError?void failureCB(getUserMediaError):void(getUserMediaFailure=failureCB)}})}}}}}if(options.localMediaConstraints.isScreen===!0){if(navigator.mediaDevices.getDisplayMedia)navigator.mediaDevices.getDisplayMedia(options.localMediaConstraints).then(function(stream){stream.streamid=stream.streamid||stream.id||getRandomString(),stream.idInstance=idInstance,streaming(stream)})[\"catch\"](function(error){options.onLocalMediaError(error,options.localMediaConstraints)});else{if(!navigator.getDisplayMedia)throw new Error(\"getDisplayMedia API is not availabe in this browser.\");navigator.getDisplayMedia(options.localMediaConstraints).then(function(stream){stream.streamid=stream.streamid||stream.id||getRandomString(),stream.idInstance=idInstance,streaming(stream)})[\"catch\"](function(error){options.onLocalMediaError(error,options.localMediaConstraints)})}return}navigator.mediaDevices.getUserMedia(options.localMediaConstraints).then(function(stream){stream.streamid=stream.streamid||stream.id||getRandomString(),stream.idInstance=idInstance,streaming(stream)})[\"catch\"](function(error){options.onLocalMediaError(error,options.localMediaConstraints)})}}function TextReceiver(connection){function receive(data,userid,extra){var uuid=data.uuid;if(content[uuid]||(content[uuid]=[]),content[uuid].push(data.message),data.last){var message=content[uuid].join(\"\");data.isobject&&(message=JSON.parse(message));var receivingTime=(new Date).getTime(),latency=receivingTime-data.sendingTime,e={data:message,userid:userid,extra:extra,latency:latency};connection.autoTranslateText?(e.original=e.data,connection.Translator.TranslateText(e.data,function(translatedText){e.data=translatedText,connection.onmessage(e)})):connection.onmessage(e),delete content[uuid]}}var content={};return{receive:receive}}var browserFakeUserAgent=\"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45\";!function(that){that&&\"undefined\"==typeof window&&\"undefined\"!=typeof global&&(global.navigator={userAgent:browserFakeUserAgent,getUserMedia:function(){}},global.console||(global.console={}),\"undefined\"==typeof global.console.debug&&(global.console.debug=global.console.info=global.console.error=global.console.log=global.console.log||function(){console.log(arguments)}),\"undefined\"==typeof document&&(that.document={},document.createElement=document.captureStream=document.mozCaptureStream=function(){var obj={getContext:function(){return obj},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return\"\"}};return obj},document.addEventListener=document.removeEventListener=that.addEventListener=that.removeEventListener=function(){},that.HTMLVideoElement=that.HTMLMediaElement=function(){}),\"undefined\"==typeof io&&(that.io=function(){return{on:function(eventName,callback){callback=callback||function(){},\"connect\"===eventName&&callback()},emit:function(eventName,data,callback){callback=callback||function(){},\"open-room\"!==eventName&&\"join-room\"!==eventName||callback(!0,data.sessionid,null)}}}),\"undefined\"==typeof location&&(that.location={protocol:\"file:\",href:\"\",hash:\"\",origin:\"self\"}),\"undefined\"==typeof screen&&(that.screen={width:0,height:0}),\"undefined\"==typeof URL&&(that.URL={createObjectURL:function(){return\"\"},revokeObjectURL:function(){return\"\"}}),that.window=global)}(\"undefined\"!=typeof global?global:null),function(){function getBrowserInfo(){var nameOffset,verOffset,ix,nAgt=(navigator.appVersion,navigator.userAgent),browserName=navigator.appName,fullVersion=\"\"+parseFloat(navigator.appVersion),majorVersion=parseInt(navigator.appVersion,10);if(isSafari&&!isChrome&&nAgt.indexOf(\"CriOS\")!==-1&&(isSafari=!1,isChrome=!0),isOpera){browserName=\"Opera\";try{fullVersion=navigator.userAgent.split(\"OPR/\")[1].split(\" \")[0],majorVersion=fullVersion.split(\".\")[0]}catch(e){fullVersion=\"0.0.0.0\",majorVersion=0}}else isIE?(verOffset=nAgt.indexOf(\"rv:\"),verOffset>0?fullVersion=nAgt.substring(verOffset+3):(verOffset=nAgt.indexOf(\"MSIE\"),fullVersion=nAgt.substring(verOffset+5)),browserName=\"IE\"):isChrome?(verOffset=nAgt.indexOf(\"Chrome\"),browserName=\"Chrome\",fullVersion=nAgt.substring(verOffset+7)):isSafari?(verOffset=nAgt.indexOf(\"Safari\"),browserName=\"Safari\",fullVersion=nAgt.substring(verOffset+7),(verOffset=nAgt.indexOf(\"Version\"))!==-1&&(fullVersion=nAgt.substring(verOffset+8)),navigator.userAgent.indexOf(\"Version/\")!==-1&&(fullVersion=navigator.userAgent.split(\"Version/\")[1].split(\" \")[0])):isFirefox?(verOffset=nAgt.indexOf(\"Firefox\"),browserName=\"Firefox\",fullVersion=nAgt.substring(verOffset+8)):(nameOffset=nAgt.lastIndexOf(\" \")+1)<(verOffset=nAgt.lastIndexOf(\"/\"))&&(browserName=nAgt.substring(nameOffset,verOffset),fullVersion=nAgt.substring(verOffset+1),browserName.toLowerCase()===browserName.toUpperCase()&&(browserName=navigator.appName));return isEdge&&(browserName=\"Edge\",fullVersion=navigator.userAgent.split(\"Edge/\")[1]),(ix=fullVersion.search(/[; \\)]/))!==-1&&(fullVersion=fullVersion.substring(0,ix)),majorVersion=parseInt(\"\"+fullVersion,10),isNaN(majorVersion)&&(fullVersion=\"\"+parseFloat(navigator.appVersion),majorVersion=parseInt(navigator.appVersion,10)),{fullVersion:fullVersion,version:majorVersion,name:browserName,isPrivateBrowsing:!1}}function retry(isDone,next){var currentTrial=0,maxRetry=50,isTimeout=!1,id=window.setInterval(function(){isDone()&&(window.clearInterval(id),next(isTimeout)),currentTrial++>maxRetry&&(window.clearInterval(id),isTimeout=!0,next(isTimeout))},10)}function isIE10OrLater(userAgent){var ua=userAgent.toLowerCase();if(0===ua.indexOf(\"msie\")&&0===ua.indexOf(\"trident\"))return!1;var match=/(?:msie|rv:)\\s?([\\d\\.]+)/.exec(ua);return!!(match&&parseInt(match[1],10)>=10)}function detectPrivateMode(callback){var isPrivate;try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){isPrivate=!1},function(e){isPrivate=!0});else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var db;try{db=window.indexedDB.open(\"test\"),db.onerror=function(){return!0}}catch(e){isPrivate=!0}\"undefined\"==typeof isPrivate&&retry(function(){return\"done\"===db.readyState},function(isTimeout){isTimeout||(isPrivate=!db.result)})}else if(isIE10OrLater(window.navigator.userAgent)){isPrivate=!1;try{window.indexedDB||(isPrivate=!0)}catch(e){isPrivate=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem(\"test\",1)}catch(e){isPrivate=!0}\"undefined\"==typeof isPrivate&&(isPrivate=!1,window.localStorage.removeItem(\"test\"))}}catch(e){isPrivate=!1}retry(function(){return\"undefined\"!=typeof isPrivate},function(isTimeout){callback(isPrivate)})}function detectDesktopOS(){for(var cs,unknown=\"-\",nVer=navigator.appVersion,nAgt=navigator.userAgent,os=unknown,clientStrings=[{s:\"Windows 10\",r:/(Windows 10.0|Windows NT 10.0)/},{s:\"Windows 8.1\",r:/(Windows 8.1|Windows NT 6.3)/},{s:\"Windows 8\",r:/(Windows 8|Windows NT 6.2)/},{s:\"Windows 7\",r:/(Windows 7|Windows NT 6.1)/},{s:\"Windows Vista\",r:/Windows NT 6.0/},{s:\"Windows Server 2003\",r:/Windows NT 5.2/},{s:\"Windows XP\",r:/(Windows NT 5.1|Windows XP)/},{s:\"Windows 2000\",r:/(Windows NT 5.0|Windows 2000)/},{s:\"Windows ME\",r:/(Win 9x 4.90|Windows ME)/},{s:\"Windows 98\",r:/(Windows 98|Win98)/},{s:\"Windows 95\",r:/(Windows 95|Win95|Windows_95)/},{s:\"Windows NT 4.0\",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:\"Windows CE\",r:/Windows CE/},{s:\"Windows 3.11\",r:/Win16/},{s:\"Android\",r:/Android/},{s:\"Open BSD\",r:/OpenBSD/},{s:\"Sun OS\",r:/SunOS/},{s:\"Linux\",r:/(Linux|X11)/},{s:\"iOS\",r:/(iPhone|iPad|iPod)/},{s:\"Mac OS X\",r:/Mac OS X/},{s:\"Mac OS\",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:\"QNX\",r:/QNX/},{s:\"UNIX\",r:/UNIX/},{s:\"BeOS\",r:/BeOS/},{s:\"OS/2\",r:/OS\\/2/},{s:\"Search Bot\",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\\/Teoma|ia_archiver)/}],i=0;cs=clientStrings[i];i++)if(cs.r.test(nAgt)){os=cs.s;break}var osVersion=unknown;switch(/Windows/.test(os)&&(/Windows (.*)/.test(os)&&(osVersion=/Windows (.*)/.exec(os)[1]),os=\"Windows\"),os){case\"Mac OS X\":/Mac OS X (10[\\.\\_\\d]+)/.test(nAgt)&&(osVersion=/Mac OS X (10[\\.\\_\\d]+)/.exec(nAgt)[1]);break;case\"Android\":/Android ([\\.\\_\\d]+)/.test(nAgt)&&(osVersion=/Android ([\\.\\_\\d]+)/.exec(nAgt)[1]);break;case\"iOS\":/OS (\\d+)_(\\d+)_?(\\d+)?/.test(nAgt)&&(osVersion=/OS (\\d+)_(\\d+)_?(\\d+)?/.exec(nVer),osVersion=osVersion[1]+\".\"+osVersion[2]+\".\"+(0|osVersion[3]))}return{osName:os,osVersion:osVersion}}function getAndroidVersion(ua){ua=(ua||navigator.userAgent).toLowerCase();var match=ua.match(/android\\s([0-9\\.]*)/);return!!match&&match[1]}function DetectLocalIPAddress(callback,stream){if(DetectRTC.isWebRTCSupported){var isPublic=!0,isIpv4=!0;getIPs(function(ip){ip?ip.match(regexIpv4Local)?(isPublic=!1,callback(\"Local: \"+ip,isPublic,isIpv4)):ip.match(regexIpv6)?(isIpv4=!1,callback(\"Public: \"+ip,isPublic,isIpv4)):callback(\"Public: \"+ip,isPublic,isIpv4):callback()},stream)}}function getIPs(callback,stream){function handleCandidate(candidate){if(!candidate)return void callback();var match=regexIpv4.exec(candidate);if(match){var ipAddress=match[1],isPublic=candidate.match(regexIpv4Local),isIpv4=!0;void 0===ipDuplicates[ipAddress]&&callback(ipAddress,isPublic,isIpv4),ipDuplicates[ipAddress]=!0}}function afterCreateOffer(){var lines=pc.localDescription.sdp.split(\"\\n\");lines.forEach(function(line){line&&0===line.indexOf(\"a=candidate:\")&&handleCandidate(line)})}if(\"undefined\"!=typeof document&&\"function\"==typeof document.getElementById){var ipDuplicates={},RTCPeerConnection=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!RTCPeerConnection){var iframe=document.getElementById(\"iframe\");if(!iframe)return;var win=iframe.contentWindow;RTCPeerConnection=win.RTCPeerConnection||win.mozRTCPeerConnection||win.webkitRTCPeerConnection}if(RTCPeerConnection){var peerConfig=null;\"Chrome\"===DetectRTC.browser&&DetectRTC.browser.version<58&&(peerConfig={optional:[{RtpDataChannels:!0}]});var servers={iceServers:[{urls:\"stun:stun.l.google.com:19302\"}]},pc=new RTCPeerConnection(servers,peerConfig);if(stream&&(pc.addStream?pc.addStream(stream):pc.addTrack&&stream.getTracks()[0]&&pc.addTrack(stream.getTracks()[0],stream)),pc.onicecandidate=function(event){event.candidate&&event.candidate.candidate?handleCandidate(event.candidate.candidate):handleCandidate()},!stream)try{pc.createDataChannel(\"sctp\",{})}catch(e){}DetectRTC.isPromisesSupported?pc.createOffer().then(function(result){pc.setLocalDescription(result).then(afterCreateOffer)}):pc.createOffer(function(result){pc.setLocalDescription(result,afterCreateOffer,function(){})},function(){})}}}function checkDeviceSupport(callback){if(!canEnumerate)return void(callback&&callback());if(!navigator.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(navigator.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!navigator.enumerateDevices&&navigator.enumerateDevices&&(navigator.enumerateDevices=navigator.enumerateDevices.bind(navigator)),!navigator.enumerateDevices)return void(callback&&callback());MediaDevices=[],audioInputDevices=[],audioOutputDevices=[],videoInputDevices=[],hasMicrophone=!1,hasSpeakers=!1,hasWebcam=!1,isWebsiteHasMicrophonePermissions=!1,isWebsiteHasWebcamPermissions=!1;var alreadyUsedDevices={};navigator.enumerateDevices(function(devices){devices.forEach(function(_device){var device={};for(var d in _device)try{\"function\"!=typeof _device[d]&&(device[d]=_device[d])}catch(e){}alreadyUsedDevices[device.deviceId+device.label+device.kind]||(\"audio\"===device.kind&&(device.kind=\"audioinput\"),\"video\"===device.kind&&(device.kind=\"videoinput\"),device.deviceId||(device.deviceId=device.id),device.id||(device.id=device.deviceId),device.label?(\"videoinput\"!==device.kind||isWebsiteHasWebcamPermissions||(isWebsiteHasWebcamPermissions=!0),\"audioinput\"!==device.kind||isWebsiteHasMicrophonePermissions||(isWebsiteHasMicrophonePermissions=!0)):(device.isCustomLabel=!0,\"videoinput\"===device.kind?device.label=\"Camera \"+(videoInputDevices.length+1):\"audioinput\"===device.kind?device.label=\"Microphone \"+(audioInputDevices.length+1):\"audiooutput\"===device.kind?device.label=\"Speaker \"+(audioOutputDevices.length+1):device.label=\"Please invoke getUserMedia once.\",\"undefined\"!=typeof DetectRTC&&DetectRTC.browser.isChrome&&DetectRTC.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||\"\")&&\"undefined\"!=typeof document&&\"string\"==typeof document.domain&&document.domain.search&&document.domain.search(/localhost|127.0./g)===-1&&(device.label=\"HTTPs is required to get label of this \"+device.kind+\" device.\")),\"audioinput\"===device.kind&&(hasMicrophone=!0,audioInputDevices.indexOf(device)===-1&&audioInputDevices.push(device)),\"audiooutput\"===device.kind&&(hasSpeakers=!0,audioOutputDevices.indexOf(device)===-1&&audioOutputDevices.push(device)),\"videoinput\"===device.kind&&(hasWebcam=!0,videoInputDevices.indexOf(device)===-1&&videoInputDevices.push(device)),MediaDevices.push(device),alreadyUsedDevices[device.deviceId+device.label+device.kind]=device)}),\"undefined\"!=typeof DetectRTC&&(DetectRTC.MediaDevices=MediaDevices,DetectRTC.hasMicrophone=hasMicrophone,DetectRTC.hasSpeakers=hasSpeakers,DetectRTC.hasWebcam=hasWebcam,DetectRTC.isWebsiteHasWebcamPermissions=isWebsiteHasWebcamPermissions,DetectRTC.isWebsiteHasMicrophonePermissions=isWebsiteHasMicrophonePermissions,DetectRTC.audioInputDevices=audioInputDevices,DetectRTC.audioOutputDevices=audioOutputDevices,DetectRTC.videoInputDevices=videoInputDevices),callback&&callback()})}function getAspectRatio(w,h){function gcd(a,b){return 0==b?a:gcd(b,a%b)}var r=gcd(w,h);return w/r/(h/r)}var browserFakeUserAgent=\"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45\",isNodejs=\"object\"==typeof process&&\"object\"==typeof process.versions&&process.versions.node&&!process.browser;if(isNodejs){var version=process.versions.node.toString().replace(\"v\",\"\");browserFakeUserAgent=\"Nodejs/\"+version+\" (NodeOS) AppleWebKit/\"+version+\" (KHTML, like Gecko) Nodejs/\"+version+\" Nodejs/\"+version}!function(that){\"undefined\"==typeof window&&(\"undefined\"==typeof window&&\"undefined\"!=typeof global?(global.navigator={userAgent:browserFakeUserAgent,getUserMedia:function(){}},that.window=global):\"undefined\"==typeof window,\"undefined\"==typeof location&&(that.location={protocol:\"file:\",href:\"\",hash:\"\"}),\"undefined\"==typeof screen&&(that.screen={width:0,height:0}))}(\"undefined\"!=typeof global?global:window);var navigator=window.navigator;\"undefined\"!=typeof navigator?(\"undefined\"!=typeof navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),\"undefined\"!=typeof navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia)):navigator={getUserMedia:function(){},userAgent:browserFakeUserAgent};var isMobileDevice=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(navigator.userAgent||\"\"),isEdge=!(navigator.userAgent.indexOf(\"Edge\")===-1||!navigator.msSaveOrOpenBlob&&!navigator.msSaveBlob),isOpera=!!window.opera||navigator.userAgent.indexOf(\" OPR/\")>=0,isFirefox=\"undefined\"!=typeof window.InstallTrigger,isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),isChrome=!!window.chrome&&!isOpera,isIE=\"undefined\"!=typeof document&&!!document.documentMode&&!isEdge,isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()},getOsName:function(){var osName=\"Unknown OS\";return isMobile.Android()&&(osName=\"Android\"),isMobile.BlackBerry()&&(osName=\"BlackBerry\"),isMobile.iOS()&&(osName=\"iOS\"),isMobile.Opera()&&(osName=\"Opera Mini\"),isMobile.Windows()&&(osName=\"Windows\"),osName}},osName=\"Unknown OS\",osVersion=\"Unknown OS Version\",osInfo=detectDesktopOS();osInfo&&osInfo.osName&&\"-\"!=osInfo.osName?(osName=osInfo.osName,osVersion=osInfo.osVersion):isMobile.any()&&(osName=isMobile.getOsName(),\"Android\"==osName&&(osVersion=getAndroidVersion()));var isNodejs=\"object\"==typeof process&&\"object\"==typeof process.versions&&process.versions.node;\"Unknown OS\"===osName&&isNodejs&&(osName=\"Nodejs\",osVersion=process.versions.node.toString().replace(\"v\",\"\"));var isCanvasSupportsStreamCapturing=!1,isVideoSupportsStreamCapturing=!1;[\"captureStream\",\"mozCaptureStream\",\"webkitCaptureStream\"].forEach(function(item){\"undefined\"!=typeof document&&\"function\"==typeof document.createElement&&(!isCanvasSupportsStreamCapturing&&item in document.createElement(\"canvas\")&&(isCanvasSupportsStreamCapturing=!0),!isVideoSupportsStreamCapturing&&item in document.createElement(\"video\")&&(isVideoSupportsStreamCapturing=!0))});var regexIpv4Local=/^(192\\.168\\.|169\\.254\\.|10\\.|172\\.(1[6-9]|2\\d|3[01]))/,regexIpv4=/([0-9]{1,3}(\\.[0-9]{1,3}){3})/,regexIpv6=/[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/,MediaDevices=[],audioInputDevices=[],audioOutputDevices=[],videoInputDevices=[];navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&(navigator.enumerateDevices=function(callback){var enumerateDevices=navigator.mediaDevices.enumerateDevices();enumerateDevices&&enumerateDevices.then?navigator.mediaDevices.enumerateDevices().then(callback)[\"catch\"](function(){callback([])}):callback([])});var canEnumerate=!1;\"undefined\"!=typeof MediaStreamTrack&&\"getSources\"in MediaStreamTrack?canEnumerate=!0:navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&(canEnumerate=!0);var hasMicrophone=!1,hasSpeakers=!1,hasWebcam=!1,isWebsiteHasMicrophonePermissions=!1,isWebsiteHasWebcamPermissions=!1,DetectRTC=window.DetectRTC||{};DetectRTC.browser=getBrowserInfo(),detectPrivateMode(function(isPrivateBrowsing){DetectRTC.browser.isPrivateBrowsing=!!isPrivateBrowsing}),DetectRTC.browser[\"is\"+DetectRTC.browser.name]=!0,DetectRTC.osName=osName,DetectRTC.osVersion=osVersion;var isWebRTCSupported=(\"object\"==typeof process&&\"object\"==typeof process.versions&&process.versions[\"node-webkit\"],!1);[\"RTCPeerConnection\",\"webkitRTCPeerConnection\",\"mozRTCPeerConnection\",\"RTCIceGatherer\"].forEach(function(item){isWebRTCSupported||item in window&&(isWebRTCSupported=!0)}),DetectRTC.isWebRTCSupported=isWebRTCSupported,DetectRTC.isORTCSupported=\"undefined\"!=typeof RTCIceGatherer;var isScreenCapturingSupported=!1;if(DetectRTC.browser.isChrome&&DetectRTC.browser.version>=35?isScreenCapturingSupported=!0:DetectRTC.browser.isFirefox&&DetectRTC.browser.version>=34?isScreenCapturingSupported=!0:DetectRTC.browser.isEdge&&DetectRTC.browser.version>=17?isScreenCapturingSupported=!0:\"Android\"===DetectRTC.osName&&DetectRTC.browser.isChrome&&(isScreenCapturingSupported=!0),!/^(https:|chrome-extension:)$/g.test(location.protocol||\"\")){var isNonLocalHost=\"undefined\"!=typeof document&&\"string\"==typeof document.domain&&document.domain.search&&document.domain.search(/localhost|127.0./g)===-1;isNonLocalHost&&(DetectRTC.browser.isChrome||DetectRTC.browser.isEdge||DetectRTC.browser.isOpera)?isScreenCapturingSupported=!1:DetectRTC.browser.isFirefox&&(isScreenCapturingSupported=!1)}DetectRTC.isScreenCapturingSupported=isScreenCapturingSupported;var webAudio={isSupported:!1,isCreateMediaStreamSourceSupported:!1};[\"AudioContext\",\"webkitAudioContext\",\"mozAudioContext\",\"msAudioContext\"].forEach(function(item){webAudio.isSupported||item in window&&(webAudio.isSupported=!0,window[item]&&\"createMediaStreamSource\"in window[item].prototype&&(webAudio.isCreateMediaStreamSourceSupported=!0))}),DetectRTC.isAudioContextSupported=webAudio.isSupported,DetectRTC.isCreateMediaStreamSourceSupported=webAudio.isCreateMediaStreamSourceSupported;var isRtpDataChannelsSupported=!1;DetectRTC.browser.isChrome&&DetectRTC.browser.version>31&&(isRtpDataChannelsSupported=!0),DetectRTC.isRtpDataChannelsSupported=isRtpDataChannelsSupported;var isSCTPSupportd=!1;DetectRTC.browser.isFirefox&&DetectRTC.browser.version>28?isSCTPSupportd=!0:DetectRTC.browser.isChrome&&DetectRTC.browser.version>25?isSCTPSupportd=!0:DetectRTC.browser.isOpera&&DetectRTC.browser.version>=11&&(isSCTPSupportd=!0),DetectRTC.isSctpDataChannelsSupported=isSCTPSupportd,DetectRTC.isMobileDevice=isMobileDevice;var isGetUserMediaSupported=!1;navigator.getUserMedia?isGetUserMediaSupported=!0:navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&(isGetUserMediaSupported=!0),DetectRTC.browser.isChrome&&DetectRTC.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||\"\")&&\"undefined\"!=typeof document&&\"string\"==typeof document.domain&&document.domain.search&&document.domain.search(/localhost|127.0./g)===-1&&(isGetUserMediaSupported=\"Requires HTTPs\"),\"Nodejs\"===DetectRTC.osName&&(isGetUserMediaSupported=!1),DetectRTC.isGetUserMediaSupported=isGetUserMediaSupported;var displayResolution=\"\";if(screen.width){var width=screen.width?screen.width:\"\",height=screen.height?screen.height:\"\";displayResolution+=\"\"+width+\" x \"+height}DetectRTC.displayResolution=displayResolution,DetectRTC.displayAspectRatio=getAspectRatio(screen.width,screen.height).toFixed(2),DetectRTC.isCanvasSupportsStreamCapturing=isCanvasSupportsStreamCapturing,DetectRTC.isVideoSupportsStreamCapturing=isVideoSupportsStreamCapturing,\"Chrome\"==DetectRTC.browser.name&&DetectRTC.browser.version>=53&&(DetectRTC.isCanvasSupportsStreamCapturing||(DetectRTC.isCanvasSupportsStreamCapturing=\"Requires chrome flag: enable-experimental-web-platform-features\"),DetectRTC.isVideoSupportsStreamCapturing||(DetectRTC.isVideoSupportsStreamCapturing=\"Requires chrome flag: enable-experimental-web-platform-features\")),DetectRTC.DetectLocalIPAddress=DetectLocalIPAddress,DetectRTC.isWebSocketsSupported=\"WebSocket\"in window&&2===window.WebSocket.CLOSING,DetectRTC.isWebSocketsBlocked=!DetectRTC.isWebSocketsSupported,\"Nodejs\"===DetectRTC.osName&&(DetectRTC.isWebSocketsSupported=!0,DetectRTC.isWebSocketsBlocked=!1),DetectRTC.checkWebSocketsSupport=function(callback){callback=callback||function(){};try{var starttime,websocket=new WebSocket(\"wss://echo.websocket.org:443/\");websocket.onopen=function(){DetectRTC.isWebSocketsBlocked=!1,starttime=(new Date).getTime(),websocket.send(\"ping\")},websocket.onmessage=function(){DetectRTC.WebsocketLatency=(new Date).getTime()-starttime+\"ms\",callback(),websocket.close(),websocket=null},websocket.onerror=function(){DetectRTC.isWebSocketsBlocked=!0,callback()}}catch(e){DetectRTC.isWebSocketsBlocked=!0,callback()}},DetectRTC.load=function(callback){callback=callback||function(){},checkDeviceSupport(callback)},\"undefined\"!=typeof MediaDevices?DetectRTC.MediaDevices=MediaDevices:DetectRTC.MediaDevices=[],DetectRTC.hasMicrophone=hasMicrophone,DetectRTC.hasSpeakers=hasSpeakers,DetectRTC.hasWebcam=hasWebcam,DetectRTC.isWebsiteHasWebcamPermissions=isWebsiteHasWebcamPermissions,DetectRTC.isWebsiteHasMicrophonePermissions=isWebsiteHasMicrophonePermissions,DetectRTC.audioInputDevices=audioInputDevices,DetectRTC.audioOutputDevices=audioOutputDevices,DetectRTC.videoInputDevices=videoInputDevices;var isSetSinkIdSupported=!1;\"undefined\"!=typeof document&&\"function\"==typeof document.createElement&&\"setSinkId\"in document.createElement(\"video\")&&(isSetSinkIdSupported=!0),DetectRTC.isSetSinkIdSupported=isSetSinkIdSupported;var isRTPSenderReplaceTracksSupported=!1;DetectRTC.browser.isFirefox&&\"undefined\"!=typeof mozRTCPeerConnection?\"getSenders\"in mozRTCPeerConnection.prototype&&(isRTPSenderReplaceTracksSupported=!0):DetectRTC.browser.isChrome&&\"undefined\"!=typeof webkitRTCPeerConnection&&\"getSenders\"in webkitRTCPeerConnection.prototype&&(isRTPSenderReplaceTracksSupported=!0),DetectRTC.isRTPSenderReplaceTracksSupported=isRTPSenderReplaceTracksSupported;var isRemoteStreamProcessingSupported=!1;DetectRTC.browser.isFirefox&&DetectRTC.browser.version>38&&(isRemoteStreamProcessingSupported=!0),DetectRTC.isRemoteStreamProcessingSupported=isRemoteStreamProcessingSupported;var isApplyConstraintsSupported=!1;\"undefined\"!=typeof MediaStreamTrack&&\"applyConstraints\"in MediaStreamTrack.prototype&&(isApplyConstraintsSupported=!0),DetectRTC.isApplyConstraintsSupported=isApplyConstraintsSupported;var isMultiMonitorScreenCapturingSupported=!1;DetectRTC.browser.isFirefox&&DetectRTC.browser.version>=43&&(isMultiMonitorScreenCapturingSupported=!0),DetectRTC.isMultiMonitorScreenCapturingSupported=isMultiMonitorScreenCapturingSupported,DetectRTC.isPromisesSupported=!!(\"Promise\"in window),DetectRTC.version=\"1.3.9\",\"undefined\"==typeof DetectRTC&&(window.DetectRTC={});var MediaStream=window.MediaStream;\"undefined\"==typeof MediaStream&&\"undefined\"!=typeof webkitMediaStream&&(MediaStream=webkitMediaStream),\"undefined\"!=typeof MediaStream&&\"function\"==typeof MediaStream?DetectRTC.MediaStream=Object.keys(MediaStream.prototype):DetectRTC.MediaStream=!1,\"undefined\"!=typeof MediaStreamTrack?DetectRTC.MediaStreamTrack=Object.keys(MediaStreamTrack.prototype):DetectRTC.MediaStreamTrack=!1;var RTCPeerConnection=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;\"undefined\"!=typeof RTCPeerConnection?DetectRTC.RTCPeerConnection=Object.keys(RTCPeerConnection.prototype):DetectRTC.RTCPeerConnection=!1,window.DetectRTC=DetectRTC,\"undefined\"!=typeof module&&(module.exports=DetectRTC),\"function\"==typeof define&&define.amd&&define(\"DetectRTC\",[],function(){return DetectRTC})}(),\"undefined\"!=typeof cordova&&(DetectRTC.isMobileDevice=!0,DetectRTC.browser.name=\"Chrome\"),navigator&&navigator.userAgent&&navigator.userAgent.indexOf(\"Crosswalk\")!==-1&&(DetectRTC.isMobileDevice=!0,DetectRTC.browser.name=\"Chrome\"),window.addEventListener||(window.addEventListener=function(el,eventName,eventHandler){\r\nel.attachEvent&&el.attachEvent(\"on\"+eventName,eventHandler)}),window.attachEventListener=function(video,type,listener,useCapture){video.addEventListener(type,listener,useCapture)};var MediaStream=window.MediaStream;\"undefined\"==typeof MediaStream&&\"undefined\"!=typeof webkitMediaStream&&(MediaStream=webkitMediaStream),\"undefined\"!=typeof MediaStream&&(\"stop\"in MediaStream.prototype||(MediaStream.prototype.stop=function(){this.getTracks().forEach(function(track){track.stop()})})),window.iOSDefaultAudioOutputDevice=window.iOSDefaultAudioOutputDevice||\"speaker\",document.addEventListener(\"deviceready\",setCordovaAPIs,!1),setCordovaAPIs();var RTCPeerConnection,defaults={};\"undefined\"!=typeof window.RTCPeerConnection?RTCPeerConnection=window.RTCPeerConnection:\"undefined\"!=typeof mozRTCPeerConnection?RTCPeerConnection=mozRTCPeerConnection:\"undefined\"!=typeof webkitRTCPeerConnection&&(RTCPeerConnection=webkitRTCPeerConnection);var RTCSessionDescription=window.RTCSessionDescription||window.mozRTCSessionDescription,RTCIceCandidate=window.RTCIceCandidate||window.mozRTCIceCandidate,MediaStreamTrack=window.MediaStreamTrack,CodecsHandler=function(){function preferCodec(sdp,codecName){var info=splitLines(sdp);return info.videoCodecNumbers?\"vp8\"===codecName&&info.vp8LineNumber===info.videoCodecNumbers[0]?sdp:\"vp9\"===codecName&&info.vp9LineNumber===info.videoCodecNumbers[0]?sdp:\"h264\"===codecName&&info.h264LineNumber===info.videoCodecNumbers[0]?sdp:sdp=preferCodecHelper(sdp,codecName,info):sdp}function preferCodecHelper(sdp,codec,info,ignore){var preferCodecNumber=\"\";if(\"vp8\"===codec){if(!info.vp8LineNumber)return sdp;preferCodecNumber=info.vp8LineNumber}if(\"vp9\"===codec){if(!info.vp9LineNumber)return sdp;preferCodecNumber=info.vp9LineNumber}if(\"h264\"===codec){if(!info.h264LineNumber)return sdp;preferCodecNumber=info.h264LineNumber}var newLine=info.videoCodecNumbersOriginal.split(\"SAVPF\")[0]+\"SAVPF \",newOrder=[preferCodecNumber];return ignore&&(newOrder=[]),info.videoCodecNumbers.forEach(function(codecNumber){codecNumber!==preferCodecNumber&&newOrder.push(codecNumber)}),newLine+=newOrder.join(\" \"),sdp=sdp.replace(info.videoCodecNumbersOriginal,newLine)}function splitLines(sdp){var info={};return sdp.split(\"\\n\").forEach(function(line){0===line.indexOf(\"m=video\")&&(info.videoCodecNumbers=[],line.split(\"SAVPF\")[1].split(\" \").forEach(function(codecNumber){codecNumber=codecNumber.trim(),codecNumber&&codecNumber.length&&(info.videoCodecNumbers.push(codecNumber),info.videoCodecNumbersOriginal=line)})),line.indexOf(\"VP8/90000\")===-1||info.vp8LineNumber||(info.vp8LineNumber=line.replace(\"a=rtpmap:\",\"\").split(\" \")[0]),line.indexOf(\"VP9/90000\")===-1||info.vp9LineNumber||(info.vp9LineNumber=line.replace(\"a=rtpmap:\",\"\").split(\" \")[0]),line.indexOf(\"H264/90000\")===-1||info.h264LineNumber||(info.h264LineNumber=line.replace(\"a=rtpmap:\",\"\").split(\" \")[0])}),info}function removeVPX(sdp){var info=splitLines(sdp);return sdp=preferCodecHelper(sdp,\"vp9\",info,!0),sdp=preferCodecHelper(sdp,\"vp8\",info,!0)}function disableNACK(sdp){if(!sdp||\"string\"!=typeof sdp)throw\"Invalid arguments.\";return sdp=sdp.replace(\"a=rtcp-fb:126 nack\\r\\n\",\"\"),sdp=sdp.replace(\"a=rtcp-fb:126 nack pli\\r\\n\",\"a=rtcp-fb:126 pli\\r\\n\"),sdp=sdp.replace(\"a=rtcp-fb:97 nack\\r\\n\",\"\"),sdp=sdp.replace(\"a=rtcp-fb:97 nack pli\\r\\n\",\"a=rtcp-fb:97 pli\\r\\n\")}function prioritize(codecMimeType,peer){if(peer&&peer.getSenders&&peer.getSenders().length){if(!codecMimeType||\"string\"!=typeof codecMimeType)throw\"Invalid arguments.\";peer.getSenders().forEach(function(sender){for(var params=sender.getParameters(),i=0;i<params.codecs.length;i++)if(params.codecs[i].mimeType==codecMimeType){params.codecs.unshift(params.codecs.splice(i,1));break}sender.setParameters(params)})}}function removeNonG722(sdp){return sdp.replace(/m=audio ([0-9]+) RTP\\/SAVPF ([0-9 ]*)/g,\"m=audio $1 RTP/SAVPF 9\")}function setBAS(sdp,bandwidth,isScreen){return bandwidth?\"undefined\"!=typeof isFirefox&&isFirefox?sdp:(isScreen&&(bandwidth.screen?bandwidth.screen<300&&console.warn(\"It seems that you are using wrong bandwidth value for screen. Screen sharing is expected to fail.\"):console.warn(\"It seems that you are not using bandwidth for screen. Screen sharing is expected to fail.\")),bandwidth.screen&&isScreen&&(sdp=sdp.replace(/b=AS([^\\r\\n]+\\r\\n)/g,\"\"),sdp=sdp.replace(/a=mid:video\\r\\n/g,\"a=mid:video\\r\\nb=AS:\"+bandwidth.screen+\"\\r\\n\")),(bandwidth.audio||bandwidth.video)&&(sdp=sdp.replace(/b=AS([^\\r\\n]+\\r\\n)/g,\"\")),bandwidth.audio&&(sdp=sdp.replace(/a=mid:audio\\r\\n/g,\"a=mid:audio\\r\\nb=AS:\"+bandwidth.audio+\"\\r\\n\")),bandwidth.screen?sdp=sdp.replace(/a=mid:video\\r\\n/g,\"a=mid:video\\r\\nb=AS:\"+bandwidth.screen+\"\\r\\n\"):bandwidth.video&&(sdp=sdp.replace(/a=mid:video\\r\\n/g,\"a=mid:video\\r\\nb=AS:\"+bandwidth.video+\"\\r\\n\")),sdp):sdp}function findLine(sdpLines,prefix,substr){return findLineInRange(sdpLines,0,-1,prefix,substr)}function findLineInRange(sdpLines,startLine,endLine,prefix,substr){for(var realEndLine=endLine!==-1?endLine:sdpLines.length,i=startLine;i<realEndLine;++i)if(0===sdpLines[i].indexOf(prefix)&&(!substr||sdpLines[i].toLowerCase().indexOf(substr.toLowerCase())!==-1))return i;return null}function getCodecPayloadType(sdpLine){var pattern=new RegExp(\"a=rtpmap:(\\\\d+) \\\\w+\\\\/\\\\d+\"),result=sdpLine.match(pattern);return result&&2===result.length?result[1]:null}function setVideoBitrates(sdp,params){params=params||{};var vp8Payload,xgoogle_min_bitrate=params.min,xgoogle_max_bitrate=params.max,sdpLines=sdp.split(\"\\r\\n\"),vp8Index=findLine(sdpLines,\"a=rtpmap\",\"VP8/90000\");if(vp8Index&&(vp8Payload=getCodecPayloadType(sdpLines[vp8Index])),!vp8Payload)return sdp;var rtxPayload,rtxIndex=findLine(sdpLines,\"a=rtpmap\",\"rtx/90000\");if(rtxIndex&&(rtxPayload=getCodecPayloadType(sdpLines[rtxIndex])),!rtxIndex)return sdp;var rtxFmtpLineIndex=findLine(sdpLines,\"a=fmtp:\"+rtxPayload.toString());if(null!==rtxFmtpLineIndex){var appendrtxNext=\"\\r\\n\";appendrtxNext+=\"a=fmtp:\"+vp8Payload+\" x-google-min-bitrate=\"+(xgoogle_min_bitrate||\"228\")+\"; x-google-max-bitrate=\"+(xgoogle_max_bitrate||\"228\"),sdpLines[rtxFmtpLineIndex]=sdpLines[rtxFmtpLineIndex].concat(appendrtxNext),sdp=sdpLines.join(\"\\r\\n\")}return sdp}function setOpusAttributes(sdp,params){params=params||{};var opusPayload,sdpLines=sdp.split(\"\\r\\n\"),opusIndex=findLine(sdpLines,\"a=rtpmap\",\"opus/48000\");if(opusIndex&&(opusPayload=getCodecPayloadType(sdpLines[opusIndex])),!opusPayload)return sdp;var opusFmtpLineIndex=findLine(sdpLines,\"a=fmtp:\"+opusPayload.toString());if(null===opusFmtpLineIndex)return sdp;var appendOpusNext=\"\";return appendOpusNext+=\"; stereo=\"+(\"undefined\"!=typeof params.stereo?params.stereo:\"1\"),appendOpusNext+=\"; sprop-stereo=\"+(\"undefined\"!=typeof params[\"sprop-stereo\"]?params[\"sprop-stereo\"]:\"1\"),\"undefined\"!=typeof params.maxaveragebitrate&&(appendOpusNext+=\"; maxaveragebitrate=\"+(params.maxaveragebitrate||1048576)),\"undefined\"!=typeof params.maxplaybackrate&&(appendOpusNext+=\"; maxplaybackrate=\"+(params.maxplaybackrate||1048576)),\"undefined\"!=typeof params.cbr&&(appendOpusNext+=\"; cbr=\"+(\"undefined\"!=typeof params.cbr?params.cbr:\"1\")),\"undefined\"!=typeof params.useinbandfec&&(appendOpusNext+=\"; useinbandfec=\"+params.useinbandfec),\"undefined\"!=typeof params.usedtx&&(appendOpusNext+=\"; usedtx=\"+params.usedtx),\"undefined\"!=typeof params.maxptime&&(appendOpusNext+=\"\\r\\na=maxptime:\"+params.maxptime),sdpLines[opusFmtpLineIndex]=sdpLines[opusFmtpLineIndex].concat(appendOpusNext),sdp=sdpLines.join(\"\\r\\n\")}function forceStereoAudio(sdp){for(var sdpLines=sdp.split(\"\\r\\n\"),fmtpLineIndex=null,i=0;i<sdpLines.length;i++)if(sdpLines[i].search(\"opus/48000\")!==-1){var opusPayload=extractSdp(sdpLines[i],/:(\\d+) opus\\/48000/i);break}for(var i=0;i<sdpLines.length;i++)if(sdpLines[i].search(\"a=fmtp\")!==-1){var payload=extractSdp(sdpLines[i],/a=fmtp:(\\d+)/);if(payload===opusPayload){fmtpLineIndex=i;break}}return null===fmtpLineIndex?sdp:(sdpLines[fmtpLineIndex]=sdpLines[fmtpLineIndex].concat(\"; stereo=1; sprop-stereo=1\"),sdp=sdpLines.join(\"\\r\\n\"))}return{removeVPX:removeVPX,disableNACK:disableNACK,prioritize:prioritize,removeNonG722:removeNonG722,setApplicationSpecificBandwidth:function(sdp,bandwidth,isScreen){return setBAS(sdp,bandwidth,isScreen)},setVideoBitrates:function(sdp,params){return setVideoBitrates(sdp,params)},setOpusAttributes:function(sdp,params){return setOpusAttributes(sdp,params)},preferVP9:function(sdp){return preferCodec(sdp,\"vp9\")},preferCodec:preferCodec,forceStereoAudio:forceStereoAudio}}();window.BandwidthHandler=CodecsHandler;var OnIceCandidateHandler=function(){function processCandidates(connection,icePair){var candidate=icePair.candidate,iceRestrictions=connection.candidates,stun=iceRestrictions.stun,turn=iceRestrictions.turn;if(isNull(iceRestrictions.reflexive)||(stun=iceRestrictions.reflexive),isNull(iceRestrictions.relay)||(turn=iceRestrictions.relay),(iceRestrictions.host||!candidate.match(/typ host/g))&&(turn||!candidate.match(/typ relay/g))&&(stun||!candidate.match(/typ srflx/g))){var protocol=connection.iceProtocols;if((protocol.udp||!candidate.match(/ udp /g))&&(protocol.tcp||!candidate.match(/ tcp /g)))return connection.enableLogs&&console.debug(\"Your candidate pairs:\",candidate),{candidate:candidate,sdpMid:icePair.sdpMid,sdpMLineIndex:icePair.sdpMLineIndex}}}return{processCandidates:processCandidates}}(),IceServersHandler=function(){function getIceServers(connection){var iceServers=[{urls:[\"stun:stun.l.google.com:19302\",\"stun:stun1.l.google.com:19302\",\"stun:stun2.l.google.com:19302\",\"stun:stun.l.google.com:19302?transport=udp\"]}];return iceServers}return{getIceServers:getIceServers}}();window.currentUserMediaRequest={streams:[],mutex:!1,queueRequests:[],remove:function(idInstance){this.mutex=!1;var stream=this.streams[idInstance];if(stream){stream=stream.stream;var options=stream.currentUserMediaRequestOptions;this.queueRequests.indexOf(options)&&(delete this.queueRequests[this.queueRequests.indexOf(options)],this.queueRequests=removeNullEntries(this.queueRequests)),this.streams[idInstance].stream=null,delete this.streams[idInstance]}}};var StreamsHandler=function(){function handleType(type){if(type)return\"string\"==typeof type||\"undefined\"==typeof type?type:type.audio&&type.video?null:type.audio?\"audio\":type.video?\"video\":void 0}function setHandlers(stream,syncAction,connection){function graduallyIncreaseVolume(){if(connection.streamEvents[stream.streamid].mediaElement){var mediaElement=connection.streamEvents[stream.streamid].mediaElement;mediaElement.volume=0,afterEach(200,5,function(){try{mediaElement.volume+=.2}catch(e){mediaElement.volume=1}})}}if(stream&&stream.addEventListener){if(\"undefined\"==typeof syncAction||1==syncAction){var streamEndedEvent=\"ended\";\"oninactive\"in stream&&(streamEndedEvent=\"inactive\"),stream.addEventListener(streamEndedEvent,function(){StreamsHandler.onSyncNeeded(this.streamid,streamEndedEvent)},!1)}stream.mute=function(type,isSyncAction){type=handleType(type),\"undefined\"!=typeof isSyncAction&&(syncAction=isSyncAction),\"undefined\"!=typeof type&&\"audio\"!=type||getTracks(stream,\"audio\").forEach(function(track){track.enabled=!1,connection.streamEvents[stream.streamid].isAudioMuted=!0}),\"undefined\"!=typeof type&&\"video\"!=type||getTracks(stream,\"video\").forEach(function(track){track.enabled=!1}),\"undefined\"!=typeof syncAction&&1!=syncAction||StreamsHandler.onSyncNeeded(stream.streamid,\"mute\",type),connection.streamEvents[stream.streamid].muteType=type||\"both\",fireEvent(stream,\"mute\",type)},stream.unmute=function(type,isSyncAction){type=handleType(type),\"undefined\"!=typeof isSyncAction&&(syncAction=isSyncAction),graduallyIncreaseVolume(),\"undefined\"!=typeof type&&\"audio\"!=type||getTracks(stream,\"audio\").forEach(function(track){track.enabled=!0,connection.streamEvents[stream.streamid].isAudioMuted=!1}),\"undefined\"!=typeof type&&\"video\"!=type||(getTracks(stream,\"video\").forEach(function(track){track.enabled=!0}),\"undefined\"!=typeof type&&\"video\"==type&&connection.streamEvents[stream.streamid].isAudioMuted&&!function looper(times){times||(times=0),times++,times<100&&connection.streamEvents[stream.streamid].isAudioMuted&&(stream.mute(\"audio\"),setTimeout(function(){looper(times)},50))}()),\"undefined\"!=typeof syncAction&&1!=syncAction||StreamsHandler.onSyncNeeded(stream.streamid,\"unmute\",type),connection.streamEvents[stream.streamid].unmuteType=type||\"both\",fireEvent(stream,\"unmute\",type)}}}function afterEach(setTimeoutInteval,numberOfTimes,callback,startedTimes){startedTimes=(startedTimes||0)+1,startedTimes>=numberOfTimes||setTimeout(function(){callback(),afterEach(setTimeoutInteval,numberOfTimes,callback,startedTimes)},setTimeoutInteval)}return{setHandlers:setHandlers,onSyncNeeded:function(streamid,action,type){}}}(),TextSender={send:function(config){function sendText(textMessage,text){var data={type:\"text\",uuid:uuid,sendingTime:sendingTime};textMessage&&(text=textMessage,data.packets=parseInt(text.length/packetSize)),text.length>packetSize?data.message=text.slice(0,packetSize):(data.message=text,data.last=!0,data.isobject=isobject),channel.send(data,remoteUserId),textToTransfer=text.slice(data.message.length),textToTransfer.length&&setTimeout(function(){sendText(null,textToTransfer)},connection.chunkInterval||100)}var connection=config.connection,channel=config.channel,remoteUserId=config.remoteUserId,initialText=config.text,packetSize=connection.chunkSize||1e3,textToTransfer=\"\",isobject=!1;isString(initialText)||(isobject=!0,initialText=JSON.stringify(initialText));var uuid=getRandomString(),sendingTime=(new Date).getTime();sendText(initialText)}},FileProgressBarHandler=function(){function handle(connection){function updateLabel(progress,label){if(progress.position!==-1){var position=+progress.position.toFixed(2).split(\".\")[1]||100;label.innerHTML=position+\"%\"}}var progressHelper={};connection.onFileStart=function(file){var div=document.createElement(\"div\");return div.title=file.name,div.innerHTML=\"<label>0%</label> <progress></progress>\",file.remoteUserId&&(div.innerHTML+=\" (Sharing with:\"+file.remoteUserId+\")\"),connection.filesContainer||(connection.filesContainer=document.body||document.documentElement),connection.filesContainer.insertBefore(div,connection.filesContainer.firstChild),file.remoteUserId?(progressHelper[file.uuid]||(progressHelper[file.uuid]={}),progressHelper[file.uuid][file.remoteUserId]={div:div,progress:div.querySelector(\"progress\"),label:div.querySelector(\"label\")},void(progressHelper[file.uuid][file.remoteUserId].progress.max=file.maxChunks)):(progressHelper[file.uuid]={div:div,progress:div.querySelector(\"progress\"),label:div.querySelector(\"label\")},void(progressHelper[file.uuid].progress.max=file.maxChunks))},connection.onFileProgress=function(chunk){var helper=progressHelper[chunk.uuid];helper&&(chunk.remoteUserId&&!(helper=progressHelper[chunk.uuid][chunk.remoteUserId])||(helper.progress.value=chunk.currentPosition||chunk.maxChunks||helper.progress.max,updateLabel(helper.progress,helper.label)))},connection.onFileEnd=function(file){var helper=progressHelper[file.uuid];if(!helper)return void console.error(\"No such progress-helper element exist.\",file);if(!file.remoteUserId||(helper=progressHelper[file.uuid][file.remoteUserId])){var div=helper.div;file.type.indexOf(\"image\")!=-1?div.innerHTML='<a href=\"'+file.url+'\" download=\"'+file.name+'\">Download <strong style=\"color:red;\">'+file.name+'</strong> </a><br /><img src=\"'+file.url+'\" title=\"'+file.name+'\" style=\"max-width: 80%;\">':div.innerHTML='<a href=\"'+file.url+'\" download=\"'+file.name+'\">Download <strong style=\"color:red;\">'+file.name+'</strong> </a><br /><iframe src=\"'+file.url+'\" title=\"'+file.name+'\" style=\"width: 80%;border: 0;height: inherit;margin-top:1em;\"></iframe>'}}}return{handle:handle}}(),TranslationHandler=function(){function handle(connection){connection.autoTranslateText=!1,connection.language=\"en\",connection.googKey=\"AIzaSyCgB5hmFY74WYB-EoWkhr9cAGr6TiTHrEE\",connection.Translator={TranslateText:function(text,callback){var newScript=document.createElement(\"script\");newScript.type=\"text/javascript\";var sourceText=encodeURIComponent(text),randomNumber=\"method\"+connection.token();window[randomNumber]=function(response){return response.data&&response.data.translations[0]&&callback?void callback(response.data.translations[0].translatedText):response.error&&\"Daily Limit Exceeded\"===response.error.message?void console.error('Text translation failed. Error message: \"Daily Limit Exceeded.\"'):response.error?void console.error(response.error.message):void console.error(response)};var source=\"https://www.googleapis.com/language/translate/v2?key=\"+connection.googKey+\"&target=\"+(connection.language||\"en-US\")+\"&callback=window.\"+randomNumber+\"&q=\"+sourceText;newScript.src=source,document.getElementsByTagName(\"head\")[0].appendChild(newScript)},getListOfLanguages:function(callback){var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){if(xhr.readyState==XMLHttpRequest.DONE){var response=JSON.parse(xhr.responseText);if(response&&response.data&&response.data.languages)return void callback(response.data.languages);if(response.error&&\"Daily Limit Exceeded\"===response.error.message)return void console.error('Text translation failed. Error message: \"Daily Limit Exceeded.\"');if(response.error)return void console.error(response.error.message);console.error(response)}};var url=\"https://www.googleapis.com/language/translate/v2/languages?key=\"+connection.googKey+\"&target=en\";xhr.open(\"GET\",url,!0),xhr.send(null)}}}return{handle:handle}}();!function(connection){function onUserLeft(remoteUserId){connection.deletePeer(remoteUserId)}function connectSocket(connectCallback){if(connection.socketAutoReConnect=!0,connection.socket)return void(connectCallback&&connectCallback(connection.socket));if(\"undefined\"==typeof SocketConnection)if(\"undefined\"!=typeof FirebaseConnection)window.SocketConnection=FirebaseConnection;else{if(\"undefined\"==typeof PubNubConnection)throw\"SocketConnection.js seems missed.\";window.SocketConnection=PubNubConnection}new SocketConnection(connection,function(s){connectCallback&&connectCallback(connection.socket)})}function joinRoom(connectionDescription,cb){connection.socket.emit(\"join-room\",{sessionid:connection.sessionid,session:connection.session,mediaConstraints:connection.mediaConstraints,sdpConstraints:connection.sdpConstraints,streams:getStreamInfoForAdmin(),extra:connection.extra,password:\"undefined\"!=typeof connection.password&&\"object\"!=typeof connection.password?connection.password:\"\"},function(isRoomJoined,error){if(isRoomJoined===!0){if(connection.enableLogs&&console.log(\"isRoomJoined: \",isRoomJoined,\" roomid: \",connection.sessionid),connection.peers[connection.sessionid])return;mPeer.onNegotiationNeeded(connectionDescription)}isRoomJoined===!1&&connection.enableLogs&&console.warn(\"isRoomJoined: \",error,\" roomid: \",connection.sessionid),cb(isRoomJoined,connection.sessionid,error)})}function openRoom(callback){connection.enableLogs&&console.log(\"Sending open-room signal to socket.io\"),connection.waitingForLocalMedia=!1,connection.socket.emit(\"open-room\",{sessionid:connection.sessionid,session:connection.session,mediaConstraints:connection.mediaConstraints,sdpConstraints:connection.sdpConstraints,streams:getStreamInfoForAdmin(),extra:connection.extra,identifier:connection.publicRoomIdentifier,password:\"undefined\"!=typeof connection.password&&\"object\"!=typeof connection.password?connection.password:\"\"},function(isRoomOpened,error){isRoomOpened===!0&&(connection.enableLogs&&console.log(\"isRoomOpened: \",isRoomOpened,\" roomid: \",connection.sessionid),callback(isRoomOpened,connection.sessionid)),isRoomOpened===!1&&(connection.enableLogs&&console.warn(\"isRoomOpened: \",error,\" roomid: \",connection.sessionid),callback(isRoomOpened,connection.sessionid,error))})}function getStreamInfoForAdmin(){try{return connection.streamEvents.selectAll(\"local\").map(function(event){return{streamid:event.streamid,tracks:event.stream.getTracks().length}})}catch(e){return[]}}function beforeJoin(userPreferences,callback){if(connection.dontCaptureUserMedia||userPreferences.isDataOnly)return void callback();var localMediaConstraints={};userPreferences.localPeerSdpConstraints.OfferToReceiveAudio&&(localMediaConstraints.audio=connection.mediaConstraints.audio),userPreferences.localPeerSdpConstraints.OfferToReceiveVideo&&(localMediaConstraints.video=connection.mediaConstraints.video);var session=userPreferences.session||connection.session;return session.oneway&&\"two-way\"!==session.audio&&\"two-way\"!==session.video&&\"two-way\"!==session.screen?void callback():(session.oneway&&session.audio&&\"two-way\"===session.audio&&(session={audio:!0}),void((session.audio||session.video||session.screen)&&(session.screen?\"Edge\"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:isAudioPlusTab(connection)}).then(function(screen){screen.isScreen=!0,mPeer.onGettingLocalMedia(screen),!session.audio&&!session.video||isAudioPlusTab(connection)?callback(screen):connection.invokeGetUserMedia(null,callback)},function(error){console.error(\"Unable to capture screen on Edge. HTTPs and version 17+ is required.\")}):connection.invokeGetUserMedia({audio:isAudioPlusTab(connection),video:!0,isScreen:!0},!session.audio&&!session.video||isAudioPlusTab(connection)?callback:connection.invokeGetUserMedia(null,callback)):(session.audio||session.video)&&connection.invokeGetUserMedia(null,callback,session))))}function applyConstraints(stream,mediaConstraints){return stream?(mediaConstraints.audio&&getTracks(stream,\"audio\").forEach(function(track){track.applyConstraints(mediaConstraints.audio)}),void(mediaConstraints.video&&getTracks(stream,\"video\").forEach(function(track){track.applyConstraints(mediaConstraints.video)}))):void(connection.enableLogs&&console.error(\"No stream to applyConstraints.\"))}function replaceTrack(track,remoteUserId,isVideoTrack){return remoteUserId?void mPeer.replaceTrack(track,remoteUserId,isVideoTrack):void connection.peers.getAllParticipants().forEach(function(participant){mPeer.replaceTrack(track,participant,isVideoTrack)})}forceOptions=forceOptions||{useDefaultDevices:!0},connection.channel=connection.sessionid=(roomid||location.href.replace(/\\/|:|#|\\?|\\$|\\^|%|\\.|`|~|!|\\+|@|\\[|\\||]|\\|*. /g,\"\").split(\"\\n\").join(\"\").split(\"\\r\").join(\"\"))+\"\";var mPeer=new MultiPeers(connection),preventDuplicateOnStreamEvents={};mPeer.onGettingLocalMedia=function(stream,callback){if(callback=callback||function(){},preventDuplicateOnStreamEvents[stream.streamid])return void callback();preventDuplicateOnStreamEvents[stream.streamid]=!0;try{stream.type=\"local\"}catch(e){}connection.setStreamEndHandler(stream),getRMCMediaElement(stream,function(mediaElement){mediaElement.id=stream.streamid,mediaElement.muted=!0,mediaElement.volume=0,connection.attachStreams.indexOf(stream)===-1&&connection.attachStreams.push(stream),\"undefined\"!=typeof StreamsHandler&&StreamsHandler.setHandlers(stream,!0,connection),connection.streamEvents[stream.streamid]={stream:stream,type:\"local\",mediaElement:mediaElement,userid:connection.userid,extra:connection.extra,streamid:stream.streamid,isAudioMuted:!0};try{setHarkEvents(connection,connection.streamEvents[stream.streamid]),setMuteHandlers(connection,connection.streamEvents[stream.streamid]),connection.onstream(connection.streamEvents[stream.streamid])}catch(e){}callback()},connection)},mPeer.onGettingRemoteMedia=function(stream,remoteUserId){try{stream.type=\"remote\"}catch(e){}connection.setStreamEndHandler(stream,\"remote-stream\"),getRMCMediaElement(stream,function(mediaElement){mediaElement.id=stream.streamid,\"undefined\"!=typeof StreamsHandler&&StreamsHandler.setHandlers(stream,!1,connection),connection.streamEvents[stream.streamid]={stream:stream,type:\"remote\",userid:remoteUserId,extra:connection.peers[remoteUserId]?connection.peers[remoteUserId].extra:{},mediaElement:mediaElement,streamid:stream.streamid},setMuteHandlers(connection,connection.streamEvents[stream.streamid]),connection.onstream(connection.streamEvents[stream.streamid])},connection)},mPeer.onRemovingRemoteMedia=function(stream,remoteUserId){var streamEvent=connection.streamEvents[stream.streamid];streamEvent||(streamEvent={stream:stream,type:\"remote\",userid:remoteUserId,extra:connection.peers[remoteUserId]?connection.peers[remoteUserId].extra:{},streamid:stream.streamid,mediaElement:connection.streamEvents[stream.streamid]?connection.streamEvents[stream.streamid].mediaElement:null}),connection.peersBackup[streamEvent.userid]&&(streamEvent.extra=connection.peersBackup[streamEvent.userid].extra),connection.onstreamended(streamEvent),delete connection.streamEvents[stream.streamid]},mPeer.onNegotiationNeeded=function(message,remoteUserId,callback){callback=callback||function(){},remoteUserId=remoteUserId||message.remoteUserId,message=message||\"\";var messageToDeliver={remoteUserId:remoteUserId,message:message,sender:connection.userid};message.remoteUserId&&message.message&&message.sender&&(messageToDeliver=message),connectSocket(function(){connection.socket.emit(connection.socketMessageEvent,messageToDeliver,callback)})},mPeer.onUserLeft=onUserLeft,mPeer.disconnectWith=function(remoteUserId,callback){connection.socket&&connection.socket.emit(\"disconnect-with\",remoteUserId,callback||function(){}),connection.deletePeer(remoteUserId)},connection.socketOptions={transport:\"polling\"},connection.openOrJoin=function(roomid,callback){callback=callback||function(){},connection.checkPresence(roomid,function(isRoomExist,roomid){if(isRoomExist){connection.sessionid=roomid;var localPeerSdpConstraints=!1,remotePeerSdpConstraints=!1,isOneWay=!!connection.session.oneway,isDataOnly=isData(connection.session);remotePeerSdpConstraints={OfferToReceiveAudio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:connection.sdpConstraints.mandatory.OfferToReceiveVideo},localPeerSdpConstraints={OfferToReceiveAudio:isOneWay?!!connection.session.audio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:isOneWay?!!connection.session.video||!!connection.session.screen:connection.sdpConstraints.mandatory.OfferToReceiveVideo};var connectionDescription={remoteUserId:connection.sessionid,message:{newParticipationRequest:!0,isOneWay:isOneWay,isDataOnly:isDataOnly,localPeerSdpConstraints:localPeerSdpConstraints,remotePeerSdpConstraints:remotePeerSdpConstraints},sender:connection.userid};return void beforeJoin(connectionDescription.message,function(){joinRoom(connectionDescription,callback)})}return connection.waitingForLocalMedia=!0,connection.isInitiator=!0,connection.sessionid=roomid||connection.sessionid,isData(connection.session)?void openRoom(callback):void connection.captureUserMedia(function(){openRoom(callback)})})},connection.waitingForLocalMedia=!1,connection.open=function(roomid,callback){callback=callback||function(){},connection.waitingForLocalMedia=!0,connection.isInitiator=!0,connection.sessionid=roomid||connection.sessionid,connectSocket(function(){return isData(connection.session)?void openRoom(callback):void connection.captureUserMedia(function(){openRoom(callback)})})},connection.peersBackup={},connection.deletePeer=function(remoteUserId){if(remoteUserId&&connection.peers[remoteUserId]){var eventObject={userid:remoteUserId,extra:connection.peers[remoteUserId]?connection.peers[remoteUserId].extra:{}};if(connection.peersBackup[eventObject.userid]&&(eventObject.extra=connection.peersBackup[eventObject.userid].extra),connection.onleave(eventObject),connection.peers[remoteUserId]){connection.peers[remoteUserId].streams.forEach(function(stream){stream.stop()});var peer=connection.peers[remoteUserId].peer;if(peer&&\"closed\"!==peer.iceConnectionState)try{peer.close()}catch(e){}connection.peers[remoteUserId]&&(connection.peers[remoteUserId].peer=null,delete connection.peers[remoteUserId])}}},connection.rejoin=function(connectionDescription){if(!connection.isInitiator&&connectionDescription&&Object.keys(connectionDescription).length){var extra={};connection.peers[connectionDescription.remoteUserId]&&(extra=connection.peers[connectionDescription.remoteUserId].extra,connection.deletePeer(connectionDescription.remoteUserId)),connectionDescription&&connectionDescription.remoteUserId&&(connection.join(connectionDescription.remoteUserId),connection.onReConnecting({userid:connectionDescription.remoteUserId,extra:extra}))}},connection.join=function(remoteUserId,options){connection.sessionid=!!remoteUserId&&(remoteUserId.sessionid||remoteUserId.remoteUserId||remoteUserId)||connection.sessionid,connection.sessionid+=\"\";var localPeerSdpConstraints=!1,remotePeerSdpConstraints=!1,isOneWay=!1,isDataOnly=!1;if(remoteUserId&&remoteUserId.session||!remoteUserId||\"string\"==typeof remoteUserId){var session=remoteUserId?remoteUserId.session||connection.session:connection.session;isOneWay=!!session.oneway,isDataOnly=isData(session),remotePeerSdpConstraints={OfferToReceiveAudio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:connection.sdpConstraints.mandatory.OfferToReceiveVideo},localPeerSdpConstraints={OfferToReceiveAudio:isOneWay?!!connection.session.audio:connection.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:isOneWay?!!connection.session.video||!!connection.session.screen:connection.sdpConstraints.mandatory.OfferToReceiveVideo}}options=options||{};var cb=function(){};\"function\"==typeof options&&(cb=options,options={}),\"undefined\"!=typeof options.localPeerSdpConstraints&&(localPeerSdpConstraints=options.localPeerSdpConstraints),\"undefined\"!=typeof options.remotePeerSdpConstraints&&(remotePeerSdpConstraints=options.remotePeerSdpConstraints),\"undefined\"!=typeof options.isOneWay&&(isOneWay=options.isOneWay),\"undefined\"!=typeof options.isDataOnly&&(isDataOnly=options.isDataOnly);var connectionDescription={remoteUserId:connection.sessionid,message:{newParticipationRequest:!0,isOneWay:isOneWay,isDataOnly:isDataOnly,localPeerSdpConstraints:localPeerSdpConstraints,remotePeerSdpConstraints:remotePeerSdpConstraints},sender:connection.userid};return beforeJoin(connectionDescription.message,function(){connectSocket(function(){joinRoom(connectionDescription,cb)})}),connectionDescription},connection.publicRoomIdentifier=\"\",connection.getUserMedia=connection.captureUserMedia=function(callback,sessionForced){callback=callback||function(){};var session=sessionForced||connection.session;return connection.dontCaptureUserMedia||isData(session)?void callback():void((session.audio||session.video||session.screen)&&(session.screen?\"Edge\"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:isAudioPlusTab(connection)}).then(function(screen){if(screen.isScreen=!0,mPeer.onGettingLocalMedia(screen),(session.audio||session.video)&&!isAudioPlusTab(connection)){var nonScreenSession={};for(var s in session)\"screen\"!==s&&(nonScreenSession[s]=session[s]);return void connection.invokeGetUserMedia(sessionForced,callback,nonScreenSession)}callback(screen)},function(error){console.error(\"Unable to capture screen on Edge. HTTPs and version 17+ is required.\")}):connection.invokeGetUserMedia({audio:isAudioPlusTab(connection),video:!0,isScreen:!0},function(stream){if((session.audio||session.video)&&!isAudioPlusTab(connection)){var nonScreenSession={};for(var s in session)\"screen\"!==s&&(nonScreenSession[s]=session[s]);return void connection.invokeGetUserMedia(sessionForced,callback,nonScreenSession)}callback(stream)}):(session.audio||session.video)&&connection.invokeGetUserMedia(sessionForced,callback,session)))},connection.onbeforeunload=function(arg1,dontCloseSocket){connection.closeBeforeUnload&&(connection.peers.getAllParticipants().forEach(function(participant){mPeer.onNegotiationNeeded({userLeft:!0},participant),connection.peers[participant]&&connection.peers[participant].peer&&connection.peers[participant].peer.close(),delete connection.peers[participant]}),dontCloseSocket||connection.closeSocket(),connection.isInitiator=!1)},window.ignoreBeforeUnload?connection.closeBeforeUnload=!1:(connection.closeBeforeUnload=!0,\r\nwindow.addEventListener(\"beforeunload\",connection.onbeforeunload,!1)),connection.userid=getRandomString(),connection.changeUserId=function(newUserId,callback){callback=callback||function(){},connection.userid=newUserId||getRandomString(),connection.socket.emit(\"changed-uuid\",connection.userid,callback)},connection.extra={},connection.attachStreams=[],connection.session={audio:!0,video:!0},connection.enableFileSharing=!1,connection.bandwidth={screen:!1,audio:!1,video:!1},connection.codecs={audio:\"opus\",video:\"VP9\"},connection.processSdp=function(sdp){return isUnifiedPlanSupportedDefault()?sdp:\"Safari\"===DetectRTC.browser.name?sdp:(\"VP8\"===connection.codecs.video.toUpperCase()&&(sdp=CodecsHandler.preferCodec(sdp,\"vp8\")),\"VP9\"===connection.codecs.video.toUpperCase()&&(sdp=CodecsHandler.preferCodec(sdp,\"vp9\")),\"H264\"===connection.codecs.video.toUpperCase()&&(sdp=CodecsHandler.preferCodec(sdp,\"h264\")),\"G722\"===connection.codecs.audio&&(sdp=CodecsHandler.removeNonG722(sdp)),\"Firefox\"===DetectRTC.browser.name?sdp:((connection.bandwidth.video||connection.bandwidth.screen)&&(sdp=CodecsHandler.setApplicationSpecificBandwidth(sdp,connection.bandwidth,!!connection.session.screen)),connection.bandwidth.video&&(sdp=CodecsHandler.setVideoBitrates(sdp,{min:8*connection.bandwidth.video*1024,max:8*connection.bandwidth.video*1024})),connection.bandwidth.audio&&(sdp=CodecsHandler.setOpusAttributes(sdp,{maxaveragebitrate:8*connection.bandwidth.audio*1024,maxplaybackrate:8*connection.bandwidth.audio*1024,stereo:1,maxptime:3})),sdp))},\"undefined\"!=typeof CodecsHandler&&(connection.BandwidthHandler=connection.CodecsHandler=CodecsHandler),connection.mediaConstraints={audio:{mandatory:{},optional:connection.bandwidth.audio?[{bandwidth:8*connection.bandwidth.audio*1024||1048576}]:[]},video:{mandatory:{},optional:connection.bandwidth.video?[{bandwidth:8*connection.bandwidth.video*1024||1048576},{facingMode:\"user\"}]:[{facingMode:\"user\"}]}},\"Firefox\"===DetectRTC.browser.name&&(connection.mediaConstraints={audio:!0,video:!0}),forceOptions.useDefaultDevices||DetectRTC.isMobileDevice||DetectRTC.load(function(){var lastAudioDevice,lastVideoDevice;if(DetectRTC.MediaDevices.forEach(function(device){\"audioinput\"===device.kind&&connection.mediaConstraints.audio!==!1&&(lastAudioDevice=device),\"videoinput\"===device.kind&&connection.mediaConstraints.video!==!1&&(lastVideoDevice=device)}),lastAudioDevice){if(\"Firefox\"===DetectRTC.browser.name)return void(connection.mediaConstraints.audio!==!0?connection.mediaConstraints.audio.deviceId=lastAudioDevice.id:connection.mediaConstraints.audio={deviceId:lastAudioDevice.id});1==connection.mediaConstraints.audio&&(connection.mediaConstraints.audio={mandatory:{},optional:[]}),connection.mediaConstraints.audio.optional||(connection.mediaConstraints.audio.optional=[]);var optional=[{sourceId:lastAudioDevice.id}];connection.mediaConstraints.audio.optional=optional.concat(connection.mediaConstraints.audio.optional)}if(lastVideoDevice){if(\"Firefox\"===DetectRTC.browser.name)return void(connection.mediaConstraints.video!==!0?connection.mediaConstraints.video.deviceId=lastVideoDevice.id:connection.mediaConstraints.video={deviceId:lastVideoDevice.id});1==connection.mediaConstraints.video&&(connection.mediaConstraints.video={mandatory:{},optional:[]}),connection.mediaConstraints.video.optional||(connection.mediaConstraints.video.optional=[]);var optional=[{sourceId:lastVideoDevice.id}];connection.mediaConstraints.video.optional=optional.concat(connection.mediaConstraints.video.optional)}}),connection.sdpConstraints={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},optional:[{VoiceActivityDetection:!1}]},connection.sdpSemantics=null,connection.iceCandidatePoolSize=null,connection.bundlePolicy=null,connection.rtcpMuxPolicy=null,connection.iceTransportPolicy=null,connection.optionalArgument={optional:[{DtlsSrtpKeyAgreement:!0},{googImprovedWifiBwe:!0},{googScreencastMinBitrate:300},{googIPv6:!0},{googDscp:!0},{googCpuUnderuseThreshold:55},{googCpuOveruseThreshold:85},{googSuspendBelowMinBitrate:!0},{googCpuOveruseDetection:!0}],mandatory:{}},connection.iceServers=IceServersHandler.getIceServers(connection),connection.candidates={host:!0,stun:!0,turn:!0},connection.iceProtocols={tcp:!0,udp:!0},connection.onopen=function(event){connection.enableLogs&&console.info(\"Data connection has been opened between you & \",event.userid)},connection.onclose=function(event){connection.enableLogs&&console.warn(\"Data connection has been closed between you & \",event.userid)},connection.onerror=function(error){connection.enableLogs&&console.error(error.userid,\"data-error\",error)},connection.onmessage=function(event){connection.enableLogs&&console.debug(\"data-message\",event.userid,event.data)},connection.send=function(data,remoteUserId){connection.peers.send(data,remoteUserId)},connection.close=connection.disconnect=connection.leave=function(){connection.onbeforeunload(!1,!0)},connection.closeEntireSession=function(callback){callback=callback||function(){},connection.socket.emit(\"close-entire-session\",function looper(){return connection.getAllParticipants().length?void setTimeout(looper,100):(connection.onEntireSessionClosed({sessionid:connection.sessionid,userid:connection.userid,extra:connection.extra}),void connection.changeUserId(null,function(){connection.close(),callback()}))})},connection.onEntireSessionClosed=function(event){connection.enableLogs&&console.info(\"Entire session is closed: \",event.sessionid,event.extra)},connection.onstream=function(e){var parentNode=connection.videosContainer;parentNode.insertBefore(e.mediaElement,parentNode.firstChild);var played=e.mediaElement.play();return\"undefined\"!=typeof played?void played[\"catch\"](function(){}).then(function(){setTimeout(function(){e.mediaElement.play()},2e3)}):void setTimeout(function(){e.mediaElement.play()},2e3)},connection.onstreamended=function(e){e.mediaElement||(e.mediaElement=document.getElementById(e.streamid)),e.mediaElement&&e.mediaElement.parentNode&&e.mediaElement.parentNode.removeChild(e.mediaElement)},connection.direction=\"many-to-many\",connection.removeStream=function(streamid,remoteUserId){var stream;return connection.attachStreams.forEach(function(localStream){localStream.id===streamid&&(stream=localStream)}),stream?(connection.peers.getAllParticipants().forEach(function(participant){if(!remoteUserId||participant===remoteUserId){var user=connection.peers[participant];try{user.peer.removeStream(stream)}catch(e){}}}),void connection.renegotiate()):void console.warn(\"No such stream exist.\",streamid)},connection.addStream=function(session,remoteUserId){function gumCallback(stream){session.streamCallback&&session.streamCallback(stream),connection.renegotiate(remoteUserId)}return session.getTracks?(connection.attachStreams.indexOf(session)===-1&&(session.streamid||(session.streamid=session.id),connection.attachStreams.push(session)),void connection.renegotiate(remoteUserId)):isData(session)?void connection.renegotiate(remoteUserId):void((session.audio||session.video||session.screen)&&(session.screen?\"Edge\"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:isAudioPlusTab(connection)}).then(function(screen){screen.isScreen=!0,mPeer.onGettingLocalMedia(screen),!session.audio&&!session.video||isAudioPlusTab(connection)?gumCallback(screen):connection.invokeGetUserMedia(null,function(stream){gumCallback(stream)})},function(error){console.error(\"Unable to capture screen on Edge. HTTPs and version 17+ is required.\")}):connection.invokeGetUserMedia({audio:isAudioPlusTab(connection),video:!0,isScreen:!0},function(stream){!session.audio&&!session.video||isAudioPlusTab(connection)?gumCallback(stream):connection.invokeGetUserMedia(null,function(stream){gumCallback(stream)})}):(session.audio||session.video)&&connection.invokeGetUserMedia(null,gumCallback)))},connection.invokeGetUserMedia=function(localMediaConstraints,callback,session){session||(session=connection.session),localMediaConstraints||(localMediaConstraints=connection.mediaConstraints),getUserMediaHandler({onGettingLocalMedia:function(stream){var videoConstraints=localMediaConstraints.video;videoConstraints&&(videoConstraints.mediaSource||videoConstraints.mozMediaSource?stream.isScreen=!0:videoConstraints.mandatory&&videoConstraints.mandatory.chromeMediaSource&&(stream.isScreen=!0)),stream.isScreen||(stream.isVideo=!!getTracks(stream,\"video\").length,stream.isAudio=!stream.isVideo&&getTracks(stream,\"audio\").length),mPeer.onGettingLocalMedia(stream,function(){\"function\"==typeof callback&&callback(stream)})},onLocalMediaError:function(error,constraints){mPeer.onLocalMediaError(error,constraints)},localMediaConstraints:localMediaConstraints||{audio:!!session.audio&&localMediaConstraints.audio,video:!!session.video&&localMediaConstraints.video}})},connection.applyConstraints=function(mediaConstraints,streamid){if(!MediaStreamTrack||!MediaStreamTrack.prototype.applyConstraints)return void alert(\"track.applyConstraints is NOT supported in your browser.\");if(streamid){var stream;return connection.streamEvents[streamid]&&(stream=connection.streamEvents[streamid].stream),void applyConstraints(stream,mediaConstraints)}connection.attachStreams.forEach(function(stream){applyConstraints(stream,mediaConstraints)})},connection.replaceTrack=function(session,remoteUserId,isVideoTrack){function gumCallback(stream){connection.replaceTrack(stream,remoteUserId,isVideoTrack||session.video||session.screen)}if(session=session||{},!RTCPeerConnection.prototype.getSenders)return void connection.addStream(session);if(session instanceof MediaStreamTrack)return void replaceTrack(session,remoteUserId,isVideoTrack);if(session instanceof MediaStream)return getTracks(session,\"video\").length&&replaceTrack(getTracks(session,\"video\")[0],remoteUserId,!0),void(getTracks(session,\"audio\").length&&replaceTrack(getTracks(session,\"audio\")[0],remoteUserId,!1));if(isData(session))throw\"connection.replaceTrack requires audio and/or video and/or screen.\";(session.audio||session.video||session.screen)&&(session.screen?\"Edge\"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:isAudioPlusTab(connection)}).then(function(screen){screen.isScreen=!0,mPeer.onGettingLocalMedia(screen),!session.audio&&!session.video||isAudioPlusTab(connection)?gumCallback(screen):connection.invokeGetUserMedia(null,gumCallback)},function(error){console.error(\"Unable to capture screen on Edge. HTTPs and version 17+ is required.\")}):connection.invokeGetUserMedia({audio:isAudioPlusTab(connection),video:!0,isScreen:!0},!session.audio&&!session.video||isAudioPlusTab(connection)?gumCallback:connection.invokeGetUserMedia(null,gumCallback)):(session.audio||session.video)&&connection.invokeGetUserMedia(null,gumCallback))},connection.resetTrack=function(remoteUsersIds,isVideoTrack){remoteUsersIds||(remoteUsersIds=connection.getAllParticipants()),\"string\"==typeof remoteUsersIds&&(remoteUsersIds=[remoteUsersIds]),remoteUsersIds.forEach(function(participant){var peer=connection.peers[participant].peer;\"undefined\"!=typeof isVideoTrack&&isVideoTrack!==!0||!peer.lastVideoTrack||connection.replaceTrack(peer.lastVideoTrack,participant,!0),\"undefined\"!=typeof isVideoTrack&&isVideoTrack!==!1||!peer.lastAudioTrack||connection.replaceTrack(peer.lastAudioTrack,participant,!1)})},connection.renegotiate=function(remoteUserId){return remoteUserId?void mPeer.renegotiatePeer(remoteUserId):void connection.peers.getAllParticipants().forEach(function(participant){mPeer.renegotiatePeer(participant)})},connection.setStreamEndHandler=function(stream,isRemote){if(stream&&stream.addEventListener&&(isRemote=!!isRemote,!stream.alreadySetEndHandler)){stream.alreadySetEndHandler=!0;var streamEndedEvent=\"ended\";\"oninactive\"in stream&&(streamEndedEvent=\"inactive\"),stream.addEventListener(streamEndedEvent,function(){if(stream.idInstance&&currentUserMediaRequest.remove(stream.idInstance),!isRemote){var streams=[];connection.attachStreams.forEach(function(s){s.id!=stream.id&&streams.push(s)}),connection.attachStreams=streams}var streamEvent=connection.streamEvents[stream.streamid];if(streamEvent||(streamEvent={stream:stream,streamid:stream.streamid,type:isRemote?\"remote\":\"local\",userid:connection.userid,extra:connection.extra,mediaElement:connection.streamEvents[stream.streamid]?connection.streamEvents[stream.streamid].mediaElement:null}),isRemote&&connection.peers[streamEvent.userid]){var peer=connection.peers[streamEvent.userid].peer,streams=[];peer.getRemoteStreams().forEach(function(s){s.id!=stream.id&&streams.push(s)}),connection.peers[streamEvent.userid].streams=streams}streamEvent.userid===connection.userid&&\"remote\"===streamEvent.type||(connection.peersBackup[streamEvent.userid]&&(streamEvent.extra=connection.peersBackup[streamEvent.userid].extra),connection.onstreamended(streamEvent),delete connection.streamEvents[stream.streamid])},!1)}},connection.onMediaError=function(error,constraints){connection.enableLogs&&console.error(error,constraints)},connection.autoCloseEntireSession=!1,connection.filesContainer=connection.videosContainer=document.body||document.documentElement,connection.isInitiator=!1,connection.shareFile=mPeer.shareFile,\"undefined\"!=typeof FileProgressBarHandler&&FileProgressBarHandler.handle(connection),\"undefined\"!=typeof TranslationHandler&&TranslationHandler.handle(connection),connection.token=getRandomString,connection.onNewParticipant=function(participantId,userPreferences){connection.acceptParticipationRequest(participantId,userPreferences)},connection.acceptParticipationRequest=function(participantId,userPreferences){userPreferences.successCallback&&(userPreferences.successCallback(),delete userPreferences.successCallback),mPeer.createNewPeer(participantId,userPreferences)},\"undefined\"!=typeof StreamsHandler&&(connection.StreamsHandler=StreamsHandler),connection.onleave=function(userid){},connection.invokeSelectFileDialog=function(callback){var selector=new FileSelector;selector.accept=\"*.*\",selector.selectSingleFile(callback)},connection.onmute=function(e){if(e&&e.mediaElement)if(\"both\"===e.muteType||\"video\"===e.muteType){e.mediaElement.src=null;var paused=e.mediaElement.pause();\"undefined\"!=typeof paused?paused.then(function(){e.mediaElement.poster=e.snapshot||\"https://cdn.webrtc-experiment.com/images/muted.png\"}):e.mediaElement.poster=e.snapshot||\"https://cdn.webrtc-experiment.com/images/muted.png\"}else\"audio\"===e.muteType&&(e.mediaElement.muted=!0)},connection.onunmute=function(e){e&&e.mediaElement&&e.stream&&(\"both\"===e.unmuteType||\"video\"===e.unmuteType?(e.mediaElement.poster=null,e.mediaElement.srcObject=e.stream,e.mediaElement.play()):\"audio\"===e.unmuteType&&(e.mediaElement.muted=!1))},connection.onExtraDataUpdated=function(event){event.status=\"online\",connection.onUserStatusChanged(event,!0)},connection.getAllParticipants=function(sender){return connection.peers.getAllParticipants(sender)},\"undefined\"!=typeof StreamsHandler&&(StreamsHandler.onSyncNeeded=function(streamid,action,type){connection.peers.getAllParticipants().forEach(function(participant){mPeer.onNegotiationNeeded({streamid:streamid,action:action,streamSyncNeeded:!0,type:type||\"both\"},participant)})}),connection.connectSocket=function(callback){connectSocket(callback)},connection.closeSocket=function(){try{io.sockets={}}catch(e){}connection.socket&&(\"function\"==typeof connection.socket.disconnect&&connection.socket.disconnect(),\"function\"==typeof connection.socket.resetProps&&connection.socket.resetProps(),connection.socket=null)},connection.getSocket=function(callback){return!callback&&connection.enableLogs&&console.warn(\"getSocket.callback paramter is required.\"),callback=callback||function(){},connection.socket?callback(connection.socket):connectSocket(function(){callback(connection.socket)}),connection.socket},connection.getRemoteStreams=mPeer.getRemoteStreams;var skipStreams=[\"selectFirst\",\"selectAll\",\"forEach\"];if(connection.streamEvents={selectFirst:function(options){return connection.streamEvents.selectAll(options)[0]},selectAll:function(options){options||(options={local:!0,remote:!0,isScreen:!0,isAudio:!0,isVideo:!0}),\"local\"==options&&(options={local:!0}),\"remote\"==options&&(options={remote:!0}),\"screen\"==options&&(options={isScreen:!0}),\"audio\"==options&&(options={isAudio:!0}),\"video\"==options&&(options={isVideo:!0});var streams=[];return Object.keys(connection.streamEvents).forEach(function(key){var event=connection.streamEvents[key];if(skipStreams.indexOf(key)===-1){var ignore=!0;options.local&&\"local\"===event.type&&(ignore=!1),options.remote&&\"remote\"===event.type&&(ignore=!1),options.isScreen&&event.stream.isScreen&&(ignore=!1),options.isVideo&&event.stream.isVideo&&(ignore=!1),options.isAudio&&event.stream.isAudio&&(ignore=!1),options.userid&&event.userid===options.userid&&(ignore=!1),ignore===!1&&streams.push(event)}}),streams}},connection.socketURL=\"/\",connection.socketMessageEvent=\"RTCMultiConnection-Message\",connection.socketCustomEvent=\"RTCMultiConnection-Custom-Message\",connection.DetectRTC=DetectRTC,connection.setCustomSocketEvent=function(customEvent){customEvent&&(connection.socketCustomEvent=customEvent),connection.socket&&connection.socket.emit(\"set-custom-socket-event-listener\",connection.socketCustomEvent)},connection.getNumberOfBroadcastViewers=function(broadcastId,callback){connection.socket&&broadcastId&&callback&&connection.socket.emit(\"get-number-of-users-in-specific-broadcast\",broadcastId,callback)},connection.onNumberOfBroadcastViewersUpdated=function(event){connection.enableLogs&&connection.isInitiator&&console.info(\"Number of broadcast (\",event.broadcastId,\") viewers\",event.numberOfBroadcastViewers)},connection.onUserStatusChanged=function(event,dontWriteLogs){connection.enableLogs&&!dontWriteLogs&&console.info(event.userid,event.status)},connection.getUserMediaHandler=getUserMediaHandler,connection.multiPeersHandler=mPeer,connection.enableLogs=!0,connection.setCustomSocketHandler=function(customSocketHandler){\"undefined\"!=typeof SocketConnection&&(SocketConnection=customSocketHandler)},connection.chunkSize=4e4,connection.maxParticipantsAllowed=1e3,connection.disconnectWith=mPeer.disconnectWith,connection.checkPresence=function(roomid,callback){return roomid=roomid||connection.sessionid,\"SSEConnection\"===SocketConnection.name?void SSEConnection.checkPresence(roomid,function(isRoomExist,_roomid,extra){return connection.socket?void callback(isRoomExist,_roomid):(isRoomExist||(connection.userid=_roomid),void connection.connectSocket(function(){callback(isRoomExist,_roomid,extra)}))}):connection.socket?void connection.socket.emit(\"check-presence\",roomid+\"\",function(isRoomExist,_roomid,extra){connection.enableLogs&&console.log(\"checkPresence.isRoomExist: \",isRoomExist,\" roomid: \",_roomid),callback(isRoomExist,_roomid,extra)}):void connection.connectSocket(function(){connection.checkPresence(roomid,callback)})},connection.onReadyForOffer=function(remoteUserId,userPreferences){connection.multiPeersHandler.createNewPeer(remoteUserId,userPreferences)},connection.setUserPreferences=function(userPreferences){return connection.dontAttachStream&&(userPreferences.dontAttachLocalStream=!0),connection.dontGetRemoteStream&&(userPreferences.dontGetRemoteStream=!0),userPreferences},connection.updateExtraData=function(){connection.socket.emit(\"extra-data-updated\",connection.extra)},connection.enableScalableBroadcast=!1,connection.maxRelayLimitPerUser=3,connection.dontCaptureUserMedia=!1,connection.dontAttachStream=!1,connection.dontGetRemoteStream=!1,connection.onReConnecting=function(event){connection.enableLogs&&console.info(\"ReConnecting with\",event.userid,\"...\")},connection.beforeAddingStream=function(stream){return stream},connection.beforeRemovingStream=function(stream){return stream},\"undefined\"!=typeof isChromeExtensionAvailable&&(connection.checkIfChromeExtensionAvailable=isChromeExtensionAvailable),\"undefined\"!=typeof isFirefoxExtensionAvailable&&(connection.checkIfChromeExtensionAvailable=isFirefoxExtensionAvailable),\"undefined\"!=typeof getChromeExtensionStatus&&(connection.getChromeExtensionStatus=getChromeExtensionStatus),connection.modifyScreenConstraints=function(screen_constraints){return screen_constraints},connection.onPeerStateChanged=function(state){connection.enableLogs&&state.iceConnectionState.search(/closed|failed/gi)!==-1&&console.error(\"Peer connection is closed between you & \",state.userid,state.extra,\"state:\",state.iceConnectionState)},connection.isOnline=!0,listenEventHandler(\"online\",function(){connection.isOnline=!0}),listenEventHandler(\"offline\",function(){connection.isOnline=!1}),connection.isLowBandwidth=!1,navigator&&navigator.connection&&navigator.connection.type&&(connection.isLowBandwidth=navigator.connection.type.toString().toLowerCase().search(/wifi|cell/g)!==-1,connection.isLowBandwidth)){if(connection.bandwidth={audio:!1,video:!1,screen:!1},connection.mediaConstraints.audio&&connection.mediaConstraints.audio.optional&&connection.mediaConstraints.audio.optional.length){var newArray=[];connection.mediaConstraints.audio.optional.forEach(function(opt){\"undefined\"==typeof opt.bandwidth&&newArray.push(opt)}),connection.mediaConstraints.audio.optional=newArray}if(connection.mediaConstraints.video&&connection.mediaConstraints.video.optional&&connection.mediaConstraints.video.optional.length){var newArray=[];connection.mediaConstraints.video.optional.forEach(function(opt){\"undefined\"==typeof opt.bandwidth&&newArray.push(opt)}),connection.mediaConstraints.video.optional=newArray}}connection.getExtraData=function(remoteUserId,callback){if(!remoteUserId)throw\"remoteUserId is required.\";return\"function\"==typeof callback?void connection.socket.emit(\"get-remote-user-extra-data\",remoteUserId,function(extra,remoteUserId,error){callback(extra,remoteUserId,error)}):connection.peers[remoteUserId]?connection.peers[remoteUserId].extra:connection.peersBackup[remoteUserId]?connection.peersBackup[remoteUserId].extra:{}},forceOptions.autoOpenOrJoin&&connection.openOrJoin(connection.sessionid),connection.onUserIdAlreadyTaken=function(useridAlreadyTaken,yourNewUserId){connection.close(),connection.closeSocket(),connection.isInitiator=!1,connection.userid=connection.token(),connection.join(connection.sessionid),connection.enableLogs&&console.warn(\"Userid already taken.\",useridAlreadyTaken,\"Your new userid:\",connection.userid)},connection.trickleIce=!0,connection.version=\"3.6.9\",connection.onSettingLocalDescription=function(event){connection.enableLogs&&console.info(\"Set local description for remote user\",event.userid)},connection.resetScreen=function(){sourceId=null,DetectRTC&&DetectRTC.screen&&delete DetectRTC.screen.sourceId,currentUserMediaRequest={streams:[],mutex:!1,queueRequests:[]}},connection.autoCreateMediaElement=!0,connection.password=null,connection.setPassword=function(password,callback){callback=callback||function(){},connection.socket?connection.socket.emit(\"set-password\",password,callback):(connection.password=password,callback(!0,connection.sessionid,null))},connection.onSocketDisconnect=function(event){connection.enableLogs&&console.warn(\"socket.io connection is closed\")},connection.onSocketError=function(event){connection.enableLogs&&console.warn(\"socket.io connection is failed\")},connection.errors={ROOM_NOT_AVAILABLE:\"Room not available\",INVALID_PASSWORD:\"Invalid password\",USERID_NOT_AVAILABLE:\"User ID does not exist\",ROOM_PERMISSION_DENIED:\"Room permission denied\",ROOM_FULL:\"Room full\",DID_NOT_JOIN_ANY_ROOM:\"Did not join any room yet\",INVALID_SOCKET:\"Invalid socket\",PUBLIC_IDENTIFIER_MISSING:\"publicRoomIdentifier is required\",INVALID_ADMIN_CREDENTIAL:\"Invalid username or password attempted\"}}(this)};\"undefined\"!=typeof module&&(module.exports=exports=RTCMultiConnection),\"function\"==typeof define&&define.amd&&define(\"RTCMultiConnection\",[],function(){return RTCMultiConnection});","(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.adapter = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\r\n\t/*\r\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n\t *\r\n\t *  Use of this source code is governed by a BSD-style license\r\n\t *  that can be found in the LICENSE file in the root of the source\r\n\t *  tree.\r\n\t */\r\n\t/* eslint-env node */\r\n\t\r\n\t'use strict';\r\n\t\r\n\tvar _adapter_factory = require('./adapter_factory.js');\r\n\t\r\n\tvar adapter = (0, _adapter_factory.adapterFactory)({ window: typeof window === 'undefined' ? undefined : window });\r\n\tmodule.exports = adapter; // this is the difference from adapter_core.\r\n\t\r\n\t},{\"./adapter_factory.js\":2}],2:[function(require,module,exports){\r\n\t'use strict';\r\n\t\r\n\tObject.defineProperty(exports, \"__esModule\", {\r\n\t\tvalue: true\r\n\t});\r\n\texports.adapterFactory = adapterFactory;\r\n\t\r\n\tvar _utils = require('./utils');\r\n\t\r\n\tvar utils = _interopRequireWildcard(_utils);\r\n\t\r\n\tvar _chrome_shim = require('./chrome/chrome_shim');\r\n\t\r\n\tvar chromeShim = _interopRequireWildcard(_chrome_shim);\r\n\t\r\n\tvar _edge_shim = require('./edge/edge_shim');\r\n\t\r\n\tvar edgeShim = _interopRequireWildcard(_edge_shim);\r\n\t\r\n\tvar _firefox_shim = require('./firefox/firefox_shim');\r\n\t\r\n\tvar firefoxShim = _interopRequireWildcard(_firefox_shim);\r\n\t\r\n\tvar _safari_shim = require('./safari/safari_shim');\r\n\t\r\n\tvar safariShim = _interopRequireWildcard(_safari_shim);\r\n\t\r\n\tvar _common_shim = require('./common_shim');\r\n\t\r\n\tvar commonShim = _interopRequireWildcard(_common_shim);\r\n\t\r\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\r\n\t\r\n\t// Shimming starts here.\r\n\t/*\r\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n\t *\r\n\t *  Use of this source code is governed by a BSD-style license\r\n\t *  that can be found in the LICENSE file in the root of the source\r\n\t *  tree.\r\n\t */\r\n\tfunction adapterFactory() {\r\n\t\tvar _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\r\n\t\t\t\twindow = _ref.window;\r\n\t\r\n\t\tvar options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\r\n\t\t\tshimChrome: true,\r\n\t\t\tshimFirefox: true,\r\n\t\t\tshimEdge: true,\r\n\t\t\tshimSafari: true\r\n\t\t};\r\n\t\r\n\t\t// Utils.\r\n\t\tvar logging = utils.log;\r\n\t\tvar browserDetails = utils.detectBrowser(window);\r\n\t\r\n\t\tvar adapter = {\r\n\t\t\tbrowserDetails: browserDetails,\r\n\t\t\tcommonShim: commonShim,\r\n\t\t\textractVersion: utils.extractVersion,\r\n\t\t\tdisableLog: utils.disableLog,\r\n\t\t\tdisableWarnings: utils.disableWarnings\r\n\t\t};\r\n\t\r\n\t\t// Shim browser if found.\r\n\t\tswitch (browserDetails.browser) {\r\n\t\t\tcase 'chrome':\r\n\t\t\t\tif (!chromeShim || !chromeShim.shimPeerConnection || !options.shimChrome) {\r\n\t\t\t\t\tlogging('Chrome shim is not included in this adapter release.');\r\n\t\t\t\t\treturn adapter;\r\n\t\t\t\t}\r\n\t\t\t\tif (browserDetails.version === null) {\r\n\t\t\t\t\tlogging('Chrome shim can not determine version, not shimming.');\r\n\t\t\t\t\treturn adapter;\r\n\t\t\t\t}\r\n\t\t\t\tlogging('adapter.js shimming chrome.');\r\n\t\t\t\t// Export to the adapter global object visible in the browser.\r\n\t\t\t\tadapter.browserShim = chromeShim;\r\n\t\r\n\t\t\t\tchromeShim.shimGetUserMedia(window);\r\n\t\t\t\tchromeShim.shimMediaStream(window);\r\n\t\t\t\tchromeShim.shimPeerConnection(window);\r\n\t\t\t\tchromeShim.shimOnTrack(window);\r\n\t\t\t\tchromeShim.shimAddTrackRemoveTrack(window);\r\n\t\t\t\tchromeShim.shimGetSendersWithDtmf(window);\r\n\t\t\t\tchromeShim.shimGetStats(window);\r\n\t\t\t\tchromeShim.shimSenderReceiverGetStats(window);\r\n\t\t\t\tchromeShim.fixNegotiationNeeded(window);\r\n\t\r\n\t\t\t\tcommonShim.shimRTCIceCandidate(window);\r\n\t\t\t\tcommonShim.shimConnectionState(window);\r\n\t\t\t\tcommonShim.shimMaxMessageSize(window);\r\n\t\t\t\tcommonShim.shimSendThrowTypeError(window);\r\n\t\t\t\tcommonShim.removeAllowExtmapMixed(window);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'firefox':\r\n\t\t\t\tif (!firefoxShim || !firefoxShim.shimPeerConnection || !options.shimFirefox) {\r\n\t\t\t\t\tlogging('Firefox shim is not included in this adapter release.');\r\n\t\t\t\t\treturn adapter;\r\n\t\t\t\t}\r\n\t\t\t\tlogging('adapter.js shimming firefox.');\r\n\t\t\t\t// Export to the adapter global object visible in the browser.\r\n\t\t\t\tadapter.browserShim = firefoxShim;\r\n\t\r\n\t\t\t\tfirefoxShim.shimGetUserMedia(window);\r\n\t\t\t\tfirefoxShim.shimPeerConnection(window);\r\n\t\t\t\tfirefoxShim.shimOnTrack(window);\r\n\t\t\t\tfirefoxShim.shimRemoveStream(window);\r\n\t\t\t\tfirefoxShim.shimSenderGetStats(window);\r\n\t\t\t\tfirefoxShim.shimReceiverGetStats(window);\r\n\t\t\t\tfirefoxShim.shimRTCDataChannel(window);\r\n\t\t\t\tfirefoxShim.shimAddTransceiver(window);\r\n\t\t\t\tfirefoxShim.shimGetParameters(window);\r\n\t\t\t\tfirefoxShim.shimCreateOffer(window);\r\n\t\t\t\tfirefoxShim.shimCreateAnswer(window);\r\n\t\r\n\t\t\t\tcommonShim.shimRTCIceCandidate(window);\r\n\t\t\t\tcommonShim.shimConnectionState(window);\r\n\t\t\t\tcommonShim.shimMaxMessageSize(window);\r\n\t\t\t\tcommonShim.shimSendThrowTypeError(window);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'edge':\r\n\t\t\t\tif (!edgeShim || !edgeShim.shimPeerConnection || !options.shimEdge) {\r\n\t\t\t\t\tlogging('MS edge shim is not included in this adapter release.');\r\n\t\t\t\t\treturn adapter;\r\n\t\t\t\t}\r\n\t\t\t\tlogging('adapter.js shimming edge.');\r\n\t\t\t\t// Export to the adapter global object visible in the browser.\r\n\t\t\t\tadapter.browserShim = edgeShim;\r\n\t\r\n\t\t\t\tedgeShim.shimGetUserMedia(window);\r\n\t\t\t\tedgeShim.shimGetDisplayMedia(window);\r\n\t\t\t\tedgeShim.shimPeerConnection(window);\r\n\t\t\t\tedgeShim.shimReplaceTrack(window);\r\n\t\r\n\t\t\t\t// the edge shim implements the full RTCIceCandidate object.\r\n\t\r\n\t\t\t\tcommonShim.shimMaxMessageSize(window);\r\n\t\t\t\tcommonShim.shimSendThrowTypeError(window);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'safari':\r\n\t\t\t\tif (!safariShim || !options.shimSafari) {\r\n\t\t\t\t\tlogging('Safari shim is not included in this adapter release.');\r\n\t\t\t\t\treturn adapter;\r\n\t\t\t\t}\r\n\t\t\t\tlogging('adapter.js shimming safari.');\r\n\t\t\t\t// Export to the adapter global object visible in the browser.\r\n\t\t\t\tadapter.browserShim = safariShim;\r\n\t\r\n\t\t\t\tsafariShim.shimRTCIceServerUrls(window);\r\n\t\t\t\tsafariShim.shimCreateOfferLegacy(window);\r\n\t\t\t\tsafariShim.shimCallbacksAPI(window);\r\n\t\t\t\tsafariShim.shimLocalStreamsAPI(window);\r\n\t\t\t\tsafariShim.shimRemoteStreamsAPI(window);\r\n\t\t\t\tsafariShim.shimTrackEventTransceiver(window);\r\n\t\t\t\tsafariShim.shimGetUserMedia(window);\r\n\t\t\t\tsafariShim.shimAudioContext(window);\r\n\t\r\n\t\t\t\tcommonShim.shimRTCIceCandidate(window);\r\n\t\t\t\tcommonShim.shimMaxMessageSize(window);\r\n\t\t\t\tcommonShim.shimSendThrowTypeError(window);\r\n\t\t\t\tcommonShim.removeAllowExtmapMixed(window);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tlogging('Unsupported browser!');\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\r\n\t\treturn adapter;\r\n\t}\r\n\t\r\n\t// Browser shims.\r\n\t\r\n\t},{\"./chrome/chrome_shim\":3,\"./common_shim\":6,\"./edge/edge_shim\":7,\"./firefox/firefox_shim\":11,\"./safari/safari_shim\":14,\"./utils\":15}],3:[function(require,module,exports){\r\n\t/*\r\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n\t *\r\n\t *  Use of this source code is governed by a BSD-style license\r\n\t *  that can be found in the LICENSE file in the root of the source\r\n\t *  tree.\r\n\t */\r\n\t/* eslint-env node */\r\n\t'use strict';\r\n\t\r\n\tObject.defineProperty(exports, \"__esModule\", {\r\n\t\tvalue: true\r\n\t});\r\n\texports.shimGetDisplayMedia = exports.shimGetUserMedia = undefined;\r\n\t\r\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\r\n\t\r\n\tvar _getusermedia = require('./getusermedia');\r\n\t\r\n\tObject.defineProperty(exports, 'shimGetUserMedia', {\r\n\t\tenumerable: true,\r\n\t\tget: function get() {\r\n\t\t\treturn _getusermedia.shimGetUserMedia;\r\n\t\t}\r\n\t});\r\n\t\r\n\tvar _getdisplaymedia = require('./getdisplaymedia');\r\n\t\r\n\tObject.defineProperty(exports, 'shimGetDisplayMedia', {\r\n\t\tenumerable: true,\r\n\t\tget: function get() {\r\n\t\t\treturn _getdisplaymedia.shimGetDisplayMedia;\r\n\t\t}\r\n\t});\r\n\texports.shimMediaStream = shimMediaStream;\r\n\texports.shimOnTrack = shimOnTrack;\r\n\texports.shimGetSendersWithDtmf = shimGetSendersWithDtmf;\r\n\texports.shimGetStats = shimGetStats;\r\n\texports.shimSenderReceiverGetStats = shimSenderReceiverGetStats;\r\n\texports.shimAddTrackRemoveTrackWithNative = shimAddTrackRemoveTrackWithNative;\r\n\texports.shimAddTrackRemoveTrack = shimAddTrackRemoveTrack;\r\n\texports.shimPeerConnection = shimPeerConnection;\r\n\texports.fixNegotiationNeeded = fixNegotiationNeeded;\r\n\t\r\n\tvar _utils = require('../utils.js');\r\n\t\r\n\tvar utils = _interopRequireWildcard(_utils);\r\n\t\r\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\r\n\t\r\n\tfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\t\r\n\tfunction shimMediaStream(window) {\r\n\t\twindow.MediaStream = window.MediaStream || window.webkitMediaStream;\r\n\t}\r\n\t\r\n\tfunction shimOnTrack(window) {\r\n\t\tif ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && !('ontrack' in window.RTCPeerConnection.prototype)) {\r\n\t\t\tObject.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\r\n\t\t\t\tget: function get() {\r\n\t\t\t\t\treturn this._ontrack;\r\n\t\t\t\t},\r\n\t\t\t\tset: function set(f) {\r\n\t\t\t\t\tif (this._ontrack) {\r\n\t\t\t\t\t\tthis.removeEventListener('track', this._ontrack);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.addEventListener('track', this._ontrack = f);\r\n\t\t\t\t},\r\n\t\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tconfigurable: true\r\n\t\t\t});\r\n\t\t\tvar origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\r\n\t\t\twindow.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription() {\r\n\t\t\t\tvar _this = this;\r\n\t\r\n\t\t\t\tif (!this._ontrackpoly) {\r\n\t\t\t\t\tthis._ontrackpoly = function (e) {\r\n\t\t\t\t\t\t// onaddstream does not fire when a track is added to an existing\r\n\t\t\t\t\t\t// stream. But stream.onaddtrack is implemented so we use that.\r\n\t\t\t\t\t\te.stream.addEventListener('addtrack', function (te) {\r\n\t\t\t\t\t\t\tvar receiver = void 0;\r\n\t\t\t\t\t\t\tif (window.RTCPeerConnection.prototype.getReceivers) {\r\n\t\t\t\t\t\t\t\treceiver = _this.getReceivers().find(function (r) {\r\n\t\t\t\t\t\t\t\t\treturn r.track && r.track.id === te.track.id;\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\treceiver = { track: te.track };\r\n\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t\tvar event = new Event('track');\r\n\t\t\t\t\t\t\tevent.track = te.track;\r\n\t\t\t\t\t\t\tevent.receiver = receiver;\r\n\t\t\t\t\t\t\tevent.transceiver = { receiver: receiver };\r\n\t\t\t\t\t\t\tevent.streams = [e.stream];\r\n\t\t\t\t\t\t\t_this.dispatchEvent(event);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\te.stream.getTracks().forEach(function (track) {\r\n\t\t\t\t\t\t\tvar receiver = void 0;\r\n\t\t\t\t\t\t\tif (window.RTCPeerConnection.prototype.getReceivers) {\r\n\t\t\t\t\t\t\t\treceiver = _this.getReceivers().find(function (r) {\r\n\t\t\t\t\t\t\t\t\treturn r.track && r.track.id === track.id;\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\treceiver = { track: track };\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar event = new Event('track');\r\n\t\t\t\t\t\t\tevent.track = track;\r\n\t\t\t\t\t\t\tevent.receiver = receiver;\r\n\t\t\t\t\t\t\tevent.transceiver = { receiver: receiver };\r\n\t\t\t\t\t\t\tevent.streams = [e.stream];\r\n\t\t\t\t\t\t\t_this.dispatchEvent(event);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis.addEventListener('addstream', this._ontrackpoly);\r\n\t\t\t\t}\r\n\t\t\t\treturn origSetRemoteDescription.apply(this, arguments);\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\t// even if RTCRtpTransceiver is in window, it is only used and\r\n\t\t\t// emitted in unified-plan. Unfortunately this means we need\r\n\t\t\t// to unconditionally wrap the event.\r\n\t\t\tutils.wrapPeerConnectionEvent(window, 'track', function (e) {\r\n\t\t\t\tif (!e.transceiver) {\r\n\t\t\t\t\tObject.defineProperty(e, 'transceiver', { value: { receiver: e.receiver } });\r\n\t\t\t\t}\r\n\t\t\t\treturn e;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction shimGetSendersWithDtmf(window) {\r\n\t\t// Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\r\n\t\tif ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && !('getSenders' in window.RTCPeerConnection.prototype) && 'createDTMFSender' in window.RTCPeerConnection.prototype) {\r\n\t\t\tvar shimSenderWithDtmf = function shimSenderWithDtmf(pc, track) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttrack: track,\r\n\t\t\t\t\tget dtmf() {\r\n\t\t\t\t\t\tif (this._dtmf === undefined) {\r\n\t\t\t\t\t\t\tif (track.kind === 'audio') {\r\n\t\t\t\t\t\t\t\tthis._dtmf = pc.createDTMFSender(track);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis._dtmf = null;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn this._dtmf;\r\n\t\t\t\t\t},\r\n\t\t\t\t\t_pc: pc\r\n\t\t\t\t};\r\n\t\t\t};\r\n\t\r\n\t\t\t// augment addTrack when getSenders is not available.\r\n\t\t\tif (!window.RTCPeerConnection.prototype.getSenders) {\r\n\t\t\t\twindow.RTCPeerConnection.prototype.getSenders = function getSenders() {\r\n\t\t\t\t\tthis._senders = this._senders || [];\r\n\t\t\t\t\treturn this._senders.slice(); // return a copy of the internal state.\r\n\t\t\t\t};\r\n\t\t\t\tvar origAddTrack = window.RTCPeerConnection.prototype.addTrack;\r\n\t\t\t\twindow.RTCPeerConnection.prototype.addTrack = function addTrack(track, stream) {\r\n\t\t\t\t\tvar sender = origAddTrack.apply(this, arguments);\r\n\t\t\t\t\tif (!sender) {\r\n\t\t\t\t\t\tsender = shimSenderWithDtmf(this, track);\r\n\t\t\t\t\t\tthis._senders.push(sender);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn sender;\r\n\t\t\t\t};\r\n\t\r\n\t\t\t\tvar origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\r\n\t\t\t\twindow.RTCPeerConnection.prototype.removeTrack = function removeTrack(sender) {\r\n\t\t\t\t\torigRemoveTrack.apply(this, arguments);\r\n\t\t\t\t\tvar idx = this._senders.indexOf(sender);\r\n\t\t\t\t\tif (idx !== -1) {\r\n\t\t\t\t\t\tthis._senders.splice(idx, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tvar origAddStream = window.RTCPeerConnection.prototype.addStream;\r\n\t\t\twindow.RTCPeerConnection.prototype.addStream = function addStream(stream) {\r\n\t\t\t\tvar _this2 = this;\r\n\t\r\n\t\t\t\tthis._senders = this._senders || [];\r\n\t\t\t\torigAddStream.apply(this, [stream]);\r\n\t\t\t\tstream.getTracks().forEach(function (track) {\r\n\t\t\t\t\t_this2._senders.push(shimSenderWithDtmf(_this2, track));\r\n\t\t\t\t});\r\n\t\t\t};\r\n\t\r\n\t\t\tvar origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\r\n\t\t\twindow.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\r\n\t\t\t\tvar _this3 = this;\r\n\t\r\n\t\t\t\tthis._senders = this._senders || [];\r\n\t\t\t\torigRemoveStream.apply(this, [stream]);\r\n\t\r\n\t\t\t\tstream.getTracks().forEach(function (track) {\r\n\t\t\t\t\tvar sender = _this3._senders.find(function (s) {\r\n\t\t\t\t\t\treturn s.track === track;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (sender) {\r\n\t\t\t\t\t\t// remove sender\r\n\t\t\t\t\t\t_this3._senders.splice(_this3._senders.indexOf(sender), 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\t\t} else if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && 'getSenders' in window.RTCPeerConnection.prototype && 'createDTMFSender' in window.RTCPeerConnection.prototype && window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\r\n\t\t\tvar origGetSenders = window.RTCPeerConnection.prototype.getSenders;\r\n\t\t\twindow.RTCPeerConnection.prototype.getSenders = function getSenders() {\r\n\t\t\t\tvar _this4 = this;\r\n\t\r\n\t\t\t\tvar senders = origGetSenders.apply(this, []);\r\n\t\t\t\tsenders.forEach(function (sender) {\r\n\t\t\t\t\treturn sender._pc = _this4;\r\n\t\t\t\t});\r\n\t\t\t\treturn senders;\r\n\t\t\t};\r\n\t\r\n\t\t\tObject.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\r\n\t\t\t\tget: function get() {\r\n\t\t\t\t\tif (this._dtmf === undefined) {\r\n\t\t\t\t\t\tif (this.track.kind === 'audio') {\r\n\t\t\t\t\t\t\tthis._dtmf = this._pc.createDTMFSender(this.track);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._dtmf = null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn this._dtmf;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction shimGetStats(window) {\r\n\t\tif (!window.RTCPeerConnection) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\r\n\t\tvar origGetStats = window.RTCPeerConnection.prototype.getStats;\r\n\t\twindow.RTCPeerConnection.prototype.getStats = function getStats() {\r\n\t\t\tvar _this5 = this;\r\n\t\r\n\t\t\tvar _arguments = Array.prototype.slice.call(arguments),\r\n\t\t\t\t\tselector = _arguments[0],\r\n\t\t\t\t\tonSucc = _arguments[1],\r\n\t\t\t\t\tonErr = _arguments[2];\r\n\t\r\n\t\t\t// If selector is a function then we are in the old style stats so just\r\n\t\t\t// pass back the original getStats format to avoid breaking old users.\r\n\t\r\n\t\r\n\t\t\tif (arguments.length > 0 && typeof selector === 'function') {\r\n\t\t\t\treturn origGetStats.apply(this, arguments);\r\n\t\t\t}\r\n\t\r\n\t\t\t// When spec-style getStats is supported, return those when called with\r\n\t\t\t// either no arguments or the selector argument is null.\r\n\t\t\tif (origGetStats.length === 0 && (arguments.length === 0 || typeof selector !== 'function')) {\r\n\t\t\t\treturn origGetStats.apply(this, []);\r\n\t\t\t}\r\n\t\r\n\t\t\tvar fixChromeStats_ = function fixChromeStats_(response) {\r\n\t\t\t\tvar standardReport = {};\r\n\t\t\t\tvar reports = response.result();\r\n\t\t\t\treports.forEach(function (report) {\r\n\t\t\t\t\tvar standardStats = {\r\n\t\t\t\t\t\tid: report.id,\r\n\t\t\t\t\t\ttimestamp: report.timestamp,\r\n\t\t\t\t\t\ttype: {\r\n\t\t\t\t\t\t\tlocalcandidate: 'local-candidate',\r\n\t\t\t\t\t\t\tremotecandidate: 'remote-candidate'\r\n\t\t\t\t\t\t}[report.type] || report.type\r\n\t\t\t\t\t};\r\n\t\t\t\t\treport.names().forEach(function (name) {\r\n\t\t\t\t\t\tstandardStats[name] = report.stat(name);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tstandardReport[standardStats.id] = standardStats;\r\n\t\t\t\t});\r\n\t\r\n\t\t\t\treturn standardReport;\r\n\t\t\t};\r\n\t\r\n\t\t\t// shim getStats with maplike support\r\n\t\t\tvar makeMapStats = function makeMapStats(stats) {\r\n\t\t\t\treturn new Map(Object.keys(stats).map(function (key) {\r\n\t\t\t\t\treturn [key, stats[key]];\r\n\t\t\t\t}));\r\n\t\t\t};\r\n\t\r\n\t\t\tif (arguments.length >= 2) {\r\n\t\t\t\tvar successCallbackWrapper_ = function successCallbackWrapper_(response) {\r\n\t\t\t\t\tonSucc(makeMapStats(fixChromeStats_(response)));\r\n\t\t\t\t};\r\n\t\r\n\t\t\t\treturn origGetStats.apply(this, [successCallbackWrapper_, selector]);\r\n\t\t\t}\r\n\t\r\n\t\t\t// promise-support\r\n\t\t\treturn new Promise(function (resolve, reject) {\r\n\t\t\t\torigGetStats.apply(_this5, [function (response) {\r\n\t\t\t\t\tresolve(makeMapStats(fixChromeStats_(response)));\r\n\t\t\t\t}, reject]);\r\n\t\t\t}).then(onSucc, onErr);\r\n\t\t};\r\n\t}\r\n\t\r\n\tfunction shimSenderReceiverGetStats(window) {\r\n\t\tif (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender && window.RTCRtpReceiver)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\r\n\t\t// shim sender stats.\r\n\t\tif (!('getStats' in window.RTCRtpSender.prototype)) {\r\n\t\t\tvar origGetSenders = window.RTCPeerConnection.prototype.getSenders;\r\n\t\t\tif (origGetSenders) {\r\n\t\t\t\twindow.RTCPeerConnection.prototype.getSenders = function getSenders() {\r\n\t\t\t\t\tvar _this6 = this;\r\n\t\r\n\t\t\t\t\tvar senders = origGetSenders.apply(this, []);\r\n\t\t\t\t\tsenders.forEach(function (sender) {\r\n\t\t\t\t\t\treturn sender._pc = _this6;\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn senders;\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\r\n\t\t\tvar origAddTrack = window.RTCPeerConnection.prototype.addTrack;\r\n\t\t\tif (origAddTrack) {\r\n\t\t\t\twindow.RTCPeerConnection.prototype.addTrack = function addTrack() {\r\n\t\t\t\t\tvar sender = origAddTrack.apply(this, arguments);\r\n\t\t\t\t\tsender._pc = this;\r\n\t\t\t\t\treturn sender;\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\twindow.RTCRtpSender.prototype.getStats = function getStats() {\r\n\t\t\t\tvar sender = this;\r\n\t\t\t\treturn this._pc.getStats().then(function (result) {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t/* Note: this will include stats of all senders that\r\n\t\t\t\t\t\t *   send a track with the same id as sender.track as\r\n\t\t\t\t\t\t *   it is not possible to identify the RTCRtpSender.\r\n\t\t\t\t\t\t */\r\n\t\t\t\t\t\tutils.filterStats(result, sender.track, true)\r\n\t\t\t\t\t);\r\n\t\t\t\t});\r\n\t\t\t};\r\n\t\t}\r\n\t\r\n\t\t// shim receiver stats.\r\n\t\tif (!('getStats' in window.RTCRtpReceiver.prototype)) {\r\n\t\t\tvar origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\r\n\t\t\tif (origGetReceivers) {\r\n\t\t\t\twindow.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\r\n\t\t\t\t\tvar _this7 = this;\r\n\t\r\n\t\t\t\t\tvar receivers = origGetReceivers.apply(this, []);\r\n\t\t\t\t\treceivers.forEach(function (receiver) {\r\n\t\t\t\t\t\treturn receiver._pc = _this7;\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn receivers;\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tutils.wrapPeerConnectionEvent(window, 'track', function (e) {\r\n\t\t\t\te.receiver._pc = e.srcElement;\r\n\t\t\t\treturn e;\r\n\t\t\t});\r\n\t\t\twindow.RTCRtpReceiver.prototype.getStats = function getStats() {\r\n\t\t\t\tvar receiver = this;\r\n\t\t\t\treturn this._pc.getStats().then(function (result) {\r\n\t\t\t\t\treturn utils.filterStats(result, receiver.track, false);\r\n\t\t\t\t});\r\n\t\t\t};\r\n\t\t}\r\n\t\r\n\t\tif (!('getStats' in window.RTCRtpSender.prototype && 'getStats' in window.RTCRtpReceiver.prototype)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\r\n\t\t// shim RTCPeerConnection.getStats(track).\r\n\t\tvar origGetStats = window.RTCPeerConnection.prototype.getStats;\r\n\t\twindow.RTCPeerConnection.prototype.getStats = function getStats() {\r\n\t\t\tif (arguments.length > 0 && arguments[0] instanceof window.MediaStreamTrack) {\r\n\t\t\t\tvar track = arguments[0];\r\n\t\t\t\tvar sender = void 0;\r\n\t\t\t\tvar receiver = void 0;\r\n\t\t\t\tvar err = void 0;\r\n\t\t\t\tthis.getSenders().forEach(function (s) {\r\n\t\t\t\t\tif (s.track === track) {\r\n\t\t\t\t\t\tif (sender) {\r\n\t\t\t\t\t\t\terr = true;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tsender = s;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tthis.getReceivers().forEach(function (r) {\r\n\t\t\t\t\tif (r.track === track) {\r\n\t\t\t\t\t\tif (receiver) {\r\n\t\t\t\t\t\t\terr = true;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treceiver = r;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn r.track === track;\r\n\t\t\t\t});\r\n\t\t\t\tif (err || sender && receiver) {\r\n\t\t\t\t\treturn Promise.reject(new DOMException('There are more than one sender or receiver for the track.', 'InvalidAccessError'));\r\n\t\t\t\t} else if (sender) {\r\n\t\t\t\t\treturn sender.getStats();\r\n\t\t\t\t} else if (receiver) {\r\n\t\t\t\t\treturn receiver.getStats();\r\n\t\t\t\t}\r\n\t\t\t\treturn Promise.reject(new DOMException('There is no sender or receiver for the track.', 'InvalidAccessError'));\r\n\t\t\t}\r\n\t\t\treturn origGetStats.apply(this, arguments);\r\n\t\t};\r\n\t}\r\n\t\r\n\tfunction shimAddTrackRemoveTrackWithNative(window) {\r\n\t\t// shim addTrack/removeTrack with native variants in order to make\r\n\t\t// the interactions with legacy getLocalStreams behave as in other browsers.\r\n\t\t// Keeps a mapping stream.id => [stream, rtpsenders...]\r\n\t\twindow.RTCPeerConnection.prototype.getLocalStreams = function getLocalStreams() {\r\n\t\t\tvar _this8 = this;\r\n\t\r\n\t\t\tthis._shimmedLocalStreams = this._shimmedLocalStreams || {};\r\n\t\t\treturn Object.keys(this._shimmedLocalStreams).map(function (streamId) {\r\n\t\t\t\treturn _this8._shimmedLocalStreams[streamId][0];\r\n\t\t\t});\r\n\t\t};\r\n\t\r\n\t\tvar origAddTrack = window.RTCPeerConnection.prototype.addTrack;\r\n\t\twindow.RTCPeerConnection.prototype.addTrack = function addTrack(track, stream) {\r\n\t\t\tif (!stream) {\r\n\t\t\t\treturn origAddTrack.apply(this, arguments);\r\n\t\t\t}\r\n\t\t\tthis._shimmedLocalStreams = this._shimmedLocalStreams || {};\r\n\t\r\n\t\t\tvar sender = origAddTrack.apply(this, arguments);\r\n\t\t\tif (!this._shimmedLocalStreams[stream.id]) {\r\n\t\t\t\tthis._shimmedLocalStreams[stream.id] = [stream, sender];\r\n\t\t\t} else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\r\n\t\t\t\tthis._shimmedLocalStreams[stream.id].push(sender);\r\n\t\t\t}\r\n\t\t\treturn sender;\r\n\t\t};\r\n\t\r\n\t\tvar origAddStream = window.RTCPeerConnection.prototype.addStream;\r\n\t\twindow.RTCPeerConnection.prototype.addStream = function addStream(stream) {\r\n\t\t\tvar _this9 = this;\r\n\t\r\n\t\t\tthis._shimmedLocalStreams = this._shimmedLocalStreams || {};\r\n\t\r\n\t\t\tstream.getTracks().forEach(function (track) {\r\n\t\t\t\tvar alreadyExists = _this9.getSenders().find(function (s) {\r\n\t\t\t\t\treturn s.track === track;\r\n\t\t\t\t});\r\n\t\t\t\tif (alreadyExists) {\r\n\t\t\t\t\tthrow new DOMException('Track already exists.', 'InvalidAccessError');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tvar existingSenders = this.getSenders();\r\n\t\t\torigAddStream.apply(this, arguments);\r\n\t\t\tvar newSenders = this.getSenders().filter(function (newSender) {\r\n\t\t\t\treturn existingSenders.indexOf(newSender) === -1;\r\n\t\t\t});\r\n\t\t\tthis._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\r\n\t\t};\r\n\t\r\n\t\tvar origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\r\n\t\twindow.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\r\n\t\t\tthis._shimmedLocalStreams = this._shimmedLocalStreams || {};\r\n\t\t\tdelete this._shimmedLocalStreams[stream.id];\r\n\t\t\treturn origRemoveStream.apply(this, arguments);\r\n\t\t};\r\n\t\r\n\t\tvar origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\r\n\t\twindow.RTCPeerConnection.prototype.removeTrack = function removeTrack(sender) {\r\n\t\t\tvar _this10 = this;\r\n\t\r\n\t\t\tthis._shimmedLocalStreams = this._shimmedLocalStreams || {};\r\n\t\t\tif (sender) {\r\n\t\t\t\tObject.keys(this._shimmedLocalStreams).forEach(function (streamId) {\r\n\t\t\t\t\tvar idx = _this10._shimmedLocalStreams[streamId].indexOf(sender);\r\n\t\t\t\t\tif (idx !== -1) {\r\n\t\t\t\t\t\t_this10._shimmedLocalStreams[streamId].splice(idx, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (_this10._shimmedLocalStreams[streamId].length === 1) {\r\n\t\t\t\t\t\tdelete _this10._shimmedLocalStreams[streamId];\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn origRemoveTrack.apply(this, arguments);\r\n\t\t};\r\n\t}\r\n\t\r\n\tfunction shimAddTrackRemoveTrack(window) {\r\n\t\tif (!window.RTCPeerConnection) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar browserDetails = utils.detectBrowser(window);\r\n\t\t// shim addTrack and removeTrack.\r\n\t\tif (window.RTCPeerConnection.prototype.addTrack && browserDetails.version >= 65) {\r\n\t\t\treturn shimAddTrackRemoveTrackWithNative(window);\r\n\t\t}\r\n\t\r\n\t\t// also shim pc.getLocalStreams when addTrack is shimmed\r\n\t\t// to return the original streams.\r\n\t\tvar origGetLocalStreams = window.RTCPeerConnection.prototype.getLocalStreams;\r\n\t\twindow.RTCPeerConnection.prototype.getLocalStreams = function getLocalStreams() {\r\n\t\t\tvar _this11 = this;\r\n\t\r\n\t\t\tvar nativeStreams = origGetLocalStreams.apply(this);\r\n\t\t\tthis._reverseStreams = this._reverseStreams || {};\r\n\t\t\treturn nativeStreams.map(function (stream) {\r\n\t\t\t\treturn _this11._reverseStreams[stream.id];\r\n\t\t\t});\r\n\t\t};\r\n\t\r\n\t\tvar origAddStream = window.RTCPeerConnection.prototype.addStream;\r\n\t\twindow.RTCPeerConnection.prototype.addStream = function addStream(stream) {\r\n\t\t\tvar _this12 = this;\r\n\t\r\n\t\t\tthis._streams = this._streams || {};\r\n\t\t\tthis._reverseStreams = this._reverseStreams || {};\r\n\t\r\n\t\t\tstream.getTracks().forEach(function (track) {\r\n\t\t\t\tvar alreadyExists = _this12.getSenders().find(function (s) {\r\n\t\t\t\t\treturn s.track === track;\r\n\t\t\t\t});\r\n\t\t\t\tif (alreadyExists) {\r\n\t\t\t\t\tthrow new DOMException('Track already exists.', 'InvalidAccessError');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t// Add identity mapping for consistency with addTrack.\r\n\t\t\t// Unless this is being used with a stream from addTrack.\r\n\t\t\tif (!this._reverseStreams[stream.id]) {\r\n\t\t\t\tvar newStream = new window.MediaStream(stream.getTracks());\r\n\t\t\t\tthis._streams[stream.id] = newStream;\r\n\t\t\t\tthis._reverseStreams[newStream.id] = stream;\r\n\t\t\t\tstream = newStream;\r\n\t\t\t}\r\n\t\t\torigAddStream.apply(this, [stream]);\r\n\t\t};\r\n\t\r\n\t\tvar origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\r\n\t\twindow.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\r\n\t\t\tthis._streams = this._streams || {};\r\n\t\t\tthis._reverseStreams = this._reverseStreams || {};\r\n\t\r\n\t\t\torigRemoveStream.apply(this, [this._streams[stream.id] || stream]);\r\n\t\t\tdelete this._reverseStreams[this._streams[stream.id] ? this._streams[stream.id].id : stream.id];\r\n\t\t\tdelete this._streams[stream.id];\r\n\t\t};\r\n\t\r\n\t\twindow.RTCPeerConnection.prototype.addTrack = function addTrack(track, stream) {\r\n\t\t\tvar _this13 = this;\r\n\t\r\n\t\t\tif (this.signalingState === 'closed') {\r\n\t\t\t\tthrow new DOMException('The RTCPeerConnection\\'s signalingState is \\'closed\\'.', 'InvalidStateError');\r\n\t\t\t}\r\n\t\t\tvar streams = [].slice.call(arguments, 1);\r\n\t\t\tif (streams.length !== 1 || !streams[0].getTracks().find(function (t) {\r\n\t\t\t\treturn t === track;\r\n\t\t\t})) {\r\n\t\t\t\t// this is not fully correct but all we can manage without\r\n\t\t\t\t// [[associated MediaStreams]] internal slot.\r\n\t\t\t\tthrow new DOMException('The adapter.js addTrack polyfill only supports a single ' + ' stream which is associated with the specified track.', 'NotSupportedError');\r\n\t\t\t}\r\n\t\r\n\t\t\tvar alreadyExists = this.getSenders().find(function (s) {\r\n\t\t\t\treturn s.track === track;\r\n\t\t\t});\r\n\t\t\tif (alreadyExists) {\r\n\t\t\t\tthrow new DOMException('Track already exists.', 'InvalidAccessError');\r\n\t\t\t}\r\n\t\r\n\t\t\tthis._streams = this._streams || {};\r\n\t\t\tthis._reverseStreams = this._reverseStreams || {};\r\n\t\t\tvar oldStream = this._streams[stream.id];\r\n\t\t\tif (oldStream) {\r\n\t\t\t\t// this is using odd Chrome behaviour, use with caution:\r\n\t\t\t\t// https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\r\n\t\t\t\t// Note: we rely on the high-level addTrack/dtmf shim to\r\n\t\t\t\t// create the sender with a dtmf sender.\r\n\t\t\t\toldStream.addTrack(track);\r\n\t\r\n\t\t\t\t// Trigger ONN async.\r\n\t\t\t\tPromise.resolve().then(function () {\r\n\t\t\t\t\t_this13.dispatchEvent(new Event('negotiationneeded'));\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tvar newStream = new window.MediaStream([track]);\r\n\t\t\t\tthis._streams[stream.id] = newStream;\r\n\t\t\t\tthis._reverseStreams[newStream.id] = stream;\r\n\t\t\t\tthis.addStream(newStream);\r\n\t\t\t}\r\n\t\t\treturn this.getSenders().find(function (s) {\r\n\t\t\t\treturn s.track === track;\r\n\t\t\t});\r\n\t\t};\r\n\t\r\n\t\t// replace the internal stream id with the external one and\r\n\t\t// vice versa.\r\n\t\tfunction replaceInternalStreamId(pc, description) {\r\n\t\t\tvar sdp = description.sdp;\r\n\t\t\tObject.keys(pc._reverseStreams || []).forEach(function (internalId) {\r\n\t\t\t\tvar externalStream = pc._reverseStreams[internalId];\r\n\t\t\t\tvar internalStream = pc._streams[externalStream.id];\r\n\t\t\t\tsdp = sdp.replace(new RegExp(internalStream.id, 'g'), externalStream.id);\r\n\t\t\t});\r\n\t\t\treturn new RTCSessionDescription({\r\n\t\t\t\ttype: description.type,\r\n\t\t\t\tsdp: sdp\r\n\t\t\t});\r\n\t\t}\r\n\t\tfunction replaceExternalStreamId(pc, description) {\r\n\t\t\tvar sdp = description.sdp;\r\n\t\t\tObject.keys(pc._reverseStreams || []).forEach(function (internalId) {\r\n\t\t\t\tvar externalStream = pc._reverseStreams[internalId];\r\n\t\t\t\tvar internalStream = pc._streams[externalStream.id];\r\n\t\t\t\tsdp = sdp.replace(new RegExp(externalStream.id, 'g'), internalStream.id);\r\n\t\t\t});\r\n\t\t\treturn new RTCSessionDescription({\r\n\t\t\t\ttype: description.type,\r\n\t\t\t\tsdp: sdp\r\n\t\t\t});\r\n\t\t}\r\n\t\t['createOffer', 'createAnswer'].forEach(function (method) {\r\n\t\t\tvar nativeMethod = window.RTCPeerConnection.prototype[method];\r\n\t\t\tvar methodObj = _defineProperty({}, method, function () {\r\n\t\t\t\tvar _this14 = this;\r\n\t\r\n\t\t\t\tvar args = arguments;\r\n\t\t\t\tvar isLegacyCall = arguments.length && typeof arguments[0] === 'function';\r\n\t\t\t\tif (isLegacyCall) {\r\n\t\t\t\t\treturn nativeMethod.apply(this, [function (description) {\r\n\t\t\t\t\t\tvar desc = replaceInternalStreamId(_this14, description);\r\n\t\t\t\t\t\targs[0].apply(null, [desc]);\r\n\t\t\t\t\t}, function (err) {\r\n\t\t\t\t\t\tif (args[1]) {\r\n\t\t\t\t\t\t\targs[1].apply(null, err);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, arguments[2]]);\r\n\t\t\t\t}\r\n\t\t\t\treturn nativeMethod.apply(this, arguments).then(function (description) {\r\n\t\t\t\t\treturn replaceInternalStreamId(_this14, description);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\twindow.RTCPeerConnection.prototype[method] = methodObj[method];\r\n\t\t});\r\n\t\r\n\t\tvar origSetLocalDescription = window.RTCPeerConnection.prototype.setLocalDescription;\r\n\t\twindow.RTCPeerConnection.prototype.setLocalDescription = function setLocalDescription() {\r\n\t\t\tif (!arguments.length || !arguments[0].type) {\r\n\t\t\t\treturn origSetLocalDescription.apply(this, arguments);\r\n\t\t\t}\r\n\t\t\targuments[0] = replaceExternalStreamId(this, arguments[0]);\r\n\t\t\treturn origSetLocalDescription.apply(this, arguments);\r\n\t\t};\r\n\t\r\n\t\t// TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\r\n\t\r\n\t\tvar origLocalDescription = Object.getOwnPropertyDescriptor(window.RTCPeerConnection.prototype, 'localDescription');\r\n\t\tObject.defineProperty(window.RTCPeerConnection.prototype, 'localDescription', {\r\n\t\t\tget: function get() {\r\n\t\t\t\tvar description = origLocalDescription.get.apply(this);\r\n\t\t\t\tif (description.type === '') {\r\n\t\t\t\t\treturn description;\r\n\t\t\t\t}\r\n\t\t\t\treturn replaceInternalStreamId(this, description);\r\n\t\t\t}\r\n\t\t});\r\n\t\r\n\t\twindow.RTCPeerConnection.prototype.removeTrack = function removeTrack(sender) {\r\n\t\t\tvar _this15 = this;\r\n\t\r\n\t\t\tif (this.signalingState === 'closed') {\r\n\t\t\t\tthrow new DOMException('The RTCPeerConnection\\'s signalingState is \\'closed\\'.', 'InvalidStateError');\r\n\t\t\t}\r\n\t\t\t// We can not yet check for sender instanceof RTCRtpSender\r\n\t\t\t// since we shim RTPSender. So we check if sender._pc is set.\r\n\t\t\tif (!sender._pc) {\r\n\t\t\t\tthrow new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' + 'does not implement interface RTCRtpSender.', 'TypeError');\r\n\t\t\t}\r\n\t\t\tvar isLocal = sender._pc === this;\r\n\t\t\tif (!isLocal) {\r\n\t\t\t\tthrow new DOMException('Sender was not created by this connection.', 'InvalidAccessError');\r\n\t\t\t}\r\n\t\r\n\t\t\t// Search for the native stream the senders track belongs to.\r\n\t\t\tthis._streams = this._streams || {};\r\n\t\t\tvar stream = void 0;\r\n\t\t\tObject.keys(this._streams).forEach(function (streamid) {\r\n\t\t\t\tvar hasTrack = _this15._streams[streamid].getTracks().find(function (track) {\r\n\t\t\t\t\treturn sender.track === track;\r\n\t\t\t\t});\r\n\t\t\t\tif (hasTrack) {\r\n\t\t\t\t\tstream = _this15._streams[streamid];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\r\n\t\t\tif (stream) {\r\n\t\t\t\tif (stream.getTracks().length === 1) {\r\n\t\t\t\t\t// if this is the last track of the stream, remove the stream. This\r\n\t\t\t\t\t// takes care of any shimmed _senders.\r\n\t\t\t\t\tthis.removeStream(this._reverseStreams[stream.id]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// relying on the same odd chrome behaviour as above.\r\n\t\t\t\t\tstream.removeTrack(sender.track);\r\n\t\t\t\t}\r\n\t\t\t\tthis.dispatchEvent(new Event('negotiationneeded'));\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\t\r\n\tfunction shimPeerConnection(window) {\r\n\t\tvar browserDetails = utils.detectBrowser(window);\r\n\t\r\n\t\tif (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\r\n\t\t\t// very basic support for old versions.\r\n\t\t\twindow.RTCPeerConnection = window.webkitRTCPeerConnection;\r\n\t\t}\r\n\t\tif (!window.RTCPeerConnection) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\r\n\t\tvar addIceCandidateNullSupported = window.RTCPeerConnection.prototype.addIceCandidate.length === 0;\r\n\t\r\n\t\t// shim implicit creation of RTCSessionDescription/RTCIceCandidate\r\n\t\tif (browserDetails.version < 53) {\r\n\t\t\t['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'].forEach(function (method) {\r\n\t\t\t\tvar nativeMethod = window.RTCPeerConnection.prototype[method];\r\n\t\t\t\tvar methodObj = _defineProperty({}, method, function () {\r\n\t\t\t\t\targuments[0] = new (method === 'addIceCandidate' ? window.RTCIceCandidate : window.RTCSessionDescription)(arguments[0]);\r\n\t\t\t\t\treturn nativeMethod.apply(this, arguments);\r\n\t\t\t\t});\r\n\t\t\t\twindow.RTCPeerConnection.prototype[method] = methodObj[method];\r\n\t\t\t});\r\n\t\t}\r\n\t\r\n\t\t// support for addIceCandidate(null or undefined)\r\n\t\tvar nativeAddIceCandidate = window.RTCPeerConnection.prototype.addIceCandidate;\r\n\t\twindow.RTCPeerConnection.prototype.addIceCandidate = function addIceCandidate() {\r\n\t\t\tif (!addIceCandidateNullSupported && !arguments[0]) {\r\n\t\t\t\tif (arguments[1]) {\r\n\t\t\t\t\targuments[1].apply(null);\r\n\t\t\t\t}\r\n\t\t\t\treturn Promise.resolve();\r\n\t\t\t}\r\n\t\t\t// Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\r\n\t\t\t// in older versions. Native support planned for Chrome M77.\r\n\t\t\tif (browserDetails.version < 78 && arguments[0] && arguments[0].candidate === '') {\r\n\t\t\t\treturn Promise.resolve();\r\n\t\t\t}\r\n\t\t\treturn nativeAddIceCandidate.apply(this, arguments);\r\n\t\t};\r\n\t}\r\n\t\r\n\t// Attempt to fix ONN in plan-b mode.\r\n\tfunction fixNegotiationNeeded(window) {\r\n\t\tvar browserDetails = utils.detectBrowser(window);\r\n\t\tutils.wrapPeerConnectionEvent(window, 'negotiationneeded', function (e) {\r\n\t\t\tvar pc = e.target;\r\n\t\t\tif (browserDetails.version < 72 || pc.getConfiguration && pc.getConfiguration().sdpSemantics === 'plan-b') {\r\n\t\t\t\tif (pc.signalingState !== 'stable') {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn e;\r\n\t\t});\r\n\t}\r\n\t\r\n\t},{\"../utils.js\":15,\"./getdisplaymedia\":4,\"./getusermedia\":5}],4:[function(require,module,exports){\r\n\t/*\r\n\t *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\r\n\t *\r\n\t *  Use of this source code is governed by a BSD-style license\r\n\t *  that can be found in the LICENSE file in the root of the source\r\n\t *  tree.\r\n\t */\r\n\t/* eslint-env node */\r\n\t'use strict';\r\n\t\r\n\tObject.defineProperty(exports, \"__esModule\", {\r\n\t\tvalue: true\r\n\t});\r\n\texports.shimGetDisplayMedia = shimGetDisplayMedia;\r\n\tfunction shimGetDisplayMedia(window, getSourceId) {\r\n\t\tif (window.navigator.mediaDevices && 'getDisplayMedia' in window.navigator.mediaDevices) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!window.navigator.mediaDevices) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// getSourceId is a function that returns a promise resolving with\r\n\t\t// the sourceId of the screen/window/tab to be shared.\r\n\t\tif (typeof getSourceId !== 'function') {\r\n\t\t\tconsole.error('shimGetDisplayMedia: getSourceId argument is not ' + 'a function');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\twindow.navigator.mediaDevices.getDisplayMedia = function getDisplayMedia(constraints) {\r\n\t\t\treturn getSourceId(constraints).then(function (sourceId) {\r\n\t\t\t\tvar widthSpecified = constraints.video && constraints.video.width;\r\n\t\t\t\tvar heightSpecified = constraints.video && constraints.video.height;\r\n\t\t\t\tvar frameRateSpecified = constraints.video && constraints.video.frameRate;\r\n\t\t\t\tconstraints.video = {\r\n\t\t\t\t\tmandatory: {\r\n\t\t\t\t\t\tchromeMediaSource: 'desktop',\r\n\t\t\t\t\t\tchromeMediaSourceId: sourceId,\r\n\t\t\t\t\t\tmaxFrameRate: frameRateSpecified || 3\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tif (widthSpecified) {\r\n\t\t\t\t\tconstraints.video.mandatory.maxWidth = widthSpecified;\r\n\t\t\t\t}\r\n\t\t\t\tif (heightSpecified) {\r\n\t\t\t\t\tconstraints.video.mandatory.maxHeight = heightSpecified;\r\n\t\t\t\t}\r\n\t\t\t\treturn window.navigator.mediaDevices.getUserMedia(constraints);\r\n\t\t\t});\r\n\t\t};\r\n\t}\r\n\t\r\n\t},{}],5:[function(require,module,exports){\r\n\t/*\r\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n\t *\r\n\t *  Use of this source code is governed by a BSD-style license\r\n\t *  that can be found in the LICENSE file in the root of the source\r\n\t *  tree.\r\n\t */\r\n\t/* eslint-env node */\r\n\t'use strict';\r\n\t\r\n\tObject.defineProperty(exports, \"__esModule\", {\r\n\t\tvalue: true\r\n\t});\r\n\t\r\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\r\n\t\r\n\texports.shimGetUserMedia = shimGetUserMedia;\r\n\t\r\n\tvar _utils = require('../utils.js');\r\n\t\r\n\tvar utils = _interopRequireWildcard(_utils);\r\n\t\r\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\r\n\t\r\n\tvar logging = utils.log;\r\n\t\r\n\tfunction shimGetUserMedia(window) {\r\n\t\tvar navigator = window && window.navigator;\r\n\t\r\n\t\tif (!navigator.mediaDevices) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\r\n\t\tvar browserDetails = utils.detectBrowser(window);\r\n\t\r\n\t\tvar constraintsToChrome_ = function constraintsToChrome_(c) {\r\n\t\t\tif ((typeof c === 'undefined' ? 'undefined' : _typeof(c)) !== 'object' || c.mandatory || c.optional) {\r\n\t\t\t\treturn c;\r\n\t\t\t}\r\n\t\t\tvar cc = {};\r\n\t\t\tObject.keys(c).forEach(function (key) {\r\n\t\t\t\tif (key === 'require' || key === 'advanced' || key === 'mediaSource') {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar r = _typeof(c[key]) === 'object' ? c[key] : { ideal: c[key] };\r\n\t\t\t\tif (r.exact !== undefined && typeof r.exact === 'number') {\r\n\t\t\t\t\tr.min = r.max = r.exact;\r\n\t\t\t\t}\r\n\t\t\t\tvar oldname_ = function oldname_(prefix, name) {\r\n\t\t\t\t\tif (prefix) {\r\n\t\t\t\t\t\treturn prefix + name.charAt(0).toUpperCase() + name.slice(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn name === 'deviceId' ? 'sourceId' : name;\r\n\t\t\t\t};\r\n\t\t\t\tif (r.ideal !== undefined) {\r\n\t\t\t\t\tcc.optional = cc.optional || [];\r\n\t\t\t\t\tvar oc = {};\r\n\t\t\t\t\tif (typeof r.ideal === 'number') {\r\n\t\t\t\t\t\toc[oldname_('min', key)] = r.ideal;\r\n\t\t\t\t\t\tcc.optional.push(oc);\r\n\t\t\t\t\t\toc = {};\r\n\t\t\t\t\t\toc[oldname_('max', key)] = r.ideal;\r\n\t\t\t\t\t\tcc.optional.push(oc);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toc[oldname_('', key)] = r.ideal;\r\n\t\t\t\t\t\tcc.optional.push(oc);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (r.exact !== undefined && typeof r.exact !== 'number') {\r\n\t\t\t\t\tcc.mandatory = cc.mandatory || {};\r\n\t\t\t\t\tcc.mandatory[oldname_('', key)] = r.exact;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t['min', 'max'].forEach(function (mix) {\r\n\t\t\t\t\t\tif (r[mix] !== undefined) {\r\n\t\t\t\t\t\t\tcc.mandatory = cc.mandatory || {};\r\n\t\t\t\t\t\t\tcc.mandatory[oldname_(mix, key)] = r[mix];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (c.advanced) {\r\n\t\t\t\tcc.optional = (cc.optional || []).concat(c.advanced);\r\n\t\t\t}\r\n\t\t\treturn cc;\r\n\t\t};\r\n\t\r\n\t\tvar shimConstraints_ = function shimConstraints_(constraints, func) {\r\n\t\t\tif (browserDetails.version >= 61) {\r\n\t\t\t\treturn func(constraints);\r\n\t\t\t}\r\n\t\t\tconstraints = JSON.parse(JSON.stringify(constraints));\r\n\t\t\tif (constraints && _typeof(constraints.audio) === 'object') {\r\n\t\t\t\tvar remap = function remap(obj, a, b) {\r\n\t\t\t\t\tif (a in obj && !(b in obj)) {\r\n\t\t\t\t\t\tobj[b] = obj[a];\r\n\t\t\t\t\t\tdelete obj[a];\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tconstraints = JSON.parse(JSON.stringify(constraints));\r\n\t\t\t\tremap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\r\n\t\t\t\tremap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\r\n\t\t\t\tconstraints.audio = constraintsToChrome_(constraints.audio);\r\n\t\t\t}\r\n\t\t\tif (constraints && _typeof(constraints.video) === 'object') {\r\n\t\t\t\t// Shim facingMode for mobile & surface pro.\r\n\t\t\t\tvar face = constraints.video.facingMode;\r\n\t\t\t\tface = face && ((typeof face === 'undefined' ? 'undefined' : _typeof(face)) === 'object' ? face : { ideal: face });\r\n\t\t\t\tvar getSupportedFacingModeLies = browserDetails.version < 66;\r\n\t\r\n\t\t\t\tif (face && (face.exact === 'user' || face.exact === 'environment' || face.ideal === 'user' || face.ideal === 'environment') && !(navigator.mediaDevices.getSupportedConstraints && navigator.mediaDevices.getSupportedConstraints().facingMode && !getSupportedFacingModeLies)) {\r\n\t\t\t\t\tdelete constraints.video.facingMode;\r\n\t\t\t\t\tvar matches = void 0;\r\n\t\t\t\t\tif (face.exact === 'environment' || face.ideal === 'environment') {\r\n\t\t\t\t\t\tmatches = ['back', 'rear'];\r\n\t\t\t\t\t} else if (face.exact === 'user' || face.ideal === 'user') {\r\n\t\t\t\t\t\tmatches = ['front'];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (matches) {\r\n\t\t\t\t\t\t// Look for matches in label, or use last cam for back (typical).\r\n\t\t\t\t\t\treturn navigator.mediaDevices.enumerateDevices().then(function (devices) {\r\n\t\t\t\t\t\t\tdevices = devices.filter(function (d) {\r\n\t\t\t\t\t\t\t\treturn d.kind === 'videoinput';\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tvar dev = devices.find(function (d) {\r\n\t\t\t\t\t\t\t\treturn matches.some(function (match) {\r\n\t\t\t\t\t\t\t\t\treturn d.label.toLowerCase().includes(match);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif (!dev && devices.length && matches.includes('back')) {\r\n\t\t\t\t\t\t\t\tdev = devices[devices.length - 1]; // more likely the back cam\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (dev) {\r\n\t\t\t\t\t\t\t\tconstraints.video.deviceId = face.exact ? { exact: dev.deviceId } : { ideal: dev.deviceId };\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconstraints.video = constraintsToChrome_(constraints.video);\r\n\t\t\t\t\t\t\tlogging('chrome: ' + JSON.stringify(constraints));\r\n\t\t\t\t\t\t\treturn func(constraints);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tconstraints.video = constraintsToChrome_(constraints.video);\r\n\t\t\t}\r\n\t\t\tlogging('chrome: ' + JSON.stringify(constraints));\r\n\t\t\treturn func(constraints);\r\n\t\t};\r\n\t\r\n\t\tvar shimError_ = function shimError_(e) {\r\n\t\t\tif (browserDetails.version >= 64) {\r\n\t\t\t\treturn e;\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\tname: {\r\n\t\t\t\t\tPermissionDeniedError: 'NotAllowedError',\r\n\t\t\t\t\tPermissionDismissedError: 'NotAllowedError',\r\n\t\t\t\t\tInvalidStateError: 'NotAllowedError',\r\n\t\t\t\t\tDevicesNotFoundError: 'NotFoundError',\r\n\t\t\t\t\tConstraintNotSatisfiedError: 'OverconstrainedError',\r\n\t\t\t\t\tTrackStartError: 'NotReadableError',\r\n\t\t\t\t\tMediaDeviceFailedDueToShutdown: 'NotAllowedError',\r\n\t\t\t\t\tMediaDeviceKillSwitchOn: 'NotAllowedError',\r\n\t\t\t\t\tTabCaptureError: 'AbortError',\r\n\t\t\t\t\tScreenCaptureError: 'AbortError',\r\n\t\t\t\t\tDeviceCaptureError: 'AbortError'\r\n\t\t\t\t}[e.name] || e.name,\r\n\t\t\t\tmessage: e.message,\r\n\t\t\t\tconstraint: e.constraint || e.constraintName,\r\n\t\t\t\ttoString: function toString() {\r\n\t\t\t\t\treturn this.name + (this.message && ': ') + this.message;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t};\r\n\t\r\n\t\tvar getUserMedia_ = function getUserMedia_(constraints, onSuccess, onError) {\r\n\t\t\tshimConstraints_(constraints, function (c) {\r\n\t\t\t\tnavigator.webkitGetUserMedia(c, onSuccess, function (e) {\r\n\t\t\t\t\tif (onError) {\r\n\t\t\t\t\t\tonError(shimError_(e));\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t};\r\n\t\tnavigator.getUserMedia = getUserMedia_.bind(navigator);\r\n\t\r\n\t\t// Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\r\n\t\t// function which returns a Promise, it does not accept spec-style\r\n\t\t// constraints.\r\n\t\tif (navigator.mediaDevices.getUserMedia) {\r\n\t\t\tvar origGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\r\n\t\t\tnavigator.mediaDevices.getUserMedia = function (cs) {\r\n\t\t\t\treturn shimConstraints_(cs, function (c) {\r\n\t\t\t\t\treturn origGetUserMedia(c).then(function (stream) {\r\n\t\t\t\t\t\tif (c.audio && !stream.getAudioTracks().length || c.video && !stream.getVideoTracks().length) {\r\n\t\t\t\t\t\t\tstream.getTracks().forEach(function (track) {\r\n\t\t\t\t\t\t\t\ttrack.stop();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthrow new DOMException('', 'NotFoundError');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn stream;\r\n\t\t\t\t\t}, function (e) {\r\n\t\t\t\t\t\treturn Promise.reject(shimError_(e));\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\t\r\n\t},{\"../utils.js\":15}],6:[function(require,module,exports){\r\n\t/*\r\n\t *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\r\n\t *\r\n\t *  Use of this source code is governed by a BSD-style license\r\n\t *  that can be found in the LICENSE file in the root of the source\r\n\t *  tree.\r\n\t */\r\n\t/* eslint-env node */\r\n\t'use strict';\r\n\t\r\n\tObject.defineProperty(exports, \"__esModule\", {\r\n\t\tvalue: true\r\n\t});\r\n\t\r\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\r\n\t\r\n\texports.shimRTCIceCandidate = shimRTCIceCandidate;\r\n\texports.shimMaxMessageSize = shimMaxMessageSize;\r\n\texports.shimSendThrowTypeError = shimSendThrowTypeError;\r\n\texports.shimConnectionState = shimConnectionState;\r\n\texports.removeAllowExtmapMixed = removeAllowExtmapMixed;\r\n\t\r\n\tvar _sdp = require('sdp');\r\n\t\r\n\tvar _sdp2 = _interopRequireDefault(_sdp);\r\n\t\r\n\tvar _utils = require('./utils');\r\n\t\r\n\tvar utils = _interopRequireWildcard(_utils);\r\n\t\r\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\r\n\t\r\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\t\r\n\tfunction shimRTCIceCandidate(window) {\r\n\t\t// foundation is arbitrarily chosen as an indicator for full support for\r\n\t\t// https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\r\n\t\tif (!window.RTCIceCandidate || window.RTCIceCandidate && 'foundation' in window.RTCIceCandidate.prototype) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\r\n\t\tvar NativeRTCIceCandidate = window.RTCIceCandidate;\r\n\t\twindow.RTCIceCandidate = function RTCIceCandidate(args) {\r\n\t\t\t// Remove the a= which shouldn't be part of the candidate string.\r\n\t\t\tif ((typeof args === 'undefined' ? 'undefined' : _typeof(args)) === 'object' && args.candidate && args.candidate.indexOf('a=') === 0) {\r\n\t\t\t\targs = JSON.parse(JSON.stringify(args));\r\n\t\t\t\targs.candidate = args.candidate.substr(2);\r\n\t\t\t}\r\n\t\r\n\t\t\tif (args.candidate && args.candidate.length) {\r\n\t\t\t\t// Augment the native candidate with the parsed fields.\r\n\t\t\t\tvar nativeCandidate = new NativeRTCIceCandidate(args);\r\n\t\t\t\tvar parsedCandidate = _sdp2.default.parseCandidate(args.candidate);\r\n\t\t\t\tvar augmentedCandidate = Object.assign(nativeCandidate, parsedCandidate);\r\n\t\r\n\t\t\t\t// Add a serializer that does not serialize the extra attributes.\r\n\t\t\t\taugmentedCandidate.toJSON = function toJSON() {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tcandidate: augmentedCandidate.candidate,\r\n\t\t\t\t\t\tsdpMid: augmentedCandidate.sdpMid,\r\n\t\t\t\t\t\tsdpMLineIndex: augmentedCandidate.sdpMLineIndex,\r\n\t\t\t\t\t\tusernameFragment: augmentedCandidate.usernameFragment\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\t\t\t\treturn augmentedCandidate;\r\n\t\t\t}\r\n\t\t\treturn new NativeRTCIceCandidate(args);\r\n\t\t};\r\n\t\twindow.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\r\n\t\r\n\t\t// Hook up the augmented candidate in onicecandidate and\r\n\t\t// addEventListener('icecandidate', ...)\r\n\t\tutils.wrapPeerConnectionEvent(window, 'icecandidate', function (e) {\r\n\t\t\tif (e.candidate) {\r\n\t\t\t\tObject.defineProperty(e, 'candidate', {\r\n\t\t\t\t\tvalue: new window.RTCIceCandidate(e.candidate),\r\n\t\t\t\t\twritable: 'false'\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn e;\r\n\t\t});\r\n\t}\r\n\t\r\n\tfunction shimMaxMessageSize(window) {\r\n\t\tif (!window.RTCPeerConnection) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar browserDetails = utils.detectBrowser(window);\r\n\t\r\n\t\tif (!('sctp' in window.RTCPeerConnection.prototype)) {\r\n\t\t\tObject.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\r\n\t\t\t\tget: function get() {\r\n\t\t\t\t\treturn typeof this._sctp === 'undefined' ? null : this._sctp;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\r\n\t\tvar sctpInDescription = function sctpInDescription(description) {\r\n\t\t\tif (!description || !description.sdp) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tvar sections = _sdp2.default.splitSections(description.sdp);\r\n\t\t\tsections.shift();\r\n\t\t\treturn sections.some(function (mediaSection) {\r\n\t\t\t\tvar mLine = _sdp2.default.parseMLine(mediaSection);\r\n\t\t\t\treturn mLine && mLine.kind === 'application' && mLine.protocol.indexOf('SCTP') !== -1;\r\n\t\t\t});\r\n\t\t};\r\n\t\r\n\t\tvar getRemoteFirefoxVersion = function getRemoteFirefoxVersion(description) {\r\n\t\t\t// TODO: Is there a better solution for detecting Firefox?\r\n\t\t\tvar match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\r\n\t\t\tif (match === null || match.length < 2) {\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t\tvar version = parseInt(match[1], 10);\r\n\t\t\t// Test for NaN (yes, this is ugly)\r\n\t\t\treturn version !== version ? -1 : version;\r\n\t\t};\r\n\t\r\n\t\tvar getCanSendMaxMessageSize = function getCanSendMaxMessageSize(remoteIsFirefox) {\r\n\t\t\t// Every implementation we know can send at least 64 KiB.\r\n\t\t\t// Note: Although Chrome is technically able to send up to 256 KiB, the\r\n\t\t\t//       data does not reach the other peer reliably.\r\n\t\t\t//       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\r\n\t\t\tvar canSendMaxMessageSize = 65536;\r\n\t\t\tif (browserDetails.browser === 'firefox') {\r\n\t\t\t\tif (browserDetails.version < 57) {\r\n\t\t\t\t\tif (remoteIsFirefox === -1) {\r\n\t\t\t\t\t\t// FF < 57 will send in 16 KiB chunks using the deprecated PPID\r\n\t\t\t\t\t\t// fragmentation.\r\n\t\t\t\t\t\tcanSendMaxMessageSize = 16384;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// However, other FF (and RAWRTC) can reassemble PPID-fragmented\r\n\t\t\t\t\t\t// messages. Thus, supporting ~2 GiB when sending.\r\n\t\t\t\t\t\tcanSendMaxMessageSize = 2147483637;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (browserDetails.version < 60) {\r\n\t\t\t\t\t// Currently, all FF >= 57 will reset the remote maximum message size\r\n\t\t\t\t\t// to the default value when a data channel is created at a later\r\n\t\t\t\t\t// stage. :(\r\n\t\t\t\t\t// See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\r\n\t\t\t\t\tcanSendMaxMessageSize = browserDetails.version === 57 ? 65535 : 65536;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// FF >= 60 supports sending ~2 GiB\r\n\t\t\t\t\tcanSendMaxMessageSize = 2147483637;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn canSendMaxMessageSize;\r\n\t\t};\r\n\t\r\n\t\tvar getMaxMessageSize = function getMaxMessageSize(description, remoteIsFirefox) {\r\n\t\t\t// Note: 65536 bytes is the default value from the SDP spec. Also,\r\n\t\t\t//       every implementation we know supports receiving 65536 bytes.\r\n\t\t\tvar maxMessageSize = 65536;\r\n\t\r\n\t\t\t// FF 57 has a slightly incorrect default remote max message size, so\r\n\t\t\t// we need to adjust it here to avoid a failure when sending.\r\n\t\t\t// See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\r\n\t\t\tif (browserDetails.browser === 'firefox' && browserDetails.version === 57) {\r\n\t\t\t\tmaxMessageSize = 65535;\r\n\t\t\t}\r\n\t\r\n\t\t\tvar match = _sdp2.default.matchPrefix(description.sdp, 'a=max-message-size:');\r\n\t\t\tif (match.length > 0) {\r\n\t\t\t\tmaxMessageSize = parseInt(match[0].substr(19), 10);\r\n\t\t\t} else if (browserDetails.browser === 'firefox' && remoteIsFirefox !== -1) {\r\n\t\t\t\t// If the maximum message size is not present in the remote SDP and\r\n\t\t\t\t// both local and remote are Firefox, the remote peer can receive\r\n\t\t\t\t// ~2 GiB.\r\n\t\t\t\tmaxMessageSize = 2147483637;\r\n\t\t\t}\r\n\t\t\treturn maxMessageSize;\r\n\t\t};\r\n\t\r\n\t\tvar origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\r\n\t\twindow.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription() {\r\n\t\t\tthis._sctp = null;\r\n\t\t\t// Chrome decided to not expose .sctp in plan-b mode.\r\n\t\t\t// As usual, adapter.js has to do an 'ugly worakaround'\r\n\t\t\t// to cover up the mess.\r\n\t\t\tif (browserDetails.browser === 'chrome' && browserDetails.version >= 76) {\r\n\t\t\t\tvar _getConfiguration = this.getConfiguration(),\r\n\t\t\t\t\t\tsdpSemantics = _getConfiguration.sdpSemantics;\r\n\t\r\n\t\t\t\tif (sdpSemantics === 'plan-b') {\r\n\t\t\t\t\tObject.defineProperty(this, 'sctp', {\r\n\t\t\t\t\t\tget: function get() {\r\n\t\t\t\t\t\t\treturn typeof this._sctp === 'undefined' ? null : this._sctp;\r\n\t\t\t\t\t\t},\r\n\t\r\n\t\t\t\t\t\tenumerable: true,\r\n\t\t\t\t\t\tconfigurable: true\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\r\n\t\t\tif (sctpInDescription(arguments[0])) {\r\n\t\t\t\t// Check if the remote is FF.\r\n\t\t\t\tvar isFirefox = getRemoteFirefoxVersion(arguments[0]);\r\n\t\r\n\t\t\t\t// Get the maximum message size the local peer is capable of sending\r\n\t\t\t\tvar canSendMMS = getCanSendMaxMessageSize(isFirefox);\r\n\t\r\n\t\t\t\t// Get the maximum message size of the remote peer.\r\n\t\t\t\tvar remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\r\n\t\r\n\t\t\t\t// Determine final maximum message size\r\n\t\t\t\tvar maxMessageSize = void 0;\r\n\t\t\t\tif (canSendMMS === 0 && remoteMMS === 0) {\r\n\t\t\t\t\tmaxMessageSize = Number.POSITIVE_INFINITY;\r\n\t\t\t\t} else if (canSendMMS === 0 || remoteMMS === 0) {\r\n\t\t\t\t\tmaxMessageSize = Math.max(canSendMMS, remoteMMS);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmaxMessageSize = Math.min(canSendMMS, remoteMMS);\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// Create a dummy RTCSctpTransport object and the 'maxMessageSize'\r\n\t\t\t\t// attribute.\r\n\t\t\t\tvar sctp = {};\r\n\t\t\t\tObject.defineProperty(sctp, 'maxMessageSize', {\r\n\t\t\t\t\tget: function get() {\r\n\t\t\t\t\t\treturn maxMessageSize;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tthis._sctp = sctp;\r\n\t\t\t}\r\n\t\r\n\t\t\treturn origSetRemoteDescription.apply(this, arguments);\r\n\t\t};\r\n\t}\r\n\t\r\n\tfunction shimSendThrowTypeError(window) {\r\n\t\tif (!(window.RTCPeerConnection && 'createDataChannel' in window.RTCPeerConnection.prototype)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\r\n\t\t// Note: Although Firefox >= 57 has a native implementation, the maximum\r\n\t\t//       message size can be reset for all data channels at a later stage.\r\n\t\t//       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\r\n\t\r\n\t\tfunction wrapDcSend(dc, pc) {\r\n\t\t\tvar origDataChannelSend = dc.send;\r\n\t\t\tdc.send = function send() {\r\n\t\t\t\tvar data = arguments[0];\r\n\t\t\t\tvar length = data.length || data.size || data.byteLength;\r\n\t\t\t\tif (dc.readyState === 'open' && pc.sctp && length > pc.sctp.maxMessageSize) {\r\n\t\t\t\t\tthrow new TypeError('Message too large (can send a maximum of ' + pc.sctp.maxMessageSize + ' bytes)');\r\n\t\t\t\t}\r\n\t\t\t\treturn origDataChannelSend.apply(dc, arguments);\r\n\t\t\t};\r\n\t\t}\r\n\t\tvar origCreateDataChannel = window.RTCPeerConnection.prototype.createDataChannel;\r\n\t\twindow.RTCPeerConnection.prototype.createDataChannel = function createDataChannel() {\r\n\t\t\tvar dataChannel = origCreateDataChannel.apply(this, arguments);\r\n\t\t\twrapDcSend(dataChannel, this);\r\n\t\t\treturn dataChannel;\r\n\t\t};\r\n\t\tutils.wrapPeerConnectionEvent(window, 'datachannel', function (e) {\r\n\t\t\twrapDcSend(e.channel, e.target);\r\n\t\t\treturn e;\r\n\t\t});\r\n\t}\r\n\t\r\n\t/* shims RTCConnectionState by pretending it is the same as iceConnectionState.\r\n\t * See https://bugs.chromium.org/p/webrtc/issues/detail?id=6145#c12\r\n\t * for why this is a valid hack in Chrome. In Firefox it is slightly incorrect\r\n\t * since DTLS failures would be hidden. See\r\n\t * https://bugzilla.mozilla.org/show_bug.cgi?id=1265827\r\n\t * for the Firefox tracking bug.\r\n\t */\r\n\tfunction shimConnectionState(window) {\r\n\t\tif (!window.RTCPeerConnection || 'connectionState' in window.RTCPeerConnection.prototype) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar proto = window.RTCPeerConnection.prototype;\r\n\t\tObject.defineProperty(proto, 'connectionState', {\r\n\t\t\tget: function get() {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tcompleted: 'connected',\r\n\t\t\t\t\tchecking: 'connecting'\r\n\t\t\t\t}[this.iceConnectionState] || this.iceConnectionState;\r\n\t\t\t},\r\n\t\r\n\t\t\tenumerable: true,\r\n\t\t\tconfigurable: true\r\n\t\t});\r\n\t\tObject.defineProperty(proto, 'onconnectionstatechange', {\r\n\t\t\tget: function get() {\r\n\t\t\t\treturn this._onconnectionstatechange || null;\r\n\t\t\t},\r\n\t\t\tset: function set(cb) {\r\n\t\t\t\tif (this._onconnectionstatechange) {\r\n\t\t\t\t\tthis.removeEventListener('connectionstatechange', this._onconnectionstatechange);\r\n\t\t\t\t\tdelete this._onconnectionstatechange;\r\n\t\t\t\t}\r\n\t\t\t\tif (cb) {\r\n\t\t\t\t\tthis.addEventListener('connectionstatechange', this._onconnectionstatechange = cb);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\r\n\t\t\tenumerable: true,\r\n\t\t\tconfigurable: true\r\n\t\t});\r\n\t\r\n\t\t['setLocalDescription', 'setRemoteDescription'].forEach(function (method) {\r\n\t\t\tvar origMethod = proto[method];\r\n\t\t\tproto[method] = function () {\r\n\t\t\t\tif (!this._connectionstatechangepoly) {\r\n\t\t\t\t\tthis._connectionstatechangepoly = function (e) {\r\n\t\t\t\t\t\tvar pc = e.target;\r\n\t\t\t\t\t\tif (pc._lastConnectionState !== pc.connectionState) {\r\n\t\t\t\t\t\t\tpc._lastConnectionState = pc.connectionState;\r\n\t\t\t\t\t\t\tvar newEvent = new Event('connectionstatechange', e);\r\n\t\t\t\t\t\t\tpc.dispatchEvent(newEvent);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn e;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis.addEventListener('iceconnectionstatechange', this._connectionstatechangepoly);\r\n\t\t\t\t}\r\n\t\t\t\treturn origMethod.apply(this, arguments);\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\t\r\n\tfunction removeAllowExtmapMixed(window) {\r\n\t\t/* remove a=extmap-allow-mixed for webrtc.org < M71 */\r\n\t\tif (!window.RTCPeerConnection) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar browserDetails = utils.detectBrowser(window);\r\n\t\tif (browserDetails.browser === 'chrome' && browserDetails.version >= 71) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (browserDetails.browser === 'safari' && browserDetails.version >= 605) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar nativeSRD = window.RTCPeerConnection.prototype.setRemoteDescription;\r\n\t\twindow.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription(desc) {\r\n\t\t\tif (desc && desc.sdp && desc.sdp.indexOf('\\na=extmap-allow-mixed') !== -1) {\r\n\t\t\t\tdesc.sdp = desc.sdp.split('\\n').filter(function (line) {\r\n\t\t\t\t\treturn line.trim() !== 'a=extmap-allow-mixed';\r\n\t\t\t\t}).join('\\n');\r\n\t\t\t}\r\n\t\t\treturn nativeSRD.apply(this, arguments);\r\n\t\t};\r\n\t}\r\n\t\r\n\t},{\"./utils\":15,\"sdp\":17}],7:[function(require,module,exports){\r\n\t/*\r\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n\t *\r\n\t *  Use of this source code is governed by a BSD-style license\r\n\t *  that can be found in the LICENSE file in the root of the source\r\n\t *  tree.\r\n\t */\r\n\t/* eslint-env node */\r\n\t'use strict';\r\n\t\r\n\tObject.defineProperty(exports, \"__esModule\", {\r\n\t\tvalue: true\r\n\t});\r\n\texports.shimGetDisplayMedia = exports.shimGetUserMedia = undefined;\r\n\t\r\n\tvar _getusermedia = require('./getusermedia');\r\n\t\r\n\tObject.defineProperty(exports, 'shimGetUserMedia', {\r\n\t\tenumerable: true,\r\n\t\tget: function get() {\r\n\t\t\treturn _getusermedia.shimGetUserMedia;\r\n\t\t}\r\n\t});\r\n\t\r\n\tvar _getdisplaymedia = require('./getdisplaymedia');\r\n\t\r\n\tObject.defineProperty(exports, 'shimGetDisplayMedia', {\r\n\t\tenumerable: true,\r\n\t\tget: function get() {\r\n\t\t\treturn _getdisplaymedia.shimGetDisplayMedia;\r\n\t\t}\r\n\t});\r\n\texports.shimPeerConnection = shimPeerConnection;\r\n\texports.shimReplaceTrack = shimReplaceTrack;\r\n\t\r\n\tvar _utils = require('../utils');\r\n\t\r\n\tvar utils = _interopRequireWildcard(_utils);\r\n\t\r\n\tvar _filtericeservers = require('./filtericeservers');\r\n\t\r\n\tvar _rtcpeerconnectionShim = require('rtcpeerconnection-shim');\r\n\t\r\n\tvar _rtcpeerconnectionShim2 = _interopRequireDefault(_rtcpeerconnectionShim);\r\n\t\r\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\t\r\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\r\n\t\r\n\tfunction shimPeerConnection(window) {\r\n\t\tvar browserDetails = utils.detectBrowser(window);\r\n\t\r\n\t\tif (window.RTCIceGatherer) {\r\n\t\t\tif (!window.RTCIceCandidate) {\r\n\t\t\t\twindow.RTCIceCandidate = function RTCIceCandidate(args) {\r\n\t\t\t\t\treturn args;\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tif (!window.RTCSessionDescription) {\r\n\t\t\t\twindow.RTCSessionDescription = function RTCSessionDescription(args) {\r\n\t\t\t\t\treturn args;\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\t// this adds an additional event listener to MediaStrackTrack that signals\r\n\t\t\t// when a tracks enabled property was changed. Workaround for a bug in\r\n\t\t\t// addStream, see below. No longer required in 15025+\r\n\t\t\tif (browserDetails.version < 15025) {\r\n\t\t\t\tvar origMSTEnabled = Object.getOwnPropertyDescriptor(window.MediaStreamTrack.prototype, 'enabled');\r\n\t\t\t\tObject.defineProperty(window.MediaStreamTrack.prototype, 'enabled', {\r\n\t\t\t\t\tset: function set(value) {\r\n\t\t\t\t\t\torigMSTEnabled.set.call(this, value);\r\n\t\t\t\t\t\tvar ev = new Event('enabled');\r\n\t\t\t\t\t\tev.enabled = value;\r\n\t\t\t\t\t\tthis.dispatchEvent(ev);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\t// ORTC defines the DTMF sender a bit different.\r\n\t\t// https://github.com/w3c/ortc/issues/714\r\n\t\tif (window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\r\n\t\t\tObject.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\r\n\t\t\t\tget: function get() {\r\n\t\t\t\t\tif (this._dtmf === undefined) {\r\n\t\t\t\t\t\tif (this.track.kind === 'audio') {\r\n\t\t\t\t\t\t\tthis._dtmf = new window.RTCDtmfSender(this);\r\n\t\t\t\t\t\t} else if (this.track.kind === 'video') {\r\n\t\t\t\t\t\t\tthis._dtmf = null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn this._dtmf;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t// Edge currently only implements the RTCDtmfSender, not the\r\n\t\t// RTCDTMFSender alias. See http://draft.ortc.org/#rtcdtmfsender2*\r\n\t\tif (window.RTCDtmfSender && !window.RTCDTMFSender) {\r\n\t\t\twindow.RTCDTMFSender = window.RTCDtmfSender;\r\n\t\t}\r\n\t\r\n\t\tvar RTCPeerConnectionShim = (0, _rtcpeerconnectionShim2.default)(window, browserDetails.version);\r\n\t\twindow.RTCPeerConnection = function RTCPeerConnection(config) {\r\n\t\t\tif (config && config.iceServers) {\r\n\t\t\t\tconfig.iceServers = (0, _filtericeservers.filterIceServers)(config.iceServers, browserDetails.version);\r\n\t\t\t\tutils.log('ICE servers after filtering:', config.iceServers);\r\n\t\t\t}\r\n\t\t\treturn new RTCPeerConnectionShim(config);\r\n\t\t};\r\n\t\twindow.RTCPeerConnection.prototype = RTCPeerConnectionShim.prototype;\r\n\t}\r\n\t\r\n\tfunction shimReplaceTrack(window) {\r\n\t\t// ORTC has replaceTrack -- https://github.com/w3c/ortc/issues/614\r\n\t\tif (window.RTCRtpSender && !('replaceTrack' in window.RTCRtpSender.prototype)) {\r\n\t\t\twindow.RTCRtpSender.prototype.replaceTrack = window.RTCRtpSender.prototype.setTrack;\r\n\t\t}\r\n\t}\r\n\t\r\n\t},{\"../utils\":15,\"./filtericeservers\":8,\"./getdisplaymedia\":9,\"./getusermedia\":10,\"rtcpeerconnection-shim\":16}],8:[function(require,module,exports){\r\n\t/*\r\n\t *  Copyright (c) 2018 The WebRTC project authors. All Rights Reserved.\r\n\t *\r\n\t *  Use of this source code is governed by a BSD-style license\r\n\t *  that can be found in the LICENSE file in the root of the source\r\n\t *  tree.\r\n\t */\r\n\t/* eslint-env node */\r\n\t'use strict';\r\n\t\r\n\tObject.defineProperty(exports, \"__esModule\", {\r\n\t\tvalue: true\r\n\t});\r\n\texports.filterIceServers = filterIceServers;\r\n\t\r\n\tvar _utils = require('../utils');\r\n\t\r\n\tvar utils = _interopRequireWildcard(_utils);\r\n\t\r\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\r\n\t\r\n\t// Edge does not like\r\n\t// 1) stun: filtered after 14393 unless ?transport=udp is present\r\n\t// 2) turn: that does not have all of turn:host:port?transport=udp\r\n\t// 3) turn: with ipv6 addresses\r\n\t// 4) turn: occurring muliple times\r\n\tfunction filterIceServers(iceServers, edgeVersion) {\r\n\t\tvar hasTurn = false;\r\n\t\ticeServers = JSON.parse(JSON.stringify(iceServers));\r\n\t\treturn iceServers.filter(function (server) {\r\n\t\t\tif (server && (server.urls || server.url)) {\r\n\t\t\t\tvar urls = server.urls || server.url;\r\n\t\t\t\tif (server.url && !server.urls) {\r\n\t\t\t\t\tutils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\r\n\t\t\t\t}\r\n\t\t\t\tvar isString = typeof urls === 'string';\r\n\t\t\t\tif (isString) {\r\n\t\t\t\t\turls = [urls];\r\n\t\t\t\t}\r\n\t\t\t\turls = urls.filter(function (url) {\r\n\t\t\t\t\t// filter STUN unconditionally.\r\n\t\t\t\t\tif (url.indexOf('stun:') === 0) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tvar validTurn = url.startsWith('turn') && !url.startsWith('turn:[') && url.includes('transport=udp');\r\n\t\t\t\t\tif (validTurn && !hasTurn) {\r\n\t\t\t\t\t\thasTurn = true;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn validTurn && !hasTurn;\r\n\t\t\t\t});\r\n\t\r\n\t\t\t\tdelete server.url;\r\n\t\t\t\tserver.urls = isString ? urls[0] : urls;\r\n\t\t\t\treturn !!urls.length;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t},{\"../utils\":15}],9:[function(require,module,exports){\r\n\t/*\r\n\t *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\r\n\t *\r\n\t *  Use of this source code is governed by a BSD-style license\r\n\t *  that can be found in the LICENSE file in the root of the source\r\n\t *  tree.\r\n\t */\r\n\t/* eslint-env node */\r\n\t'use strict';\r\n\t\r\n\tObject.defineProperty(exports, \"__esModule\", {\r\n\t\tvalue: true\r\n\t});\r\n\texports.shimGetDisplayMedia = shimGetDisplayMedia;\r\n\tfunction shimGetDisplayMedia(window) {\r\n\t\tif (!('getDisplayMedia' in window.navigator)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!window.navigator.mediaDevices) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (window.navigator.mediaDevices && 'getDisplayMedia' in window.navigator.mediaDevices) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\twindow.navigator.mediaDevices.getDisplayMedia = window.navigator.getDisplayMedia.bind(window.navigator);\r\n\t}\r\n\t\r\n\t},{}],10:[function(require,module,exports){\r\n\t/*\r\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n\t *\r\n\t *  Use of this source code is governed by a BSD-style license\r\n\t *  that can be found in the LICENSE file in the root of the source\r\n\t *  tree.\r\n\t */\r\n\t/* eslint-env node */\r\n\t'use strict';\r\n\t\r\n\tObject.defineProperty(exports, \"__esModule\", {\r\n\t\tvalue: true\r\n\t});\r\n\texports.shimGetUserMedia = shimGetUserMedia;\r\n\tfunction shimGetUserMedia(window) {\r\n\t\tvar navigator = window && window.navigator;\r\n\t\r\n\t\tvar shimError_ = function shimError_(e) {\r\n\t\t\treturn {\r\n\t\t\t\tname: { PermissionDeniedError: 'NotAllowedError' }[e.name] || e.name,\r\n\t\t\t\tmessage: e.message,\r\n\t\t\t\tconstraint: e.constraint,\r\n\t\t\t\ttoString: function toString() {\r\n\t\t\t\t\treturn this.name;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t};\r\n\t\r\n\t\t// getUserMedia error shim.\r\n\t\tvar origGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\r\n\t\tnavigator.mediaDevices.getUserMedia = function (c) {\r\n\t\t\treturn origGetUserMedia(c).catch(function (e) {\r\n\t\t\t\treturn Promise.reject(shimError_(e));\r\n\t\t\t});\r\n\t\t};\r\n\t}\r\n\t\r\n\t},{}],11:[function(require,module,exports){\r\n\t/*\r\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n\t *\r\n\t *  Use of this source code is governed by a BSD-style license\r\n\t *  that can be found in the LICENSE file in the root of the source\r\n\t *  tree.\r\n\t */\r\n\t/* eslint-env node */\r\n\t'use strict';\r\n\t\r\n\tObject.defineProperty(exports, \"__esModule\", {\r\n\t\tvalue: true\r\n\t});\r\n\texports.shimGetDisplayMedia = exports.shimGetUserMedia = undefined;\r\n\t\r\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\r\n\t\r\n\tvar _getusermedia = require('./getusermedia');\r\n\t\r\n\tObject.defineProperty(exports, 'shimGetUserMedia', {\r\n\t\tenumerable: true,\r\n\t\tget: function get() {\r\n\t\t\treturn _getusermedia.shimGetUserMedia;\r\n\t\t}\r\n\t});\r\n\t\r\n\tvar _getdisplaymedia = require('./getdisplaymedia');\r\n\t\r\n\tObject.defineProperty(exports, 'shimGetDisplayMedia', {\r\n\t\tenumerable: true,\r\n\t\tget: function get() {\r\n\t\t\treturn _getdisplaymedia.shimGetDisplayMedia;\r\n\t\t}\r\n\t});\r\n\texports.shimOnTrack = shimOnTrack;\r\n\texports.shimPeerConnection = shimPeerConnection;\r\n\texports.shimSenderGetStats = shimSenderGetStats;\r\n\texports.shimReceiverGetStats = shimReceiverGetStats;\r\n\texports.shimRemoveStream = shimRemoveStream;\r\n\texports.shimRTCDataChannel = shimRTCDataChannel;\r\n\texports.shimAddTransceiver = shimAddTransceiver;\r\n\texports.shimGetParameters = shimGetParameters;\r\n\texports.shimCreateOffer = shimCreateOffer;\r\n\texports.shimCreateAnswer = shimCreateAnswer;\r\n\t\r\n\tvar _utils = require('../utils');\r\n\t\r\n\tvar utils = _interopRequireWildcard(_utils);\r\n\t\r\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\r\n\t\r\n\tfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\t\r\n\tfunction shimOnTrack(window) {\r\n\t\tif ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCTrackEvent && 'receiver' in window.RTCTrackEvent.prototype && !('transceiver' in window.RTCTrackEvent.prototype)) {\r\n\t\t\tObject.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\r\n\t\t\t\tget: function get() {\r\n\t\t\t\t\treturn { receiver: this.receiver };\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction shimPeerConnection(window) {\r\n\t\tvar browserDetails = utils.detectBrowser(window);\r\n\t\r\n\t\tif ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\r\n\t\t\treturn; // probably media.peerconnection.enabled=false in about:config\r\n\t\t}\r\n\t\tif (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\r\n\t\t\t// very basic support for old versions.\r\n\t\t\twindow.RTCPeerConnection = window.mozRTCPeerConnection;\r\n\t\t}\r\n\t\r\n\t\tif (browserDetails.version < 53) {\r\n\t\t\t// shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\r\n\t\t\t['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'].forEach(function (method) {\r\n\t\t\t\tvar nativeMethod = window.RTCPeerConnection.prototype[method];\r\n\t\t\t\tvar methodObj = _defineProperty({}, method, function () {\r\n\t\t\t\t\targuments[0] = new (method === 'addIceCandidate' ? window.RTCIceCandidate : window.RTCSessionDescription)(arguments[0]);\r\n\t\t\t\t\treturn nativeMethod.apply(this, arguments);\r\n\t\t\t\t});\r\n\t\t\t\twindow.RTCPeerConnection.prototype[method] = methodObj[method];\r\n\t\t\t});\r\n\t\t}\r\n\t\r\n\t\t// support for addIceCandidate(null or undefined)\r\n\t\t// as well as ignoring {sdpMid, candidate: \"\"}\r\n\t\tif (browserDetails.version < 68) {\r\n\t\t\tvar nativeAddIceCandidate = window.RTCPeerConnection.prototype.addIceCandidate;\r\n\t\t\twindow.RTCPeerConnection.prototype.addIceCandidate = function addIceCandidate() {\r\n\t\t\t\tif (!arguments[0]) {\r\n\t\t\t\t\tif (arguments[1]) {\r\n\t\t\t\t\t\targuments[1].apply(null);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn Promise.resolve();\r\n\t\t\t\t}\r\n\t\t\t\t// Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\r\n\t\t\t\t// in older versions.\r\n\t\t\t\tif (arguments[0] && arguments[0].candidate === '') {\r\n\t\t\t\t\treturn Promise.resolve();\r\n\t\t\t\t}\r\n\t\t\t\treturn nativeAddIceCandidate.apply(this, arguments);\r\n\t\t\t};\r\n\t\t}\r\n\t\r\n\t\tvar modernStatsTypes = {\r\n\t\t\tinboundrtp: 'inbound-rtp',\r\n\t\t\toutboundrtp: 'outbound-rtp',\r\n\t\t\tcandidatepair: 'candidate-pair',\r\n\t\t\tlocalcandidate: 'local-candidate',\r\n\t\t\tremotecandidate: 'remote-candidate'\r\n\t\t};\r\n\t\r\n\t\tvar nativeGetStats = window.RTCPeerConnection.prototype.getStats;\r\n\t\twindow.RTCPeerConnection.prototype.getStats = function getStats() {\r\n\t\t\tvar _arguments = Array.prototype.slice.call(arguments),\r\n\t\t\t\t\tselector = _arguments[0],\r\n\t\t\t\t\tonSucc = _arguments[1],\r\n\t\t\t\t\tonErr = _arguments[2];\r\n\t\r\n\t\t\treturn nativeGetStats.apply(this, [selector || null]).then(function (stats) {\r\n\t\t\t\tif (browserDetails.version < 53 && !onSucc) {\r\n\t\t\t\t\t// Shim only promise getStats with spec-hyphens in type names\r\n\t\t\t\t\t// Leave callback version alone; misc old uses of forEach before Map\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tstats.forEach(function (stat) {\r\n\t\t\t\t\t\t\tstat.type = modernStatsTypes[stat.type] || stat.type;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tif (e.name !== 'TypeError') {\r\n\t\t\t\t\t\t\tthrow e;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\r\n\t\t\t\t\t\tstats.forEach(function (stat, i) {\r\n\t\t\t\t\t\t\tstats.set(i, Object.assign({}, stat, {\r\n\t\t\t\t\t\t\t\ttype: modernStatsTypes[stat.type] || stat.type\r\n\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn stats;\r\n\t\t\t}).then(onSucc, onErr);\r\n\t\t};\r\n\t}\r\n\t\r\n\tfunction shimSenderGetStats(window) {\r\n\t\tif (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar origGetSenders = window.RTCPeerConnection.prototype.getSenders;\r\n\t\tif (origGetSenders) {\r\n\t\t\twindow.RTCPeerConnection.prototype.getSenders = function getSenders() {\r\n\t\t\t\tvar _this = this;\r\n\t\r\n\t\t\t\tvar senders = origGetSenders.apply(this, []);\r\n\t\t\t\tsenders.forEach(function (sender) {\r\n\t\t\t\t\treturn sender._pc = _this;\r\n\t\t\t\t});\r\n\t\t\t\treturn senders;\r\n\t\t\t};\r\n\t\t}\r\n\t\r\n\t\tvar origAddTrack = window.RTCPeerConnection.prototype.addTrack;\r\n\t\tif (origAddTrack) {\r\n\t\t\twindow.RTCPeerConnection.prototype.addTrack = function addTrack() {\r\n\t\t\t\tvar sender = origAddTrack.apply(this, arguments);\r\n\t\t\t\tsender._pc = this;\r\n\t\t\t\treturn sender;\r\n\t\t\t};\r\n\t\t}\r\n\t\twindow.RTCRtpSender.prototype.getStats = function getStats() {\r\n\t\t\treturn this.track ? this._pc.getStats(this.track) : Promise.resolve(new Map());\r\n\t\t};\r\n\t}\r\n\t\r\n\tfunction shimReceiverGetStats(window) {\r\n\t\tif (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\r\n\t\tif (origGetReceivers) {\r\n\t\t\twindow.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\r\n\t\t\t\tvar _this2 = this;\r\n\t\r\n\t\t\t\tvar receivers = origGetReceivers.apply(this, []);\r\n\t\t\t\treceivers.forEach(function (receiver) {\r\n\t\t\t\t\treturn receiver._pc = _this2;\r\n\t\t\t\t});\r\n\t\t\t\treturn receivers;\r\n\t\t\t};\r\n\t\t}\r\n\t\tutils.wrapPeerConnectionEvent(window, 'track', function (e) {\r\n\t\t\te.receiver._pc = e.srcElement;\r\n\t\t\treturn e;\r\n\t\t});\r\n\t\twindow.RTCRtpReceiver.prototype.getStats = function getStats() {\r\n\t\t\treturn this._pc.getStats(this.track);\r\n\t\t};\r\n\t}\r\n\t\r\n\tfunction shimRemoveStream(window) {\r\n\t\tif (!window.RTCPeerConnection || 'removeStream' in window.RTCPeerConnection.prototype) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\twindow.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\r\n\t\t\tvar _this3 = this;\r\n\t\r\n\t\t\tutils.deprecated('removeStream', 'removeTrack');\r\n\t\t\tthis.getSenders().forEach(function (sender) {\r\n\t\t\t\tif (sender.track && stream.getTracks().includes(sender.track)) {\r\n\t\t\t\t\t_this3.removeTrack(sender);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\t}\r\n\t\r\n\tfunction shimRTCDataChannel(window) {\r\n\t\t// rename DataChannel to RTCDataChannel (native fix in FF60):\r\n\t\t// https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\r\n\t\tif (window.DataChannel && !window.RTCDataChannel) {\r\n\t\t\twindow.RTCDataChannel = window.DataChannel;\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction shimAddTransceiver(window) {\r\n\t\t// https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\r\n\t\t// Firefox ignores the init sendEncodings options passed to addTransceiver\r\n\t\t// https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\r\n\t\tif (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar origAddTransceiver = window.RTCPeerConnection.prototype.addTransceiver;\r\n\t\tif (origAddTransceiver) {\r\n\t\t\twindow.RTCPeerConnection.prototype.addTransceiver = function addTransceiver() {\r\n\t\t\t\tthis.setParametersPromises = [];\r\n\t\t\t\tvar initParameters = arguments[1];\r\n\t\t\t\tvar shouldPerformCheck = initParameters && 'sendEncodings' in initParameters;\r\n\t\t\t\tif (shouldPerformCheck) {\r\n\t\t\t\t\t// If sendEncodings params are provided, validate grammar\r\n\t\t\t\t\tinitParameters.sendEncodings.forEach(function (encodingParam) {\r\n\t\t\t\t\t\tif ('rid' in encodingParam) {\r\n\t\t\t\t\t\t\tvar ridRegex = /^[a-z0-9]{0,16}$/i;\r\n\t\t\t\t\t\t\tif (!ridRegex.test(encodingParam.rid)) {\r\n\t\t\t\t\t\t\t\tthrow new TypeError('Invalid RID value provided.');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ('scaleResolutionDownBy' in encodingParam) {\r\n\t\t\t\t\t\t\tif (!(parseFloat(encodingParam.scaleResolutionDownBy) >= 1.0)) {\r\n\t\t\t\t\t\t\t\tthrow new RangeError('scale_resolution_down_by must be >= 1.0');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ('maxFramerate' in encodingParam) {\r\n\t\t\t\t\t\t\tif (!(parseFloat(encodingParam.maxFramerate) >= 0)) {\r\n\t\t\t\t\t\t\t\tthrow new RangeError('max_framerate must be >= 0.0');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tvar transceiver = origAddTransceiver.apply(this, arguments);\r\n\t\t\t\tif (shouldPerformCheck) {\r\n\t\t\t\t\t// Check if the init options were applied. If not we do this in an\r\n\t\t\t\t\t// asynchronous way and save the promise reference in a global object.\r\n\t\t\t\t\t// This is an ugly hack, but at the same time is way more robust than\r\n\t\t\t\t\t// checking the sender parameters before and after the createOffer\r\n\t\t\t\t\t// Also note that after the createoffer we are not 100% sure that\r\n\t\t\t\t\t// the params were asynchronously applied so we might miss the\r\n\t\t\t\t\t// opportunity to recreate offer.\r\n\t\t\t\t\tvar sender = transceiver.sender;\r\n\t\r\n\t\t\t\t\tvar params = sender.getParameters();\r\n\t\t\t\t\tif (!('encodings' in params) ||\r\n\t\t\t\t\t// Avoid being fooled by patched getParameters() below.\r\n\t\t\t\t\tparams.encodings.length === 1 && Object.keys(params.encodings[0]).length === 0) {\r\n\t\t\t\t\t\tparams.encodings = initParameters.sendEncodings;\r\n\t\t\t\t\t\tsender.sendEncodings = initParameters.sendEncodings;\r\n\t\t\t\t\t\tthis.setParametersPromises.push(sender.setParameters(params).then(function () {\r\n\t\t\t\t\t\t\tdelete sender.sendEncodings;\r\n\t\t\t\t\t\t}).catch(function () {\r\n\t\t\t\t\t\t\tdelete sender.sendEncodings;\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn transceiver;\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction shimGetParameters(window) {\r\n\t\tif (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCRtpSender)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar origGetParameters = window.RTCRtpSender.prototype.getParameters;\r\n\t\tif (origGetParameters) {\r\n\t\t\twindow.RTCRtpSender.prototype.getParameters = function getParameters() {\r\n\t\t\t\tvar params = origGetParameters.apply(this, arguments);\r\n\t\t\t\tif (!('encodings' in params)) {\r\n\t\t\t\t\tparams.encodings = [].concat(this.sendEncodings || [{}]);\r\n\t\t\t\t}\r\n\t\t\t\treturn params;\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction shimCreateOffer(window) {\r\n\t\t// https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\r\n\t\t// Firefox ignores the init sendEncodings options passed to addTransceiver\r\n\t\t// https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\r\n\t\tif (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\r\n\t\twindow.RTCPeerConnection.prototype.createOffer = function createOffer() {\r\n\t\t\tvar _this4 = this,\r\n\t\t\t\t\t_arguments2 = arguments;\r\n\t\r\n\t\t\tif (this.setParametersPromises && this.setParametersPromises.length) {\r\n\t\t\t\treturn Promise.all(this.setParametersPromises).then(function () {\r\n\t\t\t\t\treturn origCreateOffer.apply(_this4, _arguments2);\r\n\t\t\t\t}).finally(function () {\r\n\t\t\t\t\t_this4.setParametersPromises = [];\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn origCreateOffer.apply(this, arguments);\r\n\t\t};\r\n\t}\r\n\t\r\n\tfunction shimCreateAnswer(window) {\r\n\t\t// https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\r\n\t\t// Firefox ignores the init sendEncodings options passed to addTransceiver\r\n\t\t// https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\r\n\t\tif (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar origCreateAnswer = window.RTCPeerConnection.prototype.createAnswer;\r\n\t\twindow.RTCPeerConnection.prototype.createAnswer = function createAnswer() {\r\n\t\t\tvar _this5 = this,\r\n\t\t\t\t\t_arguments3 = arguments;\r\n\t\r\n\t\t\tif (this.setParametersPromises && this.setParametersPromises.length) {\r\n\t\t\t\treturn Promise.all(this.setParametersPromises).then(function () {\r\n\t\t\t\t\treturn origCreateAnswer.apply(_this5, _arguments3);\r\n\t\t\t\t}).finally(function () {\r\n\t\t\t\t\t_this5.setParametersPromises = [];\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn origCreateAnswer.apply(this, arguments);\r\n\t\t};\r\n\t}\r\n\t\r\n\t},{\"../utils\":15,\"./getdisplaymedia\":12,\"./getusermedia\":13}],12:[function(require,module,exports){\r\n\t/*\r\n\t *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\r\n\t *\r\n\t *  Use of this source code is governed by a BSD-style license\r\n\t *  that can be found in the LICENSE file in the root of the source\r\n\t *  tree.\r\n\t */\r\n\t/* eslint-env node */\r\n\t'use strict';\r\n\t\r\n\tObject.defineProperty(exports, \"__esModule\", {\r\n\t\tvalue: true\r\n\t});\r\n\texports.shimGetDisplayMedia = shimGetDisplayMedia;\r\n\tfunction shimGetDisplayMedia(window, preferredMediaSource) {\r\n\t\tif (window.navigator.mediaDevices && 'getDisplayMedia' in window.navigator.mediaDevices) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!window.navigator.mediaDevices) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\twindow.navigator.mediaDevices.getDisplayMedia = function getDisplayMedia(constraints) {\r\n\t\t\tif (!(constraints && constraints.video)) {\r\n\t\t\t\tvar err = new DOMException('getDisplayMedia without video ' + 'constraints is undefined');\r\n\t\t\t\terr.name = 'NotFoundError';\r\n\t\t\t\t// from https://heycam.github.io/webidl/#idl-DOMException-error-names\r\n\t\t\t\terr.code = 8;\r\n\t\t\t\treturn Promise.reject(err);\r\n\t\t\t}\r\n\t\t\tif (constraints.video === true) {\r\n\t\t\t\tconstraints.video = { mediaSource: preferredMediaSource };\r\n\t\t\t} else {\r\n\t\t\t\tconstraints.video.mediaSource = preferredMediaSource;\r\n\t\t\t}\r\n\t\t\treturn window.navigator.mediaDevices.getUserMedia(constraints);\r\n\t\t};\r\n\t}\r\n\t\r\n\t},{}],13:[function(require,module,exports){\r\n\t/*\r\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n\t *\r\n\t *  Use of this source code is governed by a BSD-style license\r\n\t *  that can be found in the LICENSE file in the root of the source\r\n\t *  tree.\r\n\t */\r\n\t/* eslint-env node */\r\n\t'use strict';\r\n\t\r\n\tObject.defineProperty(exports, \"__esModule\", {\r\n\t\tvalue: true\r\n\t});\r\n\t\r\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\r\n\t\r\n\texports.shimGetUserMedia = shimGetUserMedia;\r\n\t\r\n\tvar _utils = require('../utils');\r\n\t\r\n\tvar utils = _interopRequireWildcard(_utils);\r\n\t\r\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\r\n\t\r\n\tfunction shimGetUserMedia(window) {\r\n\t\tvar browserDetails = utils.detectBrowser(window);\r\n\t\tvar navigator = window && window.navigator;\r\n\t\tvar MediaStreamTrack = window && window.MediaStreamTrack;\r\n\t\r\n\t\tnavigator.getUserMedia = function (constraints, onSuccess, onError) {\r\n\t\t\t// Replace Firefox 44+'s deprecation warning with unprefixed version.\r\n\t\t\tutils.deprecated('navigator.getUserMedia', 'navigator.mediaDevices.getUserMedia');\r\n\t\t\tnavigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\r\n\t\t};\r\n\t\r\n\t\tif (!(browserDetails.version > 55 && 'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\r\n\t\t\tvar remap = function remap(obj, a, b) {\r\n\t\t\t\tif (a in obj && !(b in obj)) {\r\n\t\t\t\t\tobj[b] = obj[a];\r\n\t\t\t\t\tdelete obj[a];\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\r\n\t\t\tvar nativeGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\r\n\t\t\tnavigator.mediaDevices.getUserMedia = function (c) {\r\n\t\t\t\tif ((typeof c === 'undefined' ? 'undefined' : _typeof(c)) === 'object' && _typeof(c.audio) === 'object') {\r\n\t\t\t\t\tc = JSON.parse(JSON.stringify(c));\r\n\t\t\t\t\tremap(c.audio, 'autoGainControl', 'mozAutoGainControl');\r\n\t\t\t\t\tremap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\r\n\t\t\t\t}\r\n\t\t\t\treturn nativeGetUserMedia(c);\r\n\t\t\t};\r\n\t\r\n\t\t\tif (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\r\n\t\t\t\tvar nativeGetSettings = MediaStreamTrack.prototype.getSettings;\r\n\t\t\t\tMediaStreamTrack.prototype.getSettings = function () {\r\n\t\t\t\t\tvar obj = nativeGetSettings.apply(this, arguments);\r\n\t\t\t\t\tremap(obj, 'mozAutoGainControl', 'autoGainControl');\r\n\t\t\t\t\tremap(obj, 'mozNoiseSuppression', 'noiseSuppression');\r\n\t\t\t\t\treturn obj;\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\r\n\t\t\tif (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\r\n\t\t\t\tvar nativeApplyConstraints = MediaStreamTrack.prototype.applyConstraints;\r\n\t\t\t\tMediaStreamTrack.prototype.applyConstraints = function (c) {\r\n\t\t\t\t\tif (this.kind === 'audio' && (typeof c === 'undefined' ? 'undefined' : _typeof(c)) === 'object') {\r\n\t\t\t\t\t\tc = JSON.parse(JSON.stringify(c));\r\n\t\t\t\t\t\tremap(c, 'autoGainControl', 'mozAutoGainControl');\r\n\t\t\t\t\t\tremap(c, 'noiseSuppression', 'mozNoiseSuppression');\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn nativeApplyConstraints.apply(this, [c]);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t},{\"../utils\":15}],14:[function(require,module,exports){\r\n\t/*\r\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n\t *\r\n\t *  Use of this source code is governed by a BSD-style license\r\n\t *  that can be found in the LICENSE file in the root of the source\r\n\t *  tree.\r\n\t */\r\n\t'use strict';\r\n\t\r\n\tObject.defineProperty(exports, \"__esModule\", {\r\n\t\tvalue: true\r\n\t});\r\n\t\r\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\r\n\t\r\n\texports.shimLocalStreamsAPI = shimLocalStreamsAPI;\r\n\texports.shimRemoteStreamsAPI = shimRemoteStreamsAPI;\r\n\texports.shimCallbacksAPI = shimCallbacksAPI;\r\n\texports.shimGetUserMedia = shimGetUserMedia;\r\n\texports.shimConstraints = shimConstraints;\r\n\texports.shimRTCIceServerUrls = shimRTCIceServerUrls;\r\n\texports.shimTrackEventTransceiver = shimTrackEventTransceiver;\r\n\texports.shimCreateOfferLegacy = shimCreateOfferLegacy;\r\n\texports.shimAudioContext = shimAudioContext;\r\n\t\r\n\tvar _utils = require('../utils');\r\n\t\r\n\tvar utils = _interopRequireWildcard(_utils);\r\n\t\r\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\r\n\t\r\n\tfunction shimLocalStreamsAPI(window) {\r\n\t\tif ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !window.RTCPeerConnection) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\r\n\t\t\twindow.RTCPeerConnection.prototype.getLocalStreams = function getLocalStreams() {\r\n\t\t\t\tif (!this._localStreams) {\r\n\t\t\t\t\tthis._localStreams = [];\r\n\t\t\t\t}\r\n\t\t\t\treturn this._localStreams;\r\n\t\t\t};\r\n\t\t}\r\n\t\tif (!('addStream' in window.RTCPeerConnection.prototype)) {\r\n\t\t\tvar _addTrack = window.RTCPeerConnection.prototype.addTrack;\r\n\t\t\twindow.RTCPeerConnection.prototype.addStream = function addStream(stream) {\r\n\t\t\t\tvar _this = this;\r\n\t\r\n\t\t\t\tif (!this._localStreams) {\r\n\t\t\t\t\tthis._localStreams = [];\r\n\t\t\t\t}\r\n\t\t\t\tif (!this._localStreams.includes(stream)) {\r\n\t\t\t\t\tthis._localStreams.push(stream);\r\n\t\t\t\t}\r\n\t\t\t\t// Try to emulate Chrome's behaviour of adding in audio-video order.\r\n\t\t\t\t// Safari orders by track id.\r\n\t\t\t\tstream.getAudioTracks().forEach(function (track) {\r\n\t\t\t\t\treturn _addTrack.call(_this, track, stream);\r\n\t\t\t\t});\r\n\t\t\t\tstream.getVideoTracks().forEach(function (track) {\r\n\t\t\t\t\treturn _addTrack.call(_this, track, stream);\r\n\t\t\t\t});\r\n\t\t\t};\r\n\t\r\n\t\t\twindow.RTCPeerConnection.prototype.addTrack = function addTrack(track) {\r\n\t\t\t\tvar _this2 = this;\r\n\t\r\n\t\t\t\tfor (var _len = arguments.length, streams = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\r\n\t\t\t\t\tstreams[_key - 1] = arguments[_key];\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif (streams) {\r\n\t\t\t\t\tstreams.forEach(function (stream) {\r\n\t\t\t\t\t\tif (!_this2._localStreams) {\r\n\t\t\t\t\t\t\t_this2._localStreams = [stream];\r\n\t\t\t\t\t\t} else if (!_this2._localStreams.includes(stream)) {\r\n\t\t\t\t\t\t\t_this2._localStreams.push(stream);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\treturn _addTrack.apply(this, arguments);\r\n\t\t\t};\r\n\t\t}\r\n\t\tif (!('removeStream' in window.RTCPeerConnection.prototype)) {\r\n\t\t\twindow.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\r\n\t\t\t\tvar _this3 = this;\r\n\t\r\n\t\t\t\tif (!this._localStreams) {\r\n\t\t\t\t\tthis._localStreams = [];\r\n\t\t\t\t}\r\n\t\t\t\tvar index = this._localStreams.indexOf(stream);\r\n\t\t\t\tif (index === -1) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis._localStreams.splice(index, 1);\r\n\t\t\t\tvar tracks = stream.getTracks();\r\n\t\t\t\tthis.getSenders().forEach(function (sender) {\r\n\t\t\t\t\tif (tracks.includes(sender.track)) {\r\n\t\t\t\t\t\t_this3.removeTrack(sender);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction shimRemoteStreamsAPI(window) {\r\n\t\tif ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !window.RTCPeerConnection) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\r\n\t\t\twindow.RTCPeerConnection.prototype.getRemoteStreams = function getRemoteStreams() {\r\n\t\t\t\treturn this._remoteStreams ? this._remoteStreams : [];\r\n\t\t\t};\r\n\t\t}\r\n\t\tif (!('onaddstream' in window.RTCPeerConnection.prototype)) {\r\n\t\t\tObject.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\r\n\t\t\t\tget: function get() {\r\n\t\t\t\t\treturn this._onaddstream;\r\n\t\t\t\t},\r\n\t\t\t\tset: function set(f) {\r\n\t\t\t\t\tvar _this4 = this;\r\n\t\r\n\t\t\t\t\tif (this._onaddstream) {\r\n\t\t\t\t\t\tthis.removeEventListener('addstream', this._onaddstream);\r\n\t\t\t\t\t\tthis.removeEventListener('track', this._onaddstreampoly);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.addEventListener('addstream', this._onaddstream = f);\r\n\t\t\t\t\tthis.addEventListener('track', this._onaddstreampoly = function (e) {\r\n\t\t\t\t\t\te.streams.forEach(function (stream) {\r\n\t\t\t\t\t\t\tif (!_this4._remoteStreams) {\r\n\t\t\t\t\t\t\t\t_this4._remoteStreams = [];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (_this4._remoteStreams.includes(stream)) {\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t_this4._remoteStreams.push(stream);\r\n\t\t\t\t\t\t\tvar event = new Event('addstream');\r\n\t\t\t\t\t\t\tevent.stream = stream;\r\n\t\t\t\t\t\t\t_this4.dispatchEvent(event);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tvar origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\r\n\t\t\twindow.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription() {\r\n\t\t\t\tvar pc = this;\r\n\t\t\t\tif (!this._onaddstreampoly) {\r\n\t\t\t\t\tthis.addEventListener('track', this._onaddstreampoly = function (e) {\r\n\t\t\t\t\t\te.streams.forEach(function (stream) {\r\n\t\t\t\t\t\t\tif (!pc._remoteStreams) {\r\n\t\t\t\t\t\t\t\tpc._remoteStreams = [];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (pc._remoteStreams.indexOf(stream) >= 0) {\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tpc._remoteStreams.push(stream);\r\n\t\t\t\t\t\t\tvar event = new Event('addstream');\r\n\t\t\t\t\t\t\tevent.stream = stream;\r\n\t\t\t\t\t\t\tpc.dispatchEvent(event);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\treturn origSetRemoteDescription.apply(pc, arguments);\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction shimCallbacksAPI(window) {\r\n\t\tif ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !window.RTCPeerConnection) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar prototype = window.RTCPeerConnection.prototype;\r\n\t\tvar origCreateOffer = prototype.createOffer;\r\n\t\tvar origCreateAnswer = prototype.createAnswer;\r\n\t\tvar setLocalDescription = prototype.setLocalDescription;\r\n\t\tvar setRemoteDescription = prototype.setRemoteDescription;\r\n\t\tvar addIceCandidate = prototype.addIceCandidate;\r\n\t\r\n\t\tprototype.createOffer = function createOffer(successCallback, failureCallback) {\r\n\t\t\tvar options = arguments.length >= 2 ? arguments[2] : arguments[0];\r\n\t\t\tvar promise = origCreateOffer.apply(this, [options]);\r\n\t\t\tif (!failureCallback) {\r\n\t\t\t\treturn promise;\r\n\t\t\t}\r\n\t\t\tpromise.then(successCallback, failureCallback);\r\n\t\t\treturn Promise.resolve();\r\n\t\t};\r\n\t\r\n\t\tprototype.createAnswer = function createAnswer(successCallback, failureCallback) {\r\n\t\t\tvar options = arguments.length >= 2 ? arguments[2] : arguments[0];\r\n\t\t\tvar promise = origCreateAnswer.apply(this, [options]);\r\n\t\t\tif (!failureCallback) {\r\n\t\t\t\treturn promise;\r\n\t\t\t}\r\n\t\t\tpromise.then(successCallback, failureCallback);\r\n\t\t\treturn Promise.resolve();\r\n\t\t};\r\n\t\r\n\t\tvar withCallback = function withCallback(description, successCallback, failureCallback) {\r\n\t\t\tvar promise = setLocalDescription.apply(this, [description]);\r\n\t\t\tif (!failureCallback) {\r\n\t\t\t\treturn promise;\r\n\t\t\t}\r\n\t\t\tpromise.then(successCallback, failureCallback);\r\n\t\t\treturn Promise.resolve();\r\n\t\t};\r\n\t\tprototype.setLocalDescription = withCallback;\r\n\t\r\n\t\twithCallback = function withCallback(description, successCallback, failureCallback) {\r\n\t\t\tvar promise = setRemoteDescription.apply(this, [description]);\r\n\t\t\tif (!failureCallback) {\r\n\t\t\t\treturn promise;\r\n\t\t\t}\r\n\t\t\tpromise.then(successCallback, failureCallback);\r\n\t\t\treturn Promise.resolve();\r\n\t\t};\r\n\t\tprototype.setRemoteDescription = withCallback;\r\n\t\r\n\t\twithCallback = function withCallback(candidate, successCallback, failureCallback) {\r\n\t\t\tvar promise = addIceCandidate.apply(this, [candidate]);\r\n\t\t\tif (!failureCallback) {\r\n\t\t\t\treturn promise;\r\n\t\t\t}\r\n\t\t\tpromise.then(successCallback, failureCallback);\r\n\t\t\treturn Promise.resolve();\r\n\t\t};\r\n\t\tprototype.addIceCandidate = withCallback;\r\n\t}\r\n\t\r\n\tfunction shimGetUserMedia(window) {\r\n\t\tvar navigator = window && window.navigator;\r\n\t\r\n\t\tif (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\r\n\t\t\t// shim not needed in Safari 12.1\r\n\t\t\tvar mediaDevices = navigator.mediaDevices;\r\n\t\t\tvar _getUserMedia = mediaDevices.getUserMedia.bind(mediaDevices);\r\n\t\t\tnavigator.mediaDevices.getUserMedia = function (constraints) {\r\n\t\t\t\treturn _getUserMedia(shimConstraints(constraints));\r\n\t\t\t};\r\n\t\t}\r\n\t\r\n\t\tif (!navigator.getUserMedia && navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\r\n\t\t\tnavigator.getUserMedia = function getUserMedia(constraints, cb, errcb) {\r\n\t\t\t\tnavigator.mediaDevices.getUserMedia(constraints).then(cb, errcb);\r\n\t\t\t}.bind(navigator);\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction shimConstraints(constraints) {\r\n\t\tif (constraints && constraints.video !== undefined) {\r\n\t\t\treturn Object.assign({}, constraints, { video: utils.compactObject(constraints.video) });\r\n\t\t}\r\n\t\r\n\t\treturn constraints;\r\n\t}\r\n\t\r\n\tfunction shimRTCIceServerUrls(window) {\r\n\t\tif (!window.RTCPeerConnection) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// migrate from non-spec RTCIceServer.url to RTCIceServer.urls\r\n\t\tvar OrigPeerConnection = window.RTCPeerConnection;\r\n\t\twindow.RTCPeerConnection = function RTCPeerConnection(pcConfig, pcConstraints) {\r\n\t\t\tif (pcConfig && pcConfig.iceServers) {\r\n\t\t\t\tvar newIceServers = [];\r\n\t\t\t\tfor (var i = 0; i < pcConfig.iceServers.length; i++) {\r\n\t\t\t\t\tvar server = pcConfig.iceServers[i];\r\n\t\t\t\t\tif (!server.hasOwnProperty('urls') && server.hasOwnProperty('url')) {\r\n\t\t\t\t\t\tutils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\r\n\t\t\t\t\t\tserver = JSON.parse(JSON.stringify(server));\r\n\t\t\t\t\t\tserver.urls = server.url;\r\n\t\t\t\t\t\tdelete server.url;\r\n\t\t\t\t\t\tnewIceServers.push(server);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnewIceServers.push(pcConfig.iceServers[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tpcConfig.iceServers = newIceServers;\r\n\t\t\t}\r\n\t\t\treturn new OrigPeerConnection(pcConfig, pcConstraints);\r\n\t\t};\r\n\t\twindow.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\r\n\t\t// wrap static methods. Currently just generateCertificate.\r\n\t\tif ('generateCertificate' in OrigPeerConnection) {\r\n\t\t\tObject.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\r\n\t\t\t\tget: function get() {\r\n\t\t\t\t\treturn OrigPeerConnection.generateCertificate;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction shimTrackEventTransceiver(window) {\r\n\t\t// Add event.transceiver member over deprecated event.receiver\r\n\t\tif ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCTrackEvent && 'receiver' in window.RTCTrackEvent.prototype && !('transceiver' in window.RTCTrackEvent.prototype)) {\r\n\t\t\tObject.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\r\n\t\t\t\tget: function get() {\r\n\t\t\t\t\treturn { receiver: this.receiver };\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction shimCreateOfferLegacy(window) {\r\n\t\tvar origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\r\n\t\twindow.RTCPeerConnection.prototype.createOffer = function createOffer(offerOptions) {\r\n\t\t\tif (offerOptions) {\r\n\t\t\t\tif (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\r\n\t\t\t\t\t// support bit values\r\n\t\t\t\t\tofferOptions.offerToReceiveAudio = !!offerOptions.offerToReceiveAudio;\r\n\t\t\t\t}\r\n\t\t\t\tvar audioTransceiver = this.getTransceivers().find(function (transceiver) {\r\n\t\t\t\t\treturn transceiver.receiver.track.kind === 'audio';\r\n\t\t\t\t});\r\n\t\t\t\tif (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\r\n\t\t\t\t\tif (audioTransceiver.direction === 'sendrecv') {\r\n\t\t\t\t\t\tif (audioTransceiver.setDirection) {\r\n\t\t\t\t\t\t\taudioTransceiver.setDirection('sendonly');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\taudioTransceiver.direction = 'sendonly';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (audioTransceiver.direction === 'recvonly') {\r\n\t\t\t\t\t\tif (audioTransceiver.setDirection) {\r\n\t\t\t\t\t\t\taudioTransceiver.setDirection('inactive');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\taudioTransceiver.direction = 'inactive';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (offerOptions.offerToReceiveAudio === true && !audioTransceiver) {\r\n\t\t\t\t\tthis.addTransceiver('audio');\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\r\n\t\t\t\t\t// support bit values\r\n\t\t\t\t\tofferOptions.offerToReceiveVideo = !!offerOptions.offerToReceiveVideo;\r\n\t\t\t\t}\r\n\t\t\t\tvar videoTransceiver = this.getTransceivers().find(function (transceiver) {\r\n\t\t\t\t\treturn transceiver.receiver.track.kind === 'video';\r\n\t\t\t\t});\r\n\t\t\t\tif (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\r\n\t\t\t\t\tif (videoTransceiver.direction === 'sendrecv') {\r\n\t\t\t\t\t\tif (videoTransceiver.setDirection) {\r\n\t\t\t\t\t\t\tvideoTransceiver.setDirection('sendonly');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvideoTransceiver.direction = 'sendonly';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (videoTransceiver.direction === 'recvonly') {\r\n\t\t\t\t\t\tif (videoTransceiver.setDirection) {\r\n\t\t\t\t\t\t\tvideoTransceiver.setDirection('inactive');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvideoTransceiver.direction = 'inactive';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (offerOptions.offerToReceiveVideo === true && !videoTransceiver) {\r\n\t\t\t\t\tthis.addTransceiver('video');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn origCreateOffer.apply(this, arguments);\r\n\t\t};\r\n\t}\r\n\t\r\n\tfunction shimAudioContext(window) {\r\n\t\tif ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || window.AudioContext) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\twindow.AudioContext = window.webkitAudioContext;\r\n\t}\r\n\t\r\n\t},{\"../utils\":15}],15:[function(require,module,exports){\r\n\t/*\r\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\r\n\t *\r\n\t *  Use of this source code is governed by a BSD-style license\r\n\t *  that can be found in the LICENSE file in the root of the source\r\n\t *  tree.\r\n\t */\r\n\t/* eslint-env node */\r\n\t'use strict';\r\n\t\r\n\tObject.defineProperty(exports, \"__esModule\", {\r\n\t\tvalue: true\r\n\t});\r\n\t\r\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\r\n\t\r\n\texports.extractVersion = extractVersion;\r\n\texports.wrapPeerConnectionEvent = wrapPeerConnectionEvent;\r\n\texports.disableLog = disableLog;\r\n\texports.disableWarnings = disableWarnings;\r\n\texports.log = log;\r\n\texports.deprecated = deprecated;\r\n\texports.detectBrowser = detectBrowser;\r\n\texports.compactObject = compactObject;\r\n\texports.walkStats = walkStats;\r\n\texports.filterStats = filterStats;\r\n\t\r\n\tfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\t\r\n\tvar logDisabled_ = true;\r\n\tvar deprecationWarnings_ = true;\r\n\t\r\n\t/**\r\n\t * Extract browser version out of the provided user agent string.\r\n\t *\r\n\t * @param {!string} uastring userAgent string.\r\n\t * @param {!string} expr Regular expression used as match criteria.\r\n\t * @param {!number} pos position in the version string to be returned.\r\n\t * @return {!number} browser version.\r\n\t */\r\n\tfunction extractVersion(uastring, expr, pos) {\r\n\t\tvar match = uastring.match(expr);\r\n\t\treturn match && match.length >= pos && parseInt(match[pos], 10);\r\n\t}\r\n\t\r\n\t// Wraps the peerconnection event eventNameToWrap in a function\r\n\t// which returns the modified event object (or false to prevent\r\n\t// the event).\r\n\tfunction wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\r\n\t\tif (!window.RTCPeerConnection) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar proto = window.RTCPeerConnection.prototype;\r\n\t\tvar nativeAddEventListener = proto.addEventListener;\r\n\t\tproto.addEventListener = function (nativeEventName, cb) {\r\n\t\t\tif (nativeEventName !== eventNameToWrap) {\r\n\t\t\t\treturn nativeAddEventListener.apply(this, arguments);\r\n\t\t\t}\r\n\t\t\tvar wrappedCallback = function wrappedCallback(e) {\r\n\t\t\t\tvar modifiedEvent = wrapper(e);\r\n\t\t\t\tif (modifiedEvent) {\r\n\t\t\t\t\tif (cb.handleEvent) {\r\n\t\t\t\t\t\tcb.handleEvent(modifiedEvent);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcb(modifiedEvent);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tthis._eventMap = this._eventMap || {};\r\n\t\t\tif (!this._eventMap[eventNameToWrap]) {\r\n\t\t\t\tthis._eventMap[eventNameToWrap] = new Map();\r\n\t\t\t}\r\n\t\t\tthis._eventMap[eventNameToWrap].set(cb, wrappedCallback);\r\n\t\t\treturn nativeAddEventListener.apply(this, [nativeEventName, wrappedCallback]);\r\n\t\t};\r\n\t\r\n\t\tvar nativeRemoveEventListener = proto.removeEventListener;\r\n\t\tproto.removeEventListener = function (nativeEventName, cb) {\r\n\t\t\tif (nativeEventName !== eventNameToWrap || !this._eventMap || !this._eventMap[eventNameToWrap]) {\r\n\t\t\t\treturn nativeRemoveEventListener.apply(this, arguments);\r\n\t\t\t}\r\n\t\t\tif (!this._eventMap[eventNameToWrap].has(cb)) {\r\n\t\t\t\treturn nativeRemoveEventListener.apply(this, arguments);\r\n\t\t\t}\r\n\t\t\tvar unwrappedCb = this._eventMap[eventNameToWrap].get(cb);\r\n\t\t\tthis._eventMap[eventNameToWrap].delete(cb);\r\n\t\t\tif (this._eventMap[eventNameToWrap].size === 0) {\r\n\t\t\t\tdelete this._eventMap[eventNameToWrap];\r\n\t\t\t}\r\n\t\t\tif (Object.keys(this._eventMap).length === 0) {\r\n\t\t\t\tdelete this._eventMap;\r\n\t\t\t}\r\n\t\t\treturn nativeRemoveEventListener.apply(this, [nativeEventName, unwrappedCb]);\r\n\t\t};\r\n\t\r\n\t\tObject.defineProperty(proto, 'on' + eventNameToWrap, {\r\n\t\t\tget: function get() {\r\n\t\t\t\treturn this['_on' + eventNameToWrap];\r\n\t\t\t},\r\n\t\t\tset: function set(cb) {\r\n\t\t\t\tif (this['_on' + eventNameToWrap]) {\r\n\t\t\t\t\tthis.removeEventListener(eventNameToWrap, this['_on' + eventNameToWrap]);\r\n\t\t\t\t\tdelete this['_on' + eventNameToWrap];\r\n\t\t\t\t}\r\n\t\t\t\tif (cb) {\r\n\t\t\t\t\tthis.addEventListener(eventNameToWrap, this['_on' + eventNameToWrap] = cb);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\r\n\t\t\tenumerable: true,\r\n\t\t\tconfigurable: true\r\n\t\t});\r\n\t}\r\n\t\r\n\tfunction disableLog(bool) {\r\n\t\tif (typeof bool !== 'boolean') {\r\n\t\t\treturn new Error('Argument type: ' + (typeof bool === 'undefined' ? 'undefined' : _typeof(bool)) + '. Please use a boolean.');\r\n\t\t}\r\n\t\tlogDisabled_ = bool;\r\n\t\treturn bool ? 'adapter.js logging disabled' : 'adapter.js logging enabled';\r\n\t}\r\n\t\r\n\t/**\r\n\t * Disable or enable deprecation warnings\r\n\t * @param {!boolean} bool set to true to disable warnings.\r\n\t */\r\n\tfunction disableWarnings(bool) {\r\n\t\tif (typeof bool !== 'boolean') {\r\n\t\t\treturn new Error('Argument type: ' + (typeof bool === 'undefined' ? 'undefined' : _typeof(bool)) + '. Please use a boolean.');\r\n\t\t}\r\n\t\tdeprecationWarnings_ = !bool;\r\n\t\treturn 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\r\n\t}\r\n\t\r\n\tfunction log() {\r\n\t\tif ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object') {\r\n\t\t\tif (logDisabled_) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (typeof console !== 'undefined' && typeof console.log === 'function') {\r\n\t\t\t\tconsole.log.apply(console, arguments);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Shows a deprecation warning suggesting the modern and spec-compatible API.\r\n\t */\r\n\tfunction deprecated(oldMethod, newMethod) {\r\n\t\tif (!deprecationWarnings_) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconsole.warn(oldMethod + ' is deprecated, please use ' + newMethod + ' instead.');\r\n\t}\r\n\t\r\n\t/**\r\n\t * Browser detector.\r\n\t *\r\n\t * @return {object} result containing browser and version\r\n\t *     properties.\r\n\t */\r\n\tfunction detectBrowser(window) {\r\n\t\t// Returned result object.\r\n\t\tvar result = { browser: null, version: null };\r\n\t\r\n\t\t// Fail early if it's not a browser\r\n\t\tif (typeof window === 'undefined' || !window.navigator) {\r\n\t\t\tresult.browser = 'Not a browser.';\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\r\n\t\tvar navigator = window.navigator;\r\n\t\r\n\t\r\n\t\tif (navigator.mozGetUserMedia) {\r\n\t\t\t// Firefox.\r\n\t\t\tresult.browser = 'firefox';\r\n\t\t\tresult.version = extractVersion(navigator.userAgent, /Firefox\\/(\\d+)\\./, 1);\r\n\t\t} else if (navigator.webkitGetUserMedia || window.isSecureContext === false && window.webkitRTCPeerConnection && !window.RTCIceGatherer) {\r\n\t\t\t// Chrome, Chromium, Webview, Opera.\r\n\t\t\t// Version matches Chrome/WebRTC version.\r\n\t\t\t// Chrome 74 removed webkitGetUserMedia on http as well so we need the\r\n\t\t\t// more complicated fallback to webkitRTCPeerConnection.\r\n\t\t\tresult.browser = 'chrome';\r\n\t\t\tresult.version = extractVersion(navigator.userAgent, /Chrom(e|ium)\\/(\\d+)\\./, 2);\r\n\t\t} else if (navigator.mediaDevices && navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) {\r\n\t\t\t// Edge.\r\n\t\t\tresult.browser = 'edge';\r\n\t\t\tresult.version = extractVersion(navigator.userAgent, /Edge\\/(\\d+).(\\d+)$/, 2);\r\n\t\t} else if (window.RTCPeerConnection && navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) {\r\n\t\t\t// Safari.\r\n\t\t\tresult.browser = 'safari';\r\n\t\t\tresult.version = extractVersion(navigator.userAgent, /AppleWebKit\\/(\\d+)\\./, 1);\r\n\t\t\tresult.supportsUnifiedPlan = window.RTCRtpTransceiver && 'currentDirection' in window.RTCRtpTransceiver.prototype;\r\n\t\t} else {\r\n\t\t\t// Default fallthrough: not supported.\r\n\t\t\tresult.browser = 'Not a supported browser.';\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\r\n\t\treturn result;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Checks if something is an object.\r\n\t *\r\n\t * @param {*} val The something you want to check.\r\n\t * @return true if val is an object, false otherwise.\r\n\t */\r\n\tfunction isObject(val) {\r\n\t\treturn Object.prototype.toString.call(val) === '[object Object]';\r\n\t}\r\n\t\r\n\t/**\r\n\t * Remove all empty objects and undefined values\r\n\t * from a nested object -- an enhanced and vanilla version\r\n\t * of Lodash's `compact`.\r\n\t */\r\n\tfunction compactObject(data) {\r\n\t\tif (!isObject(data)) {\r\n\t\t\treturn data;\r\n\t\t}\r\n\t\r\n\t\treturn Object.keys(data).reduce(function (accumulator, key) {\r\n\t\t\tvar isObj = isObject(data[key]);\r\n\t\t\tvar value = isObj ? compactObject(data[key]) : data[key];\r\n\t\t\tvar isEmptyObject = isObj && !Object.keys(value).length;\r\n\t\t\tif (value === undefined || isEmptyObject) {\r\n\t\t\t\treturn accumulator;\r\n\t\t\t}\r\n\t\t\treturn Object.assign(accumulator, _defineProperty({}, key, value));\r\n\t\t}, {});\r\n\t}\r\n\t\r\n\t/* iterates the stats graph recursively. */\r\n\tfunction walkStats(stats, base, resultSet) {\r\n\t\tif (!base || resultSet.has(base.id)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tresultSet.set(base.id, base);\r\n\t\tObject.keys(base).forEach(function (name) {\r\n\t\t\tif (name.endsWith('Id')) {\r\n\t\t\t\twalkStats(stats, stats.get(base[name]), resultSet);\r\n\t\t\t} else if (name.endsWith('Ids')) {\r\n\t\t\t\tbase[name].forEach(function (id) {\r\n\t\t\t\t\twalkStats(stats, stats.get(id), resultSet);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/* filter getStats for a sender/receiver track. */\r\n\tfunction filterStats(result, track, outbound) {\r\n\t\tvar streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\r\n\t\tvar filteredResult = new Map();\r\n\t\tif (track === null) {\r\n\t\t\treturn filteredResult;\r\n\t\t}\r\n\t\tvar trackStats = [];\r\n\t\tresult.forEach(function (value) {\r\n\t\t\tif (value.type === 'track' && value.trackIdentifier === track.id) {\r\n\t\t\t\ttrackStats.push(value);\r\n\t\t\t}\r\n\t\t});\r\n\t\ttrackStats.forEach(function (trackStat) {\r\n\t\t\tresult.forEach(function (stats) {\r\n\t\t\t\tif (stats.type === streamStatsType && stats.trackId === trackStat.id) {\r\n\t\t\t\t\twalkStats(result, stats, filteredResult);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\treturn filteredResult;\r\n\t}\r\n\t\r\n\t},{}],16:[function(require,module,exports){\r\n\t/*\r\n\t *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\r\n\t *\r\n\t *  Use of this source code is governed by a BSD-style license\r\n\t *  that can be found in the LICENSE file in the root of the source\r\n\t *  tree.\r\n\t */\r\n\t /* eslint-env node */\r\n\t'use strict';\r\n\t\r\n\tvar SDPUtils = require('sdp');\r\n\t\r\n\tfunction fixStatsType(stat) {\r\n\t\treturn {\r\n\t\t\tinboundrtp: 'inbound-rtp',\r\n\t\t\toutboundrtp: 'outbound-rtp',\r\n\t\t\tcandidatepair: 'candidate-pair',\r\n\t\t\tlocalcandidate: 'local-candidate',\r\n\t\t\tremotecandidate: 'remote-candidate'\r\n\t\t}[stat.type] || stat.type;\r\n\t}\r\n\t\r\n\tfunction writeMediaSection(transceiver, caps, type, stream, dtlsRole) {\r\n\t\tvar sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\r\n\t\r\n\t\t// Map ICE parameters (ufrag, pwd) to SDP.\r\n\t\tsdp += SDPUtils.writeIceParameters(\r\n\t\t\t\ttransceiver.iceGatherer.getLocalParameters());\r\n\t\r\n\t\t// Map DTLS parameters to SDP.\r\n\t\tsdp += SDPUtils.writeDtlsParameters(\r\n\t\t\t\ttransceiver.dtlsTransport.getLocalParameters(),\r\n\t\t\t\ttype === 'offer' ? 'actpass' : dtlsRole || 'active');\r\n\t\r\n\t\tsdp += 'a=mid:' + transceiver.mid + '\\r\\n';\r\n\t\r\n\t\tif (transceiver.rtpSender && transceiver.rtpReceiver) {\r\n\t\t\tsdp += 'a=sendrecv\\r\\n';\r\n\t\t} else if (transceiver.rtpSender) {\r\n\t\t\tsdp += 'a=sendonly\\r\\n';\r\n\t\t} else if (transceiver.rtpReceiver) {\r\n\t\t\tsdp += 'a=recvonly\\r\\n';\r\n\t\t} else {\r\n\t\t\tsdp += 'a=inactive\\r\\n';\r\n\t\t}\r\n\t\r\n\t\tif (transceiver.rtpSender) {\r\n\t\t\tvar trackId = transceiver.rtpSender._initialTrackId ||\r\n\t\t\t\t\ttransceiver.rtpSender.track.id;\r\n\t\t\ttransceiver.rtpSender._initialTrackId = trackId;\r\n\t\t\t// spec.\r\n\t\t\tvar msid = 'msid:' + (stream ? stream.id : '-') + ' ' +\r\n\t\t\t\t\ttrackId + '\\r\\n';\r\n\t\t\tsdp += 'a=' + msid;\r\n\t\t\t// for Chrome. Legacy should no longer be required.\r\n\t\t\tsdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\r\n\t\t\t\t\t' ' + msid;\r\n\t\r\n\t\t\t// RTX\r\n\t\t\tif (transceiver.sendEncodingParameters[0].rtx) {\r\n\t\t\t\tsdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\r\n\t\t\t\t\t\t' ' + msid;\r\n\t\t\t\tsdp += 'a=ssrc-group:FID ' +\r\n\t\t\t\t\t\ttransceiver.sendEncodingParameters[0].ssrc + ' ' +\r\n\t\t\t\t\t\ttransceiver.sendEncodingParameters[0].rtx.ssrc +\r\n\t\t\t\t\t\t'\\r\\n';\r\n\t\t\t}\r\n\t\t}\r\n\t\t// FIXME: this should be written by writeRtpDescription.\r\n\t\tsdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\r\n\t\t\t\t' cname:' + SDPUtils.localCName + '\\r\\n';\r\n\t\tif (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\r\n\t\t\tsdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\r\n\t\t\t\t\t' cname:' + SDPUtils.localCName + '\\r\\n';\r\n\t\t}\r\n\t\treturn sdp;\r\n\t}\r\n\t\r\n\t// Edge does not like\r\n\t// 1) stun: filtered after 14393 unless ?transport=udp is present\r\n\t// 2) turn: that does not have all of turn:host:port?transport=udp\r\n\t// 3) turn: with ipv6 addresses\r\n\t// 4) turn: occurring muliple times\r\n\tfunction filterIceServers(iceServers, edgeVersion) {\r\n\t\tvar hasTurn = false;\r\n\t\ticeServers = JSON.parse(JSON.stringify(iceServers));\r\n\t\treturn iceServers.filter(function(server) {\r\n\t\t\tif (server && (server.urls || server.url)) {\r\n\t\t\t\tvar urls = server.urls || server.url;\r\n\t\t\t\tif (server.url && !server.urls) {\r\n\t\t\t\t\tconsole.warn('RTCIceServer.url is deprecated! Use urls instead.');\r\n\t\t\t\t}\r\n\t\t\t\tvar isString = typeof urls === 'string';\r\n\t\t\t\tif (isString) {\r\n\t\t\t\t\turls = [urls];\r\n\t\t\t\t}\r\n\t\t\t\turls = urls.filter(function(url) {\r\n\t\t\t\t\tvar validTurn = url.indexOf('turn:') === 0 &&\r\n\t\t\t\t\t\t\turl.indexOf('transport=udp') !== -1 &&\r\n\t\t\t\t\t\t\turl.indexOf('turn:[') === -1 &&\r\n\t\t\t\t\t\t\t!hasTurn;\r\n\t\r\n\t\t\t\t\tif (validTurn) {\r\n\t\t\t\t\t\thasTurn = true;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn url.indexOf('stun:') === 0 && edgeVersion >= 14393 &&\r\n\t\t\t\t\t\t\turl.indexOf('?transport=udp') === -1;\r\n\t\t\t\t});\r\n\t\r\n\t\t\t\tdelete server.url;\r\n\t\t\t\tserver.urls = isString ? urls[0] : urls;\r\n\t\t\t\treturn !!urls.length;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t// Determines the intersection of local and remote capabilities.\r\n\tfunction getCommonCapabilities(localCapabilities, remoteCapabilities) {\r\n\t\tvar commonCapabilities = {\r\n\t\t\tcodecs: [],\r\n\t\t\theaderExtensions: [],\r\n\t\t\tfecMechanisms: []\r\n\t\t};\r\n\t\r\n\t\tvar findCodecByPayloadType = function(pt, codecs) {\r\n\t\t\tpt = parseInt(pt, 10);\r\n\t\t\tfor (var i = 0; i < codecs.length; i++) {\r\n\t\t\t\tif (codecs[i].payloadType === pt ||\r\n\t\t\t\t\t\tcodecs[i].preferredPayloadType === pt) {\r\n\t\t\t\t\treturn codecs[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\r\n\t\tvar rtxCapabilityMatches = function(lRtx, rRtx, lCodecs, rCodecs) {\r\n\t\t\tvar lCodec = findCodecByPayloadType(lRtx.parameters.apt, lCodecs);\r\n\t\t\tvar rCodec = findCodecByPayloadType(rRtx.parameters.apt, rCodecs);\r\n\t\t\treturn lCodec && rCodec &&\r\n\t\t\t\t\tlCodec.name.toLowerCase() === rCodec.name.toLowerCase();\r\n\t\t};\r\n\t\r\n\t\tlocalCapabilities.codecs.forEach(function(lCodec) {\r\n\t\t\tfor (var i = 0; i < remoteCapabilities.codecs.length; i++) {\r\n\t\t\t\tvar rCodec = remoteCapabilities.codecs[i];\r\n\t\t\t\tif (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() &&\r\n\t\t\t\t\t\tlCodec.clockRate === rCodec.clockRate) {\r\n\t\t\t\t\tif (lCodec.name.toLowerCase() === 'rtx' &&\r\n\t\t\t\t\t\t\tlCodec.parameters && rCodec.parameters.apt) {\r\n\t\t\t\t\t\t// for RTX we need to find the local rtx that has a apt\r\n\t\t\t\t\t\t// which points to the same local codec as the remote one.\r\n\t\t\t\t\t\tif (!rtxCapabilityMatches(lCodec, rCodec,\r\n\t\t\t\t\t\t\t\tlocalCapabilities.codecs, remoteCapabilities.codecs)) {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\trCodec = JSON.parse(JSON.stringify(rCodec)); // deepcopy\r\n\t\t\t\t\t// number of channels is the highest common number of channels\r\n\t\t\t\t\trCodec.numChannels = Math.min(lCodec.numChannels,\r\n\t\t\t\t\t\t\trCodec.numChannels);\r\n\t\t\t\t\t// push rCodec so we reply with offerer payload type\r\n\t\t\t\t\tcommonCapabilities.codecs.push(rCodec);\r\n\t\r\n\t\t\t\t\t// determine common feedback mechanisms\r\n\t\t\t\t\trCodec.rtcpFeedback = rCodec.rtcpFeedback.filter(function(fb) {\r\n\t\t\t\t\t\tfor (var j = 0; j < lCodec.rtcpFeedback.length; j++) {\r\n\t\t\t\t\t\t\tif (lCodec.rtcpFeedback[j].type === fb.type &&\r\n\t\t\t\t\t\t\t\t\tlCodec.rtcpFeedback[j].parameter === fb.parameter) {\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// FIXME: also need to determine .parameters\r\n\t\t\t\t\t//  see https://github.com/openpeer/ortc/issues/569\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\r\n\t\tlocalCapabilities.headerExtensions.forEach(function(lHeaderExtension) {\r\n\t\t\tfor (var i = 0; i < remoteCapabilities.headerExtensions.length;\r\n\t\t\t\t\t i++) {\r\n\t\t\t\tvar rHeaderExtension = remoteCapabilities.headerExtensions[i];\r\n\t\t\t\tif (lHeaderExtension.uri === rHeaderExtension.uri) {\r\n\t\t\t\t\tcommonCapabilities.headerExtensions.push(rHeaderExtension);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\r\n\t\t// FIXME: fecMechanisms\r\n\t\treturn commonCapabilities;\r\n\t}\r\n\t\r\n\t// is action=setLocalDescription with type allowed in signalingState\r\n\tfunction isActionAllowedInSignalingState(action, type, signalingState) {\r\n\t\treturn {\r\n\t\t\toffer: {\r\n\t\t\t\tsetLocalDescription: ['stable', 'have-local-offer'],\r\n\t\t\t\tsetRemoteDescription: ['stable', 'have-remote-offer']\r\n\t\t\t},\r\n\t\t\tanswer: {\r\n\t\t\t\tsetLocalDescription: ['have-remote-offer', 'have-local-pranswer'],\r\n\t\t\t\tsetRemoteDescription: ['have-local-offer', 'have-remote-pranswer']\r\n\t\t\t}\r\n\t\t}[type][action].indexOf(signalingState) !== -1;\r\n\t}\r\n\t\r\n\tfunction maybeAddCandidate(iceTransport, candidate) {\r\n\t\t// Edge's internal representation adds some fields therefore\r\n\t\t// not all fieldѕ are taken into account.\r\n\t\tvar alreadyAdded = iceTransport.getRemoteCandidates()\r\n\t\t\t\t.find(function(remoteCandidate) {\r\n\t\t\t\t\treturn candidate.foundation === remoteCandidate.foundation &&\r\n\t\t\t\t\t\t\tcandidate.ip === remoteCandidate.ip &&\r\n\t\t\t\t\t\t\tcandidate.port === remoteCandidate.port &&\r\n\t\t\t\t\t\t\tcandidate.priority === remoteCandidate.priority &&\r\n\t\t\t\t\t\t\tcandidate.protocol === remoteCandidate.protocol &&\r\n\t\t\t\t\t\t\tcandidate.type === remoteCandidate.type;\r\n\t\t\t\t});\r\n\t\tif (!alreadyAdded) {\r\n\t\t\ticeTransport.addRemoteCandidate(candidate);\r\n\t\t}\r\n\t\treturn !alreadyAdded;\r\n\t}\r\n\t\r\n\t\r\n\tfunction makeError(name, description) {\r\n\t\tvar e = new Error(description);\r\n\t\te.name = name;\r\n\t\t// legacy error codes from https://heycam.github.io/webidl/#idl-DOMException-error-names\r\n\t\te.code = {\r\n\t\t\tNotSupportedError: 9,\r\n\t\t\tInvalidStateError: 11,\r\n\t\t\tInvalidAccessError: 15,\r\n\t\t\tTypeError: undefined,\r\n\t\t\tOperationError: undefined\r\n\t\t}[name];\r\n\t\treturn e;\r\n\t}\r\n\t\r\n\tmodule.exports = function(window, edgeVersion) {\r\n\t\t// https://w3c.github.io/mediacapture-main/#mediastream\r\n\t\t// Helper function to add the track to the stream and\r\n\t\t// dispatch the event ourselves.\r\n\t\tfunction addTrackToStreamAndFireEvent(track, stream) {\r\n\t\t\tstream.addTrack(track);\r\n\t\t\tstream.dispatchEvent(new window.MediaStreamTrackEvent('addtrack',\r\n\t\t\t\t\t{track: track}));\r\n\t\t}\r\n\t\r\n\t\tfunction removeTrackFromStreamAndFireEvent(track, stream) {\r\n\t\t\tstream.removeTrack(track);\r\n\t\t\tstream.dispatchEvent(new window.MediaStreamTrackEvent('removetrack',\r\n\t\t\t\t\t{track: track}));\r\n\t\t}\r\n\t\r\n\t\tfunction fireAddTrack(pc, track, receiver, streams) {\r\n\t\t\tvar trackEvent = new Event('track');\r\n\t\t\ttrackEvent.track = track;\r\n\t\t\ttrackEvent.receiver = receiver;\r\n\t\t\ttrackEvent.transceiver = {receiver: receiver};\r\n\t\t\ttrackEvent.streams = streams;\r\n\t\t\twindow.setTimeout(function() {\r\n\t\t\t\tpc._dispatchEvent('track', trackEvent);\r\n\t\t\t});\r\n\t\t}\r\n\t\r\n\t\tvar RTCPeerConnection = function(config) {\r\n\t\t\tvar pc = this;\r\n\t\r\n\t\t\tvar _eventTarget = document.createDocumentFragment();\r\n\t\t\t['addEventListener', 'removeEventListener', 'dispatchEvent']\r\n\t\t\t\t\t.forEach(function(method) {\r\n\t\t\t\t\t\tpc[method] = _eventTarget[method].bind(_eventTarget);\r\n\t\t\t\t\t});\r\n\t\r\n\t\t\tthis.canTrickleIceCandidates = null;\r\n\t\r\n\t\t\tthis.needNegotiation = false;\r\n\t\r\n\t\t\tthis.localStreams = [];\r\n\t\t\tthis.remoteStreams = [];\r\n\t\r\n\t\t\tthis._localDescription = null;\r\n\t\t\tthis._remoteDescription = null;\r\n\t\r\n\t\t\tthis.signalingState = 'stable';\r\n\t\t\tthis.iceConnectionState = 'new';\r\n\t\t\tthis.connectionState = 'new';\r\n\t\t\tthis.iceGatheringState = 'new';\r\n\t\r\n\t\t\tconfig = JSON.parse(JSON.stringify(config || {}));\r\n\t\r\n\t\t\tthis.usingBundle = config.bundlePolicy === 'max-bundle';\r\n\t\t\tif (config.rtcpMuxPolicy === 'negotiate') {\r\n\t\t\t\tthrow(makeError('NotSupportedError',\r\n\t\t\t\t\t\t'rtcpMuxPolicy \\'negotiate\\' is not supported'));\r\n\t\t\t} else if (!config.rtcpMuxPolicy) {\r\n\t\t\t\tconfig.rtcpMuxPolicy = 'require';\r\n\t\t\t}\r\n\t\r\n\t\t\tswitch (config.iceTransportPolicy) {\r\n\t\t\t\tcase 'all':\r\n\t\t\t\tcase 'relay':\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconfig.iceTransportPolicy = 'all';\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\r\n\t\t\tswitch (config.bundlePolicy) {\r\n\t\t\t\tcase 'balanced':\r\n\t\t\t\tcase 'max-compat':\r\n\t\t\t\tcase 'max-bundle':\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconfig.bundlePolicy = 'balanced';\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\r\n\t\t\tconfig.iceServers = filterIceServers(config.iceServers || [], edgeVersion);\r\n\t\r\n\t\t\tthis._iceGatherers = [];\r\n\t\t\tif (config.iceCandidatePoolSize) {\r\n\t\t\t\tfor (var i = config.iceCandidatePoolSize; i > 0; i--) {\r\n\t\t\t\t\tthis._iceGatherers.push(new window.RTCIceGatherer({\r\n\t\t\t\t\t\ticeServers: config.iceServers,\r\n\t\t\t\t\t\tgatherPolicy: config.iceTransportPolicy\r\n\t\t\t\t\t}));\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconfig.iceCandidatePoolSize = 0;\r\n\t\t\t}\r\n\t\r\n\t\t\tthis._config = config;\r\n\t\r\n\t\t\t// per-track iceGathers, iceTransports, dtlsTransports, rtpSenders, ...\r\n\t\t\t// everything that is needed to describe a SDP m-line.\r\n\t\t\tthis.transceivers = [];\r\n\t\r\n\t\t\tthis._sdpSessionId = SDPUtils.generateSessionId();\r\n\t\t\tthis._sdpSessionVersion = 0;\r\n\t\r\n\t\t\tthis._dtlsRole = undefined; // role for a=setup to use in answers.\r\n\t\r\n\t\t\tthis._isClosed = false;\r\n\t\t};\r\n\t\r\n\t\tObject.defineProperty(RTCPeerConnection.prototype, 'localDescription', {\r\n\t\t\tconfigurable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn this._localDescription;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(RTCPeerConnection.prototype, 'remoteDescription', {\r\n\t\t\tconfigurable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn this._remoteDescription;\r\n\t\t\t}\r\n\t\t});\r\n\t\r\n\t\t// set up event handlers on prototype\r\n\t\tRTCPeerConnection.prototype.onicecandidate = null;\r\n\t\tRTCPeerConnection.prototype.onaddstream = null;\r\n\t\tRTCPeerConnection.prototype.ontrack = null;\r\n\t\tRTCPeerConnection.prototype.onremovestream = null;\r\n\t\tRTCPeerConnection.prototype.onsignalingstatechange = null;\r\n\t\tRTCPeerConnection.prototype.oniceconnectionstatechange = null;\r\n\t\tRTCPeerConnection.prototype.onconnectionstatechange = null;\r\n\t\tRTCPeerConnection.prototype.onicegatheringstatechange = null;\r\n\t\tRTCPeerConnection.prototype.onnegotiationneeded = null;\r\n\t\tRTCPeerConnection.prototype.ondatachannel = null;\r\n\t\r\n\t\tRTCPeerConnection.prototype._dispatchEvent = function(name, event) {\r\n\t\t\tif (this._isClosed) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.dispatchEvent(event);\r\n\t\t\tif (typeof this['on' + name] === 'function') {\r\n\t\t\t\tthis['on' + name](event);\r\n\t\t\t}\r\n\t\t};\r\n\t\r\n\t\tRTCPeerConnection.prototype._emitGatheringStateChange = function() {\r\n\t\t\tvar event = new Event('icegatheringstatechange');\r\n\t\t\tthis._dispatchEvent('icegatheringstatechange', event);\r\n\t\t};\r\n\t\r\n\t\tRTCPeerConnection.prototype.getConfiguration = function() {\r\n\t\t\treturn this._config;\r\n\t\t};\r\n\t\r\n\t\tRTCPeerConnection.prototype.getLocalStreams = function() {\r\n\t\t\treturn this.localStreams;\r\n\t\t};\r\n\t\r\n\t\tRTCPeerConnection.prototype.getRemoteStreams = function() {\r\n\t\t\treturn this.remoteStreams;\r\n\t\t};\r\n\t\r\n\t\t// internal helper to create a transceiver object.\r\n\t\t// (which is not yet the same as the WebRTC 1.0 transceiver)\r\n\t\tRTCPeerConnection.prototype._createTransceiver = function(kind, doNotAdd) {\r\n\t\t\tvar hasBundleTransport = this.transceivers.length > 0;\r\n\t\t\tvar transceiver = {\r\n\t\t\t\ttrack: null,\r\n\t\t\t\ticeGatherer: null,\r\n\t\t\t\ticeTransport: null,\r\n\t\t\t\tdtlsTransport: null,\r\n\t\t\t\tlocalCapabilities: null,\r\n\t\t\t\tremoteCapabilities: null,\r\n\t\t\t\trtpSender: null,\r\n\t\t\t\trtpReceiver: null,\r\n\t\t\t\tkind: kind,\r\n\t\t\t\tmid: null,\r\n\t\t\t\tsendEncodingParameters: null,\r\n\t\t\t\trecvEncodingParameters: null,\r\n\t\t\t\tstream: null,\r\n\t\t\t\tassociatedRemoteMediaStreams: [],\r\n\t\t\t\twantReceive: true\r\n\t\t\t};\r\n\t\t\tif (this.usingBundle && hasBundleTransport) {\r\n\t\t\t\ttransceiver.iceTransport = this.transceivers[0].iceTransport;\r\n\t\t\t\ttransceiver.dtlsTransport = this.transceivers[0].dtlsTransport;\r\n\t\t\t} else {\r\n\t\t\t\tvar transports = this._createIceAndDtlsTransports();\r\n\t\t\t\ttransceiver.iceTransport = transports.iceTransport;\r\n\t\t\t\ttransceiver.dtlsTransport = transports.dtlsTransport;\r\n\t\t\t}\r\n\t\t\tif (!doNotAdd) {\r\n\t\t\t\tthis.transceivers.push(transceiver);\r\n\t\t\t}\r\n\t\t\treturn transceiver;\r\n\t\t};\r\n\t\r\n\t\tRTCPeerConnection.prototype.addTrack = function(track, stream) {\r\n\t\t\tif (this._isClosed) {\r\n\t\t\t\tthrow makeError('InvalidStateError',\r\n\t\t\t\t\t\t'Attempted to call addTrack on a closed peerconnection.');\r\n\t\t\t}\r\n\t\r\n\t\t\tvar alreadyExists = this.transceivers.find(function(s) {\r\n\t\t\t\treturn s.track === track;\r\n\t\t\t});\r\n\t\r\n\t\t\tif (alreadyExists) {\r\n\t\t\t\tthrow makeError('InvalidAccessError', 'Track already exists.');\r\n\t\t\t}\r\n\t\r\n\t\t\tvar transceiver;\r\n\t\t\tfor (var i = 0; i < this.transceivers.length; i++) {\r\n\t\t\t\tif (!this.transceivers[i].track &&\r\n\t\t\t\t\t\tthis.transceivers[i].kind === track.kind) {\r\n\t\t\t\t\ttransceiver = this.transceivers[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!transceiver) {\r\n\t\t\t\ttransceiver = this._createTransceiver(track.kind);\r\n\t\t\t}\r\n\t\r\n\t\t\tthis._maybeFireNegotiationNeeded();\r\n\t\r\n\t\t\tif (this.localStreams.indexOf(stream) === -1) {\r\n\t\t\t\tthis.localStreams.push(stream);\r\n\t\t\t}\r\n\t\r\n\t\t\ttransceiver.track = track;\r\n\t\t\ttransceiver.stream = stream;\r\n\t\t\ttransceiver.rtpSender = new window.RTCRtpSender(track,\r\n\t\t\t\t\ttransceiver.dtlsTransport);\r\n\t\t\treturn transceiver.rtpSender;\r\n\t\t};\r\n\t\r\n\t\tRTCPeerConnection.prototype.addStream = function(stream) {\r\n\t\t\tvar pc = this;\r\n\t\t\tif (edgeVersion >= 15025) {\r\n\t\t\t\tstream.getTracks().forEach(function(track) {\r\n\t\t\t\t\tpc.addTrack(track, stream);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t// Clone is necessary for local demos mostly, attaching directly\r\n\t\t\t\t// to two different senders does not work (build 10547).\r\n\t\t\t\t// Fixed in 15025 (or earlier)\r\n\t\t\t\tvar clonedStream = stream.clone();\r\n\t\t\t\tstream.getTracks().forEach(function(track, idx) {\r\n\t\t\t\t\tvar clonedTrack = clonedStream.getTracks()[idx];\r\n\t\t\t\t\ttrack.addEventListener('enabled', function(event) {\r\n\t\t\t\t\t\tclonedTrack.enabled = event.enabled;\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tclonedStream.getTracks().forEach(function(track) {\r\n\t\t\t\t\tpc.addTrack(track, clonedStream);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t\r\n\t\tRTCPeerConnection.prototype.removeTrack = function(sender) {\r\n\t\t\tif (this._isClosed) {\r\n\t\t\t\tthrow makeError('InvalidStateError',\r\n\t\t\t\t\t\t'Attempted to call removeTrack on a closed peerconnection.');\r\n\t\t\t}\r\n\t\r\n\t\t\tif (!(sender instanceof window.RTCRtpSender)) {\r\n\t\t\t\tthrow new TypeError('Argument 1 of RTCPeerConnection.removeTrack ' +\r\n\t\t\t\t\t\t'does not implement interface RTCRtpSender.');\r\n\t\t\t}\r\n\t\r\n\t\t\tvar transceiver = this.transceivers.find(function(t) {\r\n\t\t\t\treturn t.rtpSender === sender;\r\n\t\t\t});\r\n\t\r\n\t\t\tif (!transceiver) {\r\n\t\t\t\tthrow makeError('InvalidAccessError',\r\n\t\t\t\t\t\t'Sender was not created by this connection.');\r\n\t\t\t}\r\n\t\t\tvar stream = transceiver.stream;\r\n\t\r\n\t\t\ttransceiver.rtpSender.stop();\r\n\t\t\ttransceiver.rtpSender = null;\r\n\t\t\ttransceiver.track = null;\r\n\t\t\ttransceiver.stream = null;\r\n\t\r\n\t\t\t// remove the stream from the set of local streams\r\n\t\t\tvar localStreams = this.transceivers.map(function(t) {\r\n\t\t\t\treturn t.stream;\r\n\t\t\t});\r\n\t\t\tif (localStreams.indexOf(stream) === -1 &&\r\n\t\t\t\t\tthis.localStreams.indexOf(stream) > -1) {\r\n\t\t\t\tthis.localStreams.splice(this.localStreams.indexOf(stream), 1);\r\n\t\t\t}\r\n\t\r\n\t\t\tthis._maybeFireNegotiationNeeded();\r\n\t\t};\r\n\t\r\n\t\tRTCPeerConnection.prototype.removeStream = function(stream) {\r\n\t\t\tvar pc = this;\r\n\t\t\tstream.getTracks().forEach(function(track) {\r\n\t\t\t\tvar sender = pc.getSenders().find(function(s) {\r\n\t\t\t\t\treturn s.track === track;\r\n\t\t\t\t});\r\n\t\t\t\tif (sender) {\r\n\t\t\t\t\tpc.removeTrack(sender);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\t\r\n\t\tRTCPeerConnection.prototype.getSenders = function() {\r\n\t\t\treturn this.transceivers.filter(function(transceiver) {\r\n\t\t\t\treturn !!transceiver.rtpSender;\r\n\t\t\t})\r\n\t\t\t.map(function(transceiver) {\r\n\t\t\t\treturn transceiver.rtpSender;\r\n\t\t\t});\r\n\t\t};\r\n\t\r\n\t\tRTCPeerConnection.prototype.getReceivers = function() {\r\n\t\t\treturn this.transceivers.filter(function(transceiver) {\r\n\t\t\t\treturn !!transceiver.rtpReceiver;\r\n\t\t\t})\r\n\t\t\t.map(function(transceiver) {\r\n\t\t\t\treturn transceiver.rtpReceiver;\r\n\t\t\t});\r\n\t\t};\r\n\t\r\n\t\r\n\t\tRTCPeerConnection.prototype._createIceGatherer = function(sdpMLineIndex,\r\n\t\t\t\tusingBundle) {\r\n\t\t\tvar pc = this;\r\n\t\t\tif (usingBundle && sdpMLineIndex > 0) {\r\n\t\t\t\treturn this.transceivers[0].iceGatherer;\r\n\t\t\t} else if (this._iceGatherers.length) {\r\n\t\t\t\treturn this._iceGatherers.shift();\r\n\t\t\t}\r\n\t\t\tvar iceGatherer = new window.RTCIceGatherer({\r\n\t\t\t\ticeServers: this._config.iceServers,\r\n\t\t\t\tgatherPolicy: this._config.iceTransportPolicy\r\n\t\t\t});\r\n\t\t\tObject.defineProperty(iceGatherer, 'state',\r\n\t\t\t\t\t{value: 'new', writable: true}\r\n\t\t\t);\r\n\t\r\n\t\t\tthis.transceivers[sdpMLineIndex].bufferedCandidateEvents = [];\r\n\t\t\tthis.transceivers[sdpMLineIndex].bufferCandidates = function(event) {\r\n\t\t\t\tvar end = !event.candidate || Object.keys(event.candidate).length === 0;\r\n\t\t\t\t// polyfill since RTCIceGatherer.state is not implemented in\r\n\t\t\t\t// Edge 10547 yet.\r\n\t\t\t\ticeGatherer.state = end ? 'completed' : 'gathering';\r\n\t\t\t\tif (pc.transceivers[sdpMLineIndex].bufferedCandidateEvents !== null) {\r\n\t\t\t\t\tpc.transceivers[sdpMLineIndex].bufferedCandidateEvents.push(event);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\ticeGatherer.addEventListener('localcandidate',\r\n\t\t\t\tthis.transceivers[sdpMLineIndex].bufferCandidates);\r\n\t\t\treturn iceGatherer;\r\n\t\t};\r\n\t\r\n\t\t// start gathering from an RTCIceGatherer.\r\n\t\tRTCPeerConnection.prototype._gather = function(mid, sdpMLineIndex) {\r\n\t\t\tvar pc = this;\r\n\t\t\tvar iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\r\n\t\t\tif (iceGatherer.onlocalcandidate) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar bufferedCandidateEvents =\r\n\t\t\t\tthis.transceivers[sdpMLineIndex].bufferedCandidateEvents;\r\n\t\t\tthis.transceivers[sdpMLineIndex].bufferedCandidateEvents = null;\r\n\t\t\ticeGatherer.removeEventListener('localcandidate',\r\n\t\t\t\tthis.transceivers[sdpMLineIndex].bufferCandidates);\r\n\t\t\ticeGatherer.onlocalcandidate = function(evt) {\r\n\t\t\t\tif (pc.usingBundle && sdpMLineIndex > 0) {\r\n\t\t\t\t\t// if we know that we use bundle we can drop candidates with\r\n\t\t\t\t\t// ѕdpMLineIndex > 0. If we don't do this then our state gets\r\n\t\t\t\t\t// confused since we dispose the extra ice gatherer.\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar event = new Event('icecandidate');\r\n\t\t\t\tevent.candidate = {sdpMid: mid, sdpMLineIndex: sdpMLineIndex};\r\n\t\r\n\t\t\t\tvar cand = evt.candidate;\r\n\t\t\t\t// Edge emits an empty object for RTCIceCandidateComplete‥\r\n\t\t\t\tvar end = !cand || Object.keys(cand).length === 0;\r\n\t\t\t\tif (end) {\r\n\t\t\t\t\t// polyfill since RTCIceGatherer.state is not implemented in\r\n\t\t\t\t\t// Edge 10547 yet.\r\n\t\t\t\t\tif (iceGatherer.state === 'new' || iceGatherer.state === 'gathering') {\r\n\t\t\t\t\t\ticeGatherer.state = 'completed';\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (iceGatherer.state === 'new') {\r\n\t\t\t\t\t\ticeGatherer.state = 'gathering';\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// RTCIceCandidate doesn't have a component, needs to be added\r\n\t\t\t\t\tcand.component = 1;\r\n\t\t\t\t\t// also the usernameFragment. TODO: update SDP to take both variants.\r\n\t\t\t\t\tcand.ufrag = iceGatherer.getLocalParameters().usernameFragment;\r\n\t\r\n\t\t\t\t\tvar serializedCandidate = SDPUtils.writeCandidate(cand);\r\n\t\t\t\t\tevent.candidate = Object.assign(event.candidate,\r\n\t\t\t\t\t\t\tSDPUtils.parseCandidate(serializedCandidate));\r\n\t\r\n\t\t\t\t\tevent.candidate.candidate = serializedCandidate;\r\n\t\t\t\t\tevent.candidate.toJSON = function() {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tcandidate: event.candidate.candidate,\r\n\t\t\t\t\t\t\tsdpMid: event.candidate.sdpMid,\r\n\t\t\t\t\t\t\tsdpMLineIndex: event.candidate.sdpMLineIndex,\r\n\t\t\t\t\t\t\tusernameFragment: event.candidate.usernameFragment\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// update local description.\r\n\t\t\t\tvar sections = SDPUtils.getMediaSections(pc._localDescription.sdp);\r\n\t\t\t\tif (!end) {\r\n\t\t\t\t\tsections[event.candidate.sdpMLineIndex] +=\r\n\t\t\t\t\t\t\t'a=' + event.candidate.candidate + '\\r\\n';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsections[event.candidate.sdpMLineIndex] +=\r\n\t\t\t\t\t\t\t'a=end-of-candidates\\r\\n';\r\n\t\t\t\t}\r\n\t\t\t\tpc._localDescription.sdp =\r\n\t\t\t\t\t\tSDPUtils.getDescription(pc._localDescription.sdp) +\r\n\t\t\t\t\t\tsections.join('');\r\n\t\t\t\tvar complete = pc.transceivers.every(function(transceiver) {\r\n\t\t\t\t\treturn transceiver.iceGatherer &&\r\n\t\t\t\t\t\t\ttransceiver.iceGatherer.state === 'completed';\r\n\t\t\t\t});\r\n\t\r\n\t\t\t\tif (pc.iceGatheringState !== 'gathering') {\r\n\t\t\t\t\tpc.iceGatheringState = 'gathering';\r\n\t\t\t\t\tpc._emitGatheringStateChange();\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// Emit candidate. Also emit null candidate when all gatherers are\r\n\t\t\t\t// complete.\r\n\t\t\t\tif (!end) {\r\n\t\t\t\t\tpc._dispatchEvent('icecandidate', event);\r\n\t\t\t\t}\r\n\t\t\t\tif (complete) {\r\n\t\t\t\t\tpc._dispatchEvent('icecandidate', new Event('icecandidate'));\r\n\t\t\t\t\tpc.iceGatheringState = 'complete';\r\n\t\t\t\t\tpc._emitGatheringStateChange();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\r\n\t\t\t// emit already gathered candidates.\r\n\t\t\twindow.setTimeout(function() {\r\n\t\t\t\tbufferedCandidateEvents.forEach(function(e) {\r\n\t\t\t\t\ticeGatherer.onlocalcandidate(e);\r\n\t\t\t\t});\r\n\t\t\t}, 0);\r\n\t\t};\r\n\t\r\n\t\t// Create ICE transport and DTLS transport.\r\n\t\tRTCPeerConnection.prototype._createIceAndDtlsTransports = function() {\r\n\t\t\tvar pc = this;\r\n\t\t\tvar iceTransport = new window.RTCIceTransport(null);\r\n\t\t\ticeTransport.onicestatechange = function() {\r\n\t\t\t\tpc._updateIceConnectionState();\r\n\t\t\t\tpc._updateConnectionState();\r\n\t\t\t};\r\n\t\r\n\t\t\tvar dtlsTransport = new window.RTCDtlsTransport(iceTransport);\r\n\t\t\tdtlsTransport.ondtlsstatechange = function() {\r\n\t\t\t\tpc._updateConnectionState();\r\n\t\t\t};\r\n\t\t\tdtlsTransport.onerror = function() {\r\n\t\t\t\t// onerror does not set state to failed by itself.\r\n\t\t\t\tObject.defineProperty(dtlsTransport, 'state',\r\n\t\t\t\t\t\t{value: 'failed', writable: true});\r\n\t\t\t\tpc._updateConnectionState();\r\n\t\t\t};\r\n\t\r\n\t\t\treturn {\r\n\t\t\t\ticeTransport: iceTransport,\r\n\t\t\t\tdtlsTransport: dtlsTransport\r\n\t\t\t};\r\n\t\t};\r\n\t\r\n\t\t// Destroy ICE gatherer, ICE transport and DTLS transport.\r\n\t\t// Without triggering the callbacks.\r\n\t\tRTCPeerConnection.prototype._disposeIceAndDtlsTransports = function(\r\n\t\t\t\tsdpMLineIndex) {\r\n\t\t\tvar iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\r\n\t\t\tif (iceGatherer) {\r\n\t\t\t\tdelete iceGatherer.onlocalcandidate;\r\n\t\t\t\tdelete this.transceivers[sdpMLineIndex].iceGatherer;\r\n\t\t\t}\r\n\t\t\tvar iceTransport = this.transceivers[sdpMLineIndex].iceTransport;\r\n\t\t\tif (iceTransport) {\r\n\t\t\t\tdelete iceTransport.onicestatechange;\r\n\t\t\t\tdelete this.transceivers[sdpMLineIndex].iceTransport;\r\n\t\t\t}\r\n\t\t\tvar dtlsTransport = this.transceivers[sdpMLineIndex].dtlsTransport;\r\n\t\t\tif (dtlsTransport) {\r\n\t\t\t\tdelete dtlsTransport.ondtlsstatechange;\r\n\t\t\t\tdelete dtlsTransport.onerror;\r\n\t\t\t\tdelete this.transceivers[sdpMLineIndex].dtlsTransport;\r\n\t\t\t}\r\n\t\t};\r\n\t\r\n\t\t// Start the RTP Sender and Receiver for a transceiver.\r\n\t\tRTCPeerConnection.prototype._transceive = function(transceiver,\r\n\t\t\t\tsend, recv) {\r\n\t\t\tvar params = getCommonCapabilities(transceiver.localCapabilities,\r\n\t\t\t\t\ttransceiver.remoteCapabilities);\r\n\t\t\tif (send && transceiver.rtpSender) {\r\n\t\t\t\tparams.encodings = transceiver.sendEncodingParameters;\r\n\t\t\t\tparams.rtcp = {\r\n\t\t\t\t\tcname: SDPUtils.localCName,\r\n\t\t\t\t\tcompound: transceiver.rtcpParameters.compound\r\n\t\t\t\t};\r\n\t\t\t\tif (transceiver.recvEncodingParameters.length) {\r\n\t\t\t\t\tparams.rtcp.ssrc = transceiver.recvEncodingParameters[0].ssrc;\r\n\t\t\t\t}\r\n\t\t\t\ttransceiver.rtpSender.send(params);\r\n\t\t\t}\r\n\t\t\tif (recv && transceiver.rtpReceiver && params.codecs.length > 0) {\r\n\t\t\t\t// remove RTX field in Edge 14942\r\n\t\t\t\tif (transceiver.kind === 'video'\r\n\t\t\t\t\t\t&& transceiver.recvEncodingParameters\r\n\t\t\t\t\t\t&& edgeVersion < 15019) {\r\n\t\t\t\t\ttransceiver.recvEncodingParameters.forEach(function(p) {\r\n\t\t\t\t\t\tdelete p.rtx;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tif (transceiver.recvEncodingParameters.length) {\r\n\t\t\t\t\tparams.encodings = transceiver.recvEncodingParameters;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tparams.encodings = [{}];\r\n\t\t\t\t}\r\n\t\t\t\tparams.rtcp = {\r\n\t\t\t\t\tcompound: transceiver.rtcpParameters.compound\r\n\t\t\t\t};\r\n\t\t\t\tif (transceiver.rtcpParameters.cname) {\r\n\t\t\t\t\tparams.rtcp.cname = transceiver.rtcpParameters.cname;\r\n\t\t\t\t}\r\n\t\t\t\tif (transceiver.sendEncodingParameters.length) {\r\n\t\t\t\t\tparams.rtcp.ssrc = transceiver.sendEncodingParameters[0].ssrc;\r\n\t\t\t\t}\r\n\t\t\t\ttransceiver.rtpReceiver.receive(params);\r\n\t\t\t}\r\n\t\t};\r\n\t\r\n\t\tRTCPeerConnection.prototype.setLocalDescription = function(description) {\r\n\t\t\tvar pc = this;\r\n\t\r\n\t\t\t// Note: pranswer is not supported.\r\n\t\t\tif (['offer', 'answer'].indexOf(description.type) === -1) {\r\n\t\t\t\treturn Promise.reject(makeError('TypeError',\r\n\t\t\t\t\t\t'Unsupported type \"' + description.type + '\"'));\r\n\t\t\t}\r\n\t\r\n\t\t\tif (!isActionAllowedInSignalingState('setLocalDescription',\r\n\t\t\t\t\tdescription.type, pc.signalingState) || pc._isClosed) {\r\n\t\t\t\treturn Promise.reject(makeError('InvalidStateError',\r\n\t\t\t\t\t\t'Can not set local ' + description.type +\r\n\t\t\t\t\t\t' in state ' + pc.signalingState));\r\n\t\t\t}\r\n\t\r\n\t\t\tvar sections;\r\n\t\t\tvar sessionpart;\r\n\t\t\tif (description.type === 'offer') {\r\n\t\t\t\t// VERY limited support for SDP munging. Limited to:\r\n\t\t\t\t// * changing the order of codecs\r\n\t\t\t\tsections = SDPUtils.splitSections(description.sdp);\r\n\t\t\t\tsessionpart = sections.shift();\r\n\t\t\t\tsections.forEach(function(mediaSection, sdpMLineIndex) {\r\n\t\t\t\t\tvar caps = SDPUtils.parseRtpParameters(mediaSection);\r\n\t\t\t\t\tpc.transceivers[sdpMLineIndex].localCapabilities = caps;\r\n\t\t\t\t});\r\n\t\r\n\t\t\t\tpc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\r\n\t\t\t\t\tpc._gather(transceiver.mid, sdpMLineIndex);\r\n\t\t\t\t});\r\n\t\t\t} else if (description.type === 'answer') {\r\n\t\t\t\tsections = SDPUtils.splitSections(pc._remoteDescription.sdp);\r\n\t\t\t\tsessionpart = sections.shift();\r\n\t\t\t\tvar isIceLite = SDPUtils.matchPrefix(sessionpart,\r\n\t\t\t\t\t\t'a=ice-lite').length > 0;\r\n\t\t\t\tsections.forEach(function(mediaSection, sdpMLineIndex) {\r\n\t\t\t\t\tvar transceiver = pc.transceivers[sdpMLineIndex];\r\n\t\t\t\t\tvar iceGatherer = transceiver.iceGatherer;\r\n\t\t\t\t\tvar iceTransport = transceiver.iceTransport;\r\n\t\t\t\t\tvar dtlsTransport = transceiver.dtlsTransport;\r\n\t\t\t\t\tvar localCapabilities = transceiver.localCapabilities;\r\n\t\t\t\t\tvar remoteCapabilities = transceiver.remoteCapabilities;\r\n\t\r\n\t\t\t\t\t// treat bundle-only as not-rejected.\r\n\t\t\t\t\tvar rejected = SDPUtils.isRejected(mediaSection) &&\r\n\t\t\t\t\t\t\tSDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\r\n\t\r\n\t\t\t\t\tif (!rejected && !transceiver.rejected) {\r\n\t\t\t\t\t\tvar remoteIceParameters = SDPUtils.getIceParameters(\r\n\t\t\t\t\t\t\t\tmediaSection, sessionpart);\r\n\t\t\t\t\t\tvar remoteDtlsParameters = SDPUtils.getDtlsParameters(\r\n\t\t\t\t\t\t\t\tmediaSection, sessionpart);\r\n\t\t\t\t\t\tif (isIceLite) {\r\n\t\t\t\t\t\t\tremoteDtlsParameters.role = 'server';\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tif (!pc.usingBundle || sdpMLineIndex === 0) {\r\n\t\t\t\t\t\t\tpc._gather(transceiver.mid, sdpMLineIndex);\r\n\t\t\t\t\t\t\tif (iceTransport.state === 'new') {\r\n\t\t\t\t\t\t\t\ticeTransport.start(iceGatherer, remoteIceParameters,\r\n\t\t\t\t\t\t\t\t\t\tisIceLite ? 'controlling' : 'controlled');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (dtlsTransport.state === 'new') {\r\n\t\t\t\t\t\t\t\tdtlsTransport.start(remoteDtlsParameters);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t// Calculate intersection of capabilities.\r\n\t\t\t\t\t\tvar params = getCommonCapabilities(localCapabilities,\r\n\t\t\t\t\t\t\t\tremoteCapabilities);\r\n\t\r\n\t\t\t\t\t\t// Start the RTCRtpSender. The RTCRtpReceiver for this\r\n\t\t\t\t\t\t// transceiver has already been started in setRemoteDescription.\r\n\t\t\t\t\t\tpc._transceive(transceiver,\r\n\t\t\t\t\t\t\t\tparams.codecs.length > 0,\r\n\t\t\t\t\t\t\t\tfalse);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\r\n\t\t\tpc._localDescription = {\r\n\t\t\t\ttype: description.type,\r\n\t\t\t\tsdp: description.sdp\r\n\t\t\t};\r\n\t\t\tif (description.type === 'offer') {\r\n\t\t\t\tpc._updateSignalingState('have-local-offer');\r\n\t\t\t} else {\r\n\t\t\t\tpc._updateSignalingState('stable');\r\n\t\t\t}\r\n\t\r\n\t\t\treturn Promise.resolve();\r\n\t\t};\r\n\t\r\n\t\tRTCPeerConnection.prototype.setRemoteDescription = function(description) {\r\n\t\t\tvar pc = this;\r\n\t\r\n\t\t\t// Note: pranswer is not supported.\r\n\t\t\tif (['offer', 'answer'].indexOf(description.type) === -1) {\r\n\t\t\t\treturn Promise.reject(makeError('TypeError',\r\n\t\t\t\t\t\t'Unsupported type \"' + description.type + '\"'));\r\n\t\t\t}\r\n\t\r\n\t\t\tif (!isActionAllowedInSignalingState('setRemoteDescription',\r\n\t\t\t\t\tdescription.type, pc.signalingState) || pc._isClosed) {\r\n\t\t\t\treturn Promise.reject(makeError('InvalidStateError',\r\n\t\t\t\t\t\t'Can not set remote ' + description.type +\r\n\t\t\t\t\t\t' in state ' + pc.signalingState));\r\n\t\t\t}\r\n\t\r\n\t\t\tvar streams = {};\r\n\t\t\tpc.remoteStreams.forEach(function(stream) {\r\n\t\t\t\tstreams[stream.id] = stream;\r\n\t\t\t});\r\n\t\t\tvar receiverList = [];\r\n\t\t\tvar sections = SDPUtils.splitSections(description.sdp);\r\n\t\t\tvar sessionpart = sections.shift();\r\n\t\t\tvar isIceLite = SDPUtils.matchPrefix(sessionpart,\r\n\t\t\t\t\t'a=ice-lite').length > 0;\r\n\t\t\tvar usingBundle = SDPUtils.matchPrefix(sessionpart,\r\n\t\t\t\t\t'a=group:BUNDLE ').length > 0;\r\n\t\t\tpc.usingBundle = usingBundle;\r\n\t\t\tvar iceOptions = SDPUtils.matchPrefix(sessionpart,\r\n\t\t\t\t\t'a=ice-options:')[0];\r\n\t\t\tif (iceOptions) {\r\n\t\t\t\tpc.canTrickleIceCandidates = iceOptions.substr(14).split(' ')\r\n\t\t\t\t\t\t.indexOf('trickle') >= 0;\r\n\t\t\t} else {\r\n\t\t\t\tpc.canTrickleIceCandidates = false;\r\n\t\t\t}\r\n\t\r\n\t\t\tsections.forEach(function(mediaSection, sdpMLineIndex) {\r\n\t\t\t\tvar lines = SDPUtils.splitLines(mediaSection);\r\n\t\t\t\tvar kind = SDPUtils.getKind(mediaSection);\r\n\t\t\t\t// treat bundle-only as not-rejected.\r\n\t\t\t\tvar rejected = SDPUtils.isRejected(mediaSection) &&\r\n\t\t\t\t\t\tSDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\r\n\t\t\t\tvar protocol = lines[0].substr(2).split(' ')[2];\r\n\t\r\n\t\t\t\tvar direction = SDPUtils.getDirection(mediaSection, sessionpart);\r\n\t\t\t\tvar remoteMsid = SDPUtils.parseMsid(mediaSection);\r\n\t\r\n\t\t\t\tvar mid = SDPUtils.getMid(mediaSection) || SDPUtils.generateIdentifier();\r\n\t\r\n\t\t\t\t// Reject datachannels which are not implemented yet.\r\n\t\t\t\tif (rejected || (kind === 'application' && (protocol === 'DTLS/SCTP' ||\r\n\t\t\t\t\t\tprotocol === 'UDP/DTLS/SCTP'))) {\r\n\t\t\t\t\t// TODO: this is dangerous in the case where a non-rejected m-line\r\n\t\t\t\t\t//     becomes rejected.\r\n\t\t\t\t\tpc.transceivers[sdpMLineIndex] = {\r\n\t\t\t\t\t\tmid: mid,\r\n\t\t\t\t\t\tkind: kind,\r\n\t\t\t\t\t\tprotocol: protocol,\r\n\t\t\t\t\t\trejected: true\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif (!rejected && pc.transceivers[sdpMLineIndex] &&\r\n\t\t\t\t\t\tpc.transceivers[sdpMLineIndex].rejected) {\r\n\t\t\t\t\t// recycle a rejected transceiver.\r\n\t\t\t\t\tpc.transceivers[sdpMLineIndex] = pc._createTransceiver(kind, true);\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar transceiver;\r\n\t\t\t\tvar iceGatherer;\r\n\t\t\t\tvar iceTransport;\r\n\t\t\t\tvar dtlsTransport;\r\n\t\t\t\tvar rtpReceiver;\r\n\t\t\t\tvar sendEncodingParameters;\r\n\t\t\t\tvar recvEncodingParameters;\r\n\t\t\t\tvar localCapabilities;\r\n\t\r\n\t\t\t\tvar track;\r\n\t\t\t\t// FIXME: ensure the mediaSection has rtcp-mux set.\r\n\t\t\t\tvar remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection);\r\n\t\t\t\tvar remoteIceParameters;\r\n\t\t\t\tvar remoteDtlsParameters;\r\n\t\t\t\tif (!rejected) {\r\n\t\t\t\t\tremoteIceParameters = SDPUtils.getIceParameters(mediaSection,\r\n\t\t\t\t\t\t\tsessionpart);\r\n\t\t\t\t\tremoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection,\r\n\t\t\t\t\t\t\tsessionpart);\r\n\t\t\t\t\tremoteDtlsParameters.role = 'client';\r\n\t\t\t\t}\r\n\t\t\t\trecvEncodingParameters =\r\n\t\t\t\t\t\tSDPUtils.parseRtpEncodingParameters(mediaSection);\r\n\t\r\n\t\t\t\tvar rtcpParameters = SDPUtils.parseRtcpParameters(mediaSection);\r\n\t\r\n\t\t\t\tvar isComplete = SDPUtils.matchPrefix(mediaSection,\r\n\t\t\t\t\t\t'a=end-of-candidates', sessionpart).length > 0;\r\n\t\t\t\tvar cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\r\n\t\t\t\t\t\t.map(function(cand) {\r\n\t\t\t\t\t\t\treturn SDPUtils.parseCandidate(cand);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.filter(function(cand) {\r\n\t\t\t\t\t\t\treturn cand.component === 1;\r\n\t\t\t\t\t\t});\r\n\t\r\n\t\t\t\t// Check if we can use BUNDLE and dispose transports.\r\n\t\t\t\tif ((description.type === 'offer' || description.type === 'answer') &&\r\n\t\t\t\t\t\t!rejected && usingBundle && sdpMLineIndex > 0 &&\r\n\t\t\t\t\t\tpc.transceivers[sdpMLineIndex]) {\r\n\t\t\t\t\tpc._disposeIceAndDtlsTransports(sdpMLineIndex);\r\n\t\t\t\t\tpc.transceivers[sdpMLineIndex].iceGatherer =\r\n\t\t\t\t\t\t\tpc.transceivers[0].iceGatherer;\r\n\t\t\t\t\tpc.transceivers[sdpMLineIndex].iceTransport =\r\n\t\t\t\t\t\t\tpc.transceivers[0].iceTransport;\r\n\t\t\t\t\tpc.transceivers[sdpMLineIndex].dtlsTransport =\r\n\t\t\t\t\t\t\tpc.transceivers[0].dtlsTransport;\r\n\t\t\t\t\tif (pc.transceivers[sdpMLineIndex].rtpSender) {\r\n\t\t\t\t\t\tpc.transceivers[sdpMLineIndex].rtpSender.setTransport(\r\n\t\t\t\t\t\t\t\tpc.transceivers[0].dtlsTransport);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (pc.transceivers[sdpMLineIndex].rtpReceiver) {\r\n\t\t\t\t\t\tpc.transceivers[sdpMLineIndex].rtpReceiver.setTransport(\r\n\t\t\t\t\t\t\t\tpc.transceivers[0].dtlsTransport);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (description.type === 'offer' && !rejected) {\r\n\t\t\t\t\ttransceiver = pc.transceivers[sdpMLineIndex] ||\r\n\t\t\t\t\t\t\tpc._createTransceiver(kind);\r\n\t\t\t\t\ttransceiver.mid = mid;\r\n\t\r\n\t\t\t\t\tif (!transceiver.iceGatherer) {\r\n\t\t\t\t\t\ttransceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\r\n\t\t\t\t\t\t\t\tusingBundle);\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif (cands.length && transceiver.iceTransport.state === 'new') {\r\n\t\t\t\t\t\tif (isComplete && (!usingBundle || sdpMLineIndex === 0)) {\r\n\t\t\t\t\t\t\ttransceiver.iceTransport.setRemoteCandidates(cands);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcands.forEach(function(candidate) {\r\n\t\t\t\t\t\t\t\tmaybeAddCandidate(transceiver.iceTransport, candidate);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tlocalCapabilities = window.RTCRtpReceiver.getCapabilities(kind);\r\n\t\r\n\t\t\t\t\t// filter RTX until additional stuff needed for RTX is implemented\r\n\t\t\t\t\t// in adapter.js\r\n\t\t\t\t\tif (edgeVersion < 15019) {\r\n\t\t\t\t\t\tlocalCapabilities.codecs = localCapabilities.codecs.filter(\r\n\t\t\t\t\t\t\t\tfunction(codec) {\r\n\t\t\t\t\t\t\t\t\treturn codec.name !== 'rtx';\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tsendEncodingParameters = transceiver.sendEncodingParameters || [{\r\n\t\t\t\t\t\tssrc: (2 * sdpMLineIndex + 2) * 1001\r\n\t\t\t\t\t}];\r\n\t\r\n\t\t\t\t\t// TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\r\n\t\t\t\t\tvar isNewTrack = false;\r\n\t\t\t\t\tif (direction === 'sendrecv' || direction === 'sendonly') {\r\n\t\t\t\t\t\tisNewTrack = !transceiver.rtpReceiver;\r\n\t\t\t\t\t\trtpReceiver = transceiver.rtpReceiver ||\r\n\t\t\t\t\t\t\t\tnew window.RTCRtpReceiver(transceiver.dtlsTransport, kind);\r\n\t\r\n\t\t\t\t\t\tif (isNewTrack) {\r\n\t\t\t\t\t\t\tvar stream;\r\n\t\t\t\t\t\t\ttrack = rtpReceiver.track;\r\n\t\t\t\t\t\t\t// FIXME: does not work with Plan B.\r\n\t\t\t\t\t\t\tif (remoteMsid && remoteMsid.stream === '-') {\r\n\t\t\t\t\t\t\t\t// no-op. a stream id of '-' means: no associated stream.\r\n\t\t\t\t\t\t\t} else if (remoteMsid) {\r\n\t\t\t\t\t\t\t\tif (!streams[remoteMsid.stream]) {\r\n\t\t\t\t\t\t\t\t\tstreams[remoteMsid.stream] = new window.MediaStream();\r\n\t\t\t\t\t\t\t\t\tObject.defineProperty(streams[remoteMsid.stream], 'id', {\r\n\t\t\t\t\t\t\t\t\t\tget: function() {\r\n\t\t\t\t\t\t\t\t\t\t\treturn remoteMsid.stream;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tObject.defineProperty(track, 'id', {\r\n\t\t\t\t\t\t\t\t\tget: function() {\r\n\t\t\t\t\t\t\t\t\t\treturn remoteMsid.track;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tstream = streams[remoteMsid.stream];\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (!streams.default) {\r\n\t\t\t\t\t\t\t\t\tstreams.default = new window.MediaStream();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tstream = streams.default;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (stream) {\r\n\t\t\t\t\t\t\t\taddTrackToStreamAndFireEvent(track, stream);\r\n\t\t\t\t\t\t\t\ttransceiver.associatedRemoteMediaStreams.push(stream);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treceiverList.push([track, rtpReceiver, stream]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (transceiver.rtpReceiver && transceiver.rtpReceiver.track) {\r\n\t\t\t\t\t\ttransceiver.associatedRemoteMediaStreams.forEach(function(s) {\r\n\t\t\t\t\t\t\tvar nativeTrack = s.getTracks().find(function(t) {\r\n\t\t\t\t\t\t\t\treturn t.id === transceiver.rtpReceiver.track.id;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif (nativeTrack) {\r\n\t\t\t\t\t\t\t\tremoveTrackFromStreamAndFireEvent(nativeTrack, s);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\ttransceiver.associatedRemoteMediaStreams = [];\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\ttransceiver.localCapabilities = localCapabilities;\r\n\t\t\t\t\ttransceiver.remoteCapabilities = remoteCapabilities;\r\n\t\t\t\t\ttransceiver.rtpReceiver = rtpReceiver;\r\n\t\t\t\t\ttransceiver.rtcpParameters = rtcpParameters;\r\n\t\t\t\t\ttransceiver.sendEncodingParameters = sendEncodingParameters;\r\n\t\t\t\t\ttransceiver.recvEncodingParameters = recvEncodingParameters;\r\n\t\r\n\t\t\t\t\t// Start the RTCRtpReceiver now. The RTPSender is started in\r\n\t\t\t\t\t// setLocalDescription.\r\n\t\t\t\t\tpc._transceive(pc.transceivers[sdpMLineIndex],\r\n\t\t\t\t\t\t\tfalse,\r\n\t\t\t\t\t\t\tisNewTrack);\r\n\t\t\t\t} else if (description.type === 'answer' && !rejected) {\r\n\t\t\t\t\ttransceiver = pc.transceivers[sdpMLineIndex];\r\n\t\t\t\t\ticeGatherer = transceiver.iceGatherer;\r\n\t\t\t\t\ticeTransport = transceiver.iceTransport;\r\n\t\t\t\t\tdtlsTransport = transceiver.dtlsTransport;\r\n\t\t\t\t\trtpReceiver = transceiver.rtpReceiver;\r\n\t\t\t\t\tsendEncodingParameters = transceiver.sendEncodingParameters;\r\n\t\t\t\t\tlocalCapabilities = transceiver.localCapabilities;\r\n\t\r\n\t\t\t\t\tpc.transceivers[sdpMLineIndex].recvEncodingParameters =\r\n\t\t\t\t\t\t\trecvEncodingParameters;\r\n\t\t\t\t\tpc.transceivers[sdpMLineIndex].remoteCapabilities =\r\n\t\t\t\t\t\t\tremoteCapabilities;\r\n\t\t\t\t\tpc.transceivers[sdpMLineIndex].rtcpParameters = rtcpParameters;\r\n\t\r\n\t\t\t\t\tif (cands.length && iceTransport.state === 'new') {\r\n\t\t\t\t\t\tif ((isIceLite || isComplete) &&\r\n\t\t\t\t\t\t\t\t(!usingBundle || sdpMLineIndex === 0)) {\r\n\t\t\t\t\t\t\ticeTransport.setRemoteCandidates(cands);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcands.forEach(function(candidate) {\r\n\t\t\t\t\t\t\t\tmaybeAddCandidate(transceiver.iceTransport, candidate);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tif (!usingBundle || sdpMLineIndex === 0) {\r\n\t\t\t\t\t\tif (iceTransport.state === 'new') {\r\n\t\t\t\t\t\t\ticeTransport.start(iceGatherer, remoteIceParameters,\r\n\t\t\t\t\t\t\t\t\t'controlling');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (dtlsTransport.state === 'new') {\r\n\t\t\t\t\t\t\tdtlsTransport.start(remoteDtlsParameters);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t// If the offer contained RTX but the answer did not,\r\n\t\t\t\t\t// remove RTX from sendEncodingParameters.\r\n\t\t\t\t\tvar commonCapabilities = getCommonCapabilities(\r\n\t\t\t\t\t\ttransceiver.localCapabilities,\r\n\t\t\t\t\t\ttransceiver.remoteCapabilities);\r\n\t\r\n\t\t\t\t\tvar hasRtx = commonCapabilities.codecs.filter(function(c) {\r\n\t\t\t\t\t\treturn c.name.toLowerCase() === 'rtx';\r\n\t\t\t\t\t}).length;\r\n\t\t\t\t\tif (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\r\n\t\t\t\t\t\tdelete transceiver.sendEncodingParameters[0].rtx;\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\tpc._transceive(transceiver,\r\n\t\t\t\t\t\t\tdirection === 'sendrecv' || direction === 'recvonly',\r\n\t\t\t\t\t\t\tdirection === 'sendrecv' || direction === 'sendonly');\r\n\t\r\n\t\t\t\t\t// TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\r\n\t\t\t\t\tif (rtpReceiver &&\r\n\t\t\t\t\t\t\t(direction === 'sendrecv' || direction === 'sendonly')) {\r\n\t\t\t\t\t\ttrack = rtpReceiver.track;\r\n\t\t\t\t\t\tif (remoteMsid) {\r\n\t\t\t\t\t\t\tif (!streams[remoteMsid.stream]) {\r\n\t\t\t\t\t\t\t\tstreams[remoteMsid.stream] = new window.MediaStream();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\taddTrackToStreamAndFireEvent(track, streams[remoteMsid.stream]);\r\n\t\t\t\t\t\t\treceiverList.push([track, rtpReceiver, streams[remoteMsid.stream]]);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (!streams.default) {\r\n\t\t\t\t\t\t\t\tstreams.default = new window.MediaStream();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\taddTrackToStreamAndFireEvent(track, streams.default);\r\n\t\t\t\t\t\t\treceiverList.push([track, rtpReceiver, streams.default]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// FIXME: actually the receiver should be created later.\r\n\t\t\t\t\t\tdelete transceiver.rtpReceiver;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\r\n\t\t\tif (pc._dtlsRole === undefined) {\r\n\t\t\t\tpc._dtlsRole = description.type === 'offer' ? 'active' : 'passive';\r\n\t\t\t}\r\n\t\r\n\t\t\tpc._remoteDescription = {\r\n\t\t\t\ttype: description.type,\r\n\t\t\t\tsdp: description.sdp\r\n\t\t\t};\r\n\t\t\tif (description.type === 'offer') {\r\n\t\t\t\tpc._updateSignalingState('have-remote-offer');\r\n\t\t\t} else {\r\n\t\t\t\tpc._updateSignalingState('stable');\r\n\t\t\t}\r\n\t\t\tObject.keys(streams).forEach(function(sid) {\r\n\t\t\t\tvar stream = streams[sid];\r\n\t\t\t\tif (stream.getTracks().length) {\r\n\t\t\t\t\tif (pc.remoteStreams.indexOf(stream) === -1) {\r\n\t\t\t\t\t\tpc.remoteStreams.push(stream);\r\n\t\t\t\t\t\tvar event = new Event('addstream');\r\n\t\t\t\t\t\tevent.stream = stream;\r\n\t\t\t\t\t\twindow.setTimeout(function() {\r\n\t\t\t\t\t\t\tpc._dispatchEvent('addstream', event);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\treceiverList.forEach(function(item) {\r\n\t\t\t\t\t\tvar track = item[0];\r\n\t\t\t\t\t\tvar receiver = item[1];\r\n\t\t\t\t\t\tif (stream.id !== item[2].id) {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfireAddTrack(pc, track, receiver, [stream]);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treceiverList.forEach(function(item) {\r\n\t\t\t\tif (item[2]) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tfireAddTrack(pc, item[0], item[1], []);\r\n\t\t\t});\r\n\t\r\n\t\t\t// check whether addIceCandidate({}) was called within four seconds after\r\n\t\t\t// setRemoteDescription.\r\n\t\t\twindow.setTimeout(function() {\r\n\t\t\t\tif (!(pc && pc.transceivers)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tpc.transceivers.forEach(function(transceiver) {\r\n\t\t\t\t\tif (transceiver.iceTransport &&\r\n\t\t\t\t\t\t\ttransceiver.iceTransport.state === 'new' &&\r\n\t\t\t\t\t\t\ttransceiver.iceTransport.getRemoteCandidates().length > 0) {\r\n\t\t\t\t\t\tconsole.warn('Timeout for addRemoteCandidate. Consider sending ' +\r\n\t\t\t\t\t\t\t\t'an end-of-candidates notification');\r\n\t\t\t\t\t\ttransceiver.iceTransport.addRemoteCandidate({});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}, 4000);\r\n\t\r\n\t\t\treturn Promise.resolve();\r\n\t\t};\r\n\t\r\n\t\tRTCPeerConnection.prototype.close = function() {\r\n\t\t\tthis.transceivers.forEach(function(transceiver) {\r\n\t\t\t\t/* not yet\r\n\t\t\t\tif (transceiver.iceGatherer) {\r\n\t\t\t\t\ttransceiver.iceGatherer.close();\r\n\t\t\t\t}\r\n\t\t\t\t*/\r\n\t\t\t\tif (transceiver.iceTransport) {\r\n\t\t\t\t\ttransceiver.iceTransport.stop();\r\n\t\t\t\t}\r\n\t\t\t\tif (transceiver.dtlsTransport) {\r\n\t\t\t\t\ttransceiver.dtlsTransport.stop();\r\n\t\t\t\t}\r\n\t\t\t\tif (transceiver.rtpSender) {\r\n\t\t\t\t\ttransceiver.rtpSender.stop();\r\n\t\t\t\t}\r\n\t\t\t\tif (transceiver.rtpReceiver) {\r\n\t\t\t\t\ttransceiver.rtpReceiver.stop();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t// FIXME: clean up tracks, local streams, remote streams, etc\r\n\t\t\tthis._isClosed = true;\r\n\t\t\tthis._updateSignalingState('closed');\r\n\t\t};\r\n\t\r\n\t\t// Update the signaling state.\r\n\t\tRTCPeerConnection.prototype._updateSignalingState = function(newState) {\r\n\t\t\tthis.signalingState = newState;\r\n\t\t\tvar event = new Event('signalingstatechange');\r\n\t\t\tthis._dispatchEvent('signalingstatechange', event);\r\n\t\t};\r\n\t\r\n\t\t// Determine whether to fire the negotiationneeded event.\r\n\t\tRTCPeerConnection.prototype._maybeFireNegotiationNeeded = function() {\r\n\t\t\tvar pc = this;\r\n\t\t\tif (this.signalingState !== 'stable' || this.needNegotiation === true) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.needNegotiation = true;\r\n\t\t\twindow.setTimeout(function() {\r\n\t\t\t\tif (pc.needNegotiation) {\r\n\t\t\t\t\tpc.needNegotiation = false;\r\n\t\t\t\t\tvar event = new Event('negotiationneeded');\r\n\t\t\t\t\tpc._dispatchEvent('negotiationneeded', event);\r\n\t\t\t\t}\r\n\t\t\t}, 0);\r\n\t\t};\r\n\t\r\n\t\t// Update the ice connection state.\r\n\t\tRTCPeerConnection.prototype._updateIceConnectionState = function() {\r\n\t\t\tvar newState;\r\n\t\t\tvar states = {\r\n\t\t\t\t'new': 0,\r\n\t\t\t\tclosed: 0,\r\n\t\t\t\tchecking: 0,\r\n\t\t\t\tconnected: 0,\r\n\t\t\t\tcompleted: 0,\r\n\t\t\t\tdisconnected: 0,\r\n\t\t\t\tfailed: 0\r\n\t\t\t};\r\n\t\t\tthis.transceivers.forEach(function(transceiver) {\r\n\t\t\t\tif (transceiver.iceTransport && !transceiver.rejected) {\r\n\t\t\t\t\tstates[transceiver.iceTransport.state]++;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\r\n\t\t\tnewState = 'new';\r\n\t\t\tif (states.failed > 0) {\r\n\t\t\t\tnewState = 'failed';\r\n\t\t\t} else if (states.checking > 0) {\r\n\t\t\t\tnewState = 'checking';\r\n\t\t\t} else if (states.disconnected > 0) {\r\n\t\t\t\tnewState = 'disconnected';\r\n\t\t\t} else if (states.new > 0) {\r\n\t\t\t\tnewState = 'new';\r\n\t\t\t} else if (states.connected > 0) {\r\n\t\t\t\tnewState = 'connected';\r\n\t\t\t} else if (states.completed > 0) {\r\n\t\t\t\tnewState = 'completed';\r\n\t\t\t}\r\n\t\r\n\t\t\tif (newState !== this.iceConnectionState) {\r\n\t\t\t\tthis.iceConnectionState = newState;\r\n\t\t\t\tvar event = new Event('iceconnectionstatechange');\r\n\t\t\t\tthis._dispatchEvent('iceconnectionstatechange', event);\r\n\t\t\t}\r\n\t\t};\r\n\t\r\n\t\t// Update the connection state.\r\n\t\tRTCPeerConnection.prototype._updateConnectionState = function() {\r\n\t\t\tvar newState;\r\n\t\t\tvar states = {\r\n\t\t\t\t'new': 0,\r\n\t\t\t\tclosed: 0,\r\n\t\t\t\tconnecting: 0,\r\n\t\t\t\tconnected: 0,\r\n\t\t\t\tcompleted: 0,\r\n\t\t\t\tdisconnected: 0,\r\n\t\t\t\tfailed: 0\r\n\t\t\t};\r\n\t\t\tthis.transceivers.forEach(function(transceiver) {\r\n\t\t\t\tif (transceiver.iceTransport && transceiver.dtlsTransport &&\r\n\t\t\t\t\t\t!transceiver.rejected) {\r\n\t\t\t\t\tstates[transceiver.iceTransport.state]++;\r\n\t\t\t\t\tstates[transceiver.dtlsTransport.state]++;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t// ICETransport.completed and connected are the same for this purpose.\r\n\t\t\tstates.connected += states.completed;\r\n\t\r\n\t\t\tnewState = 'new';\r\n\t\t\tif (states.failed > 0) {\r\n\t\t\t\tnewState = 'failed';\r\n\t\t\t} else if (states.connecting > 0) {\r\n\t\t\t\tnewState = 'connecting';\r\n\t\t\t} else if (states.disconnected > 0) {\r\n\t\t\t\tnewState = 'disconnected';\r\n\t\t\t} else if (states.new > 0) {\r\n\t\t\t\tnewState = 'new';\r\n\t\t\t} else if (states.connected > 0) {\r\n\t\t\t\tnewState = 'connected';\r\n\t\t\t}\r\n\t\r\n\t\t\tif (newState !== this.connectionState) {\r\n\t\t\t\tthis.connectionState = newState;\r\n\t\t\t\tvar event = new Event('connectionstatechange');\r\n\t\t\t\tthis._dispatchEvent('connectionstatechange', event);\r\n\t\t\t}\r\n\t\t};\r\n\t\r\n\t\tRTCPeerConnection.prototype.createOffer = function() {\r\n\t\t\tvar pc = this;\r\n\t\r\n\t\t\tif (pc._isClosed) {\r\n\t\t\t\treturn Promise.reject(makeError('InvalidStateError',\r\n\t\t\t\t\t\t'Can not call createOffer after close'));\r\n\t\t\t}\r\n\t\r\n\t\t\tvar numAudioTracks = pc.transceivers.filter(function(t) {\r\n\t\t\t\treturn t.kind === 'audio';\r\n\t\t\t}).length;\r\n\t\t\tvar numVideoTracks = pc.transceivers.filter(function(t) {\r\n\t\t\t\treturn t.kind === 'video';\r\n\t\t\t}).length;\r\n\t\r\n\t\t\t// Determine number of audio and video tracks we need to send/recv.\r\n\t\t\tvar offerOptions = arguments[0];\r\n\t\t\tif (offerOptions) {\r\n\t\t\t\t// Reject Chrome legacy constraints.\r\n\t\t\t\tif (offerOptions.mandatory || offerOptions.optional) {\r\n\t\t\t\t\tthrow new TypeError(\r\n\t\t\t\t\t\t\t'Legacy mandatory/optional constraints not supported.');\r\n\t\t\t\t}\r\n\t\t\t\tif (offerOptions.offerToReceiveAudio !== undefined) {\r\n\t\t\t\t\tif (offerOptions.offerToReceiveAudio === true) {\r\n\t\t\t\t\t\tnumAudioTracks = 1;\r\n\t\t\t\t\t} else if (offerOptions.offerToReceiveAudio === false) {\r\n\t\t\t\t\t\tnumAudioTracks = 0;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnumAudioTracks = offerOptions.offerToReceiveAudio;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (offerOptions.offerToReceiveVideo !== undefined) {\r\n\t\t\t\t\tif (offerOptions.offerToReceiveVideo === true) {\r\n\t\t\t\t\t\tnumVideoTracks = 1;\r\n\t\t\t\t\t} else if (offerOptions.offerToReceiveVideo === false) {\r\n\t\t\t\t\t\tnumVideoTracks = 0;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnumVideoTracks = offerOptions.offerToReceiveVideo;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\r\n\t\t\tpc.transceivers.forEach(function(transceiver) {\r\n\t\t\t\tif (transceiver.kind === 'audio') {\r\n\t\t\t\t\tnumAudioTracks--;\r\n\t\t\t\t\tif (numAudioTracks < 0) {\r\n\t\t\t\t\t\ttransceiver.wantReceive = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (transceiver.kind === 'video') {\r\n\t\t\t\t\tnumVideoTracks--;\r\n\t\t\t\t\tif (numVideoTracks < 0) {\r\n\t\t\t\t\t\ttransceiver.wantReceive = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\r\n\t\t\t// Create M-lines for recvonly streams.\r\n\t\t\twhile (numAudioTracks > 0 || numVideoTracks > 0) {\r\n\t\t\t\tif (numAudioTracks > 0) {\r\n\t\t\t\t\tpc._createTransceiver('audio');\r\n\t\t\t\t\tnumAudioTracks--;\r\n\t\t\t\t}\r\n\t\t\t\tif (numVideoTracks > 0) {\r\n\t\t\t\t\tpc._createTransceiver('video');\r\n\t\t\t\t\tnumVideoTracks--;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\r\n\t\t\tvar sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\r\n\t\t\t\t\tpc._sdpSessionVersion++);\r\n\t\t\tpc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\r\n\t\t\t\t// For each track, create an ice gatherer, ice transport,\r\n\t\t\t\t// dtls transport, potentially rtpsender and rtpreceiver.\r\n\t\t\t\tvar track = transceiver.track;\r\n\t\t\t\tvar kind = transceiver.kind;\r\n\t\t\t\tvar mid = transceiver.mid || SDPUtils.generateIdentifier();\r\n\t\t\t\ttransceiver.mid = mid;\r\n\t\r\n\t\t\t\tif (!transceiver.iceGatherer) {\r\n\t\t\t\t\ttransceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\r\n\t\t\t\t\t\t\tpc.usingBundle);\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar localCapabilities = window.RTCRtpSender.getCapabilities(kind);\r\n\t\t\t\t// filter RTX until additional stuff needed for RTX is implemented\r\n\t\t\t\t// in adapter.js\r\n\t\t\t\tif (edgeVersion < 15019) {\r\n\t\t\t\t\tlocalCapabilities.codecs = localCapabilities.codecs.filter(\r\n\t\t\t\t\t\t\tfunction(codec) {\r\n\t\t\t\t\t\t\t\treturn codec.name !== 'rtx';\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tlocalCapabilities.codecs.forEach(function(codec) {\r\n\t\t\t\t\t// work around https://bugs.chromium.org/p/webrtc/issues/detail?id=6552\r\n\t\t\t\t\t// by adding level-asymmetry-allowed=1\r\n\t\t\t\t\tif (codec.name === 'H264' &&\r\n\t\t\t\t\t\t\tcodec.parameters['level-asymmetry-allowed'] === undefined) {\r\n\t\t\t\t\t\tcodec.parameters['level-asymmetry-allowed'] = '1';\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t// for subsequent offers, we might have to re-use the payload\r\n\t\t\t\t\t// type of the last offer.\r\n\t\t\t\t\tif (transceiver.remoteCapabilities &&\r\n\t\t\t\t\t\t\ttransceiver.remoteCapabilities.codecs) {\r\n\t\t\t\t\t\ttransceiver.remoteCapabilities.codecs.forEach(function(remoteCodec) {\r\n\t\t\t\t\t\t\tif (codec.name.toLowerCase() === remoteCodec.name.toLowerCase() &&\r\n\t\t\t\t\t\t\t\t\tcodec.clockRate === remoteCodec.clockRate) {\r\n\t\t\t\t\t\t\t\tcodec.preferredPayloadType = remoteCodec.payloadType;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tlocalCapabilities.headerExtensions.forEach(function(hdrExt) {\r\n\t\t\t\t\tvar remoteExtensions = transceiver.remoteCapabilities &&\r\n\t\t\t\t\t\t\ttransceiver.remoteCapabilities.headerExtensions || [];\r\n\t\t\t\t\tremoteExtensions.forEach(function(rHdrExt) {\r\n\t\t\t\t\t\tif (hdrExt.uri === rHdrExt.uri) {\r\n\t\t\t\t\t\t\thdrExt.id = rHdrExt.id;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\r\n\t\t\t\t// generate an ssrc now, to be used later in rtpSender.send\r\n\t\t\t\tvar sendEncodingParameters = transceiver.sendEncodingParameters || [{\r\n\t\t\t\t\tssrc: (2 * sdpMLineIndex + 1) * 1001\r\n\t\t\t\t}];\r\n\t\t\t\tif (track) {\r\n\t\t\t\t\t// add RTX\r\n\t\t\t\t\tif (edgeVersion >= 15019 && kind === 'video' &&\r\n\t\t\t\t\t\t\t!sendEncodingParameters[0].rtx) {\r\n\t\t\t\t\t\tsendEncodingParameters[0].rtx = {\r\n\t\t\t\t\t\t\tssrc: sendEncodingParameters[0].ssrc + 1\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif (transceiver.wantReceive) {\r\n\t\t\t\t\ttransceiver.rtpReceiver = new window.RTCRtpReceiver(\r\n\t\t\t\t\t\t\ttransceiver.dtlsTransport, kind);\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\ttransceiver.localCapabilities = localCapabilities;\r\n\t\t\t\ttransceiver.sendEncodingParameters = sendEncodingParameters;\r\n\t\t\t});\r\n\t\r\n\t\t\t// always offer BUNDLE and dispose on return if not supported.\r\n\t\t\tif (pc._config.bundlePolicy !== 'max-compat') {\r\n\t\t\t\tsdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\r\n\t\t\t\t\treturn t.mid;\r\n\t\t\t\t}).join(' ') + '\\r\\n';\r\n\t\t\t}\r\n\t\t\tsdp += 'a=ice-options:trickle\\r\\n';\r\n\t\r\n\t\t\tpc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\r\n\t\t\t\tsdp += writeMediaSection(transceiver, transceiver.localCapabilities,\r\n\t\t\t\t\t\t'offer', transceiver.stream, pc._dtlsRole);\r\n\t\t\t\tsdp += 'a=rtcp-rsize\\r\\n';\r\n\t\r\n\t\t\t\tif (transceiver.iceGatherer && pc.iceGatheringState !== 'new' &&\r\n\t\t\t\t\t\t(sdpMLineIndex === 0 || !pc.usingBundle)) {\r\n\t\t\t\t\ttransceiver.iceGatherer.getLocalCandidates().forEach(function(cand) {\r\n\t\t\t\t\t\tcand.component = 1;\r\n\t\t\t\t\t\tsdp += 'a=' + SDPUtils.writeCandidate(cand) + '\\r\\n';\r\n\t\t\t\t\t});\r\n\t\r\n\t\t\t\t\tif (transceiver.iceGatherer.state === 'completed') {\r\n\t\t\t\t\t\tsdp += 'a=end-of-candidates\\r\\n';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\r\n\t\t\tvar desc = new window.RTCSessionDescription({\r\n\t\t\t\ttype: 'offer',\r\n\t\t\t\tsdp: sdp\r\n\t\t\t});\r\n\t\t\treturn Promise.resolve(desc);\r\n\t\t};\r\n\t\r\n\t\tRTCPeerConnection.prototype.createAnswer = function() {\r\n\t\t\tvar pc = this;\r\n\t\r\n\t\t\tif (pc._isClosed) {\r\n\t\t\t\treturn Promise.reject(makeError('InvalidStateError',\r\n\t\t\t\t\t\t'Can not call createAnswer after close'));\r\n\t\t\t}\r\n\t\r\n\t\t\tif (!(pc.signalingState === 'have-remote-offer' ||\r\n\t\t\t\t\tpc.signalingState === 'have-local-pranswer')) {\r\n\t\t\t\treturn Promise.reject(makeError('InvalidStateError',\r\n\t\t\t\t\t\t'Can not call createAnswer in signalingState ' + pc.signalingState));\r\n\t\t\t}\r\n\t\r\n\t\t\tvar sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\r\n\t\t\t\t\tpc._sdpSessionVersion++);\r\n\t\t\tif (pc.usingBundle) {\r\n\t\t\t\tsdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\r\n\t\t\t\t\treturn t.mid;\r\n\t\t\t\t}).join(' ') + '\\r\\n';\r\n\t\t\t}\r\n\t\t\tsdp += 'a=ice-options:trickle\\r\\n';\r\n\t\r\n\t\t\tvar mediaSectionsInOffer = SDPUtils.getMediaSections(\r\n\t\t\t\t\tpc._remoteDescription.sdp).length;\r\n\t\t\tpc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\r\n\t\t\t\tif (sdpMLineIndex + 1 > mediaSectionsInOffer) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (transceiver.rejected) {\r\n\t\t\t\t\tif (transceiver.kind === 'application') {\r\n\t\t\t\t\t\tif (transceiver.protocol === 'DTLS/SCTP') { // legacy fmt\r\n\t\t\t\t\t\t\tsdp += 'm=application 0 DTLS/SCTP 5000\\r\\n';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tsdp += 'm=application 0 ' + transceiver.protocol +\r\n\t\t\t\t\t\t\t\t\t' webrtc-datachannel\\r\\n';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (transceiver.kind === 'audio') {\r\n\t\t\t\t\t\tsdp += 'm=audio 0 UDP/TLS/RTP/SAVPF 0\\r\\n' +\r\n\t\t\t\t\t\t\t\t'a=rtpmap:0 PCMU/8000\\r\\n';\r\n\t\t\t\t\t} else if (transceiver.kind === 'video') {\r\n\t\t\t\t\t\tsdp += 'm=video 0 UDP/TLS/RTP/SAVPF 120\\r\\n' +\r\n\t\t\t\t\t\t\t\t'a=rtpmap:120 VP8/90000\\r\\n';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsdp += 'c=IN IP4 0.0.0.0\\r\\n' +\r\n\t\t\t\t\t\t\t'a=inactive\\r\\n' +\r\n\t\t\t\t\t\t\t'a=mid:' + transceiver.mid + '\\r\\n';\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// FIXME: look at direction.\r\n\t\t\t\tif (transceiver.stream) {\r\n\t\t\t\t\tvar localTrack;\r\n\t\t\t\t\tif (transceiver.kind === 'audio') {\r\n\t\t\t\t\t\tlocalTrack = transceiver.stream.getAudioTracks()[0];\r\n\t\t\t\t\t} else if (transceiver.kind === 'video') {\r\n\t\t\t\t\t\tlocalTrack = transceiver.stream.getVideoTracks()[0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (localTrack) {\r\n\t\t\t\t\t\t// add RTX\r\n\t\t\t\t\t\tif (edgeVersion >= 15019 && transceiver.kind === 'video' &&\r\n\t\t\t\t\t\t\t\t!transceiver.sendEncodingParameters[0].rtx) {\r\n\t\t\t\t\t\t\ttransceiver.sendEncodingParameters[0].rtx = {\r\n\t\t\t\t\t\t\t\tssrc: transceiver.sendEncodingParameters[0].ssrc + 1\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t// Calculate intersection of capabilities.\r\n\t\t\t\tvar commonCapabilities = getCommonCapabilities(\r\n\t\t\t\t\t\ttransceiver.localCapabilities,\r\n\t\t\t\t\t\ttransceiver.remoteCapabilities);\r\n\t\r\n\t\t\t\tvar hasRtx = commonCapabilities.codecs.filter(function(c) {\r\n\t\t\t\t\treturn c.name.toLowerCase() === 'rtx';\r\n\t\t\t\t}).length;\r\n\t\t\t\tif (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\r\n\t\t\t\t\tdelete transceiver.sendEncodingParameters[0].rtx;\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tsdp += writeMediaSection(transceiver, commonCapabilities,\r\n\t\t\t\t\t\t'answer', transceiver.stream, pc._dtlsRole);\r\n\t\t\t\tif (transceiver.rtcpParameters &&\r\n\t\t\t\t\t\ttransceiver.rtcpParameters.reducedSize) {\r\n\t\t\t\t\tsdp += 'a=rtcp-rsize\\r\\n';\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\r\n\t\t\tvar desc = new window.RTCSessionDescription({\r\n\t\t\t\ttype: 'answer',\r\n\t\t\t\tsdp: sdp\r\n\t\t\t});\r\n\t\t\treturn Promise.resolve(desc);\r\n\t\t};\r\n\t\r\n\t\tRTCPeerConnection.prototype.addIceCandidate = function(candidate) {\r\n\t\t\tvar pc = this;\r\n\t\t\tvar sections;\r\n\t\t\tif (candidate && !(candidate.sdpMLineIndex !== undefined ||\r\n\t\t\t\t\tcandidate.sdpMid)) {\r\n\t\t\t\treturn Promise.reject(new TypeError('sdpMLineIndex or sdpMid required'));\r\n\t\t\t}\r\n\t\r\n\t\t\t// TODO: needs to go into ops queue.\r\n\t\t\treturn new Promise(function(resolve, reject) {\r\n\t\t\t\tif (!pc._remoteDescription) {\r\n\t\t\t\t\treturn reject(makeError('InvalidStateError',\r\n\t\t\t\t\t\t\t'Can not add ICE candidate without a remote description'));\r\n\t\t\t\t} else if (!candidate || candidate.candidate === '') {\r\n\t\t\t\t\tfor (var j = 0; j < pc.transceivers.length; j++) {\r\n\t\t\t\t\t\tif (pc.transceivers[j].rejected) {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tpc.transceivers[j].iceTransport.addRemoteCandidate({});\r\n\t\t\t\t\t\tsections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\r\n\t\t\t\t\t\tsections[j] += 'a=end-of-candidates\\r\\n';\r\n\t\t\t\t\t\tpc._remoteDescription.sdp =\r\n\t\t\t\t\t\t\t\tSDPUtils.getDescription(pc._remoteDescription.sdp) +\r\n\t\t\t\t\t\t\t\tsections.join('');\r\n\t\t\t\t\t\tif (pc.usingBundle) {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar sdpMLineIndex = candidate.sdpMLineIndex;\r\n\t\t\t\t\tif (candidate.sdpMid) {\r\n\t\t\t\t\t\tfor (var i = 0; i < pc.transceivers.length; i++) {\r\n\t\t\t\t\t\t\tif (pc.transceivers[i].mid === candidate.sdpMid) {\r\n\t\t\t\t\t\t\t\tsdpMLineIndex = i;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar transceiver = pc.transceivers[sdpMLineIndex];\r\n\t\t\t\t\tif (transceiver) {\r\n\t\t\t\t\t\tif (transceiver.rejected) {\r\n\t\t\t\t\t\t\treturn resolve();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar cand = Object.keys(candidate.candidate).length > 0 ?\r\n\t\t\t\t\t\t\t\tSDPUtils.parseCandidate(candidate.candidate) : {};\r\n\t\t\t\t\t\t// Ignore Chrome's invalid candidates since Edge does not like them.\r\n\t\t\t\t\t\tif (cand.protocol === 'tcp' && (cand.port === 0 || cand.port === 9)) {\r\n\t\t\t\t\t\t\treturn resolve();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Ignore RTCP candidates, we assume RTCP-MUX.\r\n\t\t\t\t\t\tif (cand.component && cand.component !== 1) {\r\n\t\t\t\t\t\t\treturn resolve();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// when using bundle, avoid adding candidates to the wrong\r\n\t\t\t\t\t\t// ice transport. And avoid adding candidates added in the SDP.\r\n\t\t\t\t\t\tif (sdpMLineIndex === 0 || (sdpMLineIndex > 0 &&\r\n\t\t\t\t\t\t\t\ttransceiver.iceTransport !== pc.transceivers[0].iceTransport)) {\r\n\t\t\t\t\t\t\tif (!maybeAddCandidate(transceiver.iceTransport, cand)) {\r\n\t\t\t\t\t\t\t\treturn reject(makeError('OperationError',\r\n\t\t\t\t\t\t\t\t\t\t'Can not add ICE candidate'));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t// update the remoteDescription.\r\n\t\t\t\t\t\tvar candidateString = candidate.candidate.trim();\r\n\t\t\t\t\t\tif (candidateString.indexOf('a=') === 0) {\r\n\t\t\t\t\t\t\tcandidateString = candidateString.substr(2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\r\n\t\t\t\t\t\tsections[sdpMLineIndex] += 'a=' +\r\n\t\t\t\t\t\t\t\t(cand.type ? candidateString : 'end-of-candidates')\r\n\t\t\t\t\t\t\t\t+ '\\r\\n';\r\n\t\t\t\t\t\tpc._remoteDescription.sdp =\r\n\t\t\t\t\t\t\t\tSDPUtils.getDescription(pc._remoteDescription.sdp) +\r\n\t\t\t\t\t\t\t\tsections.join('');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn reject(makeError('OperationError',\r\n\t\t\t\t\t\t\t\t'Can not add ICE candidate'));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tresolve();\r\n\t\t\t});\r\n\t\t};\r\n\t\r\n\t\tRTCPeerConnection.prototype.getStats = function(selector) {\r\n\t\t\tif (selector && selector instanceof window.MediaStreamTrack) {\r\n\t\t\t\tvar senderOrReceiver = null;\r\n\t\t\t\tthis.transceivers.forEach(function(transceiver) {\r\n\t\t\t\t\tif (transceiver.rtpSender &&\r\n\t\t\t\t\t\t\ttransceiver.rtpSender.track === selector) {\r\n\t\t\t\t\t\tsenderOrReceiver = transceiver.rtpSender;\r\n\t\t\t\t\t} else if (transceiver.rtpReceiver &&\r\n\t\t\t\t\t\t\ttransceiver.rtpReceiver.track === selector) {\r\n\t\t\t\t\t\tsenderOrReceiver = transceiver.rtpReceiver;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (!senderOrReceiver) {\r\n\t\t\t\t\tthrow makeError('InvalidAccessError', 'Invalid selector.');\r\n\t\t\t\t}\r\n\t\t\t\treturn senderOrReceiver.getStats();\r\n\t\t\t}\r\n\t\r\n\t\t\tvar promises = [];\r\n\t\t\tthis.transceivers.forEach(function(transceiver) {\r\n\t\t\t\t['rtpSender', 'rtpReceiver', 'iceGatherer', 'iceTransport',\r\n\t\t\t\t\t\t'dtlsTransport'].forEach(function(method) {\r\n\t\t\t\t\t\t\tif (transceiver[method]) {\r\n\t\t\t\t\t\t\t\tpromises.push(transceiver[method].getStats());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t});\r\n\t\t\treturn Promise.all(promises).then(function(allStats) {\r\n\t\t\t\tvar results = new Map();\r\n\t\t\t\tallStats.forEach(function(stats) {\r\n\t\t\t\t\tstats.forEach(function(stat) {\r\n\t\t\t\t\t\tresults.set(stat.id, stat);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\treturn results;\r\n\t\t\t});\r\n\t\t};\r\n\t\r\n\t\t// fix low-level stat names and return Map instead of object.\r\n\t\tvar ortcObjects = ['RTCRtpSender', 'RTCRtpReceiver', 'RTCIceGatherer',\r\n\t\t\t'RTCIceTransport', 'RTCDtlsTransport'];\r\n\t\tortcObjects.forEach(function(ortcObjectName) {\r\n\t\t\tvar obj = window[ortcObjectName];\r\n\t\t\tif (obj && obj.prototype && obj.prototype.getStats) {\r\n\t\t\t\tvar nativeGetstats = obj.prototype.getStats;\r\n\t\t\t\tobj.prototype.getStats = function() {\r\n\t\t\t\t\treturn nativeGetstats.apply(this)\r\n\t\t\t\t\t.then(function(nativeStats) {\r\n\t\t\t\t\t\tvar mapStats = new Map();\r\n\t\t\t\t\t\tObject.keys(nativeStats).forEach(function(id) {\r\n\t\t\t\t\t\t\tnativeStats[id].type = fixStatsType(nativeStats[id]);\r\n\t\t\t\t\t\t\tmapStats.set(id, nativeStats[id]);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn mapStats;\r\n\t\t\t\t\t});\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t});\r\n\t\r\n\t\t// legacy callback shims. Should be moved to adapter.js some days.\r\n\t\tvar methods = ['createOffer', 'createAnswer'];\r\n\t\tmethods.forEach(function(method) {\r\n\t\t\tvar nativeMethod = RTCPeerConnection.prototype[method];\r\n\t\t\tRTCPeerConnection.prototype[method] = function() {\r\n\t\t\t\tvar args = arguments;\r\n\t\t\t\tif (typeof args[0] === 'function' ||\r\n\t\t\t\t\t\ttypeof args[1] === 'function') { // legacy\r\n\t\t\t\t\treturn nativeMethod.apply(this, [arguments[2]])\r\n\t\t\t\t\t.then(function(description) {\r\n\t\t\t\t\t\tif (typeof args[0] === 'function') {\r\n\t\t\t\t\t\t\targs[0].apply(null, [description]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, function(error) {\r\n\t\t\t\t\t\tif (typeof args[1] === 'function') {\r\n\t\t\t\t\t\t\targs[1].apply(null, [error]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\treturn nativeMethod.apply(this, arguments);\r\n\t\t\t};\r\n\t\t});\r\n\t\r\n\t\tmethods = ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'];\r\n\t\tmethods.forEach(function(method) {\r\n\t\t\tvar nativeMethod = RTCPeerConnection.prototype[method];\r\n\t\t\tRTCPeerConnection.prototype[method] = function() {\r\n\t\t\t\tvar args = arguments;\r\n\t\t\t\tif (typeof args[1] === 'function' ||\r\n\t\t\t\t\t\ttypeof args[2] === 'function') { // legacy\r\n\t\t\t\t\treturn nativeMethod.apply(this, arguments)\r\n\t\t\t\t\t.then(function() {\r\n\t\t\t\t\t\tif (typeof args[1] === 'function') {\r\n\t\t\t\t\t\t\targs[1].apply(null);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, function(error) {\r\n\t\t\t\t\t\tif (typeof args[2] === 'function') {\r\n\t\t\t\t\t\t\targs[2].apply(null, [error]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\treturn nativeMethod.apply(this, arguments);\r\n\t\t\t};\r\n\t\t});\r\n\t\r\n\t\t// getStats is special. It doesn't have a spec legacy method yet we support\r\n\t\t// getStats(something, cb) without error callbacks.\r\n\t\t['getStats'].forEach(function(method) {\r\n\t\t\tvar nativeMethod = RTCPeerConnection.prototype[method];\r\n\t\t\tRTCPeerConnection.prototype[method] = function() {\r\n\t\t\t\tvar args = arguments;\r\n\t\t\t\tif (typeof args[1] === 'function') {\r\n\t\t\t\t\treturn nativeMethod.apply(this, arguments)\r\n\t\t\t\t\t.then(function() {\r\n\t\t\t\t\t\tif (typeof args[1] === 'function') {\r\n\t\t\t\t\t\t\targs[1].apply(null);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\treturn nativeMethod.apply(this, arguments);\r\n\t\t\t};\r\n\t\t});\r\n\t\r\n\t\treturn RTCPeerConnection;\r\n\t};\r\n\t\r\n\t},{\"sdp\":17}],17:[function(require,module,exports){\r\n\t/* eslint-env node */\r\n\t'use strict';\r\n\t\r\n\t// SDP helpers.\r\n\tvar SDPUtils = {};\r\n\t\r\n\t// Generate an alphanumeric identifier for cname or mids.\r\n\t// TODO: use UUIDs instead? https://gist.github.com/jed/982883\r\n\tSDPUtils.generateIdentifier = function() {\r\n\t\treturn Math.random().toString(36).substr(2, 10);\r\n\t};\r\n\t\r\n\t// The RTCP CNAME used by all peerconnections from the same JS.\r\n\tSDPUtils.localCName = SDPUtils.generateIdentifier();\r\n\t\r\n\t// Splits SDP into lines, dealing with both CRLF and LF.\r\n\tSDPUtils.splitLines = function(blob) {\r\n\t\treturn blob.trim().split('\\n').map(function(line) {\r\n\t\t\treturn line.trim();\r\n\t\t});\r\n\t};\r\n\t// Splits SDP into sessionpart and mediasections. Ensures CRLF.\r\n\tSDPUtils.splitSections = function(blob) {\r\n\t\tvar parts = blob.split('\\nm=');\r\n\t\treturn parts.map(function(part, index) {\r\n\t\t\treturn (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\r\n\t\t});\r\n\t};\r\n\t\r\n\t// returns the session description.\r\n\tSDPUtils.getDescription = function(blob) {\r\n\t\tvar sections = SDPUtils.splitSections(blob);\r\n\t\treturn sections && sections[0];\r\n\t};\r\n\t\r\n\t// returns the individual media sections.\r\n\tSDPUtils.getMediaSections = function(blob) {\r\n\t\tvar sections = SDPUtils.splitSections(blob);\r\n\t\tsections.shift();\r\n\t\treturn sections;\r\n\t};\r\n\t\r\n\t// Returns lines that start with a certain prefix.\r\n\tSDPUtils.matchPrefix = function(blob, prefix) {\r\n\t\treturn SDPUtils.splitLines(blob).filter(function(line) {\r\n\t\t\treturn line.indexOf(prefix) === 0;\r\n\t\t});\r\n\t};\r\n\t\r\n\t// Parses an ICE candidate line. Sample input:\r\n\t// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\r\n\t// rport 55996\"\r\n\tSDPUtils.parseCandidate = function(line) {\r\n\t\tvar parts;\r\n\t\t// Parse both variants.\r\n\t\tif (line.indexOf('a=candidate:') === 0) {\r\n\t\t\tparts = line.substring(12).split(' ');\r\n\t\t} else {\r\n\t\t\tparts = line.substring(10).split(' ');\r\n\t\t}\r\n\t\r\n\t\tvar candidate = {\r\n\t\t\tfoundation: parts[0],\r\n\t\t\tcomponent: parseInt(parts[1], 10),\r\n\t\t\tprotocol: parts[2].toLowerCase(),\r\n\t\t\tpriority: parseInt(parts[3], 10),\r\n\t\t\tip: parts[4],\r\n\t\t\taddress: parts[4], // address is an alias for ip.\r\n\t\t\tport: parseInt(parts[5], 10),\r\n\t\t\t// skip parts[6] == 'typ'\r\n\t\t\ttype: parts[7]\r\n\t\t};\r\n\t\r\n\t\tfor (var i = 8; i < parts.length; i += 2) {\r\n\t\t\tswitch (parts[i]) {\r\n\t\t\t\tcase 'raddr':\r\n\t\t\t\t\tcandidate.relatedAddress = parts[i + 1];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'rport':\r\n\t\t\t\t\tcandidate.relatedPort = parseInt(parts[i + 1], 10);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'tcptype':\r\n\t\t\t\t\tcandidate.tcpType = parts[i + 1];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ufrag':\r\n\t\t\t\t\tcandidate.ufrag = parts[i + 1]; // for backward compability.\r\n\t\t\t\t\tcandidate.usernameFragment = parts[i + 1];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault: // extension handling, in particular ufrag\r\n\t\t\t\t\tcandidate[parts[i]] = parts[i + 1];\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn candidate;\r\n\t};\r\n\t\r\n\t// Translates a candidate object into SDP candidate attribute.\r\n\tSDPUtils.writeCandidate = function(candidate) {\r\n\t\tvar sdp = [];\r\n\t\tsdp.push(candidate.foundation);\r\n\t\tsdp.push(candidate.component);\r\n\t\tsdp.push(candidate.protocol.toUpperCase());\r\n\t\tsdp.push(candidate.priority);\r\n\t\tsdp.push(candidate.address || candidate.ip);\r\n\t\tsdp.push(candidate.port);\r\n\t\r\n\t\tvar type = candidate.type;\r\n\t\tsdp.push('typ');\r\n\t\tsdp.push(type);\r\n\t\tif (type !== 'host' && candidate.relatedAddress &&\r\n\t\t\t\tcandidate.relatedPort) {\r\n\t\t\tsdp.push('raddr');\r\n\t\t\tsdp.push(candidate.relatedAddress);\r\n\t\t\tsdp.push('rport');\r\n\t\t\tsdp.push(candidate.relatedPort);\r\n\t\t}\r\n\t\tif (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\r\n\t\t\tsdp.push('tcptype');\r\n\t\t\tsdp.push(candidate.tcpType);\r\n\t\t}\r\n\t\tif (candidate.usernameFragment || candidate.ufrag) {\r\n\t\t\tsdp.push('ufrag');\r\n\t\t\tsdp.push(candidate.usernameFragment || candidate.ufrag);\r\n\t\t}\r\n\t\treturn 'candidate:' + sdp.join(' ');\r\n\t};\r\n\t\r\n\t// Parses an ice-options line, returns an array of option tags.\r\n\t// a=ice-options:foo bar\r\n\tSDPUtils.parseIceOptions = function(line) {\r\n\t\treturn line.substr(14).split(' ');\r\n\t};\r\n\t\r\n\t// Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\r\n\t// a=rtpmap:111 opus/48000/2\r\n\tSDPUtils.parseRtpMap = function(line) {\r\n\t\tvar parts = line.substr(9).split(' ');\r\n\t\tvar parsed = {\r\n\t\t\tpayloadType: parseInt(parts.shift(), 10) // was: id\r\n\t\t};\r\n\t\r\n\t\tparts = parts[0].split('/');\r\n\t\r\n\t\tparsed.name = parts[0];\r\n\t\tparsed.clockRate = parseInt(parts[1], 10); // was: clockrate\r\n\t\tparsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\r\n\t\t// legacy alias, got renamed back to channels in ORTC.\r\n\t\tparsed.numChannels = parsed.channels;\r\n\t\treturn parsed;\r\n\t};\r\n\t\r\n\t// Generate an a=rtpmap line from RTCRtpCodecCapability or\r\n\t// RTCRtpCodecParameters.\r\n\tSDPUtils.writeRtpMap = function(codec) {\r\n\t\tvar pt = codec.payloadType;\r\n\t\tif (codec.preferredPayloadType !== undefined) {\r\n\t\t\tpt = codec.preferredPayloadType;\r\n\t\t}\r\n\t\tvar channels = codec.channels || codec.numChannels || 1;\r\n\t\treturn 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\r\n\t\t\t\t(channels !== 1 ? '/' + channels : '') + '\\r\\n';\r\n\t};\r\n\t\r\n\t// Parses an a=extmap line (headerextension from RFC 5285). Sample input:\r\n\t// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\r\n\t// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\r\n\tSDPUtils.parseExtmap = function(line) {\r\n\t\tvar parts = line.substr(9).split(' ');\r\n\t\treturn {\r\n\t\t\tid: parseInt(parts[0], 10),\r\n\t\t\tdirection: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\r\n\t\t\turi: parts[1]\r\n\t\t};\r\n\t};\r\n\t\r\n\t// Generates a=extmap line from RTCRtpHeaderExtensionParameters or\r\n\t// RTCRtpHeaderExtension.\r\n\tSDPUtils.writeExtmap = function(headerExtension) {\r\n\t\treturn 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\r\n\t\t\t\t(headerExtension.direction && headerExtension.direction !== 'sendrecv'\r\n\t\t\t\t\t? '/' + headerExtension.direction\r\n\t\t\t\t\t: '') +\r\n\t\t\t\t' ' + headerExtension.uri + '\\r\\n';\r\n\t};\r\n\t\r\n\t// Parses an ftmp line, returns dictionary. Sample input:\r\n\t// a=fmtp:96 vbr=on;cng=on\r\n\t// Also deals with vbr=on; cng=on\r\n\tSDPUtils.parseFmtp = function(line) {\r\n\t\tvar parsed = {};\r\n\t\tvar kv;\r\n\t\tvar parts = line.substr(line.indexOf(' ') + 1).split(';');\r\n\t\tfor (var j = 0; j < parts.length; j++) {\r\n\t\t\tkv = parts[j].trim().split('=');\r\n\t\t\tparsed[kv[0].trim()] = kv[1];\r\n\t\t}\r\n\t\treturn parsed;\r\n\t};\r\n\t\r\n\t// Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\r\n\tSDPUtils.writeFmtp = function(codec) {\r\n\t\tvar line = '';\r\n\t\tvar pt = codec.payloadType;\r\n\t\tif (codec.preferredPayloadType !== undefined) {\r\n\t\t\tpt = codec.preferredPayloadType;\r\n\t\t}\r\n\t\tif (codec.parameters && Object.keys(codec.parameters).length) {\r\n\t\t\tvar params = [];\r\n\t\t\tObject.keys(codec.parameters).forEach(function(param) {\r\n\t\t\t\tif (codec.parameters[param]) {\r\n\t\t\t\t\tparams.push(param + '=' + codec.parameters[param]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tparams.push(param);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tline += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\r\n\t\t}\r\n\t\treturn line;\r\n\t};\r\n\t\r\n\t// Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\r\n\t// a=rtcp-fb:98 nack rpsi\r\n\tSDPUtils.parseRtcpFb = function(line) {\r\n\t\tvar parts = line.substr(line.indexOf(' ') + 1).split(' ');\r\n\t\treturn {\r\n\t\t\ttype: parts.shift(),\r\n\t\t\tparameter: parts.join(' ')\r\n\t\t};\r\n\t};\r\n\t// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\r\n\tSDPUtils.writeRtcpFb = function(codec) {\r\n\t\tvar lines = '';\r\n\t\tvar pt = codec.payloadType;\r\n\t\tif (codec.preferredPayloadType !== undefined) {\r\n\t\t\tpt = codec.preferredPayloadType;\r\n\t\t}\r\n\t\tif (codec.rtcpFeedback && codec.rtcpFeedback.length) {\r\n\t\t\t// FIXME: special handling for trr-int?\r\n\t\t\tcodec.rtcpFeedback.forEach(function(fb) {\r\n\t\t\t\tlines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\r\n\t\t\t\t(fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\r\n\t\t\t\t\t\t'\\r\\n';\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn lines;\r\n\t};\r\n\t\r\n\t// Parses an RFC 5576 ssrc media attribute. Sample input:\r\n\t// a=ssrc:3735928559 cname:something\r\n\tSDPUtils.parseSsrcMedia = function(line) {\r\n\t\tvar sp = line.indexOf(' ');\r\n\t\tvar parts = {\r\n\t\t\tssrc: parseInt(line.substr(7, sp - 7), 10)\r\n\t\t};\r\n\t\tvar colon = line.indexOf(':', sp);\r\n\t\tif (colon > -1) {\r\n\t\t\tparts.attribute = line.substr(sp + 1, colon - sp - 1);\r\n\t\t\tparts.value = line.substr(colon + 1);\r\n\t\t} else {\r\n\t\t\tparts.attribute = line.substr(sp + 1);\r\n\t\t}\r\n\t\treturn parts;\r\n\t};\r\n\t\r\n\tSDPUtils.parseSsrcGroup = function(line) {\r\n\t\tvar parts = line.substr(13).split(' ');\r\n\t\treturn {\r\n\t\t\tsemantics: parts.shift(),\r\n\t\t\tssrcs: parts.map(function(ssrc) {\r\n\t\t\t\treturn parseInt(ssrc, 10);\r\n\t\t\t})\r\n\t\t};\r\n\t};\r\n\t\r\n\t// Extracts the MID (RFC 5888) from a media section.\r\n\t// returns the MID or undefined if no mid line was found.\r\n\tSDPUtils.getMid = function(mediaSection) {\r\n\t\tvar mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\r\n\t\tif (mid) {\r\n\t\t\treturn mid.substr(6);\r\n\t\t}\r\n\t};\r\n\t\r\n\tSDPUtils.parseFingerprint = function(line) {\r\n\t\tvar parts = line.substr(14).split(' ');\r\n\t\treturn {\r\n\t\t\talgorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\r\n\t\t\tvalue: parts[1]\r\n\t\t};\r\n\t};\r\n\t\r\n\t// Extracts DTLS parameters from SDP media section or sessionpart.\r\n\t// FIXME: for consistency with other functions this should only\r\n\t//   get the fingerprint line as input. See also getIceParameters.\r\n\tSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\r\n\t\tvar lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\r\n\t\t\t'a=fingerprint:');\r\n\t\t// Note: a=setup line is ignored since we use the 'auto' role.\r\n\t\t// Note2: 'algorithm' is not case sensitive except in Edge.\r\n\t\treturn {\r\n\t\t\trole: 'auto',\r\n\t\t\tfingerprints: lines.map(SDPUtils.parseFingerprint)\r\n\t\t};\r\n\t};\r\n\t\r\n\t// Serializes DTLS parameters to SDP.\r\n\tSDPUtils.writeDtlsParameters = function(params, setupType) {\r\n\t\tvar sdp = 'a=setup:' + setupType + '\\r\\n';\r\n\t\tparams.fingerprints.forEach(function(fp) {\r\n\t\t\tsdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\r\n\t\t});\r\n\t\treturn sdp;\r\n\t};\r\n\t\r\n\t// Parses a=crypto lines into\r\n\t//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#dictionary-rtcsrtpsdesparameters-members\r\n\tSDPUtils.parseCryptoLine = function(line) {\r\n\t\tvar parts = line.substr(9).split(' ');\r\n\t\treturn {\r\n\t\t\ttag: parseInt(parts[0], 10),\r\n\t\t\tcryptoSuite: parts[1],\r\n\t\t\tkeyParams: parts[2],\r\n\t\t\tsessionParams: parts.slice(3),\r\n\t\t};\r\n\t};\r\n\t\r\n\tSDPUtils.writeCryptoLine = function(parameters) {\r\n\t\treturn 'a=crypto:' + parameters.tag + ' ' +\r\n\t\t\tparameters.cryptoSuite + ' ' +\r\n\t\t\t(typeof parameters.keyParams === 'object'\r\n\t\t\t\t? SDPUtils.writeCryptoKeyParams(parameters.keyParams)\r\n\t\t\t\t: parameters.keyParams) +\r\n\t\t\t(parameters.sessionParams ? ' ' + parameters.sessionParams.join(' ') : '') +\r\n\t\t\t'\\r\\n';\r\n\t};\r\n\t\r\n\t// Parses the crypto key parameters into\r\n\t//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#rtcsrtpkeyparam*\r\n\tSDPUtils.parseCryptoKeyParams = function(keyParams) {\r\n\t\tif (keyParams.indexOf('inline:') !== 0) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar parts = keyParams.substr(7).split('|');\r\n\t\treturn {\r\n\t\t\tkeyMethod: 'inline',\r\n\t\t\tkeySalt: parts[0],\r\n\t\t\tlifeTime: parts[1],\r\n\t\t\tmkiValue: parts[2] ? parts[2].split(':')[0] : undefined,\r\n\t\t\tmkiLength: parts[2] ? parts[2].split(':')[1] : undefined,\r\n\t\t};\r\n\t};\r\n\t\r\n\tSDPUtils.writeCryptoKeyParams = function(keyParams) {\r\n\t\treturn keyParams.keyMethod + ':'\r\n\t\t\t+ keyParams.keySalt +\r\n\t\t\t(keyParams.lifeTime ? '|' + keyParams.lifeTime : '') +\r\n\t\t\t(keyParams.mkiValue && keyParams.mkiLength\r\n\t\t\t\t? '|' + keyParams.mkiValue + ':' + keyParams.mkiLength\r\n\t\t\t\t: '');\r\n\t};\r\n\t\r\n\t// Extracts all SDES paramters.\r\n\tSDPUtils.getCryptoParameters = function(mediaSection, sessionpart) {\r\n\t\tvar lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\r\n\t\t\t'a=crypto:');\r\n\t\treturn lines.map(SDPUtils.parseCryptoLine);\r\n\t};\r\n\t\r\n\t// Parses ICE information from SDP media section or sessionpart.\r\n\t// FIXME: for consistency with other functions this should only\r\n\t//   get the ice-ufrag and ice-pwd lines as input.\r\n\tSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\r\n\t\tvar ufrag = SDPUtils.matchPrefix(mediaSection + sessionpart,\r\n\t\t\t'a=ice-ufrag:')[0];\r\n\t\tvar pwd = SDPUtils.matchPrefix(mediaSection + sessionpart,\r\n\t\t\t'a=ice-pwd:')[0];\r\n\t\tif (!(ufrag && pwd)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tusernameFragment: ufrag.substr(12),\r\n\t\t\tpassword: pwd.substr(10),\r\n\t\t};\r\n\t};\r\n\t\r\n\t// Serializes ICE parameters to SDP.\r\n\tSDPUtils.writeIceParameters = function(params) {\r\n\t\treturn 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\r\n\t\t\t\t'a=ice-pwd:' + params.password + '\\r\\n';\r\n\t};\r\n\t\r\n\t// Parses the SDP media section and returns RTCRtpParameters.\r\n\tSDPUtils.parseRtpParameters = function(mediaSection) {\r\n\t\tvar description = {\r\n\t\t\tcodecs: [],\r\n\t\t\theaderExtensions: [],\r\n\t\t\tfecMechanisms: [],\r\n\t\t\trtcp: []\r\n\t\t};\r\n\t\tvar lines = SDPUtils.splitLines(mediaSection);\r\n\t\tvar mline = lines[0].split(' ');\r\n\t\tfor (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\r\n\t\t\tvar pt = mline[i];\r\n\t\t\tvar rtpmapline = SDPUtils.matchPrefix(\r\n\t\t\t\tmediaSection, 'a=rtpmap:' + pt + ' ')[0];\r\n\t\t\tif (rtpmapline) {\r\n\t\t\t\tvar codec = SDPUtils.parseRtpMap(rtpmapline);\r\n\t\t\t\tvar fmtps = SDPUtils.matchPrefix(\r\n\t\t\t\t\tmediaSection, 'a=fmtp:' + pt + ' ');\r\n\t\t\t\t// Only the first a=fmtp:<pt> is considered.\r\n\t\t\t\tcodec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\r\n\t\t\t\tcodec.rtcpFeedback = SDPUtils.matchPrefix(\r\n\t\t\t\t\tmediaSection, 'a=rtcp-fb:' + pt + ' ')\r\n\t\t\t\t\t.map(SDPUtils.parseRtcpFb);\r\n\t\t\t\tdescription.codecs.push(codec);\r\n\t\t\t\t// parse FEC mechanisms from rtpmap lines.\r\n\t\t\t\tswitch (codec.name.toUpperCase()) {\r\n\t\t\t\t\tcase 'RED':\r\n\t\t\t\t\tcase 'ULPFEC':\r\n\t\t\t\t\t\tdescription.fecMechanisms.push(codec.name.toUpperCase());\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault: // only RED and ULPFEC are recognized as FEC mechanisms.\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tSDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {\r\n\t\t\tdescription.headerExtensions.push(SDPUtils.parseExtmap(line));\r\n\t\t});\r\n\t\t// FIXME: parse rtcp.\r\n\t\treturn description;\r\n\t};\r\n\t\r\n\t// Generates parts of the SDP media section describing the capabilities /\r\n\t// parameters.\r\n\tSDPUtils.writeRtpDescription = function(kind, caps) {\r\n\t\tvar sdp = '';\r\n\t\r\n\t\t// Build the mline.\r\n\t\tsdp += 'm=' + kind + ' ';\r\n\t\tsdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\r\n\t\tsdp += ' UDP/TLS/RTP/SAVPF ';\r\n\t\tsdp += caps.codecs.map(function(codec) {\r\n\t\t\tif (codec.preferredPayloadType !== undefined) {\r\n\t\t\t\treturn codec.preferredPayloadType;\r\n\t\t\t}\r\n\t\t\treturn codec.payloadType;\r\n\t\t}).join(' ') + '\\r\\n';\r\n\t\r\n\t\tsdp += 'c=IN IP4 0.0.0.0\\r\\n';\r\n\t\tsdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\r\n\t\r\n\t\t// Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\r\n\t\tcaps.codecs.forEach(function(codec) {\r\n\t\t\tsdp += SDPUtils.writeRtpMap(codec);\r\n\t\t\tsdp += SDPUtils.writeFmtp(codec);\r\n\t\t\tsdp += SDPUtils.writeRtcpFb(codec);\r\n\t\t});\r\n\t\tvar maxptime = 0;\r\n\t\tcaps.codecs.forEach(function(codec) {\r\n\t\t\tif (codec.maxptime > maxptime) {\r\n\t\t\t\tmaxptime = codec.maxptime;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (maxptime > 0) {\r\n\t\t\tsdp += 'a=maxptime:' + maxptime + '\\r\\n';\r\n\t\t}\r\n\t\tsdp += 'a=rtcp-mux\\r\\n';\r\n\t\r\n\t\tif (caps.headerExtensions) {\r\n\t\t\tcaps.headerExtensions.forEach(function(extension) {\r\n\t\t\t\tsdp += SDPUtils.writeExtmap(extension);\r\n\t\t\t});\r\n\t\t}\r\n\t\t// FIXME: write fecMechanisms.\r\n\t\treturn sdp;\r\n\t};\r\n\t\r\n\t// Parses the SDP media section and returns an array of\r\n\t// RTCRtpEncodingParameters.\r\n\tSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\r\n\t\tvar encodingParameters = [];\r\n\t\tvar description = SDPUtils.parseRtpParameters(mediaSection);\r\n\t\tvar hasRed = description.fecMechanisms.indexOf('RED') !== -1;\r\n\t\tvar hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\r\n\t\r\n\t\t// filter a=ssrc:... cname:, ignore PlanB-msid\r\n\t\tvar ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\r\n\t\t\t.map(function(line) {\r\n\t\t\t\treturn SDPUtils.parseSsrcMedia(line);\r\n\t\t\t})\r\n\t\t\t.filter(function(parts) {\r\n\t\t\t\treturn parts.attribute === 'cname';\r\n\t\t\t});\r\n\t\tvar primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\r\n\t\tvar secondarySsrc;\r\n\t\r\n\t\tvar flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\r\n\t\t\t.map(function(line) {\r\n\t\t\t\tvar parts = line.substr(17).split(' ');\r\n\t\t\t\treturn parts.map(function(part) {\r\n\t\t\t\t\treturn parseInt(part, 10);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\tif (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\r\n\t\t\tsecondarySsrc = flows[0][1];\r\n\t\t}\r\n\t\r\n\t\tdescription.codecs.forEach(function(codec) {\r\n\t\t\tif (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\r\n\t\t\t\tvar encParam = {\r\n\t\t\t\t\tssrc: primarySsrc,\r\n\t\t\t\t\tcodecPayloadType: parseInt(codec.parameters.apt, 10)\r\n\t\t\t\t};\r\n\t\t\t\tif (primarySsrc && secondarySsrc) {\r\n\t\t\t\t\tencParam.rtx = {ssrc: secondarySsrc};\r\n\t\t\t\t}\r\n\t\t\t\tencodingParameters.push(encParam);\r\n\t\t\t\tif (hasRed) {\r\n\t\t\t\t\tencParam = JSON.parse(JSON.stringify(encParam));\r\n\t\t\t\t\tencParam.fec = {\r\n\t\t\t\t\t\tssrc: primarySsrc,\r\n\t\t\t\t\t\tmechanism: hasUlpfec ? 'red+ulpfec' : 'red'\r\n\t\t\t\t\t};\r\n\t\t\t\t\tencodingParameters.push(encParam);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (encodingParameters.length === 0 && primarySsrc) {\r\n\t\t\tencodingParameters.push({\r\n\t\t\t\tssrc: primarySsrc\r\n\t\t\t});\r\n\t\t}\r\n\t\r\n\t\t// we support both b=AS and b=TIAS but interpret AS as TIAS.\r\n\t\tvar bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\r\n\t\tif (bandwidth.length) {\r\n\t\t\tif (bandwidth[0].indexOf('b=TIAS:') === 0) {\r\n\t\t\t\tbandwidth = parseInt(bandwidth[0].substr(7), 10);\r\n\t\t\t} else if (bandwidth[0].indexOf('b=AS:') === 0) {\r\n\t\t\t\t// use formula from JSEP to convert b=AS to TIAS value.\r\n\t\t\t\tbandwidth = parseInt(bandwidth[0].substr(5), 10) * 1000 * 0.95\r\n\t\t\t\t\t\t- (50 * 40 * 8);\r\n\t\t\t} else {\r\n\t\t\t\tbandwidth = undefined;\r\n\t\t\t}\r\n\t\t\tencodingParameters.forEach(function(params) {\r\n\t\t\t\tparams.maxBitrate = bandwidth;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn encodingParameters;\r\n\t};\r\n\t\r\n\t// parses http://draft.ortc.org/#rtcrtcpparameters*\r\n\tSDPUtils.parseRtcpParameters = function(mediaSection) {\r\n\t\tvar rtcpParameters = {};\r\n\t\r\n\t\t// Gets the first SSRC. Note tha with RTX there might be multiple\r\n\t\t// SSRCs.\r\n\t\tvar remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\r\n\t\t\t.map(function(line) {\r\n\t\t\t\treturn SDPUtils.parseSsrcMedia(line);\r\n\t\t\t})\r\n\t\t\t.filter(function(obj) {\r\n\t\t\t\treturn obj.attribute === 'cname';\r\n\t\t\t})[0];\r\n\t\tif (remoteSsrc) {\r\n\t\t\trtcpParameters.cname = remoteSsrc.value;\r\n\t\t\trtcpParameters.ssrc = remoteSsrc.ssrc;\r\n\t\t}\r\n\t\r\n\t\t// Edge uses the compound attribute instead of reducedSize\r\n\t\t// compound is !reducedSize\r\n\t\tvar rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\r\n\t\trtcpParameters.reducedSize = rsize.length > 0;\r\n\t\trtcpParameters.compound = rsize.length === 0;\r\n\t\r\n\t\t// parses the rtcp-mux attrіbute.\r\n\t\t// Note that Edge does not support unmuxed RTCP.\r\n\t\tvar mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\r\n\t\trtcpParameters.mux = mux.length > 0;\r\n\t\r\n\t\treturn rtcpParameters;\r\n\t};\r\n\t\r\n\t// parses either a=msid: or a=ssrc:... msid lines and returns\r\n\t// the id of the MediaStream and MediaStreamTrack.\r\n\tSDPUtils.parseMsid = function(mediaSection) {\r\n\t\tvar parts;\r\n\t\tvar spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\r\n\t\tif (spec.length === 1) {\r\n\t\t\tparts = spec[0].substr(7).split(' ');\r\n\t\t\treturn {stream: parts[0], track: parts[1]};\r\n\t\t}\r\n\t\tvar planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\r\n\t\t\t.map(function(line) {\r\n\t\t\t\treturn SDPUtils.parseSsrcMedia(line);\r\n\t\t\t})\r\n\t\t\t.filter(function(msidParts) {\r\n\t\t\t\treturn msidParts.attribute === 'msid';\r\n\t\t\t});\r\n\t\tif (planB.length > 0) {\r\n\t\t\tparts = planB[0].value.split(' ');\r\n\t\t\treturn {stream: parts[0], track: parts[1]};\r\n\t\t}\r\n\t};\r\n\t\r\n\t// SCTP\r\n\t// parses draft-ietf-mmusic-sctp-sdp-26 first and falls back\r\n\t// to draft-ietf-mmusic-sctp-sdp-05\r\n\tSDPUtils.parseSctpDescription = function(mediaSection) {\r\n\t\tvar mline = SDPUtils.parseMLine(mediaSection);\r\n\t\tvar maxSizeLine = SDPUtils.matchPrefix(mediaSection, 'a=max-message-size:');\r\n\t\tvar maxMessageSize;\r\n\t\tif (maxSizeLine.length > 0) {\r\n\t\t\tmaxMessageSize = parseInt(maxSizeLine[0].substr(19), 10);\r\n\t\t}\r\n\t\tif (isNaN(maxMessageSize)) {\r\n\t\t\tmaxMessageSize = 65536;\r\n\t\t}\r\n\t\tvar sctpPort = SDPUtils.matchPrefix(mediaSection, 'a=sctp-port:');\r\n\t\tif (sctpPort.length > 0) {\r\n\t\t\treturn {\r\n\t\t\t\tport: parseInt(sctpPort[0].substr(12), 10),\r\n\t\t\t\tprotocol: mline.fmt,\r\n\t\t\t\tmaxMessageSize: maxMessageSize\r\n\t\t\t};\r\n\t\t}\r\n\t\tvar sctpMapLines = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:');\r\n\t\tif (sctpMapLines.length > 0) {\r\n\t\t\tvar parts = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:')[0]\r\n\t\t\t\t.substr(10)\r\n\t\t\t\t.split(' ');\r\n\t\t\treturn {\r\n\t\t\t\tport: parseInt(parts[0], 10),\r\n\t\t\t\tprotocol: parts[1],\r\n\t\t\t\tmaxMessageSize: maxMessageSize\r\n\t\t\t};\r\n\t\t}\r\n\t};\r\n\t\r\n\t// SCTP\r\n\t// outputs the draft-ietf-mmusic-sctp-sdp-26 version that all browsers\r\n\t// support by now receiving in this format, unless we originally parsed\r\n\t// as the draft-ietf-mmusic-sctp-sdp-05 format (indicated by the m-line\r\n\t// protocol of DTLS/SCTP -- without UDP/ or TCP/)\r\n\tSDPUtils.writeSctpDescription = function(media, sctp) {\r\n\t\tvar output = [];\r\n\t\tif (media.protocol !== 'DTLS/SCTP') {\r\n\t\t\toutput = [\r\n\t\t\t\t'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.protocol + '\\r\\n',\r\n\t\t\t\t'c=IN IP4 0.0.0.0\\r\\n',\r\n\t\t\t\t'a=sctp-port:' + sctp.port + '\\r\\n'\r\n\t\t\t];\r\n\t\t} else {\r\n\t\t\toutput = [\r\n\t\t\t\t'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.port + '\\r\\n',\r\n\t\t\t\t'c=IN IP4 0.0.0.0\\r\\n',\r\n\t\t\t\t'a=sctpmap:' + sctp.port + ' ' + sctp.protocol + ' 65535\\r\\n'\r\n\t\t\t];\r\n\t\t}\r\n\t\tif (sctp.maxMessageSize !== undefined) {\r\n\t\t\toutput.push('a=max-message-size:' + sctp.maxMessageSize + '\\r\\n');\r\n\t\t}\r\n\t\treturn output.join('');\r\n\t};\r\n\t\r\n\t// Generate a session ID for SDP.\r\n\t// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\r\n\t// recommends using a cryptographically random +ve 64-bit value\r\n\t// but right now this should be acceptable and within the right range\r\n\tSDPUtils.generateSessionId = function() {\r\n\t\treturn Math.random().toString().substr(2, 21);\r\n\t};\r\n\t\r\n\t// Write boilder plate for start of SDP\r\n\t// sessId argument is optional - if not supplied it will\r\n\t// be generated randomly\r\n\t// sessVersion is optional and defaults to 2\r\n\t// sessUser is optional and defaults to 'thisisadapterortc'\r\n\tSDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {\r\n\t\tvar sessionId;\r\n\t\tvar version = sessVer !== undefined ? sessVer : 2;\r\n\t\tif (sessId) {\r\n\t\t\tsessionId = sessId;\r\n\t\t} else {\r\n\t\t\tsessionId = SDPUtils.generateSessionId();\r\n\t\t}\r\n\t\tvar user = sessUser || 'thisisadapterortc';\r\n\t\t// FIXME: sess-id should be an NTP timestamp.\r\n\t\treturn 'v=0\\r\\n' +\r\n\t\t\t\t'o=' + user + ' ' + sessionId + ' ' + version +\r\n\t\t\t\t\t' IN IP4 127.0.0.1\\r\\n' +\r\n\t\t\t\t's=-\\r\\n' +\r\n\t\t\t\t't=0 0\\r\\n';\r\n\t};\r\n\t\r\n\tSDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {\r\n\t\tvar sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\r\n\t\r\n\t\t// Map ICE parameters (ufrag, pwd) to SDP.\r\n\t\tsdp += SDPUtils.writeIceParameters(\r\n\t\t\ttransceiver.iceGatherer.getLocalParameters());\r\n\t\r\n\t\t// Map DTLS parameters to SDP.\r\n\t\tsdp += SDPUtils.writeDtlsParameters(\r\n\t\t\ttransceiver.dtlsTransport.getLocalParameters(),\r\n\t\t\ttype === 'offer' ? 'actpass' : 'active');\r\n\t\r\n\t\tsdp += 'a=mid:' + transceiver.mid + '\\r\\n';\r\n\t\r\n\t\tif (transceiver.direction) {\r\n\t\t\tsdp += 'a=' + transceiver.direction + '\\r\\n';\r\n\t\t} else if (transceiver.rtpSender && transceiver.rtpReceiver) {\r\n\t\t\tsdp += 'a=sendrecv\\r\\n';\r\n\t\t} else if (transceiver.rtpSender) {\r\n\t\t\tsdp += 'a=sendonly\\r\\n';\r\n\t\t} else if (transceiver.rtpReceiver) {\r\n\t\t\tsdp += 'a=recvonly\\r\\n';\r\n\t\t} else {\r\n\t\t\tsdp += 'a=inactive\\r\\n';\r\n\t\t}\r\n\t\r\n\t\tif (transceiver.rtpSender) {\r\n\t\t\t// spec.\r\n\t\t\tvar msid = 'msid:' + stream.id + ' ' +\r\n\t\t\t\t\ttransceiver.rtpSender.track.id + '\\r\\n';\r\n\t\t\tsdp += 'a=' + msid;\r\n\t\r\n\t\t\t// for Chrome.\r\n\t\t\tsdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\r\n\t\t\t\t\t' ' + msid;\r\n\t\t\tif (transceiver.sendEncodingParameters[0].rtx) {\r\n\t\t\t\tsdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\r\n\t\t\t\t\t\t' ' + msid;\r\n\t\t\t\tsdp += 'a=ssrc-group:FID ' +\r\n\t\t\t\t\t\ttransceiver.sendEncodingParameters[0].ssrc + ' ' +\r\n\t\t\t\t\t\ttransceiver.sendEncodingParameters[0].rtx.ssrc +\r\n\t\t\t\t\t\t'\\r\\n';\r\n\t\t\t}\r\n\t\t}\r\n\t\t// FIXME: this should be written by writeRtpDescription.\r\n\t\tsdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\r\n\t\t\t\t' cname:' + SDPUtils.localCName + '\\r\\n';\r\n\t\tif (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\r\n\t\t\tsdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\r\n\t\t\t\t\t' cname:' + SDPUtils.localCName + '\\r\\n';\r\n\t\t}\r\n\t\treturn sdp;\r\n\t};\r\n\t\r\n\t// Gets the direction from the mediaSection or the sessionpart.\r\n\tSDPUtils.getDirection = function(mediaSection, sessionpart) {\r\n\t\t// Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\r\n\t\tvar lines = SDPUtils.splitLines(mediaSection);\r\n\t\tfor (var i = 0; i < lines.length; i++) {\r\n\t\t\tswitch (lines[i]) {\r\n\t\t\t\tcase 'a=sendrecv':\r\n\t\t\t\tcase 'a=sendonly':\r\n\t\t\t\tcase 'a=recvonly':\r\n\t\t\t\tcase 'a=inactive':\r\n\t\t\t\t\treturn lines[i].substr(2);\r\n\t\t\t\tdefault:\r\n\t\t\t\t\t// FIXME: What should happen here?\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (sessionpart) {\r\n\t\t\treturn SDPUtils.getDirection(sessionpart);\r\n\t\t}\r\n\t\treturn 'sendrecv';\r\n\t};\r\n\t\r\n\tSDPUtils.getKind = function(mediaSection) {\r\n\t\tvar lines = SDPUtils.splitLines(mediaSection);\r\n\t\tvar mline = lines[0].split(' ');\r\n\t\treturn mline[0].substr(2);\r\n\t};\r\n\t\r\n\tSDPUtils.isRejected = function(mediaSection) {\r\n\t\treturn mediaSection.split(' ', 2)[1] === '0';\r\n\t};\r\n\t\r\n\tSDPUtils.parseMLine = function(mediaSection) {\r\n\t\tvar lines = SDPUtils.splitLines(mediaSection);\r\n\t\tvar parts = lines[0].substr(2).split(' ');\r\n\t\treturn {\r\n\t\t\tkind: parts[0],\r\n\t\t\tport: parseInt(parts[1], 10),\r\n\t\t\tprotocol: parts[2],\r\n\t\t\tfmt: parts.slice(3).join(' ')\r\n\t\t};\r\n\t};\r\n\t\r\n\tSDPUtils.parseOLine = function(mediaSection) {\r\n\t\tvar line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\r\n\t\tvar parts = line.substr(2).split(' ');\r\n\t\treturn {\r\n\t\t\tusername: parts[0],\r\n\t\t\tsessionId: parts[1],\r\n\t\t\tsessionVersion: parseInt(parts[2], 10),\r\n\t\t\tnetType: parts[3],\r\n\t\t\taddressType: parts[4],\r\n\t\t\taddress: parts[5]\r\n\t\t};\r\n\t};\r\n\t\r\n\t// a very naive interpretation of a valid SDP.\r\n\tSDPUtils.isValidSDP = function(blob) {\r\n\t\tif (typeof blob !== 'string' || blob.length === 0) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar lines = SDPUtils.splitLines(blob);\r\n\t\tfor (var i = 0; i < lines.length; i++) {\r\n\t\t\tif (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t// TODO: check the modifier a bit more.\r\n\t\t}\r\n\t\treturn true;\r\n\t};\r\n\t\r\n\t// Expose public methods.\r\n\tif (typeof module === 'object') {\r\n\t\tmodule.exports = SDPUtils;\r\n\t}\r\n\t\r\n\t},{}]},{},[1])(1)\r\n\t});\r\n\t","// __________________\r\n// getHTMLMediaElement.js\r\n\r\nfunction getHTMLMediaElement(mediaElement, config) {\r\n    config = config || {};\r\n\r\n    if (!mediaElement.nodeName || (mediaElement.nodeName.toLowerCase() != 'audio' && mediaElement.nodeName.toLowerCase() != 'video')) {\r\n        if (!mediaElement.getVideoTracks().length) {\r\n            return getAudioElement(mediaElement, config);\r\n        }\r\n\r\n        var mediaStream = mediaElement;\r\n        mediaElement = document.createElement(mediaStream.getVideoTracks().length ? 'video' : 'audio');\r\n\r\n        try {\r\n            mediaElement.setAttributeNode(document.createAttribute('autoplay'));\r\n            mediaElement.setAttributeNode(document.createAttribute('playsinline'));\r\n        } catch (e) {\r\n            mediaElement.setAttribute('autoplay', true);\r\n            mediaElement.setAttribute('playsinline', true);\r\n        }\r\n\r\n        if ('srcObject' in mediaElement) {\r\n            mediaElement.srcObject = mediaStream;\r\n        } else {\r\n            mediaElement[!!navigator.mozGetUserMedia ? 'mozSrcObject' : 'src'] = !!navigator.mozGetUserMedia ? mediaStream : (window.URL || window.webkitURL).createObjectURL(mediaStream);\r\n        }\r\n    }\r\n\r\n    if (mediaElement.nodeName && mediaElement.nodeName.toLowerCase() == 'audio') {\r\n        return getAudioElement(mediaElement, config);\r\n    }\r\n\r\n    var buttons = config.buttons || ['mute-audio', 'mute-video', 'full-screen', 'volume-slider', 'stop'];\r\n    buttons.has = function(element) {\r\n        return buttons.indexOf(element) !== -1;\r\n    };\r\n\r\n    config.toggle = config.toggle || [];\r\n    config.toggle.has = function(element) {\r\n        return config.toggle.indexOf(element) !== -1;\r\n    };\r\n\r\n    var mediaElementContainer = document.createElement('div');\r\n    mediaElementContainer.className = 'media-container';\r\n\r\n    var mediaControls = document.createElement('div');\r\n    mediaControls.className = 'media-controls';\r\n    // mediaElementContainer.appendChild(mediaControls);\r\n\r\n    if (buttons.has('mute-audio')) {\r\n        var muteAudio = document.createElement('div');\r\n        muteAudio.className = 'control ' + (config.toggle.has('mute-audio') ? 'unmute-audio selected' : 'mute-audio');\r\n        mediaControls.appendChild(muteAudio);\r\n\r\n        muteAudio.onclick = function() {\r\n            if (muteAudio.className.indexOf('unmute-audio') != -1) {\r\n                muteAudio.className = muteAudio.className.replace('unmute-audio selected', 'mute-audio');\r\n                mediaElement.muted = false;\r\n                mediaElement.volume = 1;\r\n                if (config.onUnMuted) config.onUnMuted('audio');\r\n            } else {\r\n                muteAudio.className = muteAudio.className.replace('mute-audio', 'unmute-audio selected');\r\n                mediaElement.muted = true;\r\n                mediaElement.volume = 0;\r\n                if (config.onMuted) config.onMuted('audio');\r\n            }\r\n        };\r\n    }\r\n\r\n    if (buttons.has('mute-video')) {\r\n        var muteVideo = document.createElement('div');\r\n        muteVideo.className = 'control ' + (config.toggle.has('mute-video') ? 'unmute-video selected' : 'mute-video');\r\n        mediaControls.appendChild(muteVideo);\r\n\r\n        muteVideo.onclick = function() {\r\n            if (muteVideo.className.indexOf('unmute-video') != -1) {\r\n                muteVideo.className = muteVideo.className.replace('unmute-video selected', 'mute-video');\r\n                mediaElement.muted = false;\r\n                mediaElement.volume = 1;\r\n                mediaElement.play();\r\n                if (config.onUnMuted) config.onUnMuted('video');\r\n            } else {\r\n                muteVideo.className = muteVideo.className.replace('mute-video', 'unmute-video selected');\r\n                mediaElement.muted = true;\r\n                mediaElement.volume = 0;\r\n                mediaElement.pause();\r\n                if (config.onMuted) config.onMuted('video');\r\n            }\r\n        };\r\n    }\r\n\r\n    if (buttons.has('take-snapshot')) {\r\n        var takeSnapshot = document.createElement('div');\r\n        takeSnapshot.className = 'control take-snapshot';\r\n        mediaControls.appendChild(takeSnapshot);\r\n\r\n        takeSnapshot.onclick = function() {\r\n            if (config.onTakeSnapshot) config.onTakeSnapshot();\r\n        };\r\n    }\r\n\r\n    if (buttons.has('stop')) {\r\n        var stop = document.createElement('div');\r\n        stop.className = 'control stop';\r\n        mediaControls.appendChild(stop);\r\n\r\n        stop.onclick = function() {\r\n            mediaElementContainer.style.opacity = 0;\r\n            setTimeout(function() {\r\n                if (mediaElementContainer.parentNode) {\r\n                    mediaElementContainer.parentNode.removeChild(mediaElementContainer);\r\n                }\r\n            }, 800);\r\n            if (config.onStopped) config.onStopped();\r\n        };\r\n    }\r\n\r\n    var volumeControl = document.createElement('div');\r\n    volumeControl.className = 'volume-control';\r\n\r\n    if (buttons.has('record-audio')) {\r\n        var recordAudio = document.createElement('div');\r\n        recordAudio.className = 'control ' + (config.toggle.has('record-audio') ? 'stop-recording-audio selected' : 'record-audio');\r\n\t\t\t\t// volumeControl.appendChild(recordAudio);\r\n\t\t\t\t\r\n\r\n        recordAudio.onclick = function() {\r\n            if (recordAudio.className.indexOf('stop-recording-audio') != -1) {\r\n                recordAudio.className = recordAudio.className.replace('stop-recording-audio selected', 'record-audio');\r\n                if (config.onRecordingStopped) config.onRecordingStopped('audio');\r\n            } else {\r\n                recordAudio.className = recordAudio.className.replace('record-audio', 'stop-recording-audio selected');\r\n                if (config.onRecordingStarted) config.onRecordingStarted('audio');\r\n            }\r\n        };\r\n    }\r\n\r\n    if (buttons.has('record-video')) {\r\n        var recordVideo = document.createElement('div');\r\n        recordVideo.className = 'control ' + (config.toggle.has('record-video') ? 'stop-recording-video selected' : 'record-video');\r\n        // volumeControl.appendChild(recordVideo);\r\n\r\n        recordVideo.onclick = function() {\r\n            if (recordVideo.className.indexOf('stop-recording-video') != -1) {\r\n                recordVideo.className = recordVideo.className.replace('stop-recording-video selected', 'record-video');\r\n                if (config.onRecordingStopped) config.onRecordingStopped('video');\r\n            } else {\r\n                recordVideo.className = recordVideo.className.replace('record-video', 'stop-recording-video selected');\r\n                if (config.onRecordingStarted) config.onRecordingStarted('video');\r\n            }\r\n        };\r\n    }\r\n\r\n    if (buttons.has('volume-slider')) {\r\n        var volumeSlider = document.createElement('div');\r\n        volumeSlider.className = 'control volume-slider';\r\n        // volumeControl.appendChild(volumeSlider);\r\n\r\n        var slider = document.createElement('input');\r\n        slider.type = 'range';\r\n        slider.min = 0;\r\n        slider.max = 100;\r\n        slider.value = 100;\r\n        slider.onchange = function() {\r\n            mediaElement.volume = '.' + slider.value.toString().substr(0, 1);\r\n        };\r\n        volumeSlider.appendChild(slider);\r\n    }\r\n\r\n    if (buttons.has('full-screen')) {\r\n        var zoom = document.createElement('div');\r\n        zoom.className = 'control ' + (config.toggle.has('zoom-in') ? 'zoom-out selected' : 'zoom-in');\r\n\r\n        if (!slider && !recordAudio && !recordVideo && zoom) {\r\n            mediaControls.insertBefore(zoom, mediaControls.firstChild);\r\n        } else {\r\n\t\t\t\t\t// volumeControl.appendChild(zoom);\r\n\t\t\t\t}\r\n\r\n        zoom.onclick = function() {\r\n            if (zoom.className.indexOf('zoom-out') != -1) {\r\n                zoom.className = zoom.className.replace('zoom-out selected', 'zoom-in');\r\n                exitFullScreen();\r\n            } else {\r\n                zoom.className = zoom.className.replace('zoom-in', 'zoom-out selected');\r\n                launchFullscreen(mediaElementContainer);\r\n            }\r\n        };\r\n\r\n        function launchFullscreen(element) {\r\n            if (element.requestFullscreen) {\r\n                element.requestFullscreen();\r\n            } else if (element.mozRequestFullScreen) {\r\n                element.mozRequestFullScreen();\r\n            } else if (element.webkitRequestFullscreen) {\r\n                element.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\r\n            }\r\n        }\r\n\r\n        function exitFullScreen() {\r\n            if (document.fullscreen) {\r\n                document.exitFullscreen();\r\n            }\r\n\r\n            if (document.mozFullScreen) {\r\n                document.mozCancelFullScreen();\r\n            }\r\n\r\n            if (document.webkitIsFullScreen) {\r\n                document.webkitExitFullscreen();\r\n            }\r\n        }\r\n\r\n        function screenStateChange(e) {\r\n            if (e.srcElement != mediaElementContainer) return;\r\n\r\n            var isFullScreeMode = document.webkitIsFullScreen || document.mozFullScreen || document.fullscreen;\r\n\r\n            mediaElementContainer.style.width = (isFullScreeMode ? (window.innerWidth - 20) : config.width) + 'px';\r\n            mediaElementContainer.style.display = isFullScreeMode ? 'block' : 'inline-block';\r\n\r\n            if (config.height) {\r\n                mediaBox.style.height = (isFullScreeMode ? (window.innerHeight - 20) : config.height) + 'px';\r\n            }\r\n\r\n            if (!isFullScreeMode && config.onZoomout) config.onZoomout();\r\n            if (isFullScreeMode && config.onZoomin) config.onZoomin();\r\n\r\n            if (!isFullScreeMode && zoom.className.indexOf('zoom-out') != -1) {\r\n                zoom.className = zoom.className.replace('zoom-out selected', 'zoom-in');\r\n                if (config.onZoomout) config.onZoomout();\r\n            }\r\n            setTimeout(adjustControls, 1000);\r\n        }\r\n\r\n        document.addEventListener('fullscreenchange', screenStateChange, false);\r\n        document.addEventListener('mozfullscreenchange', screenStateChange, false);\r\n        document.addEventListener('webkitfullscreenchange', screenStateChange, false);\r\n    }\r\n\r\n    if (buttons.has('volume-slider') || buttons.has('full-screen') || buttons.has('record-audio') || buttons.has('record-video')) {\r\n        // mediaElementContainer.appendChild(volumeControl);\r\n    }\r\n\r\n    var mediaBox = document.createElement('div');\r\n    mediaBox.className = 'media-box';\r\n    mediaElementContainer.appendChild(mediaBox);\r\n\r\n    if (config.title) {\r\n        var h2 = document.createElement('h2');\r\n        h2.innerHTML = config.title;\r\n        h2.setAttribute('style', 'position: absolute;color:white;font-size:17px;text-shadow: 1px 1px black;padding:0;margin:0;text-align: left; margin-top: 10px; margin-left: 10px; display: block; border: 0;line-height:1.5;z-index:1;');\r\n        mediaBox.appendChild(h2);\r\n    }\r\n\r\n    mediaBox.appendChild(mediaElement);\r\n\r\n    if (!config.width) config.width = (innerWidth / 2) - 50;\r\n\r\n    mediaElementContainer.style.width = config.width + 'px';\r\n\r\n    if (config.height) {\r\n        mediaBox.style.height = config.height + 'px';\r\n    }\r\n\r\n    mediaBox.querySelector('video').style.maxHeight = innerHeight + 'px';\r\n\r\n    var times = 0;\r\n\r\n    function adjustControls() {\r\n        mediaControls.style.marginLeft = (mediaElementContainer.clientWidth - mediaControls.clientWidth - 2) + 'px';\r\n\r\n        if (slider) {\r\n            slider.style.width = (mediaElementContainer.clientWidth / 3) + 'px';\r\n            volumeControl.style.marginLeft = (mediaElementContainer.clientWidth / 3 - 30) + 'px';\r\n\r\n            if (zoom) zoom.style['border-top-right-radius'] = '5px';\r\n        } else {\r\n            volumeControl.style.marginLeft = (mediaElementContainer.clientWidth - volumeControl.clientWidth - 2) + 'px';\r\n        }\r\n\r\n        volumeControl.style.marginTop = (mediaElementContainer.clientHeight - volumeControl.clientHeight - 2) + 'px';\r\n\r\n        if (times < 10) {\r\n            times++;\r\n            setTimeout(adjustControls, 1000);\r\n        } else times = 0;\r\n    }\r\n\r\n    if (config.showOnMouseEnter || typeof config.showOnMouseEnter === 'undefined') {\r\n        mediaElementContainer.onmouseenter = mediaElementContainer.onmousedown = function() {\r\n            adjustControls();\r\n            mediaControls.style.opacity = 1;\r\n            volumeControl.style.opacity = 1;\r\n        };\r\n\r\n        mediaElementContainer.onmouseleave = function() {\r\n            mediaControls.style.opacity = 0;\r\n            volumeControl.style.opacity = 0;\r\n        };\r\n    } else {\r\n        setTimeout(function() {\r\n            adjustControls();\r\n            setTimeout(function() {\r\n                mediaControls.style.opacity = 1;\r\n                volumeControl.style.opacity = 1;\r\n            }, 300);\r\n        }, 700);\r\n    }\r\n\r\n    adjustControls();\r\n\r\n    mediaElementContainer.toggle = function(clasName) {\r\n        if (typeof clasName != 'string') {\r\n            for (var i = 0; i < clasName.length; i++) {\r\n                mediaElementContainer.toggle(clasName[i]);\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (clasName == 'mute-audio' && muteAudio) muteAudio.onclick();\r\n        if (clasName == 'mute-video' && muteVideo) muteVideo.onclick();\r\n\r\n        if (clasName == 'record-audio' && recordAudio) recordAudio.onclick();\r\n        if (clasName == 'record-video' && recordVideo) recordVideo.onclick();\r\n\r\n        if (clasName == 'stop' && stop) stop.onclick();\r\n\r\n        return this;\r\n    };\r\n\r\n    mediaElementContainer.media = mediaElement;\r\n\r\n    return mediaElementContainer;\r\n}\r\n\r\n// __________________\r\n// getAudioElement.js\r\n\r\nfunction getAudioElement(mediaElement, config) {\r\n    config = config || {};\r\n\r\n    if (!mediaElement.nodeName || (mediaElement.nodeName.toLowerCase() != 'audio' && mediaElement.nodeName.toLowerCase() != 'video')) {\r\n        var mediaStream = mediaElement;\r\n        mediaElement = document.createElement('audio');\r\n\r\n        try {\r\n            mediaElement.setAttributeNode(document.createAttribute('autoplay'));\r\n            mediaElement.setAttributeNode(document.createAttribute('controls'));\r\n        } catch (e) {\r\n            mediaElement.setAttribute('autoplay', true);\r\n            mediaElement.setAttribute('controls', true);\r\n        }\r\n\r\n        if ('srcObject' in mediaElement) {\r\n            mediaElement.mediaElement = mediaStream;\r\n        } else {\r\n            mediaElement[!!navigator.mozGetUserMedia ? 'mozSrcObject' : 'src'] = !!navigator.mozGetUserMedia ? mediaStream : (window.URL || window.webkitURL).createObjectURL(mediaStream);\r\n        }\r\n    }\r\n\r\n    config.toggle = config.toggle || [];\r\n    config.toggle.has = function(element) {\r\n        return config.toggle.indexOf(element) !== -1;\r\n    };\r\n\r\n    var mediaElementContainer = document.createElement('div');\r\n    mediaElementContainer.className = 'media-container';\r\n\r\n    var mediaControls = document.createElement('div');\r\n    mediaControls.className = 'media-controls';\r\n    mediaElementContainer.appendChild(mediaControls);\r\n\r\n    var muteAudio = document.createElement('div');\r\n    muteAudio.className = 'control ' + (config.toggle.has('mute-audio') ? 'unmute-audio selected' : 'mute-audio');\r\n    mediaControls.appendChild(muteAudio);\r\n\r\n    muteAudio.style['border-top-left-radius'] = '5px';\r\n\r\n    muteAudio.onclick = function() {\r\n        if (muteAudio.className.indexOf('unmute-audio') != -1) {\r\n            muteAudio.className = muteAudio.className.replace('unmute-audio selected', 'mute-audio');\r\n            mediaElement.muted = false;\r\n            if (config.onUnMuted) config.onUnMuted('audio');\r\n        } else {\r\n            muteAudio.className = muteAudio.className.replace('mute-audio', 'unmute-audio selected');\r\n            mediaElement.muted = true;\r\n            if (config.onMuted) config.onMuted('audio');\r\n        }\r\n    };\r\n\r\n    if (!config.buttons || (config.buttons && config.buttons.indexOf('record-audio') != -1)) {\r\n        var recordAudio = document.createElement('div');\r\n        recordAudio.className = 'control ' + (config.toggle.has('record-audio') ? 'stop-recording-audio selected' : 'record-audio');\r\n        mediaControls.appendChild(recordAudio);\r\n\r\n        recordAudio.onclick = function() {\r\n            if (recordAudio.className.indexOf('stop-recording-audio') != -1) {\r\n                recordAudio.className = recordAudio.className.replace('stop-recording-audio selected', 'record-audio');\r\n                if (config.onRecordingStopped) config.onRecordingStopped('audio');\r\n            } else {\r\n                recordAudio.className = recordAudio.className.replace('record-audio', 'stop-recording-audio selected');\r\n                if (config.onRecordingStarted) config.onRecordingStarted('audio');\r\n            }\r\n        };\r\n    }\r\n\r\n    var volumeSlider = document.createElement('div');\r\n    volumeSlider.className = 'control volume-slider';\r\n    volumeSlider.style.width = 'auto';\r\n    mediaControls.appendChild(volumeSlider);\r\n\r\n    var slider = document.createElement('input');\r\n    slider.style.marginTop = '11px';\r\n    slider.style.width = ' 200px';\r\n\r\n    if (config.buttons && config.buttons.indexOf('record-audio') == -1) {\r\n        slider.style.width = ' 241px';\r\n    }\r\n\r\n    slider.type = 'range';\r\n    slider.min = 0;\r\n    slider.max = 100;\r\n    slider.value = 100;\r\n    slider.onchange = function() {\r\n        mediaElement.volume = '.' + slider.value.toString().substr(0, 1);\r\n    };\r\n    volumeSlider.appendChild(slider);\r\n\r\n    var stop = document.createElement('div');\r\n    stop.className = 'control stop';\r\n    mediaControls.appendChild(stop);\r\n\r\n    stop.onclick = function() {\r\n        mediaElementContainer.style.opacity = 0;\r\n        setTimeout(function() {\r\n            if (mediaElementContainer.parentNode) {\r\n                mediaElementContainer.parentNode.removeChild(mediaElementContainer);\r\n            }\r\n        }, 800);\r\n        if (config.onStopped) config.onStopped();\r\n    };\r\n\r\n    stop.style['border-top-right-radius'] = '5px';\r\n    stop.style['border-bottom-right-radius'] = '5px';\r\n\r\n    var mediaBox = document.createElement('div');\r\n    mediaBox.className = 'media-box';\r\n    mediaElementContainer.appendChild(mediaBox);\r\n\r\n    var h2 = document.createElement('h2');\r\n    h2.innerHTML = config.title || 'Audio Element';\r\n    h2.setAttribute('style', 'position: absolute;color: rgb(160, 160, 160);font-size: 20px;text-shadow: 1px 1px rgb(255, 255, 255);padding:0;margin:0;');\r\n    mediaBox.appendChild(h2);\r\n\r\n    mediaBox.appendChild(mediaElement);\r\n\r\n    mediaElementContainer.style.width = '329px';\r\n    mediaBox.style.height = '90px';\r\n\r\n    h2.style.width = mediaElementContainer.style.width;\r\n    h2.style.height = '50px';\r\n    h2.style.overflow = 'hidden';\r\n\r\n    var times = 0;\r\n\r\n    function adjustControls() {\r\n        mediaControls.style.marginLeft = (mediaElementContainer.clientWidth - mediaControls.clientWidth - 7) + 'px';\r\n        mediaControls.style.marginTop = (mediaElementContainer.clientHeight - mediaControls.clientHeight - 6) + 'px';\r\n        if (times < 10) {\r\n            times++;\r\n            setTimeout(adjustControls, 1000);\r\n        } else times = 0;\r\n    }\r\n\r\n    if (config.showOnMouseEnter || typeof config.showOnMouseEnter === 'undefined') {\r\n        mediaElementContainer.onmouseenter = mediaElementContainer.onmousedown = function() {\r\n            adjustControls();\r\n            mediaControls.style.opacity = 1;\r\n        };\r\n\r\n        mediaElementContainer.onmouseleave = function() {\r\n            mediaControls.style.opacity = 0;\r\n        };\r\n    } else {\r\n        setTimeout(function() {\r\n            adjustControls();\r\n            setTimeout(function() {\r\n                mediaControls.style.opacity = 1;\r\n            }, 300);\r\n        }, 700);\r\n    }\r\n\r\n    adjustControls();\r\n\r\n    mediaElementContainer.toggle = function(clasName) {\r\n        if (typeof clasName != 'string') {\r\n            for (var i = 0; i < clasName.length; i++) {\r\n                mediaElementContainer.toggle(clasName[i]);\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (clasName == 'mute-audio' && muteAudio) muteAudio.onclick();\r\n        if (clasName == 'record-audio' && recordAudio) recordAudio.onclick();\r\n        if (clasName == 'stop' && stop) stop.onclick();\r\n\r\n        return this;\r\n    };\r\n\r\n    mediaElementContainer.media = mediaElement;\r\n\r\n    return mediaElementContainer;\r\n}\r\n","// CodecsHandler.js\r\n\r\nvar CodecsHandler = (function() {\r\n\tfunction preferCodec(sdp, codecName) {\r\n\t\t\tvar info = splitLines(sdp);\r\n\r\n\t\t\tcodecName = codecName.toLowerCase()\r\n\r\n\t\t\tif (!info.videoCodecNumbers) {\r\n\t\t\t\t\treturn sdp;\r\n\t\t\t}\r\n\r\n\t\t\tif (codecName === 'vp8' && info.vp8LineNumber === info.videoCodecNumbers[0]) {\r\n\t\t\t\t\treturn sdp;\r\n\t\t\t}\r\n\r\n\t\t\tif (codecName === 'vp9' && info.vp9LineNumber === info.videoCodecNumbers[0]) {\r\n\t\t\t\t\treturn sdp;\r\n\t\t\t}\r\n\r\n\t\t\tif (codecName === 'h264' && info.h264LineNumber === info.videoCodecNumbers[0]) {\r\n\t\t\t\t\treturn sdp;\r\n\t\t\t}\r\n\r\n\t\t\tsdp = preferCodecHelper(sdp, codecName, info);\r\n\r\n\t\t\treturn sdp;\r\n\t}\r\n\r\n\tfunction preferCodecHelper(sdp, codec, info, ignore) {\r\n\t\t\tvar preferCodecNumber = '';\r\n\r\n\t\t\tif (codec === 'vp8') {\r\n\t\t\t\t\tif (!info.vp8LineNumber) {\r\n\t\t\t\t\t\t\treturn sdp;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpreferCodecNumber = info.vp8LineNumber;\r\n\t\t\t}\r\n\r\n\t\t\tif (codec === 'vp9') {\r\n\t\t\t\t\tif (!info.vp9LineNumber) {\r\n\t\t\t\t\t\t\treturn sdp;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpreferCodecNumber = info.vp9LineNumber;\r\n\t\t\t}\r\n\r\n\t\t\tif (codec === 'h264') {\r\n\t\t\t\t\tif (!info.h264LineNumber) {\r\n\t\t\t\t\t\t\treturn sdp;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tpreferCodecNumber = info.h264LineNumber;\r\n\t\t\t}\r\n\r\n\t\t\tvar newLine = info.videoCodecNumbersOriginal.split('SAVPF')[0] + 'SAVPF ';\r\n\r\n\t\t\tvar newOrder = [preferCodecNumber];\r\n\r\n\t\t\tif (ignore) {\r\n\t\t\t\t\tnewOrder = [];\r\n\t\t\t}\r\n\r\n\t\t\tinfo.videoCodecNumbers.forEach(function(codecNumber) {\r\n\t\t\t\t\tif (codecNumber === preferCodecNumber) return;\r\n\t\t\t\t\tnewOrder.push(codecNumber);\r\n\t\t\t});\r\n\r\n\t\t\tnewLine += newOrder.join(' ');\r\n\r\n\t\t\tsdp = sdp.replace(info.videoCodecNumbersOriginal, newLine);\r\n\t\t\treturn sdp;\r\n\t}\r\n\r\n\tfunction splitLines(sdp) {\r\n\t\t\tvar info = {};\r\n\t\t\tsdp.split('\\n').forEach(function(line) {\r\n\t\t\t\t\tif (line.indexOf('m=video') === 0) {\r\n\t\t\t\t\t\t\tinfo.videoCodecNumbers = [];\r\n\t\t\t\t\t\t\tline.split('SAVPF')[1].split(' ').forEach(function(codecNumber) {\r\n\t\t\t\t\t\t\t\t\tcodecNumber = codecNumber.trim();\r\n\t\t\t\t\t\t\t\t\tif (!codecNumber || !codecNumber.length) return;\r\n\t\t\t\t\t\t\t\t\tinfo.videoCodecNumbers.push(codecNumber);\r\n\t\t\t\t\t\t\t\t\tinfo.videoCodecNumbersOriginal = line;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (line.indexOf('VP8/90000') !== -1 && !info.vp8LineNumber) {\r\n\t\t\t\t\t\t\tinfo.vp8LineNumber = line.replace('a=rtpmap:', '').split(' ')[0];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (line.indexOf('VP9/90000') !== -1 && !info.vp9LineNumber) {\r\n\t\t\t\t\t\t\tinfo.vp9LineNumber = line.replace('a=rtpmap:', '').split(' ')[0];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (line.indexOf('H264/90000') !== -1 && !info.h264LineNumber) {\r\n\t\t\t\t\t\t\tinfo.h264LineNumber = line.replace('a=rtpmap:', '').split(' ')[0];\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\treturn info;\r\n\t}\r\n\r\n\tfunction removeVPX(sdp) {\r\n\t\t\tvar info = splitLines(sdp);\r\n\r\n\t\t\t// last parameter below means: ignore these codecs\r\n\t\t\tsdp = preferCodecHelper(sdp, 'vp9', info, true);\r\n\t\t\tsdp = preferCodecHelper(sdp, 'vp8', info, true);\r\n\r\n\t\t\treturn sdp;\r\n\t}\r\n\r\n\tfunction disableNACK(sdp) {\r\n\t\t\tif (!sdp || typeof sdp !== 'string') {\r\n\t\t\t\t\tthrow 'Invalid arguments.';\r\n\t\t\t}\r\n\r\n\t\t\tsdp = sdp.replace('a=rtcp-fb:126 nack\\r\\n', '');\r\n\t\t\tsdp = sdp.replace('a=rtcp-fb:126 nack pli\\r\\n', 'a=rtcp-fb:126 pli\\r\\n');\r\n\t\t\tsdp = sdp.replace('a=rtcp-fb:97 nack\\r\\n', '');\r\n\t\t\tsdp = sdp.replace('a=rtcp-fb:97 nack pli\\r\\n', 'a=rtcp-fb:97 pli\\r\\n');\r\n\r\n\t\t\treturn sdp;\r\n\t}\r\n\r\n\tfunction prioritize(codecMimeType, peer) {\r\n\t\t\tif (!peer || !peer.getSenders || !peer.getSenders().length) {\r\n\t\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!codecMimeType || typeof codecMimeType !== 'string') {\r\n\t\t\t\t\tthrow 'Invalid arguments.';\r\n\t\t\t}\r\n\r\n\t\t\tpeer.getSenders().forEach(function(sender) {\r\n\t\t\t\t\tvar params = sender.getParameters();\r\n\t\t\t\t\tfor (var i = 0; i < params.codecs.length; i++) {\r\n\t\t\t\t\t\t\tif (params.codecs[i].mimeType == codecMimeType) {\r\n\t\t\t\t\t\t\t\t\tparams.codecs.unshift(params.codecs.splice(i, 1));\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsender.setParameters(params);\r\n\t\t\t});\r\n\t}\r\n\r\n\tfunction removeNonG722(sdp) {\r\n\t\t\treturn sdp.replace(/m=audio ([0-9]+) RTP\\/SAVPF ([0-9 ]*)/g, 'm=audio $1 RTP\\/SAVPF 9');\r\n\t}\r\n\r\n\tfunction setBAS(sdp, bandwidth, isScreen) {\r\n\t\t\tif (!bandwidth) {\r\n\t\t\t\t\treturn sdp;\r\n\t\t\t}\r\n\r\n\t\t\tif (typeof isFirefox !== 'undefined' && isFirefox) {\r\n\t\t\t\t\treturn sdp;\r\n\t\t\t}\r\n\r\n\t\t\tif (isScreen) {\r\n\t\t\t\t\tif (!bandwidth.screen) {\r\n\t\t\t\t\t\t\tconsole.warn('It seems that you are not using bandwidth for screen. Screen sharing is expected to fail.');\r\n\t\t\t\t\t} else if (bandwidth.screen < 300) {\r\n\t\t\t\t\t\t\tconsole.warn('It seems that you are using wrong bandwidth value for screen. Screen sharing is expected to fail.');\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// if screen; must use at least 300kbs\r\n\t\t\tif (bandwidth.screen && isScreen) {\r\n\t\t\t\t\tsdp = sdp.replace(/b=AS([^\\r\\n]+\\r\\n)/g, '');\r\n\t\t\t\t\tsdp = sdp.replace(/a=mid:video\\r\\n/g, 'a=mid:video\\r\\nb=AS:' + bandwidth.screen + '\\r\\n');\r\n\t\t\t}\r\n\r\n\t\t\t// remove existing bandwidth lines\r\n\t\t\tif (bandwidth.audio || bandwidth.video) {\r\n\t\t\t\t\tsdp = sdp.replace(/b=AS([^\\r\\n]+\\r\\n)/g, '');\r\n\t\t\t}\r\n\r\n\t\t\tif (bandwidth.audio) {\r\n\t\t\t\t\tsdp = sdp.replace(/a=mid:audio\\r\\n/g, 'a=mid:audio\\r\\nb=AS:' + bandwidth.audio + '\\r\\n');\r\n\t\t\t}\r\n\r\n\t\t\tif (bandwidth.screen) {\r\n\t\t\t\t\tsdp = sdp.replace(/a=mid:video\\r\\n/g, 'a=mid:video\\r\\nb=AS:' + bandwidth.screen + '\\r\\n');\r\n\t\t\t} else if (bandwidth.video) {\r\n\t\t\t\t\tsdp = sdp.replace(/a=mid:video\\r\\n/g, 'a=mid:video\\r\\nb=AS:' + bandwidth.video + '\\r\\n');\r\n\t\t\t}\r\n\r\n\t\t\treturn sdp;\r\n\t}\r\n\r\n\t// Find the line in sdpLines that starts with |prefix|, and, if specified,\r\n\t// contains |substr| (case-insensitive search).\r\n\tfunction findLine(sdpLines, prefix, substr) {\r\n\t\t\treturn findLineInRange(sdpLines, 0, -1, prefix, substr);\r\n\t}\r\n\r\n\t// Find the line in sdpLines[startLine...endLine - 1] that starts with |prefix|\r\n\t// and, if specified, contains |substr| (case-insensitive search).\r\n\tfunction findLineInRange(sdpLines, startLine, endLine, prefix, substr) {\r\n\t\t\tvar realEndLine = endLine !== -1 ? endLine : sdpLines.length;\r\n\t\t\tfor (var i = startLine; i < realEndLine; ++i) {\r\n\t\t\t\t\tif (sdpLines[i].indexOf(prefix) === 0) {\r\n\t\t\t\t\t\t\tif (!substr ||\r\n\t\t\t\t\t\t\t\t\tsdpLines[i].toLowerCase().indexOf(substr.toLowerCase()) !== -1) {\r\n\t\t\t\t\t\t\t\t\treturn i;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t}\r\n\r\n\t// Gets the codec payload type from an a=rtpmap:X line.\r\n\tfunction getCodecPayloadType(sdpLine) {\r\n\t\t\tvar pattern = new RegExp('a=rtpmap:(\\\\d+) \\\\w+\\\\/\\\\d+');\r\n\t\t\tvar result = sdpLine.match(pattern);\r\n\t\t\treturn (result && result.length === 2) ? result[1] : null;\r\n\t}\r\n\r\n\tfunction setVideoBitrates(sdp, params) {\r\n\t\t\tparams = params || {};\r\n\t\t\tvar xgoogle_min_bitrate = params.min;\r\n\t\t\tvar xgoogle_max_bitrate = params.max;\r\n\r\n\t\t\tvar sdpLines = sdp.split('\\r\\n');\r\n\r\n\t\t\t// VP8\r\n\t\t\tvar vp8Index = findLine(sdpLines, 'a=rtpmap', 'VP8/90000');\r\n\t\t\tvar vp8Payload;\r\n\t\t\tif (vp8Index) {\r\n\t\t\t\t\tvp8Payload = getCodecPayloadType(sdpLines[vp8Index]);\r\n\t\t\t}\r\n\r\n\t\t\tif (!vp8Payload) {\r\n\t\t\t\t\treturn sdp;\r\n\t\t\t}\r\n\r\n\t\t\tvar rtxIndex = findLine(sdpLines, 'a=rtpmap', 'rtx/90000');\r\n\t\t\tvar rtxPayload;\r\n\t\t\tif (rtxIndex) {\r\n\t\t\t\t\trtxPayload = getCodecPayloadType(sdpLines[rtxIndex]);\r\n\t\t\t}\r\n\r\n\t\t\tif (!rtxIndex) {\r\n\t\t\t\t\treturn sdp;\r\n\t\t\t}\r\n\r\n\t\t\tvar rtxFmtpLineIndex = findLine(sdpLines, 'a=fmtp:' + rtxPayload.toString());\r\n\t\t\tif (rtxFmtpLineIndex !== null) {\r\n\t\t\t\t\tvar appendrtxNext = '\\r\\n';\r\n\t\t\t\t\tappendrtxNext += 'a=fmtp:' + vp8Payload + ' x-google-min-bitrate=' + (xgoogle_min_bitrate || '228') + '; x-google-max-bitrate=' + (xgoogle_max_bitrate || '228');\r\n\t\t\t\t\tsdpLines[rtxFmtpLineIndex] = sdpLines[rtxFmtpLineIndex].concat(appendrtxNext);\r\n\t\t\t\t\tsdp = sdpLines.join('\\r\\n');\r\n\t\t\t}\r\n\r\n\t\t\treturn sdp;\r\n\t}\r\n\r\n\tfunction setOpusAttributes(sdp, params) {\r\n\t\t\tparams = params || {};\r\n\r\n\t\t\tvar sdpLines = sdp.split('\\r\\n');\r\n\r\n\t\t\t// Opus\r\n\t\t\tvar opusIndex = findLine(sdpLines, 'a=rtpmap', 'opus/48000');\r\n\t\t\tvar opusPayload;\r\n\t\t\tif (opusIndex) {\r\n\t\t\t\t\topusPayload = getCodecPayloadType(sdpLines[opusIndex]);\r\n\t\t\t}\r\n\r\n\t\t\tif (!opusPayload) {\r\n\t\t\t\t\treturn sdp;\r\n\t\t\t}\r\n\r\n\t\t\tvar opusFmtpLineIndex = findLine(sdpLines, 'a=fmtp:' + opusPayload.toString());\r\n\t\t\tif (opusFmtpLineIndex === null) {\r\n\t\t\t\t\treturn sdp;\r\n\t\t\t}\r\n\r\n\t\t\tvar appendOpusNext = '';\r\n\t\t\tappendOpusNext += '; stereo=' + (typeof params.stereo != 'undefined' ? params.stereo : '1');\r\n\t\t\tappendOpusNext += '; sprop-stereo=' + (typeof params['sprop-stereo'] != 'undefined' ? params['sprop-stereo'] : '1');\r\n\r\n\t\t\tif (typeof params.maxaveragebitrate != 'undefined') {\r\n\t\t\t\t\tappendOpusNext += '; maxaveragebitrate=' + (params.maxaveragebitrate || 128 * 1024 * 8);\r\n\t\t\t}\r\n\r\n\t\t\tif (typeof params.maxplaybackrate != 'undefined') {\r\n\t\t\t\t\tappendOpusNext += '; maxplaybackrate=' + (params.maxplaybackrate || 128 * 1024 * 8);\r\n\t\t\t}\r\n\r\n\t\t\tif (typeof params.cbr != 'undefined') {\r\n\t\t\t\t\tappendOpusNext += '; cbr=' + (typeof params.cbr != 'undefined' ? params.cbr : '1');\r\n\t\t\t}\r\n\r\n\t\t\tif (typeof params.useinbandfec != 'undefined') {\r\n\t\t\t\t\tappendOpusNext += '; useinbandfec=' + params.useinbandfec;\r\n\t\t\t}\r\n\r\n\t\t\tif (typeof params.usedtx != 'undefined') {\r\n\t\t\t\t\tappendOpusNext += '; usedtx=' + params.usedtx;\r\n\t\t\t}\r\n\r\n\t\t\tif (typeof params.maxptime != 'undefined') {\r\n\t\t\t\t\tappendOpusNext += '\\r\\na=maxptime:' + params.maxptime;\r\n\t\t\t}\r\n\r\n\t\t\tsdpLines[opusFmtpLineIndex] = sdpLines[opusFmtpLineIndex].concat(appendOpusNext);\r\n\r\n\t\t\tsdp = sdpLines.join('\\r\\n');\r\n\t\t\treturn sdp;\r\n\t}\r\n\r\n\t// forceStereoAudio => via webrtcexample.com\r\n\t// requires getUserMedia => echoCancellation:false\r\n\tfunction forceStereoAudio(sdp) {\r\n\t\t\tvar sdpLines = sdp.split('\\r\\n');\r\n\t\t\tvar fmtpLineIndex = null;\r\n\t\t\tfor (var i = 0; i < sdpLines.length; i++) {\r\n\t\t\t\t\tif (sdpLines[i].search('opus/48000') !== -1) {\r\n\t\t\t\t\t\t\tvar opusPayload = extractSdp(sdpLines[i], /:(\\d+) opus\\/48000/i);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < sdpLines.length; i++) {\r\n\t\t\t\t\tif (sdpLines[i].search('a=fmtp') !== -1) {\r\n\t\t\t\t\t\t\tvar payload = extractSdp(sdpLines[i], /a=fmtp:(\\d+)/);\r\n\t\t\t\t\t\t\tif (payload === opusPayload) {\r\n\t\t\t\t\t\t\t\t\tfmtpLineIndex = i;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (fmtpLineIndex === null) return sdp;\r\n\t\t\tsdpLines[fmtpLineIndex] = sdpLines[fmtpLineIndex].concat('; stereo=1; sprop-stereo=1');\r\n\t\t\tsdp = sdpLines.join('\\r\\n');\r\n\t\t\treturn sdp;\r\n\t}\r\n\r\n\treturn {\r\n\t\t\tremoveVPX: removeVPX,\r\n\t\t\tdisableNACK: disableNACK,\r\n\t\t\tprioritize: prioritize,\r\n\t\t\tremoveNonG722: removeNonG722,\r\n\t\t\tsetApplicationSpecificBandwidth: function(sdp, bandwidth, isScreen) {\r\n\t\t\t\t\treturn setBAS(sdp, bandwidth, isScreen);\r\n\t\t\t},\r\n\t\t\tsetVideoBitrates: function(sdp, params) {\r\n\t\t\t\t\treturn setVideoBitrates(sdp, params);\r\n\t\t\t},\r\n\t\t\tsetOpusAttributes: function(sdp, params) {\r\n\t\t\t\t\treturn setOpusAttributes(sdp, params);\r\n\t\t\t},\r\n\t\t\tpreferVP9: function(sdp) {\r\n\t\t\t\t\treturn preferCodec(sdp, 'vp9');\r\n\t\t\t},\r\n\t\t\tpreferCodec: preferCodec,\r\n\t\t\tforceStereoAudio: forceStereoAudio\r\n\t};\r\n})();\r\n\r\n// backward compatibility\r\nwindow.BandwidthHandler = CodecsHandler;","'use strict';\r\n\r\n// Last time updated: 2019-02-20 3:31:30 PM UTC\r\n\r\n// _______________\r\n// getStats v1.2.0\r\n\r\n// Open-Sourced: https://github.com/muaz-khan/getStats\r\n\r\n// --------------------------------------------------\r\n// Muaz Khan     - www.MuazKhan.com\r\n// MIT License   - www.WebRTC-Experiment.com/licence\r\n// --------------------------------------------------\r\n\r\n\"use strict\";var getStats=function(mediaStreamTrack,callback,interval){function getStatsLooper(){getStatsWrapper(function(results){if(results&&results.forEach){results.forEach(function(result){Object.keys(getStatsParser).forEach(function(key){if(\"function\"==typeof getStatsParser[key])try{getStatsParser[key](result)}catch(e){console.error(e.message,e.stack,e)}})});try{peer.iceConnectionState.search(/failed|closed|disconnected/gi)!==-1&&(nomore=!0)}catch(e){nomore=!0}nomore===!0&&(getStatsResult.datachannel&&(getStatsResult.datachannel.state=\"close\"),getStatsResult.ended=!0),getStatsResult.results=results,getStatsResult.audio&&getStatsResult.video&&(getStatsResult.bandwidth.speed=getStatsResult.audio.bytesSent-getStatsResult.bandwidth.helper.audioBytesSent+(getStatsResult.video.bytesSent-getStatsResult.bandwidth.helper.videoBytesSent),getStatsResult.bandwidth.helper.audioBytesSent=getStatsResult.audio.bytesSent,getStatsResult.bandwidth.helper.videoBytesSent=getStatsResult.video.bytesSent),callback(getStatsResult),nomore||void 0!=typeof interval&&interval&&setTimeout(getStatsLooper,interval||1e3)}})}function getStatsWrapper(cb){\"undefined\"!=typeof window.InstallTrigger||isSafari?peer.getStats(window.mediaStreamTrack||null).then(function(res){var items=[];res.forEach(function(r){items.push(r)}),cb(items)})[\"catch\"](cb):peer.getStats(function(res){var items=[];res.result().forEach(function(res){var item={};res.names().forEach(function(name){item[name]=res.stat(name)}),item.id=res.id,item.type=res.type,item.timestamp=res.timestamp,items.push(item)}),cb(items)})}var browserFakeUserAgent=\"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45\";!function(that){that&&\"undefined\"==typeof window&&\"undefined\"!=typeof global&&(global.navigator={userAgent:browserFakeUserAgent,getUserMedia:function(){}},global.console||(global.console={}),\"undefined\"!=typeof global.console.log&&\"undefined\"!=typeof global.console.error||(global.console.error=global.console.log=global.console.log||function(){console.log(arguments)}),\"undefined\"==typeof document&&(that.document={documentElement:{appendChild:function(){return\"\"}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var obj={getContext:function(){return obj},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return\"\"}};return obj},that.HTMLVideoElement=function(){}),\"undefined\"==typeof location&&(that.location={protocol:\"file:\",href:\"\",hash:\"\"}),\"undefined\"==typeof screen&&(that.screen={width:0,height:0}),\"undefined\"==typeof URL&&(that.URL={createObjectURL:function(){return\"\"},revokeObjectURL:function(){return\"\"}}),\"undefined\"==typeof MediaStreamTrack&&(that.MediaStreamTrack=function(){}),\"undefined\"==typeof RTCPeerConnection&&(that.RTCPeerConnection=function(){}),that.window=global)}(\"undefined\"!=typeof global?global:null);var RTCPeerConnection=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;\"undefined\"==typeof MediaStreamTrack&&(MediaStreamTrack={});var systemNetworkType=((navigator.connection||{}).type||\"unknown\").toString().toLowerCase(),getStatsResult={encryption:\"sha-256\",audio:{send:{tracks:[],codecs:[],availableBandwidth:0,streams:0,framerateMean:0,bitrateMean:0},recv:{tracks:[],codecs:[],availableBandwidth:0,streams:0,framerateMean:0,bitrateMean:0},bytesSent:0,bytesReceived:0,latency:0,packetsLost:0},video:{send:{tracks:[],codecs:[],availableBandwidth:0,streams:0,framerateMean:0,bitrateMean:0},recv:{tracks:[],codecs:[],availableBandwidth:0,streams:0,framerateMean:0,bitrateMean:0},bytesSent:0,bytesReceived:0,latency:0,packetsLost:0},bandwidth:{systemBandwidth:0,sentPerSecond:0,encodedPerSecond:0,helper:{audioBytesSent:0,videoBytestSent:0},speed:0},results:{},connectionType:{systemNetworkType:systemNetworkType,systemIpAddress:\"192.168.1.2\",local:{candidateType:[],transport:[],ipAddress:[],networkType:[]},remote:{candidateType:[],transport:[],ipAddress:[],networkType:[]}},resolutions:{send:{width:0,height:0},recv:{width:0,height:0}},internal:{audio:{send:{},recv:{}},video:{send:{},recv:{}},candidates:{}},nomore:function(){nomore=!0}},getStatsParser={checkIfOfferer:function(result){\"googLibjingleSession\"===result.type&&(getStatsResult.isOfferer=result.googInitiator)}},isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),peer=this;if(!(arguments[0]instanceof RTCPeerConnection))throw\"1st argument is not instance of RTCPeerConnection.\";peer=arguments[0],arguments[1]instanceof MediaStreamTrack&&(mediaStreamTrack=arguments[1],callback=arguments[2],interval=arguments[3]);var nomore=!1;getStatsParser.datachannel=function(result){\"datachannel\"===result.type&&(getStatsResult.datachannel={state:result.state})},getStatsParser.googCertificate=function(result){\"googCertificate\"==result.type&&(getStatsResult.encryption=result.googFingerprintAlgorithm),\"certificate\"==result.type&&(getStatsResult.encryption=result.fingerprintAlgorithm)},getStatsParser.checkAudioTracks=function(result){if(\"audio\"===result.mediaType){var sendrecvType=result.id.split(\"_\").pop();if(result.isRemote===!0&&(sendrecvType=\"recv\"),result.isRemote===!1&&(sendrecvType=\"send\"),sendrecvType){if(getStatsResult.audio[sendrecvType].codecs.indexOf(result.googCodecName||\"opus\")===-1&&getStatsResult.audio[sendrecvType].codecs.push(result.googCodecName||\"opus\"),result.bytesSent){var kilobytes=0;getStatsResult.internal.audio[sendrecvType].prevBytesSent||(getStatsResult.internal.audio[sendrecvType].prevBytesSent=result.bytesSent);var bytes=result.bytesSent-getStatsResult.internal.audio[sendrecvType].prevBytesSent;getStatsResult.internal.audio[sendrecvType].prevBytesSent=result.bytesSent,kilobytes=bytes/1024,getStatsResult.audio[sendrecvType].availableBandwidth=kilobytes.toFixed(1),getStatsResult.audio.bytesSent=kilobytes.toFixed(1)}if(result.bytesReceived){var kilobytes=0;getStatsResult.internal.audio[sendrecvType].prevBytesReceived||(getStatsResult.internal.audio[sendrecvType].prevBytesReceived=result.bytesReceived);var bytes=result.bytesReceived-getStatsResult.internal.audio[sendrecvType].prevBytesReceived;getStatsResult.internal.audio[sendrecvType].prevBytesReceived=result.bytesReceived,kilobytes=bytes/1024,getStatsResult.audio.bytesReceived=kilobytes.toFixed(1)}if(result.googTrackId&&getStatsResult.audio[sendrecvType].tracks.indexOf(result.googTrackId)===-1&&getStatsResult.audio[sendrecvType].tracks.push(result.googTrackId),result.googCurrentDelayMs){var kilobytes=0;getStatsResult.internal.audio.prevGoogCurrentDelayMs||(getStatsResult.internal.audio.prevGoogCurrentDelayMs=result.googCurrentDelayMs);var bytes=result.googCurrentDelayMs-getStatsResult.internal.audio.prevGoogCurrentDelayMs;getStatsResult.internal.audio.prevGoogCurrentDelayMs=result.googCurrentDelayMs,getStatsResult.audio.latency=bytes.toFixed(1),getStatsResult.audio.latency<0&&(getStatsResult.audio.latency=0)}if(result.packetsLost){var kilobytes=0;getStatsResult.internal.audio.prevPacketsLost||(getStatsResult.internal.audio.prevPacketsLost=result.packetsLost);var bytes=result.packetsLost-getStatsResult.internal.audio.prevPacketsLost;getStatsResult.internal.audio.prevPacketsLost=result.packetsLost,getStatsResult.audio.packetsLost=bytes.toFixed(1),getStatsResult.audio.packetsLost<0&&(getStatsResult.audio.packetsLost=0)}}}},getStatsParser.checkVideoTracks=function(result){if(\"video\"===result.mediaType){var sendrecvType=result.id.split(\"_\").pop();if(result.isRemote===!0&&(sendrecvType=\"recv\"),result.isRemote===!1&&(sendrecvType=\"send\"),sendrecvType){if(getStatsResult.video[sendrecvType].codecs.indexOf(result.googCodecName||\"VP8\")===-1&&getStatsResult.video[sendrecvType].codecs.push(result.googCodecName||\"VP8\"),result.bytesSent){var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevBytesSent||(getStatsResult.internal.video[sendrecvType].prevBytesSent=result.bytesSent);var bytes=result.bytesSent-getStatsResult.internal.video[sendrecvType].prevBytesSent;getStatsResult.internal.video[sendrecvType].prevBytesSent=result.bytesSent,kilobytes=bytes/1024,getStatsResult.video[sendrecvType].availableBandwidth=kilobytes.toFixed(1),getStatsResult.video.bytesSent=kilobytes.toFixed(1)}if(result.bytesReceived){var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevBytesReceived||(getStatsResult.internal.video[sendrecvType].prevBytesReceived=result.bytesReceived);var bytes=result.bytesReceived-getStatsResult.internal.video[sendrecvType].prevBytesReceived;getStatsResult.internal.video[sendrecvType].prevBytesReceived=result.bytesReceived,kilobytes=bytes/1024,getStatsResult.video.bytesReceived=kilobytes.toFixed(1)}if(result.googFrameHeightReceived&&result.googFrameWidthReceived&&(getStatsResult.resolutions[sendrecvType].width=result.googFrameWidthReceived,getStatsResult.resolutions[sendrecvType].height=result.googFrameHeightReceived),result.googFrameHeightSent&&result.googFrameWidthSent&&(getStatsResult.resolutions[sendrecvType].width=result.googFrameWidthSent,getStatsResult.resolutions[sendrecvType].height=result.googFrameHeightSent),result.googTrackId&&getStatsResult.video[sendrecvType].tracks.indexOf(result.googTrackId)===-1&&getStatsResult.video[sendrecvType].tracks.push(result.googTrackId),result.framerateMean){getStatsResult.bandwidth.framerateMean=result.framerateMean;var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevFramerateMean||(getStatsResult.internal.video[sendrecvType].prevFramerateMean=result.bitrateMean);var bytes=result.bytesSent-getStatsResult.internal.video[sendrecvType].prevFramerateMean;getStatsResult.internal.video[sendrecvType].prevFramerateMean=result.framerateMean,kilobytes=bytes/1024,getStatsResult.video[sendrecvType].framerateMean=bytes.toFixed(1)}if(result.bitrateMean){getStatsResult.bandwidth.bitrateMean=result.bitrateMean;var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevBitrateMean||(getStatsResult.internal.video[sendrecvType].prevBitrateMean=result.bitrateMean);var bytes=result.bytesSent-getStatsResult.internal.video[sendrecvType].prevBitrateMean;getStatsResult.internal.video[sendrecvType].prevBitrateMean=result.bitrateMean,kilobytes=bytes/1024,getStatsResult.video[sendrecvType].bitrateMean=bytes.toFixed(1)}if(result.googCurrentDelayMs){var kilobytes=0;getStatsResult.internal.video.prevGoogCurrentDelayMs||(getStatsResult.internal.video.prevGoogCurrentDelayMs=result.googCurrentDelayMs);var bytes=result.googCurrentDelayMs-getStatsResult.internal.video.prevGoogCurrentDelayMs;getStatsResult.internal.video.prevGoogCurrentDelayMs=result.googCurrentDelayMs,getStatsResult.video.latency=bytes.toFixed(1),getStatsResult.video.latency<0&&(getStatsResult.video.latency=0)}if(result.packetsLost){var kilobytes=0;getStatsResult.internal.video.prevPacketsLost||(getStatsResult.internal.video.prevPacketsLost=result.packetsLost);var bytes=result.packetsLost-getStatsResult.internal.video.prevPacketsLost;getStatsResult.internal.video.prevPacketsLost=result.packetsLost,getStatsResult.video.packetsLost=bytes.toFixed(1),getStatsResult.video.packetsLost<0&&(getStatsResult.video.packetsLost=0)}}}},getStatsParser.bweforvideo=function(result){\"VideoBwe\"===result.type&&(getStatsResult.bandwidth.availableSendBandwidth=result.googAvailableSendBandwidth,getStatsResult.bandwidth.googActualEncBitrate=result.googActualEncBitrate,getStatsResult.bandwidth.googAvailableSendBandwidth=result.googAvailableSendBandwidth,getStatsResult.bandwidth.googAvailableReceiveBandwidth=result.googAvailableReceiveBandwidth,getStatsResult.bandwidth.googRetransmitBitrate=result.googRetransmitBitrate,getStatsResult.bandwidth.googTargetEncBitrate=result.googTargetEncBitrate,getStatsResult.bandwidth.googBucketDelay=result.googBucketDelay,getStatsResult.bandwidth.googTransmitBitrate=result.googTransmitBitrate)},getStatsParser.candidatePair=function(result){if(\"googCandidatePair\"===result.type||\"candidate-pair\"===result.type||\"local-candidate\"===result.type||\"remote-candidate\"===result.type){if(\"true\"==result.googActiveConnection){Object.keys(getStatsResult.internal.candidates).forEach(function(cid){var candidate=getStatsResult.internal.candidates[cid];candidate.ipAddress.indexOf(result.googLocalAddress)!==-1&&(getStatsResult.connectionType.local.candidateType=candidate.candidateType,getStatsResult.connectionType.local.ipAddress=candidate.ipAddress,getStatsResult.connectionType.local.networkType=candidate.networkType,getStatsResult.connectionType.local.transport=candidate.transport),candidate.ipAddress.indexOf(result.googRemoteAddress)!==-1&&(getStatsResult.connectionType.remote.candidateType=candidate.candidateType,getStatsResult.connectionType.remote.ipAddress=candidate.ipAddress,getStatsResult.connectionType.remote.networkType=candidate.networkType,getStatsResult.connectionType.remote.transport=candidate.transport)}),getStatsResult.connectionType.transport=result.googTransportType;var localCandidate=getStatsResult.internal.candidates[result.localCandidateId];localCandidate&&localCandidate.ipAddress&&(getStatsResult.connectionType.systemIpAddress=localCandidate.ipAddress);var remoteCandidate=getStatsResult.internal.candidates[result.remoteCandidateId];remoteCandidate&&remoteCandidate.ipAddress&&(getStatsResult.connectionType.systemIpAddress=remoteCandidate.ipAddress)}if(\"candidate-pair\"===result.type&&result.selected===!0&&result.nominated===!0&&\"succeeded\"===result.state)var localCandidate=getStatsResult.internal.candidates[result.remoteCandidateId],remoteCandidate=getStatsResult.internal.candidates[result.remoteCandidateId];if(\"local-candidate\"===result.type&&(getStatsResult.connectionType.local.candidateType=result.candidateType,getStatsResult.connectionType.local.ipAddress=result.ipAddress,getStatsResult.connectionType.local.networkType=result.networkType,getStatsResult.connectionType.local.transport=result.mozLocalTransport||result.transport),\"remote-candidate\"===result.type&&(getStatsResult.connectionType.remote.candidateType=result.candidateType,getStatsResult.connectionType.remote.ipAddress=result.ipAddress,getStatsResult.connectionType.remote.networkType=result.networkType,getStatsResult.connectionType.remote.transport=result.mozRemoteTransport||result.transport),isSafari){var sendrecvType=result.localCandidateId?\"send\":\"recv\";if(!sendrecvType)return;if(result.bytesSent){var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevBytesSent||(getStatsResult.internal.video[sendrecvType].prevBytesSent=result.bytesSent);var bytes=result.bytesSent-getStatsResult.internal.video[sendrecvType].prevBytesSent;getStatsResult.internal.video[sendrecvType].prevBytesSent=result.bytesSent,kilobytes=bytes/1024,getStatsResult.video[sendrecvType].availableBandwidth=kilobytes.toFixed(1),getStatsResult.video.bytesSent=kilobytes.toFixed(1)}if(result.bytesReceived){var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevBytesReceived||(getStatsResult.internal.video[sendrecvType].prevBytesReceived=result.bytesReceived);var bytes=result.bytesReceived-getStatsResult.internal.video[sendrecvType].prevBytesReceived;getStatsResult.internal.video[sendrecvType].prevBytesReceived=result.bytesReceived,kilobytes=bytes/1024,getStatsResult.video.bytesReceived=kilobytes.toFixed(1)}if(result.availableOutgoingBitrate){var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevAvailableOutgoingBitrate||(getStatsResult.internal.video[sendrecvType].prevAvailableOutgoingBitrate=result.availableOutgoingBitrate);var bytes=result.availableOutgoingBitrate-getStatsResult.internal.video[sendrecvType].prevAvailableOutgoingBitrate;getStatsResult.internal.video[sendrecvType].prevAvailableOutgoingBitrate=result.availableOutgoingBitrate,kilobytes=bytes/1024,getStatsResult.video.availableOutgoingBitrate=kilobytes.toFixed(1)}if(result.availableIncomingBitrate){var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevAvailableIncomingBitrate||(getStatsResult.internal.video[sendrecvType].prevAvailableIncomingBitrate=result.availableIncomingBitrate);var bytes=result.availableIncomingBitrate-getStatsResult.internal.video[sendrecvType].prevAvailableIncomingBitrate;getStatsResult.internal.video[sendrecvType].prevAvailableIncomingBitrate=result.availableIncomingBitrate,kilobytes=bytes/1024,getStatsResult.video.availableIncomingBitrate=kilobytes.toFixed(1)}}}};var LOCAL_candidateType={},LOCAL_transport={},LOCAL_ipAddress={},LOCAL_networkType={};getStatsParser.localcandidate=function(result){\"localcandidate\"!==result.type&&\"local-candidate\"!==result.type||result.id&&(LOCAL_candidateType[result.id]||(LOCAL_candidateType[result.id]=[]),LOCAL_transport[result.id]||(LOCAL_transport[result.id]=[]),LOCAL_ipAddress[result.id]||(LOCAL_ipAddress[result.id]=[]),LOCAL_networkType[result.id]||(LOCAL_networkType[result.id]=[]),result.candidateType&&LOCAL_candidateType[result.id].indexOf(result.candidateType)===-1&&LOCAL_candidateType[result.id].push(result.candidateType),result.transport&&LOCAL_transport[result.id].indexOf(result.transport)===-1&&LOCAL_transport[result.id].push(result.transport),result.ipAddress&&LOCAL_ipAddress[result.id].indexOf(result.ipAddress+\":\"+result.portNumber)===-1&&LOCAL_ipAddress[result.id].push(result.ipAddress+\":\"+result.portNumber),result.networkType&&LOCAL_networkType[result.id].indexOf(result.networkType)===-1&&LOCAL_networkType[result.id].push(result.networkType),getStatsResult.internal.candidates[result.id]={candidateType:LOCAL_candidateType[result.id],ipAddress:LOCAL_ipAddress[result.id],portNumber:result.portNumber,networkType:LOCAL_networkType[result.id],priority:result.priority,transport:LOCAL_transport[result.id],timestamp:result.timestamp,id:result.id,type:result.type},getStatsResult.connectionType.local.candidateType=LOCAL_candidateType[result.id],getStatsResult.connectionType.local.ipAddress=LOCAL_ipAddress[result.id],getStatsResult.connectionType.local.networkType=LOCAL_networkType[result.id],getStatsResult.connectionType.local.transport=LOCAL_transport[result.id])};var REMOTE_candidateType={},REMOTE_transport={},REMOTE_ipAddress={},REMOTE_networkType={};getStatsParser.remotecandidate=function(result){\"remotecandidate\"!==result.type&&\"remote-candidate\"!==result.type||result.id&&(REMOTE_candidateType[result.id]||(REMOTE_candidateType[result.id]=[]),REMOTE_transport[result.id]||(REMOTE_transport[result.id]=[]),REMOTE_ipAddress[result.id]||(REMOTE_ipAddress[result.id]=[]),REMOTE_networkType[result.id]||(REMOTE_networkType[result.id]=[]),result.candidateType&&REMOTE_candidateType[result.id].indexOf(result.candidateType)===-1&&REMOTE_candidateType[result.id].push(result.candidateType),result.transport&&REMOTE_transport[result.id].indexOf(result.transport)===-1&&REMOTE_transport[result.id].push(result.transport),result.ipAddress&&REMOTE_ipAddress[result.id].indexOf(result.ipAddress+\":\"+result.portNumber)===-1&&REMOTE_ipAddress[result.id].push(result.ipAddress+\":\"+result.portNumber),result.networkType&&REMOTE_networkType[result.id].indexOf(result.networkType)===-1&&REMOTE_networkType[result.id].push(result.networkType),getStatsResult.internal.candidates[result.id]={candidateType:REMOTE_candidateType[result.id],ipAddress:REMOTE_ipAddress[result.id],portNumber:result.portNumber,networkType:REMOTE_networkType[result.id],priority:result.priority,transport:REMOTE_transport[result.id],timestamp:result.timestamp,id:result.id,type:result.type},getStatsResult.connectionType.remote.candidateType=REMOTE_candidateType[result.id],getStatsResult.connectionType.remote.ipAddress=REMOTE_ipAddress[result.id],getStatsResult.connectionType.remote.networkType=REMOTE_networkType[result.id],getStatsResult.connectionType.remote.transport=REMOTE_transport[result.id])},getStatsParser.dataSentReceived=function(result){!result.googCodecName||\"video\"!==result.mediaType&&\"audio\"!==result.mediaType||(result.bytesSent&&(getStatsResult[result.mediaType].bytesSent=parseInt(result.bytesSent)),result.bytesReceived&&(getStatsResult[result.mediaType].bytesReceived=parseInt(result.bytesReceived)))},getStatsParser.inboundrtp=function(result){if(isSafari&&\"inbound-rtp\"===result.type){var mediaType=result.mediaType||\"audio\",sendrecvType=result.isRemote?\"recv\":\"send\";if(sendrecvType){if(result.bytesSent){var kilobytes=0;getStatsResult.internal[mediaType][sendrecvType].prevBytesSent||(getStatsResult.internal[mediaType][sendrecvType].prevBytesSent=result.bytesSent);var bytes=result.bytesSent-getStatsResult.internal[mediaType][sendrecvType].prevBytesSent;getStatsResult.internal[mediaType][sendrecvType].prevBytesSent=result.bytesSent,kilobytes=bytes/1024,getStatsResult[mediaType][sendrecvType].availableBandwidth=kilobytes.toFixed(1),getStatsResult[mediaType].bytesSent=kilobytes.toFixed(1)}if(result.bytesReceived){var kilobytes=0;getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived||(getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived=result.bytesReceived);var bytes=result.bytesReceived-getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived;getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived=result.bytesReceived,kilobytes=bytes/1024,getStatsResult[mediaType].bytesReceived=kilobytes.toFixed(1)}}}},getStatsParser.outboundrtp=function(result){if(isSafari&&\"outbound-rtp\"===result.type){var mediaType=result.mediaType||\"audio\",sendrecvType=result.isRemote?\"recv\":\"send\";if(sendrecvType){if(result.bytesSent){var kilobytes=0;getStatsResult.internal[mediaType][sendrecvType].prevBytesSent||(getStatsResult.internal[mediaType][sendrecvType].prevBytesSent=result.bytesSent);var bytes=result.bytesSent-getStatsResult.internal[mediaType][sendrecvType].prevBytesSent;getStatsResult.internal[mediaType][sendrecvType].prevBytesSent=result.bytesSent,kilobytes=bytes/1024,getStatsResult[mediaType][sendrecvType].availableBandwidth=kilobytes.toFixed(1),getStatsResult[mediaType].bytesSent=kilobytes.toFixed(1)}if(result.bytesReceived){var kilobytes=0;getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived||(getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived=result.bytesReceived);var bytes=result.bytesReceived-getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived;getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived=result.bytesReceived,kilobytes=bytes/1024,getStatsResult[mediaType].bytesReceived=kilobytes.toFixed(1)}}}},getStatsParser.track=function(result){if(isSafari&&\"track\"===result.type){var sendrecvType=result.remoteSource===!0?\"send\":\"recv\";result.frameWidth&&result.frameHeight&&(getStatsResult.resolutions[sendrecvType].width=result.frameWidth,getStatsResult.resolutions[sendrecvType].height=result.frameHeight)}};var SSRC={audio:{send:[],recv:[]},video:{send:[],recv:[]}};getStatsParser.ssrc=function(result){if(result.googCodecName&&(\"video\"===result.mediaType||\"audio\"===result.mediaType)&&\"ssrc\"===result.type){var sendrecvType=result.id.split(\"_\").pop();SSRC[result.mediaType][sendrecvType].indexOf(result.ssrc)===-1&&SSRC[result.mediaType][sendrecvType].push(result.ssrc),getStatsResult[result.mediaType][sendrecvType].streams=SSRC[result.mediaType][sendrecvType].length}},getStatsLooper()};\"undefined\"!=typeof module&&(module.exports=getStats),\"function\"==typeof define&&define.amd&&define(\"getStats\",[],function(){return getStats});","// BandwidthHandler.js\r\nvar BandwidthHandler = (function() {\r\n\r\n    function setBAS(sdp, bandwidth, isScreen) {\r\n        if (!!navigator.mozGetUserMedia || !bandwidth) {\r\n            return sdp;\r\n        }\r\n\r\n        if (isScreen) {\r\n            if (!bandwidth.screen) {\r\n                console.warn('It seems that you are not using bandwidth for screen. Screen sharing is expected to fail.');\r\n            } else if (bandwidth.screen < 300) {\r\n                console.warn('It seems that you are using wrong bandwidth value for screen. Screen sharing is expected to fail.');\r\n            }\r\n        }\r\n\r\n        // if screen; must use at least 300kbs\r\n        if (bandwidth.screen && isScreen) {\r\n            sdp = sdp.replace(/b=AS([^\\r\\n]+\\r\\n)/g, '');\r\n            sdp = sdp.replace(/a=mid:video\\r\\n/g, 'a=mid:video\\r\\nb=AS:' + bandwidth.screen + '\\r\\n');\r\n        }\r\n\r\n        // remove existing bandwidth lines\r\n        if (bandwidth.audio || bandwidth.video || bandwidth.data) {\r\n            sdp = sdp.replace(/b=AS([^\\r\\n]+\\r\\n)/g, '');\r\n        }\r\n\r\n        if (bandwidth.audio) {\r\n            sdp = sdp.replace(/a=mid:audio\\r\\n/g, 'a=mid:audio\\r\\nb=AS:' + bandwidth.audio + '\\r\\n');\r\n        }\r\n\r\n        if (bandwidth.video) {\r\n            sdp = sdp.replace(/a=mid:video\\r\\n/g, 'a=mid:video\\r\\nb=AS:' + (isScreen ? bandwidth.screen : bandwidth.video) + '\\r\\n');\r\n        }\r\n\r\n        return sdp;\r\n    }\r\n\r\n    // Find the line in sdpLines that starts with |prefix|, and, if specified,\r\n    // contains |substr| (case-insensitive search).\r\n    function findLine(sdpLines, prefix, substr) {\r\n        return findLineInRange(sdpLines, 0, -1, prefix, substr);\r\n    }\r\n\r\n    // Find the line in sdpLines[startLine...endLine - 1] that starts with |prefix|\r\n    // and, if specified, contains |substr| (case-insensitive search).\r\n    function findLineInRange(sdpLines, startLine, endLine, prefix, substr) {\r\n        var realEndLine = endLine !== -1 ? endLine : sdpLines.length;\r\n        for (var i = startLine; i < realEndLine; ++i) {\r\n            if (sdpLines[i].indexOf(prefix) === 0) {\r\n                if (!substr ||\r\n                    sdpLines[i].toLowerCase().indexOf(substr.toLowerCase()) !== -1) {\r\n                    return i;\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    // Gets the codec payload type from an a=rtpmap:X line.\r\n    function getCodecPayloadType(sdpLine) {\r\n        var pattern = new RegExp('a=rtpmap:(\\\\d+) \\\\w+\\\\/\\\\d+');\r\n        var result = sdpLine.match(pattern);\r\n        return (result && result.length === 2) ? result[1] : null;\r\n    }\r\n\r\n    function setVideoBitrates(sdp, params) {\r\n        params = params || {};\r\n        var xgoogle_min_bitrate = params.min;\r\n\t\t\t\tvar xgoogle_max_bitrate = params.max;\r\n\t\t\t\tvar videoCodec = params.codec.toUpperCase() || \"VP8\"\r\n\t\t\t\t\r\n\t\t\t\tsdp = CodecsHandler.preferCodec(sdp, videoCodec)\r\n\r\n\t\t\t\tvar sdpLines = sdp.split('\\r\\n');\r\n\t\t\t\t\r\n        var vp8Index = findLine(sdpLines, 'a=rtpmap', `${videoCodec}/90000`);\r\n        var vp8Payload;\r\n        if (vp8Index) {\r\n            vp8Payload = getCodecPayloadType(sdpLines[vp8Index]);\r\n        }\r\n\r\n        if (!vp8Payload) {\r\n            return sdp;\r\n        }\r\n\r\n        var rtxIndex = findLine(sdpLines, 'a=rtpmap', 'rtx/90000');\r\n        var rtxPayload;\r\n        if (rtxIndex) {\r\n            rtxPayload = getCodecPayloadType(sdpLines[rtxIndex]);\r\n        }\r\n\r\n        if (!rtxIndex) {\r\n            return sdp;\r\n        }\r\n\r\n        var rtxFmtpLineIndex = findLine(sdpLines, 'a=fmtp:' + rtxPayload.toString());\r\n        if (rtxFmtpLineIndex !== null) {\r\n            var appendrtxNext = '\\r\\n';\r\n            appendrtxNext += 'a=fmtp:' + vp8Payload + ' x-google-min-bitrate=' + (xgoogle_min_bitrate || '228') + '; x-google-max-bitrate=' + (xgoogle_max_bitrate || '228');\r\n            sdpLines[rtxFmtpLineIndex] = sdpLines[rtxFmtpLineIndex].concat(appendrtxNext);\r\n            sdp = sdpLines.join('\\r\\n');\r\n        }\r\n\r\n        return sdp;\r\n    }\r\n\r\n    function setOpusAttributes(sdp, params) {\r\n        params = params || {};\r\n\r\n        var sdpLines = sdp.split('\\r\\n');\r\n\r\n        // Opus\r\n        var opusIndex = findLine(sdpLines, 'a=rtpmap', 'opus/48000');\r\n        var opusPayload;\r\n        if (opusIndex) {\r\n            opusPayload = getCodecPayloadType(sdpLines[opusIndex]);\r\n        }\r\n\r\n        if (!opusPayload) {\r\n            return sdp;\r\n        }\r\n\r\n        var opusFmtpLineIndex = findLine(sdpLines, 'a=fmtp:' + opusPayload.toString());\r\n        if (opusFmtpLineIndex === null) {\r\n            return sdp;\r\n        }\r\n\r\n        var appendOpusNext = '';\r\n        appendOpusNext += '; stereo=' + (typeof params.stereo != 'undefined' ? params.stereo : '1');\r\n        appendOpusNext += '; sprop-stereo=' + (typeof params['sprop-stereo'] != 'undefined' ? params['sprop-stereo'] : '1');\r\n\r\n        if (typeof params.maxaveragebitrate != 'undefined') {\r\n            appendOpusNext += '; maxaveragebitrate=' + (params.maxaveragebitrate || 128 * 1024 * 8);\r\n        }\r\n\r\n        if (typeof params.maxplaybackrate != 'undefined') {\r\n            appendOpusNext += '; maxplaybackrate=' + (params.maxplaybackrate || 128 * 1024 * 8);\r\n        }\r\n\r\n        if (typeof params.cbr != 'undefined') {\r\n            appendOpusNext += '; cbr=' + (typeof params.cbr != 'undefined' ? params.cbr : '1');\r\n        }\r\n\r\n        if (typeof params.useinbandfec != 'undefined') {\r\n            appendOpusNext += '; useinbandfec=' + params.useinbandfec;\r\n        }\r\n\r\n        if (typeof params.usedtx != 'undefined') {\r\n            appendOpusNext += '; usedtx=' + params.usedtx;\r\n        }\r\n\r\n        if (typeof params.maxptime != 'undefined') {\r\n            appendOpusNext += '\\r\\na=maxptime:' + params.maxptime;\r\n        }\r\n\r\n        sdpLines[opusFmtpLineIndex] = sdpLines[opusFmtpLineIndex].concat(appendOpusNext);\r\n\r\n        sdp = sdpLines.join('\\r\\n');\r\n        return sdp;\r\n    }\r\n\r\n    return {\r\n        setApplicationSpecificBandwidth: function(sdp, bandwidth, isScreen) {\r\n            return setBAS(sdp, bandwidth, isScreen);\r\n        },\r\n        setVideoBitrates: function(sdp, params) {\r\n            return setVideoBitrates(sdp, params);\r\n        },\r\n        setOpusAttributes: function(sdp, params) {\r\n            return setOpusAttributes(sdp, params);\r\n        }\r\n    };\r\n})();","\r\n// inspired by ep_comments_page plugin, used and modified copyPasteEvents.js\r\n\r\n'use strict';\r\nvar _ = require('ep_etherpad-lite/static/js/underscore');\r\nvar randomString = require('ep_etherpad-lite/static/js/pad_utils').randomString;\r\n\r\nvar events = (function events() {\r\n\r\n\tvar padInner = null;\r\n\r\n\tvar getFirstColumnOfSelection = function getFirstColumnOfSelection(line, rep, firstLineOfSelection) {\r\n\t\treturn line !== firstLineOfSelection ? 0 : rep.selStart[1];\r\n\t};\r\n\t\r\n\tvar getLength = function getLength(line, rep) {\r\n\t\tvar nextLine = line + 1;\r\n\t\tvar startLineOffset = rep.lines.offsetOfIndex(line);\r\n\t\tvar endLineOffset = rep.lines.offsetOfIndex(nextLine);\r\n\t\r\n\t\t// lineLength without \\n\r\n\t\tvar lineLength = endLineOffset - startLineOffset - 1;\r\n\t\r\n\t\treturn lineLength;\r\n\t};\r\n\t\r\n\tvar getLastColumnOfSelection = function getLastColumnOfSelection(line, rep, lastLineOfSelection) {\r\n\t\tvar lastColumnOfSelection;\r\n\t\tif (line !== lastLineOfSelection) {\r\n\t\t\tlastColumnOfSelection = getLength(line, rep); // length of line\r\n\t\t} else {\r\n\t\t\tlastColumnOfSelection = rep.selEnd[1] - 1; // position of last character selected\r\n\t\t}\r\n\t\treturn lastColumnOfSelection;\r\n\t};\r\n\t\r\n\t\r\n\tvar hasCommentOnLine = function hasCommentOnLine(lineNumber, firstColumn, lastColumn, attributeManager) {\r\n\t\tvar foundHeadOnLine = false;\r\n\t\tvar headId = null;\r\n\t\tfor (var column = firstColumn; column <= lastColumn && !foundHeadOnLine; column++) {\r\n\t\t\theadId = _.object(attributeManager.getAttributesOnPosition(lineNumber, column)).headingTagId;\r\n\t\t\tif (headId) {\r\n\t\t\t\tfoundHeadOnLine = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn { foundHeadOnLine: foundHeadOnLine, headId: headId };\r\n\t};\r\n\t\r\n\tvar hasCommentOnMultipleLineSelection = function hasCommentOnMultipleLineSelection(firstLineOfSelection, lastLineOfSelection, rep, attributeManager) {\r\n\t\tvar foundLineWithComment = false;\r\n\t\tfor (var line = firstLineOfSelection; line <= lastLineOfSelection && !foundLineWithComment; line++) {\r\n\t\t\tvar firstColumn = getFirstColumnOfSelection(line, rep, firstLineOfSelection);\r\n\t\t\tvar lastColumn = getLastColumnOfSelection(line, rep, lastLineOfSelection);\r\n\t\t\tvar hasComment = hasCommentOnLine(line, firstColumn, lastColumn, attributeManager);\r\n\t\t\tif (hasComment) {\r\n\t\t\t\tfoundLineWithComment = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn foundLineWithComment;\r\n\t};\r\n\t\r\n\tvar hasMultipleLineSelected = function hasMultipleLineSelected(firstLineOfSelection, lastLineOfSelection) {\r\n\t\treturn firstLineOfSelection !== lastLineOfSelection;\r\n\t};\r\n\t\r\n\tvar hasHeaderOnSelection = function hasHeaderOnSelection() {\r\n\t\tvar hasVideoHeader;\r\n\t\tvar attributeManager = this.documentAttributeManager;\r\n\t\tvar rep = this.rep;\r\n\t\tvar firstLineOfSelection = rep.selStart[0];\r\n\t\tvar firstColumn = rep.selStart[1];\r\n\t\tvar lastColumn = rep.selEnd[1];\r\n\t\tvar lastLineOfSelection = rep.selEnd[0];\r\n\t\tvar selectionOfMultipleLine = hasMultipleLineSelected(firstLineOfSelection, lastLineOfSelection);\r\n\t\tif (selectionOfMultipleLine) {\r\n\t\t\thasVideoHeader = hasCommentOnMultipleLineSelection(firstLineOfSelection, lastLineOfSelection, rep, attributeManager);\r\n\t\t} else {\r\n\t\t\thasVideoHeader = hasCommentOnLine(firstLineOfSelection, firstColumn, lastColumn, attributeManager);\r\n\t\t}\r\n\t\treturn { hasVideoHeader: hasVideoHeader.foundHeadOnLine, headId: hasVideoHeader.headId, hasMultipleLine: selectionOfMultipleLine };\r\n\t};\r\n\t\r\n\tfunction getSelectionHtml() {\r\n\t\tvar html = '';\r\n\t\tif (typeof window.getSelection !== 'undefined') {\r\n\t\t\tvar sel = padInner.contents()[0].getSelection();\r\n\t\t\tif (sel.rangeCount) {\r\n\t\t\t\tvar container = document.createElement('div');\r\n\t\t\t\tfor (var i = 0, len = sel.rangeCount; i < len; ++i) {\r\n\t\t\t\t\tcontainer.appendChild(sel.getRangeAt(i).cloneContents());\r\n\t\t\t\t}\r\n\t\t\t\thtml = container.innerHTML;\r\n\t\t\t}\r\n\t\t} else if (typeof document.selection !== 'undefined') {\r\n\t\t\tif (document.selection.type === 'Text') {\r\n\t\t\t\thtml = document.selection.createRange().htmlText;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn html;\r\n\t}\r\n\t\r\n\tfunction selectionMultipleLine() {\r\n\t\tvar rawHtml = getSelectionHtml();\r\n\t\trawHtml = $('<div></div>').append(rawHtml);\r\n\t\trawHtml.find(':header span').removeClass(function removeClass(index, css) {\r\n\t\t\treturn (css.match(/\\headingTagId_\\S+/g) || []).join(' ');\r\n\t\t}).addClass(function addClass(index, css) {\r\n\t\t\treturn 'headingTagId_' + randomString(16) + ' ' + css;\r\n\t\t});\r\n\t\treturn rawHtml.html();\r\n\t}\r\n\t\r\n\tfunction selectionOneLine(headerId) {\r\n\t\tvar hTag = padInner.contents().find('.headingTagId_' + headerId).closest(':header').eq(0).prop(\"tagName\").toLowerCase();\r\n\t\tvar content = padInner.contents().find('.headingTagId_' + headerId).closest(':header span').removeClass(function(index, css) {\r\n\t\t\treturn (css.match(/\\headingTagId_\\S+/g) || []).join(' ');\r\n\t\t}).html();\r\n\t\tif(!hTag && !content) return false;\r\n\t\tvar rawHtml = $('<div></div>').append('<' + hTag + \"><span class='headingTagId_\" + randomString(16) + \"'>\" + content + '</span></' + hTag + '>');\r\n\t\treturn rawHtml.html();\r\n\t}\r\n\t\r\n\tvar addTextOnClipboard = function addTextOnClipboard(e, aces, inner, removeSelection) {\r\n\t\tpadInner = inner;\r\n\t\r\n\t\tvar selection;\r\n\t\taces.callWithAce(function callWithAce(ace) {\r\n\t\t\tselection = ace.ace_hasHeaderOnSelection();\r\n\t\t});\r\n\t\r\n\t\tif (selection.hasVideoHeader || selection.hasMultipleLine) {\r\n\t\t\tvar rawHtml;\r\n\t\t\tif (selection.hasMultipleLine) {\r\n\t\t\t\tvar htmlSelection = getSelectionHtml();\r\n\t\t\t\trawHtml = selectionMultipleLine(htmlSelection);\r\n\t\t\t} else {\r\n\t\t\t\tif(!selection.headId) return false;\r\n\t\t\t\trawHtml = selectionOneLine(selection.headId);\r\n\t\t\t}\r\n\t\r\n\t\t\tif (rawHtml) {\r\n\t\t\t\te.originalEvent.clipboardData.setData('text/html', rawHtml);\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\r\n\t\t\t// if it is a cut event we have to remove the selection\r\n\t\t\tif (removeSelection) {\r\n\t\t\t\tpadInner.contents()[0].execCommand('delete');\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\t\r\n\treturn Object.freeze({\r\n\t\taddTextOnClipboard,\r\n\t\thasHeaderOnSelection\r\n\t})\r\n\r\n})();","(function(a){var r=a.fn.domManip,d=\"_tmplitem\",q=/^[^<]*(<[\\w\\W]+>)[^>]*$|\\{\\{\\! /,b={},f={},e,p={key:0,data:{}},h=0,c=0,l=[];function g(e,d,g,i){var c={data:i||(d?d.data:{}),_wrap:d?d._wrap:null,tmpl:null,parent:d||null,nodes:[],calls:u,nest:w,wrap:x,html:v,update:t};e&&a.extend(c,e,{nodes:[],parent:d});if(g){c.tmpl=g;c._ctnt=c._ctnt||c.tmpl(a,c);c.key=++h;(l.length?f:b)[h]=c}return c}a.each({appendTo:\"append\",prependTo:\"prepend\",insertBefore:\"before\",insertAfter:\"after\",replaceAll:\"replaceWith\"},function(f,d){a.fn[f]=function(n){var g=[],i=a(n),k,h,m,l,j=this.length===1&&this[0].parentNode;e=b||{};if(j&&j.nodeType===11&&j.childNodes.length===1&&i.length===1){i[d](this[0]);g=this}else{for(h=0,m=i.length;h<m;h++){c=h;k=(h>0?this.clone(true):this).get();a.fn[d].apply(a(i[h]),k);g=g.concat(k)}c=0;g=this.pushStack(g,f,i.selector)}l=e;e=null;a.tmpl.complete(l);return g}});a.fn.extend({tmpl:function(d,c,b){return a.tmpl(this[0],d,c,b)},tmplItem:function(){return a.tmplItem(this[0])},template:function(b){return a.template(b,this[0])},domManip:function(d,l,j){if(d[0]&&d[0].nodeType){var f=a.makeArray(arguments),g=d.length,i=0,h;while(i<g&&!(h=a.data(d[i++],\"tmplItem\")));if(g>1)f[0]=[a.makeArray(d)];if(h&&c)f[2]=function(b){a.tmpl.afterManip(this,b,j)};r.apply(this,f)}else r.apply(this,arguments);c=0;!e&&a.tmpl.complete(b);return this}});a.extend({tmpl:function(d,h,e,c){var j,k=!c;if(k){c=p;d=a.template[d]||a.template(null,d);f={}}else if(!d){d=c.tmpl;b[c.key]=c;c.nodes=[];c.wrapped&&n(c,c.wrapped);return a(i(c,null,c.tmpl(a,c)))}if(!d)return[];if(typeof h===\"function\")h=h.call(c||{});e&&e.wrapped&&n(e,e.wrapped);j=a.isArray(h)?a.map(h,function(a){return a?g(e,c,d,a):null}):[g(e,c,d,h)];return k?a(i(c,null,j)):j},tmplItem:function(b){var c;if(b instanceof a)b=b[0];while(b&&b.nodeType===1&&!(c=a.data(b,\"tmplItem\"))&&(b=b.parentNode));return c||p},template:function(c,b){if(b){if(typeof b===\"string\")b=o(b);else if(b instanceof a)b=b[0]||{};if(b.nodeType)b=a.data(b,\"tmpl\")||a.data(b,\"tmpl\",o(b.innerHTML));return typeof c===\"string\"?(a.template[c]=b):b}return c?typeof c!==\"string\"?a.template(null,c):a.template[c]||a.template(null,q.test(c)?c:a(c)):null},encode:function(a){return(\"\"+a).split(\"<\").join(\"&lt;\").split(\">\").join(\"&gt;\").split('\"').join(\"&#34;\").split(\"'\").join(\"&#39;\")}});a.extend(a.tmpl,{tag:{tmpl:{_default:{$2:\"null\"},open:\"if($notnull_1){_=_.concat($item.nest($1,$2));}\"},wrap:{_default:{$2:\"null\"},open:\"$item.calls(_,$1,$2);_=[];\",close:\"call=$item.calls();_=call._.concat($item.wrap(call,_));\"},each:{_default:{$2:\"$index, $value\"},open:\"if($notnull_1){$.each($1a,function($2){with(this){\",close:\"}});}\"},\"if\":{open:\"if(($notnull_1) && $1a){\",close:\"}\"},\"else\":{_default:{$1:\"true\"},open:\"}else if(($notnull_1) && $1a){\"},html:{open:\"if($notnull_1){_.push($1a);}\"},\"=\":{_default:{$1:\"$data\"},open:\"if($notnull_1){_.push($.encode($1a));}\"},\"!\":{open:\"\"}},complete:function(){b={}},afterManip:function(f,b,d){var e=b.nodeType===11?a.makeArray(b.childNodes):b.nodeType===1?[b]:[];d.call(f,b);m(e);c++}});function i(e,g,f){var b,c=f?a.map(f,function(a){return typeof a===\"string\"?e.key?a.replace(/(<\\w+)(?=[\\s>])(?![^>]*_tmplitem)([^>]*)/g,\"$1 \"+d+'=\"'+e.key+'\" $2'):a:i(a,e,a._ctnt)}):e;if(g)return c;c=c.join(\"\");c.replace(/^\\s*([^<\\s][^<]*)?(<[\\w\\W]+>)([^>]*[^>\\s])?\\s*$/,function(f,c,e,d){b=a(e).get();m(b);if(c)b=j(c).concat(b);if(d)b=b.concat(j(d))});return b?b:j(c)}function j(c){var b=document.createElement(\"div\");b.innerHTML=c;return a.makeArray(b.childNodes)}function o(b){return new Function(\"jQuery\",\"$item\",\"var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('\"+a.trim(b).replace(/([\\\\'])/g,\"\\\\$1\").replace(/[\\r\\t\\n]/g,\" \").replace(/\\$\\{([^\\}]*)\\}/g,\"{{= $1}}\").replace(/\\{\\{(\\/?)(\\w+|.)(?:\\(((?:[^\\}]|\\}(?!\\}))*?)?\\))?(?:\\s+(.*?)?)?(\\(((?:[^\\}]|\\}(?!\\}))*?)\\))?\\s*\\}\\}/g,function(m,l,j,d,b,c,e){var i=a.tmpl.tag[j],h,f,g;if(!i)throw\"Template command not found: \"+j;h=i._default||[];if(c&&!/\\w$/.test(b)){b+=c;c=\"\"}if(b){b=k(b);e=e?\",\"+k(e)+\")\":c?\")\":\"\";f=c?b.indexOf(\".\")>-1?b+c:\"(\"+b+\").call($item\"+e:b;g=c?f:\"(typeof(\"+b+\")==='function'?(\"+b+\").call($item):(\"+b+\"))\"}else g=f=h.$1||\"null\";d=k(d);return\"');\"+i[l?\"close\":\"open\"].split(\"$notnull_1\").join(b?\"typeof(\"+b+\")!=='undefined' && (\"+b+\")!=null\":\"true\").split(\"$1a\").join(g).split(\"$1\").join(f).split(\"$2\").join(d?d.replace(/\\s*([^\\(]+)\\s*(\\((.*?)\\))?/g,function(d,c,b,a){a=a?\",\"+a+\")\":b?\")\":\"\";return a?\"(\"+c+\").call($item\"+a:d}):h.$2||\"\")+\"_.push('\"})+\"');}return _;\")}function n(c,b){c._wrap=i(c,true,a.isArray(b)?b:[q.test(b)?b:a(b).html()]).join(\"\")}function k(a){return a?a.replace(/\\\\'/g,\"'\").replace(/\\\\\\\\/g,\"\\\\\"):null}function s(b){var a=document.createElement(\"div\");a.appendChild(b.cloneNode(true));return a.innerHTML}function m(o){var n=\"_\"+c,k,j,l={},e,p,i;for(e=0,p=o.length;e<p;e++){if((k=o[e]).nodeType!==1)continue;j=k.getElementsByTagName(\"*\");for(i=j.length-1;i>=0;i--)m(j[i]);m(k)}function m(j){var p,i=j,k,e,m;if(m=j.getAttribute(d)){while(i.parentNode&&(i=i.parentNode).nodeType===1&&!(p=i.getAttribute(d)));if(p!==m){i=i.parentNode?i.nodeType===11?0:i.getAttribute(d)||0:0;if(!(e=b[m])){e=f[m];e=g(e,b[i]||f[i],null,true);e.key=++h;b[h]=e}c&&o(m)}j.removeAttribute(d)}else if(c&&(e=a.data(j,\"tmplItem\"))){o(e.key);b[e.key]=e;i=a.data(j.parentNode,\"tmplItem\");i=i?i.key:0}if(e){k=e;while(k&&k.key!=i){k.nodes.push(j);k=k.parent}delete e._ctnt;delete e._wrap;a.data(j,\"tmplItem\",e)}function o(a){a=a+n;e=l[a]=l[a]||g(e,b[e.parent.key+n]||e.parent,null,true)}}}function u(a,d,c,b){if(!a)return l.pop();l.push({_:a,tmpl:d,item:this,data:c,options:b})}function w(d,c,b){return a.tmpl(a.template(d),c,b,this)}function x(b,d){var c=b.options||{};c.wrapped=d;return a.tmpl(a.template(b.tmpl),b.data,c,b.item)}function v(d,c){var b=this._wrap;return a.map(a(a.isArray(b)?b.join(\"\"):b).filter(d||\"*\"),function(a){return c?a.innerText||a.textContent:a.outerHTML||s(a)})}function t(){var b=this.nodes;a.tmpl(null,null,null,this).insertBefore(b[0]);a(b).remove()}})(jQuery)","'use strict';\r\n\r\nvar avatarUrl = '../static/plugins/ep_profile_modal/static/img/user.png';\r\n\r\nvar share = (function textChat() {\r\n\r\n\tvar getUserId = function getUserId() {\r\n\t\treturn clientVars.userId || window.pad.getUserId();\r\n\t}\r\n\r\n\r\n\r\n\tfunction stopStreaming(stream) {\r\n\t\tif (stream) {\r\n\t\t\tstream.getTracks().forEach(function stopStream(track) {\r\n\t\t\t\ttrack.stop();\r\n\t\t\t\tstream.removeTrack(track);\r\n\t\t\t});\r\n\t\t\tstream = null;\r\n\t\t}\r\n\t}\r\n\t\r\n\tvar scrollDownToLastChatText = function scrollDownToLastChatText(selector) {\r\n\t\tvar $element = $(selector);\r\n\t\tif ($element.length <= 0 || !$element[0]) return true;\r\n\t\t$element.animate({ scrollTop: $element[0].scrollHeight }, { duration: 400, queue: false });\r\n\t};\r\n\r\n\tvar getUserFromId = function getUserFromId(userId) {\r\n\t\tif (!window.pad || !window.pad.collabClient) return null;\r\n\t\tvar result = window.pad.collabClient.getConnectedUsers().filter(function getUser(user) {\r\n\t\t\treturn user.userId === userId;\r\n\t\t});\r\n\t\tvar user = result.length > 0 ? result[0] : null;\r\n\t\treturn user;\r\n\t};\r\n\t\r\n\tvar slugify = function slugify(text) {\r\n\t\treturn text.toString().toLowerCase().trim().replace(/\\s+/g, '-') // Replace spaces with -\r\n\t\t.replace(/&/g, '-and-') // Replace & with 'and'\r\n\t\t.replace(/[^\\w\\-]+/g, '') // Remove all non-word chars\r\n\t\t.replace(/\\--+/g, '-') // Replace multiple - with single -\r\n\t\t.replace(/^-+/, '') // Trim - from start of text\r\n\t\t.replace(/-+$/, ''); // Trim - from end of text\r\n\t};\r\n\t\r\n\tvar $body_ace_outer = function $body_ace_outer() {\r\n\t\treturn $(document).find('iframe[name=\"ace_outer\"]').contents();\r\n\t};\r\n\t\r\n\tvar createShareLink = function createShareLink(headingTagId, headerText) {\r\n\t\treturn window.location.origin + window.location.pathname + '?header=' + slugify(headerText) + '&headerId=' + headingTagId + '&joinvideo=true';\r\n\t};\r\n\t\r\n\tfunction addTextChatMessage(msg) {\r\n\t\tvar authorClass = 'author-' + msg.userId.replace(/[^a-y0-9]/g, function replace(c) {\r\n\t\t\tif (c === '.') return '-';\r\n\t\t\treturn 'z' + c.charCodeAt(0) + 'z';\r\n\t\t});\r\n\t\r\n\t\t// create the time string\r\n\t\tvar minutes = '' + new Date(msg.time).getMinutes();\r\n\t\tvar hours = '' + new Date(msg.time).getHours();\r\n\t\tif (minutes.length === 1) minutes = '0' + minutes;\r\n\t\tif (hours.length === 1) hours = '0' + hours;\r\n\t\tvar timeStr = hours + ':' + minutes;\r\n\t\r\n\t\tvar html = \"<p data-target='\" + msg.target + \"' data-id='\" + msg.headerId + \"' data-authorId='\" + msg.userId + \"' class='wrtc_text \" + msg.headId + ' ' + authorClass + \"'><b>\" + msg.userName + \"</b><span class='time \" + authorClass + \"'>\" + timeStr + '</span> ' + msg.text + '</p>';\r\n\t\r\n\t\t$(document).find('#chatbox #chattext').append(html);\r\n\t\tscrollDownToLastChatText('#chatbox #chattext');\r\n\t}\r\n\t\r\n\tvar notifyNewUserJoined = function notifyNewUserJoined(target, msg, action) {\r\n\t\tvar videoIcon = '<span class=\"videoIcon\"><svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"video\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 576 512\" class=\"svg-inline--fa fa-video fa-w-18 fa-2x\"><path fill=\"currentColor\" d=\"M336.2 64H47.8C21.4 64 0 85.4 0 111.8v288.4C0 426.6 21.4 448 47.8 448h288.4c26.4 0 47.8-21.4 47.8-47.8V111.8c0-26.4-21.4-47.8-47.8-47.8zm189.4 37.7L416 177.3v157.4l109.6 75.5c21.2 14.6 50.4-.3 50.4-25.8V127.5c0-25.4-29.1-40.4-50.4-25.8z\" class=\"\"></path></svg></span>';\r\n\t\tvar textIcon = '<span class=\"textIcon\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 576 512\"><path fill=\"currentColor\" d=\"M416 224V64c0-35.3-28.7-64-64-64H64C28.7 0 0 28.7 0 64v160c0 35.3 28.7 64 64 64v54.2c0 8 9.1 12.6 15.5 7.8l82.8-62.1H352c35.3.1 64-28.6 64-63.9zm96-64h-64v64c0 52.9-43.1 96-96 96H192v64c0 35.3 28.7 64 64 64h125.7l82.8 62.1c6.4 4.8 15.5.2 15.5-7.8V448h32c35.3 0 64-28.7 64-64V224c0-35.3-28.7-64-64-64z\"></path></svg></span>';\r\n\t\tvar btnJoin = \"<span class='wrtc_roomLink' data-join='\" + target + \"' data-action='JOIN' data-id='\" + msg.headerId + \"' title='Join'>\" + msg.headerTitle + '</span>';\r\n\t\r\n\t\tvar text = action === 'JOIN' ? 'joins' : 'leaves';\r\n\t\r\n\t\tif (target === 'VIDEO') {\r\n\t\t\tvar roomCounter = \"<span class='userCount'>(\" + msg.userCount + '/' + msg.VIDEOCHATLIMIT + ')</span>';\r\n\t\t\tmsg.text = '<span>' + text + '</span>' + videoIcon + btnJoin + roomCounter;\r\n\t\t} else if (target === 'TEXT') {\r\n\t\t\tmsg.text = '<span>' + text + '</span>' + textIcon + btnJoin;\r\n\t\t}\r\n\t\r\n\t\tmsg.target = target;\r\n\t\r\n\t\taddTextChatMessage(msg);\r\n\t};\r\n\t\r\n\tvar roomBoxIconActive = function roomBoxIconActive() {\r\n\t\t$body_ace_outer().find('.wbrtc_roomBox').each(function (index, val) {\r\n\t\t\tvar textActive = $(val).attr('data-text');\r\n\t\t\tvar videoActive = $(val).attr('data-video');\r\n\t\t\tif (textActive || videoActive) {\r\n\t\t\t\t$(val).find('.btn_joinChat_chatRoom').addClass('active');\r\n\t\t\t} else {\r\n\t\t\t\t$(val).find('.btn_joinChat_chatRoom').removeClass('active');\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\t\r\n\tvar appendUserList = function appendUserList(roomInfo, selector) {\r\n\t\tif (!roomInfo.list) return true;\r\n\t\tvar $element = typeof selector === 'string' ? $(document).find(selector) : selector;\r\n\t\t$element.empty();\r\n\t\troomInfo.list.forEach(function reOrderUserList(el) {\r\n\t\t\tvar userInList = getUserFromId(el.userId) || { colorId: '', name: 'anonymous', userId: '0000000' };\r\n\t\t\tif (clientVars.ep_profile_list && clientVars.ep_profile_list[el.userId]) {\r\n\t\t\t\tavatarUrl = clientVars.ep_profile_list[el.userId].imageUrl || clientVars.ep_profile_list[el.userId].img;\r\n\t\t\t}\r\n\t\t\t$element.append('<li data-id=' + el.userId + \" style='border-color: \" + userInList.colorId + \"'><div class='avatar'><img src='\" + avatarUrl + \"'></div>\" + userInList.name + '</li>');\r\n\t\t});\r\n\t};\r\n\t\r\n\tvar wrtcStore = {};\r\n\t\r\n\tvar wrtcPubsub = {\r\n\t\tevents: {},\r\n\t\ton: function on(eventName, fn) {\r\n\t\t\tthis.events[eventName] = this.events[eventName] || [];\r\n\t\t\tthis.events[eventName].push(fn);\r\n\t\t},\r\n\t\toff: function off(eventName, fn) {\r\n\t\t\tif (this.events[eventName]) {\r\n\t\t\t\tfor (var i = 0; i < this.events[eventName].length; i++) {\r\n\t\t\t\t\tif (this.events[eventName][i] === fn) {\r\n\t\t\t\t\t\tthis.events[eventName].splice(i, 1);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\temit: function emit(eventName) {\r\n\t\t\tfor (var _len = arguments.length, data = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\r\n\t\t\t\tdata[_key - 1] = arguments[_key];\r\n\t\t\t}\r\n\t\r\n\t\t\tif (this.events[eventName]) {\r\n\t\t\t\tthis.events[eventName].forEach(function (fn) {\r\n\t\t\t\t\tfn.apply(undefined, data);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\t\r\n\tvar inlineAvatar = {\r\n\t\tROOM: function ROOM(headerId, room) {\r\n\t\t\tvar inlineAvatarLimit = clientVars.webrtc.inlineAvatarLimit || 4;\r\n\t\t\tvar $element = $body_ace_outer().find('#wbrtc_avatarCol .' + headerId + ' .wrtc_inlineAvatars');\r\n\t\t\t$element.find('.avatar').remove();\r\n\t\t\t$element.parent().css({ left: WRTC_Room.getHeaderRoomX($element.parent()) + 'px' });\r\n\t\t\tObject.keys(room).forEach(function reOrderUserList(key, index) {\r\n\t\t\t\tvar userInList = getUserFromId(room[key].userId) || { colorId: '', name: 'anonymous'};\r\n\t\t\t\tif(userInList.userId){\r\n\t\t\t\t\t// TODO: If the user is not found, we hangup the user.\r\n\t\t\t\t\tif (clientVars.ep_profile_list && clientVars.ep_profile_list[userInList.userId]) {\r\n\t\t\t\t\t\tavatarUrl = clientVars.ep_profile_list[userInList.userId].imageUrl || clientVars.ep_profile_list[userInList.userId].img;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (index < inlineAvatarLimit) {\r\n\t\t\t\t\t\t$element.find('.avatarMore').hide();\r\n\t\t\t\t\t\t$element.append('<div class=\"avatar\" data-id=\"' + userInList.userId + '\"><img src=\"' + avatarUrl + '\"></div>');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$element.find('.avatarMore').show().text('+' + (index + 1 - inlineAvatarLimit));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tTEXT: function TEXT(headerId, room) {\r\n\t\t\tvar $element = $(document).find('#wrtc_textChatWrapper .wrtc_inlineAvatars');\r\n\t\t\t$element.find('.avatar').remove();\r\n\t\t\tthis.append(room.list, $element);\r\n\t\t},\r\n\t\tVIDEO: function VIDEO(headerId, room) {\r\n\t\t\tvar $element = $(document).find('#werc_toolbar .wrtc_inlineAvatars');\r\n\t\t\t$element.find('.avatar').remove();\r\n\t\t\tthis.append(room.list, $element);\r\n\t\t},\r\n\t\tappend: function appendAvatart(list, $element) {\r\n\t\t\tvar inlineAvatarLimit = clientVars.webrtc.inlineAvatarLimit || 4;\r\n\t\t\tlist.forEach(function reOrderUserList(el, index) {\r\n\t\t\t\tvar userInList = getUserFromId(el.userId) || { colorId: '', name: 'anonymous'};\r\n\t\t\t\tif(userInList.userId){\r\n\t\t\t\t\tif (clientVars.ep_profile_list && clientVars.ep_profile_list[userInList.userId]) {\r\n\t\t\t\t\t\tavatarUrl = clientVars.ep_profile_list[userInList.userId].imageUrl || clientVars.ep_profile_list[userInList.userId].img;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (index < inlineAvatarLimit) {\r\n\t\t\t\t\t\t$element.find('.avatarMore').hide();\r\n\t\t\t\t\t\t$element.append('<div class=\"avatar\" data-id=\"' + userInList.userId + '\"><img src=\"' + avatarUrl + '\"></div>');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$element.find('.avatarMore').show().text('+' + (index + 1 - inlineAvatarLimit));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\t\r\n\twrtcPubsub.on('update store', function (requestUser, headerId, action, target, roomInfo, callback) {\r\n\t\tif (!requestUser || !headerId || !action || !roomInfo || !target) return false;\r\n\t\r\n\t\tif(!wrtcStore[headerId]) wrtcStore[headerId] = {};\r\n\t\tif(!wrtcStore[headerId].USERS) wrtcStore[headerId].USERS = {};\r\n\t\r\n\t\tvar users = wrtcStore[headerId].USERS;\r\n\t\twrtcStore[headerId][target] = roomInfo;\r\n\t\t// if(action === \"JOIN\"){}\r\n\t\t// if(action === \"LEAVE\"){}\r\n\t\t// remove all users\r\n\t\tusers = {};\r\n\t\r\n\t\twrtcStore[headerId].TEXT.list.forEach(function (el) {\r\n\t\t\tif (!users[el.userId]) users[el.userId] = {};\r\n\t\t\tusers[el.userId] = el;\r\n\t\t});\r\n\t\r\n\t\twrtcStore[headerId].VIDEO.list.forEach(function (el) {\r\n\t\t\tif (!users[el.userId]) users[el.userId] = {};\r\n\t\t\tusers[el.userId] = el;\r\n\t\t});\r\n\t\r\n\t\tinlineAvatar[target](headerId, wrtcStore[headerId][target]);\r\n\t\tinlineAvatar.ROOM(headerId, users);\r\n\t\r\n\t\tif (callback) callback(wrtcStore[headerId]);\r\n\t});\r\n\t\r\n\twrtcPubsub.on('disable room buttons', function disableRoomButtons(headerId, actions, target) {\r\n\t\tvar $headingRoom = $body_ace_outer().find('#' + headerId);\r\n\t\r\n\t\tvar $btnVideo = $headingRoom.find('.btn_icon[data-join=\"VIDEO\"]');\r\n\t\tvar $btnText = $headingRoom.find('.btn_icon[data-join=\"TEXT\"]');\r\n\t\tvar $btnPlus = $headingRoom.find('.btn_icon[data-join=\"PLUS\"]');\r\n\t\r\n\t\tif (target === 'TEXT' || target === 'VIDEO') {\r\n\t\t\t// disable target and plus buttton\r\n\t\t\t$headingRoom.find('.btn_icon[data-join=\"' + target + '\"]').prop('disabled', true);\r\n\t\t\t$btnPlus.prop('disabled', true);\r\n\t\t}\r\n\t\r\n\t\tif (target === 'PLUS') {\r\n\t\t\t// disable all buttons\r\n\t\t\t$btnText.prop('disabled', true);\r\n\t\t\t$btnVideo.prop('disabled', true);\r\n\t\t\t$btnPlus.prop('disabled', true);\r\n\t\t}\r\n\t});\r\n\t\r\n\twrtcPubsub.on('enable room buttons', function enableRoomButtons(headerId, action, target) {\r\n\t\tvar $headingRoom = $body_ace_outer().find('#' + headerId);\r\n\t\tvar newAction = action === 'JOIN' ? 'LEAVE' : 'JOIN';\r\n\t\r\n\t\tvar $btnVideo = $headingRoom.find('.btn_icon[data-join=\"VIDEO\"]');\r\n\t\tvar $btnText = $headingRoom.find('.btn_icon[data-join=\"TEXT\"]');\r\n\t\tvar $btnPlus = $headingRoom.find('.btn_icon[data-join=\"PLUS\"]');\r\n\t\r\n\t\tif (target === 'TEXT' || target === 'VIDEO') {\r\n\t\t\t// enable target and plus buttton\r\n\t\t\t$headingRoom.find('.btn_icon[data-join=\"' + target + '\"]').attr({ 'data-action': newAction }).prop('disabled', false);\r\n\t\r\n\t\t\t$btnPlus.attr({ 'data-action': newAction }).prop('disabled', false);\r\n\t\t}\r\n\t\r\n\t\tif (target === 'TEXTPLUS') {\r\n\t\t\t// enable text button\r\n\t\t\t$btnText.attr({ 'data-action': newAction }).prop('disabled', false);\r\n\t\t\t$btnVideo.attr({ 'data-action': newAction });\r\n\t\t}\r\n\t\r\n\t\tif (target === 'PLUS') {\r\n\t\t\t// make enable and action toggle all buttons\r\n\t\t\t$btnText.attr({ 'data-action': newAction }).prop('disabled', false);\r\n\t\t\t$btnVideo.attr({ 'data-action': newAction }).prop('disabled', false);\r\n\t\t\t$btnPlus.attr({ 'data-action': newAction }).prop('disabled', false);\r\n\t\t}\r\n\t});\r\n\t\r\n\r\n\treturn Object.freeze({\r\n\t\twrtcPubsub,\r\n\t\twrtcStore,\r\n\t\tappendUserList,\r\n\t\troomBoxIconActive,\r\n\t\tnotifyNewUserJoined,\r\n\t\tcreateShareLink,\r\n\t\t$body_ace_outer,\r\n\t\tslugify,\r\n\t\tscrollDownToLastChatText,\r\n\t\tgetUserFromId,\r\n\t\tgetUserId,\r\n\t\tstopStreaming\r\n\t})\r\n\r\n\r\n})();\r\n\r\n\r\n\r\n\r\n/* Helper */","var textChat = (function textChat() {\r\n\tvar socket = null;\r\n\tvar padId = null;\r\n\tvar currentRoom = {};\r\n\tvar $joinBtn = null;\r\n\r\n\tfunction createAndAppendMessage(msg) {\r\n\t\tif (!msg || !currentRoom.userId) return true;\r\n\r\n\t\t// correct the time\r\n\t\t// msg.time += window.clientTimeOffset;\r\n\r\n\t\tvar minutes = '' + new Date(msg.time).getMinutes();\r\n\t\tvar hours = '' + new Date(msg.time).getHours();\r\n\t\tif (minutes.length === 1) minutes = '0' + minutes;\r\n\t\tif (hours.length === 1) hours = '0' + hours;\r\n\t\tvar timeStr = hours + ':' + minutes;\r\n\r\n\t\tvar userName = $('<b>').text(msg.userName + ': ');\r\n\t\tvar tim = $('<span>').attr({ 'class': 'time' }).text(timeStr);\r\n\r\n\t\tvar text = padutils.escapeHtmlWithClickableLinks(msg.text, \"_blank\");\r\n\r\n\t\t// var urlParams = new URLSearchParams(msg.text.split(\"?\")[1]);\r\n\r\n\t\t// if(urlParams.get('id')) {\r\n\t\t// \tvar headerId = urlParams.get('id');\r\n\t\t// \tvar target = urlParams.get('target');\r\n\t\t// \tvar join = urlParams.get('join');\r\n\t\t// \ttext = $(text).attr({\r\n\t\t// \t\t\"data-join\": join,\r\n\t\t// \t\t\"data-action\":\"JOIN\",\r\n\t\t// \t\t\"data-id\": headerId\r\n\t\t// \t}).addClass('btn_roomHandler')\r\n\t\t// }\r\n\r\n\r\n\t\tvar message = $('<p>').attr({\r\n\t\t\t'data-authorid': msg.author\r\n\t\t}).append(userName).append(tim).append(text);\r\n\r\n\t\t$('#wrtc_textChat').append(message);\r\n\t\tshare.scrollDownToLastChatText('#wrtc_textChat');\r\n\t}\r\n\r\n\t// function privateNotifyNewUserJoined(target, msg, action) {\r\n\t// \tvar textIcon = '<span class=\"textIcon\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 576 512\"><path fill=\"currentColor\" d=\"M416 224V64c0-35.3-28.7-64-64-64H64C28.7 0 0 28.7 0 64v160c0 35.3 28.7 64 64 64v54.2c0 8 9.1 12.6 15.5 7.8l82.8-62.1H352c35.3.1 64-28.6 64-63.9zm96-64h-64v64c0 52.9-43.1 96-96 96H192v64c0 35.3 28.7 64 64 64h125.7l82.8 62.1c6.4 4.8 15.5.2 15.5-7.8V448h32c35.3 0 64-28.7 64-64V224c0-35.3-28.7-64-64-64z\"></path></svg></span>';\r\n\t// \tvar btnJoin = \"<span class='wrtc_roomLink' data-join='\" + target + \"' data-action='JOIN' data-id='\" + msg.headerId + \"' title='Join'>\" + msg.headerTitle + '</span>';\r\n\r\n\t// \tvar text = action === 'JOIN' ? 'joins' : 'leaves';\r\n\r\n\t// \tmsg.text = '<span>' + text + '</span>' + textIcon + btnJoin;\r\n\r\n\t// \tmsg.target = target;\r\n\r\n\t// \tcreateAndAppendMessage(msg);\r\n\t// }\r\n\r\n\tfunction eventTextChatInput() {\r\n\t\tvar keycode = event.keyCode || event.which;\r\n\t\t// when press Enter key\r\n\t\tif (keycode === 13) {\r\n\t\t\tvar textMessage = $(this).val();\r\n\t\t\tif (!textMessage) return true;\r\n\t\t\t$(this).val('');\r\n\t\t\tvar user = share.getUserFromId(clientVars.userId);\r\n\t\t\tif(!user) return true;\r\n\t\t\tvar msg = { text: textMessage, userName: user.name, author: user.userId, time: new Date().getTime() };\r\n\t\t\tsocket.emit('sendTextMessage', padId, currentRoom.headerId, msg, function sendTextMessage(incomMsg) {\r\n\t\t\t\tcreateAndAppendMessage(incomMsg);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfunction eventListers() {\r\n\t\t$(document).on('keypress', '#wrtc_textChatInputBox input', eventTextChatInput);\r\n\r\n\t\t$(document).on('click', '#wrtc_textChatWrapper .btn_toggle_modal', function click() {\r\n\t\t\tvar action = $(this).attr('data-action');\r\n\t\t\tvar chatBox = $('#wrtc_textChat').innerHeight() + $('#wrtc_textChatInputBox').innerHeight() + 1;\r\n\r\n\t\t\t$(this).find('.fa_arrow-from-top').toggle();\r\n\t\t\t$(this).find('.fa_arrow-to-top').toggle();\r\n\r\n\t\t\tif (action === 'collapse') {\r\n\t\t\t\t$(this).attr({ 'data-action': 'expand' });\r\n\t\t\t\t$('#wrtc_textChatWrapper').css({\r\n\t\t\t\t\ttransform: 'translate(-50%, ' + chatBox + 'px)'\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t$(this).attr({ 'data-action': 'collapse' });\r\n\t\t\t\t$('#wrtc_textChatWrapper').css({\r\n\t\t\t\t\ttransform: 'translate(-50%, 0)'\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tfunction deactivateModal(headerId, roomInfo) {\r\n\t\tvar $TextChatWrapper = $(document).find('#wrtc_textChatWrapper');\r\n\r\n\t\t$TextChatWrapper.removeClass('active').removeAttr('style');\r\n\t\t$TextChatWrapper.find('#wrtc_textChat p').remove();\r\n\t\t// socket.removeListener('receiveTextMessage:' + headerId);\r\n\r\n\t\tvar $btn = $(document).find('#wrtc_textChatWrapper .btn_toggle_modal');\r\n\t\t$btn.attr({ 'data-action': 'collapse' });\r\n\t\t$btn.find('.fa_arrow-from-top').toggle();\r\n\t\t$btn.find('.fa_arrow-to-top').toggle();\r\n\t}\r\n\r\n\tfunction activateModal(headerId, headTitle, userCount, roomInfo) {\r\n\t\tif (!headerId) return false;\r\n\t\tvar existTextChat = $(document).find('#wrtc_textChatWrapper');\r\n\t\tif (!existTextChat.length) {\r\n\t\t\tvar textChatBox = $('#wrtc_textChatBox').tmpl({\r\n\t\t\t\theaderId: headerId,\r\n\t\t\t\theadTitle: headTitle\r\n\t\t\t});\r\n\t\t\t$('body').append(textChatBox);\r\n\t\t} else {\r\n\t\t\t// TODO: change this to template\r\n\t\t\texistTextChat.attr({ 'data-id': headerId }).find('.textChatToolbar b, .btn_leave').attr({ 'data-id': headerId });\r\n\t\t\texistTextChat.find('.nd_title b').text(headTitle);\r\n\t\t}\r\n\r\n\t\t// for animation pop up\r\n\t\tsetTimeout(function setTimeout() {\r\n\t\t\t$(document).find('#wrtc_textChatWrapper').addClass('active');\r\n\t\t}, 250);\r\n\r\n\t\tsocket.on('receiveTextMessage:' + headerId, function receiveTextMessage(headingId, msg) {\r\n\t\t\tif (headingId === headerId) {\r\n\t\t\t\tcreateAndAppendMessage(msg);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tsocket.emit('getTextMessages', padId, headerId, {}, function getTextMessages(data) {\r\n\t\t\tdata.forEach(function (el) {\r\n\t\t\t\tcreateAndAppendMessage(el);\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tshare.appendUserList(roomInfo, '#wrtc_textChatWrapper  #textChatUserModal ul');\r\n\t}\r\n\r\n\tfunction addUserToRoom(data, roomInfo) {\r\n\t\tif (!data || !data.userId) return true;\r\n\t\tvar headerId = data.headerId;\r\n\t\tvar $headingRoom = share.$body_ace_outer().find('#' + headerId);\r\n\t\tvar headTitle = $headingRoom.find('.wrtc_header b.titleRoom').text();\r\n\t\tvar userCount = roomInfo.present;\r\n\t\t$headingRoom.find('.textChatCount').text(userCount);\r\n\r\n\t\tvar user = share.getUserFromId(data.userId);\r\n\t\t// some user may session does exist but the user info does not available in all over the current pad\r\n\t\tif (!user) return true;\r\n\r\n\t\t// TODO: this is not good idea, use global state\r\n\t\t// if incoming user has already in the room don't persuade the request\r\n\t\tvar IsUserInRooms = $headingRoom.find(\".wrtc_content.textChat ul li[data-id='\" + user.userId + \"']\").text();\r\n\t\tif (IsUserInRooms) return false;\r\n\r\n\t\tshare.appendUserList(roomInfo, $headingRoom.find('.wrtc_content.textChat ul'));\r\n\t\tshare.appendUserList(roomInfo, '#wrtc_textChatWrapper  #textChatUserModal ul');\r\n\r\n\t\t// notify, a user join the video-chat room\r\n\t\t// var msg = {\r\n\t\t// \ttime: new Date(),\r\n\t\t// \tuserId: data.userId || user.userId,\r\n\t\t// \tuserName: user.name || data.name || 'anonymous',\r\n\t\t// \theaderId: data.headerId,\r\n\t\t// \tuserCount: userCount,\r\n\t\t// \theaderTitle: headTitle\r\n\t\t// };\r\n\t\t// share.notifyNewUserJoined('TEXT', msg, 'JOIN');\r\n\r\n\t\t// if (data.headerId === currentRoom.headerId) {\r\n\t\t// \tvar privateMsg = {\r\n\t\t// \t\tuserName: user.name,\r\n\t\t// \t\tauthor: user.userId,\r\n\t\t// \t\theaderTitle: headTitle,\r\n\t\t// \t\ttime: new Date().getTime()\r\n\t\t// \t};\r\n\t\t// \tprivateNotifyNewUserJoined('TEXT', privateMsg, 'JOIN');\r\n\t\t// }\r\n\r\n\t\t// if (data.headerId === currentRoom.headerId && data.userId !== clientVars.userId) {\r\n\t\t// \t$.gritter.add({\r\n\t\t// \t\ttext: '<span class=\"author-name\">' + user.name + '</span>' + 'has joined the text-chat, <b><i> \"' + headTitle + '\"</b></i>',\r\n\t\t// \t\tsticky: false,\r\n\t\t// \t\ttime: 3000,\r\n\t\t// \t\tposition: 'center',\r\n\t\t// \t\tclass_name: 'chat-gritter-msg'\r\n\t\t// \t});\r\n\t\t// }\r\n\r\n\t\tif (data.userId === clientVars.userId) {\r\n\t\t\tcurrentRoom = data;\r\n\t\t\t$headingRoom.attr({ 'data-text': true });\r\n\t\t\tshare.roomBoxIconActive();\r\n\t\t\tactivateModal(headerId, headTitle, userCount, roomInfo);\r\n\t\t\tshare.wrtcPubsub.emit('enable room buttons', headerId, 'JOIN', $joinBtn);\r\n\t\t}\r\n\r\n\t\tshare.wrtcPubsub.emit('update store', data, headerId, 'JOIN', 'TEXT', roomInfo, function updateStore() {});\r\n\t}\r\n\r\n\tfunction removeUserFromRoom(data, roomInfo, target, cb) {\r\n\t\tif (!data || !data.userId) return true;\r\n\t\tvar headerId = data.headerId;\r\n\t\tvar $headingRoom = share.$body_ace_outer().find('#' + headerId);\r\n\t\tvar headTitle = $headingRoom.find('.wrtc_header b.titleRoom').text();\r\n\r\n\t\tvar userCount = roomInfo.present;\r\n\t\t$headingRoom.find('.textChatCount').text(userCount);\r\n\r\n\t\tvar $textChatUserList = $headingRoom.find('.wrtc_content.textChat ul');\r\n\r\n\t\tshare.appendUserList(roomInfo, $textChatUserList);\r\n\t\tshare.appendUserList(roomInfo, '#wrtc_textChatWrapper #textChatUserModal ul');\r\n\r\n\t\tif (userCount === 0) {\r\n\t\t\t$textChatUserList.append('<li class=\"empty\">Be the first to join the <button class=\"btn_joinChat_text\" data-action=\"JOIN\" data-id=\"' + headerId + '\" data-join=\"TEXT\"><b>text-chat</b></button></li>');\r\n\t\t}\r\n\r\n\t\t// var user = share.getUserFromId(data.userId);\r\n\r\n\t\t// notify, a user join the text-chat room\r\n\t\t// var msg = {\r\n\t\t// \ttime: new Date(),\r\n\t\t// \tuserId: user.userId || data.userId,\r\n\t\t// \tuserName: user.name || data.name || 'anonymous',\r\n\t\t// \theaderId: data.headerId,\r\n\t\t// \tuserCount: userCount,\r\n\t\t// \theaderTitle: headTitle\r\n\t\t// };\r\n\t\t// share.notifyNewUserJoined('TEXT', msg, 'LEAVE');\r\n\r\n\t\t// if (data.headerId === currentRoom.headerId) {\r\n\t\t// \tvar privateMsg = {\r\n\t\t// \t\tuserName: user.name,\r\n\t\t// \t\tauthor: user.userId,\r\n\t\t// \t\theaderTitle: headTitle,\r\n\t\t// \t\ttime: new Date().getTime()\r\n\t\t// \t};\r\n\t\t// \tprivateNotifyNewUserJoined('TEXT', privateMsg, 'LEAVE');\r\n\t\t// }\r\n\r\n\t\tif (data.userId === clientVars.userId) {\r\n\t\t\t$headingRoom.removeAttr('data-text');\r\n\t\t\tshare.roomBoxIconActive();\r\n\t\t\tcurrentRoom = {};\r\n\t\t\tdeactivateModal(data.headerId, roomInfo);\r\n\t\t\tshare.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\r\n\t\t}\r\n\r\n\t\tshare.wrtcPubsub.emit('update store', data, headerId, 'LEAVE', 'TEXT', roomInfo, function () {});\r\n\r\n\t\tif (cb && typeof cb === 'function') cb();\r\n\t}\r\n\r\n\tfunction userJoin(headerId, userData, $joinButton) {\r\n\t\tif (!userData || !userData.userId) {\r\n\t\t\tshare.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// check if user already in that room\r\n\t\tif (currentRoom && currentRoom.headerId === headerId) {\r\n\t\t\tshare.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t$joinBtn = $joinButton;\r\n\r\n\t\tshare.$body_ace_outer().find('button.btn_joinChat_chatRoom').removeClass('active');\r\n\r\n\t\tif (!currentRoom.userId) {\r\n\t\t\tsocket.emit('userJoin', padId, userData, 'text', addUserToRoom);\r\n\t\t} else {\r\n\t\t\tsocket.emit('userLeave', padId, currentRoom, 'text', function userLeave(data, roomInfo, target) {\r\n\t\t\t\tremoveUserFromRoom(data, roomInfo, 'text', function join2newOne() {\r\n\t\t\t\t\tsocket.emit('userJoin', padId, userData, 'text', addUserToRoom);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfunction userLeave(headerId, userData, $joinButton) {\r\n\t\t$joinBtn = $joinButton;\r\n\t\tsocket.emit('userLeave', padId, userData, 'text', removeUserFromRoom);\r\n\t}\r\n\r\n\tfunction socketBulkUpdateRooms(rooms, info, target) {\r\n\t\tvar roomsInfo = {};\r\n\t\t// create a roomInfo for each individual room\r\n\t\tObject.keys(rooms).forEach(function (headerId) {\r\n\t\t\tvar roomInfo = {\r\n\t\t\t\tpresent: rooms[headerId].length,\r\n\t\t\t\tlist: rooms[headerId]\r\n\t\t\t};\r\n\t\t\troomsInfo[headerId] = roomInfo;\r\n\t\t});\r\n\r\n\t\t// bind roomInfo and send user to gateway_userJoin\r\n\t\tObject.keys(rooms).forEach(function (headerId) {\r\n\t\t\trooms[headerId].forEach(function (user) {\r\n\t\t\t\taddUserToRoom(user, roomsInfo[headerId], 'text');\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tfunction bulkUpdateRooms(hTagList) {\r\n\t\tsocket.emit('bulkUpdateRooms', padId, hTagList, 'text', socketBulkUpdateRooms);\r\n\t}\r\n\r\n\tfunction postAceInit(hook, context, webSocket, docId) {\r\n\t\tsocket = webSocket;\r\n\t\tpadId = docId || window.pad.getPadId();\r\n\t\teventListers();\r\n\t}\r\n\r\n\treturn {\r\n\t\tpostAceInit: postAceInit,\r\n\t\tactivateModal: activateModal,\r\n\t\tdeactivateModal: deactivateModal,\r\n\t\tuserJoin: userJoin,\r\n\t\tuserLeave: userLeave,\r\n\t\tremoveUserFromRoom: removeUserFromRoom,\r\n\t\taddUserToRoom: addUserToRoom,\r\n\t\tbulkUpdateRooms: bulkUpdateRooms\r\n\t};\r\n})();\r\n\r\n// module.exports = textChat;","'use strict';\r\n// var share = require('ep_wrtc_heading/static/js/clientShare');\r\n\r\nvar videoChat = (function videoChat() {\r\n\tvar socket = null;\r\n\tvar padId = null;\r\n\tvar currentRoom = {};\r\n\tvar localStream = null;\r\n\tvar VIDEOCHATLIMIT = 0;\r\n\tvar $joinBtn = null;\r\n\r\n\tfunction mediaDevices() {\r\n\t\tnavigator.mediaDevices.enumerateDevices().then(function enumerateDevices(data) {\r\n\t\t\tvar videoSettings = localStorage.getItem('videoSettings') || { microphone: null, speaker: null, camera: null };\r\n\r\n\t\t\tif (typeof videoSettings === 'string') {\r\n\t\t\t\tvideoSettings = JSON.parse(videoSettings);\r\n\t\t\t}\r\n\r\n\t\t\tvar audioInputSelect = document.querySelector('select#audioSource');\r\n\t\t\tvar audioOutputSelect = document.querySelector('select#audioOutput');\r\n\t\t\tvar videoSelect = document.querySelector('select#videoSource');\r\n\r\n\t\t\tfor (var i = 0; i !== data.length; ++i) {\r\n\t\t\t\tvar deviceInfo = data[i];\r\n\t\t\t\tvar option = document.createElement('option');\r\n\t\t\t\toption.value = deviceInfo.deviceId;\r\n\t\t\t\tif (deviceInfo.kind === 'audioinput') {\r\n\t\t\t\t\toption.text = deviceInfo.label || 'microphone ' + (audioInputSelect.length + 1);\r\n\t\t\t\t\tif (videoSettings.microphone === deviceInfo.deviceId) option.selected = true;\r\n\t\t\t\t\t// audioInputSelect.appendChild(option);\r\n\t\t\t\t} else if (deviceInfo.kind === 'audiooutput') {\r\n\t\t\t\t\toption.text = deviceInfo.label || 'speaker ' + (audioOutputSelect.length + 1);\r\n\t\t\t\t\tif (videoSettings.speaker === deviceInfo.deviceId) option.selected = true;\r\n\t\t\t\t\t// audioOutputSelect.appendChild(option);\r\n\t\t\t\t} else if (deviceInfo.kind === 'videoinput') {\r\n\t\t\t\t\toption.text = deviceInfo.label || 'camera ' + (videoSelect.length + 1);\r\n\t\t\t\t\tif (videoSettings.camera === deviceInfo.deviceId) option.selected = true;\r\n\t\t\t\t\t// videoSelect.appendChild(option);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tfunction stopStreaming(stream, userId) {\r\n\t\tif (stream) {\r\n\t\t\tstream.getTracks().forEach(function stopStream(track) {\r\n\t\t\t\ttrack.stop();\r\n\t\t\t});\r\n\t\t\tstream = null;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction isUserMediaAvailable() {\r\n\t\treturn window.navigator.mediaDevices.getUserMedia({ audio: true, video: true });\r\n\t}\r\n\r\n\tfunction activateModal() {}\r\n\r\n\tfunction deactivateModal() {}\r\n\r\n\tfunction removeUserFromRoom(data, roomInfo, cb) {\r\n\t\tif (!data || !roomInfo || !data.userId) return false;\r\n\t\tvar headerId = data.headerId;\r\n\t\tvar $headingRoom = share.$body_ace_outer().find('#' + headerId);\r\n\t\tvar headerTitle = $headingRoom.find('.wrtc_header b.titleRoom').text();\r\n\t\tvar $videoChatUserList = $headingRoom.find('.wrtc_content.videoChat ul');\r\n\r\n\t\tshare.appendUserList(roomInfo, $videoChatUserList);\r\n\r\n\t\tvar userCount = roomInfo.present;\r\n\t\t$headingRoom.find('.videoChatCount').text(userCount);\r\n\r\n\t\tif (userCount === 0) {\r\n\t\t\t$videoChatUserList.append('<li class=\"empty\">Be the first to join the <button class=\"btn_joinChat_video\" data-action=\"JOIN\" data-id=\"' + headerId + '\" data-join=\"VIDEO\"><b>video-chat</b></button></li>');\r\n\t\t}\r\n\r\n\t\tvar user = share.getUserFromId(data.userId);\r\n\r\n\t\tif(user && data.action !== 'JOIN' && data.action !== 'RELOAD' ){\r\n\t\t\t// notify, a user join the video-chat room\r\n\t\t\tvar msg = {\r\n\t\t\t\ttime: new Date(),\r\n\t\t\t\tuserId: data.userId || user.userId,\r\n\t\t\t\tuserName: data.name || user.name || 'anonymous',\r\n\t\t\t\theaderId: data.headerId,\r\n\t\t\t\tuserCount: userCount,\r\n\t\t\t\theaderTitle: headerTitle,\r\n\t\t\t\tVIDEOCHATLIMIT: VIDEOCHATLIMIT\r\n\t\t\t};\r\n\t\t\tshare.notifyNewUserJoined('VIDEO', msg, 'LEAVE');\r\n\t\t}\r\n\r\n\t\tif (data.userId === clientVars.userId) {\r\n\t\t\t$headingRoom.removeAttr('data-video');\r\n\t\t\tshare.roomBoxIconActive();\r\n\t\t\t\r\n\t\t\twindow.headerId = null;\r\n\r\n\t\t\tcurrentRoom = {};\r\n\r\n\t\t\t$('#wrtc_modal').css({\r\n\t\t\t\ttransform: 'translate(-50%, -100%)',\r\n\t\t\t\topacity: 0\r\n\t\t\t}).attr({ 'data-active': false });\r\n\r\n\t\t\tWRTC.deactivate(data.userId, data.headerId);\r\n\t\t\tstopStreaming(localStream);\r\n\t\t\tlocalStream = null\r\n\t\t\tsocket.removeListener('receiveTextMessage:' + data.headerId);\r\n\t\t}\r\n\r\n\t\tif (cb && typeof cb === 'function') cb();\r\n\r\n\t\tshare.wrtcPubsub.emit('update store', data, headerId, 'LEAVE', 'VIDEO', roomInfo, function updateStore() {});\r\n\r\n\t\tshare.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\r\n\r\n\t\tWRTC.userLeave(data.userId)\r\n\t}\r\n\r\n\tfunction addUserToRoom(data, roomInfo) {\r\n\t\tif (!data || !data.userId) return false;\r\n\t\tvar headerId = data.headerId;\r\n\t\tvar $headingRoom = share.$body_ace_outer().find('#' + headerId);\r\n\t\tvar headerTitle = $headingRoom.find('.wrtc_header b.titleRoom').text();\r\n\r\n\t\tvar user = share.getUserFromId(data.userId);\r\n\t\t// some user may session does exist but the user info does not available in all over the current pad\r\n\t\tif (!user) return true;\r\n\r\n\t\t// TODO: this is not good idea, use global state\r\n\t\t// if incoming user has already in the room don't persuade the request\r\n\t\tvar IsUserInRooms = $headingRoom.find(\".wrtc_content.videoChat ul li[data-id='\" + user.userId + \"']\").text();\r\n\t\tif (IsUserInRooms) return false;\r\n\r\n\t\tvar userCount = roomInfo.present;\r\n\t\t$headingRoom.find('.videoChatCount').text(userCount);\r\n\r\n\t\t$(document).find('#wrtc_textChatWrapper .textChatToolbar .userCount').text(userCount);\r\n\r\n\t\tshare.appendUserList(roomInfo, $headingRoom.find('.wrtc_content.videoChat ul'));\r\n\r\n\t\tif(data.action == 'JOIN'){\r\n\t\t\t// notify, a user join the video-chat room\r\n\t\t\tvar msg = {\r\n\t\t\t\ttime: new Date(),\r\n\t\t\t\tuserId: data.userId,\r\n\t\t\t\tuserName: user.name || data.name || 'anonymous',\r\n\t\t\t\theaderId: data.headerId,\r\n\t\t\t\tuserCount: userCount,\r\n\t\t\t\theaderTitle: headerTitle,\r\n\t\t\t\tVIDEOCHATLIMIT: VIDEOCHATLIMIT\r\n\t\t\t};\r\n\r\n\t\t\tshare.notifyNewUserJoined('VIDEO', msg, 'JOIN');\r\n\r\n\t\t\t// if (data.headerId === currentRoom.headerId && data.userId !== clientVars.userId) {\r\n\t\t\t// \t$.gritter.add({\r\n\t\t\t// \t\ttext: '<span class=\"author-name\">' + user.name + '</span>' + 'has joined the video-chat, <b><i> \"' + headerTitle + '\"</b></i>',\r\n\t\t\t// \t\tsticky: false,\r\n\t\t\t// \t\ttime: 3000,\r\n\t\t\t// \t\tposition: 'center',\r\n\t\t\t// \t\tclass_name: 'chat-gritter-msg'\r\n\t\t\t// \t});\r\n\t\t\t// }\r\n\t\t}\r\n\r\n\t\tif (data.userId === clientVars.userId) {\r\n\t\t\t$headingRoom.attr({ 'data-video': true });\r\n\t\t\tshare.roomBoxIconActive();\r\n\r\n\t\t\t$('#werc_toolbar p').attr({ 'data-id': data.headerId }).text(headerTitle);\r\n\t\t\t$(\"#werc_toolbar .btn_roomHandler\").attr({ 'data-id': data.headerId });\r\n\r\n\t\t\twindow.headerId = data.headerId;\r\n\t\t\tWRTC.activate(data.headerId, user.userId);\r\n\t\t\tcurrentRoom = data;\r\n\r\n\t\t\t$('#rtcbox').prepend('<h4 class=\"chatTitle\">' + headerTitle + '</h4>');\r\n\r\n\t\t\t$('#wrtc_modal').css({\r\n\t\t\t\ttransform: 'translate(-50%, 0)',\r\n\t\t\t\topacity: 1\r\n\t\t\t}).attr({ 'data-active': true });\r\n\r\n\t\t\tshare.wrtcPubsub.emit('enable room buttons', headerId, 'JOIN', $joinBtn);\r\n\r\n\t\t\tsocket.on('receiveTextMessage:' + headerId, function receiveTextMessage(headingId, msg) {\r\n\t\t\t\tvar active = $(document).find('#wrtc_textChatWrapper').hasClass('active');\r\n\t\t\t\tif (headingId === headerId && !active) {\r\n\t\t\t\t\ttextChat.userJoin(headerId, data, 'TEXT');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t}\r\n\r\n\t\tshare.wrtcPubsub.emit('update store', data, headerId, 'JOIN', 'VIDEO', roomInfo, function updateStore() {});\r\n\t}\r\n\t\r\n\tfunction createSession(headerId, userInfo, $joinButton) {\r\n\t\tshare.$body_ace_outer().find('button.btn_joinChat_chatRoom').removeClass('active');\r\n\t\t$joinBtn = $joinButton;\r\n\t\t// isUserMediaAvailable().then(function joining(stream) {\r\n\t\t\tlocalStream = null;\r\n\r\n\t\t\tif (!currentRoom.userId) {\r\n\t\t\t\treturn socket.emit('userJoin', padId, userInfo, 'video', gateway_userJoin);\r\n\t\t\t}\r\n\t\t\t// If the user has already joined the video chat, make suer leave that room then join to the new chat room\r\n\t\t\tsocket.emit('userLeave', padId, currentRoom, 'video', function userLeave(_userData, roomInfo) {\r\n\t\t\t\tgateway_userLeave(_userData, roomInfo, function join2newOne() {\r\n\t\t\t\t\tsocket.emit('userJoin', padId, userInfo, 'video', gateway_userJoin);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t// })['catch'](function (err) {\r\n\t\t// \tconsole.error(err);\r\n\t\t// \tshare.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\r\n\t\t// \tsocket.emit('userLeave', padId, currentRoom, 'video', function userLeave(_userData, roomInfo) {\r\n\t\t// \t\tgateway_userLeave(_userData, roomInfo);\r\n\t\t// \t});\r\n\t\t// \tWRTC.showUserMediaError(err);\r\n\t\t// });\r\n\r\n\t}\r\n\r\n\tfunction userJoin(headerId, userInfo, $joinButton) {\r\n\t\tif (!userInfo || !userInfo.userId) {\r\n\t\t\tshare.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// check if has user already in that room\r\n\t\tif (currentRoom && currentRoom.headerId === headerId) {\r\n\t\t\tshare.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tcreateSession(headerId, userInfo, $joinButton);\r\n\t}\r\n\r\n\tfunction reloadSession(headerId, userInfo, $joinButton){\r\n\t\tif (!userInfo || !userInfo.userId) {\r\n\t\t\tshare.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tcreateSession(headerId, userInfo, $joinButton, 'RELOAD');\r\n\t}\r\n\r\n\tfunction userLeave(headerId, data, $joinButton) {\r\n\t\t$joinBtn = $joinButton;\r\n\t\tsocket.emit('userLeave', padId, data, 'video', gateway_userLeave);\r\n\t}\r\n\r\n\tfunction reachedVideoRoomSize(roomInfo, showAlert, isBulkUpdate) {\r\n\t\tconsole.log(VIDEOCHATLIMIT, roomInfo)\r\n\t\tif (roomInfo && roomInfo.present <= VIDEOCHATLIMIT) return true;\r\n\r\n\t\tshowAlert = showAlert || true;\r\n\t\tif (showAlert && !isBulkUpdate) {\r\n\t\t\t$.gritter.add({\r\n\t\t\t\ttitle: 'Video chat Limitation',\r\n\t\t\t\ttext: 'The video-chat room has been reached its limitation. \\r\\n <br> The size of this video-chat room is ' + VIDEOCHATLIMIT + '.',\r\n\t\t\t\tsticky: false,\r\n\t\t\t\tclass_name: 'error',\r\n\t\t\t\ttime: '5000'\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfunction socketBulkUpdateRooms(rooms, info, target) {\r\n\t\tvar roomsInfo = {};\r\n\t\t// create a roomInfo for each individual room\r\n\t\tObject.keys(rooms).forEach(function makeRoomInfo(headerId) {\r\n\t\t\tvar roomInfo = {\r\n\t\t\t\tpresent: rooms[headerId].length,\r\n\t\t\t\tlist: rooms[headerId]\r\n\t\t\t};\r\n\t\t\troomsInfo[headerId] = roomInfo;\r\n\t\t});\r\n\r\n\t\t// bind roomInfo and send user to gateway_userJoin\r\n\t\tObject.keys(rooms).forEach(function (headerId) {\r\n\t\t\trooms[headerId].forEach(function (user) {\r\n\t\t\t\tgateway_userJoin(user, roomsInfo[headerId], true);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tfunction bulkUpdateRooms(hTagList) {\r\n\t\tsocket.emit('bulkUpdateRooms', padId, hTagList, 'video', socketBulkUpdateRooms);\r\n\t}\r\n\r\n\t/**\r\n  *\r\n  * @param {Object} data @requires\r\n  * @param {String} data.padId @requires\r\n  * @param {String} data.userId @requires\r\n  * @param {String} data.userName @requires\r\n  * @param {String} data.headerId\r\n  *\r\n  * @param {Object} roomInfo\r\n  * @param {Boolean} showAlert\r\n  * @param {Boolean} bulkUpdate\r\n *\r\n *\t@returns\r\n  */\r\n\tfunction gateway_userJoin(data, roomInfo, showAlert, bulkUpdate) {\r\n\t\tif (!data) return reachedVideoRoomSize(null, true, false);\r\n\r\n\t\tif (data && reachedVideoRoomSize(roomInfo, showAlert, bulkUpdate)) {\r\n\t\t\treturn addUserToRoom(data, roomInfo);\r\n\t\t} else if (bulkUpdate) {\r\n\t\t\treturn addUserToRoom(data, roomInfo);\r\n\t\t}\r\n\t\treturn stopStreaming(localStream);\r\n\t}\r\n\r\n\tfunction gateway_userLeave(data, roomInfo, cb) {\r\n\t\tremoveUserFromRoom(data, roomInfo, cb);\r\n\t}\r\n\r\n\tfunction postAceInit(hook, context, webSocket, docId) {\r\n\t\tsocket = webSocket;\r\n\t\tpadId = docId || window.pad.getPadId();\r\n\t\tVIDEOCHATLIMIT = clientVars.webrtc.videoChatLimit;\r\n\r\n\t\tmediaDevices();\r\n\t}\r\n\r\n\treturn {\r\n\t\tpostAceInit: postAceInit,\r\n\t\tactivateModal: activateModal,\r\n\t\tdeactivateModal: deactivateModal,\r\n\t\tuserJoin: userJoin,\r\n\t\tuserLeave: userLeave,\r\n\t\tgateway_userJoin: gateway_userJoin,\r\n\t\tgateway_userLeave: gateway_userLeave,\r\n\t\tbulkUpdateRooms: bulkUpdateRooms,\r\n\t\treloadSession: reloadSession\r\n\t};\r\n})();\r\n\r\n// module.exports = videoChat;","\r\n\r\n// var share = require('ep_wrtc_heading/static/js/clientShare');\r\n// var textChat = require('ep_wrtc_heading/static/js/textChat');\r\n// var videoChat = require('ep_wrtc_heading/static/js/videoChat');\r\n// new comment so wat?\r\n\r\nvar WRTC_Room = (function WRTC_Room() {\r\n\tvar self = null;\r\n\tvar socket = null;\r\n\tvar padId = null;\r\n\tvar VIDEOCHATLIMIT = 0;\r\n\t// var $lastJoinButton = null;\r\n\tvar prefixHeaderId = 'headingTagId_';\r\n\tvar hElements = \"h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6\";\r\n\r\n\r\n\tfunction postAceInit(hook, context, webSocket, docId) {\r\n\t\tsocket = webSocket;\r\n\t\tpadId = docId;\r\n\t\tVIDEOCHATLIMIT = clientVars.webrtc.videoChatLimit;\r\n\r\n\t\tsocket.on('userJoin', function (data, roomInfo, target) {\r\n\t\t\tif (target === 'video') {\r\n\t\t\t\tvideoChat.gateway_userJoin(data, roomInfo, false);\r\n\t\t\t} else {\r\n\t\t\t\ttextChat.addUserToRoom(data, roomInfo, target);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tsocket.on('userLeave', function (data, roomInfo, target) {\r\n\t\t\tif (target === 'video') {\r\n\t\t\t\tvideoChat.gateway_userLeave(data, roomInfo, target);\r\n\t\t\t} else {\r\n\t\t\t\ttextChat.removeUserFromRoom(data, roomInfo, target);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tactiveEventListener();\r\n\r\n\t\t// check if there is a join request in URI queryString\r\n\t\t// TODO: befre check this, the tags must be ready\r\n\t\tsetTimeout(function () {\r\n\t\t\tjoinByQueryString();\r\n\t\t}, 500);\r\n\t}\r\n\r\n\r\n\t/** --------- Helper --------- */\r\n\r\n\tfunction link2Clipboard(text) {\r\n\t\tvar $temp = $('<input>');\r\n\t\t$('body').append($temp);\r\n\t\t$temp.val(text).select();\r\n\t\tdocument.execCommand('copy');\r\n\t\t$temp.remove();\r\n\t\t$.gritter.add({\r\n\t\t\ttitle: 'Copied',\r\n\t\t\ttext: 'Join link copied to clip board',\r\n\t\t\tsticky: false,\r\n\t\t\tclass_name: 'copyLinkToClipboard',\r\n\t\t\ttime: '3000'\r\n\t\t});\r\n\t}\r\n\r\n\tfunction scroll2Header(headerId) {\r\n\t\tvar padContainer = share.$body_ace_outer().find('iframe').contents().find('#innerdocbody');\r\n\t\tpadContainer.find('.' + prefixHeaderId + headerId).each(function scrolling() {\r\n\t\t\tthis.scrollIntoView({\r\n\t\t\t\tbehavior: 'smooth'\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tfunction closeTextChat () {\r\n\t\t$('#wrtc_textChatWrapper .btn_leave').trigger('click');\r\n\t}\r\n\r\n\tfunction joinChatRoom(headerId, userInfo, target) {\r\n\t\t// textChat.userJoin(headerId, userInfo, 'TEXTPLUS');\r\n\t\tvideoChat.userJoin(headerId, userInfo, 'PLUS');\r\n\t\tcloseTextChat();\r\n\t}\r\n\t\r\n\tfunction leaveChatRoom(headerId, userInfo, target) {\r\n\t\t// textChat.userLeave(headerId, userInfo, 'TEXTPLUS');\r\n\t\tvideoChat.userLeave(headerId, userInfo, 'PLUS');\r\n\t\tcloseTextChat();\r\n\t}\r\n\r\n\t/**\r\n  *\r\n  * @param {string} actions @enum (JOIN|LEAVE)\r\n  * @param {string} headerId\r\n  * @param {string} target @enum (chatRoom|video|text)\r\n  */\r\n\tfunction roomBtnHandler(actions, headerId, target) {\r\n\t\tif(typeof actions !== 'string') {\r\n\t\t\tactions.preventDefault();\r\n\t\t\t// actions.stopPropagation();\r\n\t\t}\r\n\t\theaderId = $(this).attr('data-id') || headerId;\r\n\t\tactions = $(this).attr('data-action') || actions;\r\n\t\ttarget = $(this).attr('data-join') || target;\r\n\r\n\t\tif (!headerId || !target ) return true;\r\n\r\n\t\tvar $joinBtn = $(this);\r\n\r\n\t\tvar userInfo = {\r\n\t\t\tpadId: clientVars.padId || window.pad.getPadId(),\r\n\t\t\tuserId: clientVars.userId || window.pad.getUserId(),\r\n\t\t\tuserName: clientVars.userName || 'anonymous',\r\n\t\t\theaderId: headerId,\r\n\t\t\ttarget: target,\r\n\t\t\taction: actions\r\n\t\t};\r\n\r\n\t\tshare.wrtcPubsub.emit('disable room buttons', headerId, actions, target);\r\n\r\n\t\tif (actions === 'JOIN') {\r\n\t\t\tswitch (target) {\r\n\t\t\t\tcase 'PLUS':\r\n\t\t\t\t\tjoinChatRoom(headerId, userInfo, target);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'VIDEO':\r\n\t\t\t\t\tvideoChat.userJoin(headerId, userInfo, target);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'TEXT':\r\n\t\t\t\t\ttextChat.userJoin(headerId, userInfo, target);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t} else if (actions === 'LEAVE') {\r\n\t\t\tswitch (target) {\r\n\t\t\t\tcase 'PLUS':\r\n\t\t\t\t\tleaveChatRoom(headerId, userInfo, target);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'VIDEO':\r\n\t\t\t\t\tvideoChat.userLeave(headerId, userInfo, target);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'TEXT':\r\n\t\t\t\t\ttextChat.userLeave(headerId, userInfo, target);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t} else if(actions === 'RELOAD') {\r\n\t\t\tvideoChat.reloadSession(headerId, userInfo, target, actions);\r\n\t\t} else if(actions === 'SHARELINK') {\r\n\t\t\tshareRoomsLink(headerId, target);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction joinByQueryString() {\r\n\t\tvar urlParams = new URLSearchParams(window.location.search);\r\n\t\tvar headerId = urlParams.get('id');\r\n\t\tvar target = urlParams.get('target');\r\n\t\tvar join = urlParams.get('join');\r\n\r\n\t\tif(!headerId) return true;\r\n\r\n\t\tvar isHeading = share.$body_ace_outer().find('#' + headerId);\r\n\r\n\t\tif(!isHeading.length){\r\n\t\t\t$.gritter.add({\r\n\t\t\t\ttitle: 'Error',\r\n\t\t\t\ttext: \"The header seems not to exist anymore!\",\r\n\t\t\t\ttime: 3000,\r\n\t\t\t\tsticky: false,\r\n\t\t\t\tclass_name: 'error'\r\n\t\t\t});\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (headerId) {\r\n\t\t\tscroll2Header(headerId);\r\n\t\t}\r\n\t\tif (join === 'true') {\r\n\t\t\ttarget = target.toUpperCase();\r\n\t\t\tsetTimeout(function makeSureHeadingReady() {\r\n\t\t\t\troomBtnHandler('JOIN', headerId, target);\r\n\t\t\t}, 700);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction shareRoomsLink(headId, target) {\r\n\t\theadId = $(this).attr('data-id') || headId;\r\n\t\ttarget = $(this).attr('data-join') || target;\r\n\t\tvar title = share.$body_ace_outer().find('.wbrtc_roomBox.' + headId + ' .titleRoom').text();\r\n\r\n\t\tvar origin = window.location.origin;\r\n\t\tvar pathName = window.location.pathname;\r\n\t\tvar link = origin + pathName + '?header=' + share.slugify(title) + '&id=' + headId + '&target=' + target + '&join=true';\r\n\r\n\t\tvar $temp = $('<input>');\r\n\t\t$('body').append($temp);\r\n\t\t$temp.val(link).select();\r\n\t\tdocument.execCommand('copy');\r\n\t\t$temp.remove();\r\n\r\n\t\t$.gritter.add({\r\n\t\t\ttitle: 'Copied',\r\n\t\t\ttext: 'Join link copied to clip board',\r\n\t\t\tsticky: false,\r\n\t\t\tclass_name: 'copyLinkToClipboard',\r\n\t\t\ttime: '3000'\r\n\t\t});\r\n\t}\r\n\r\n\tfunction getHeaderRoomY($element) {\r\n\t\tvar height = $element.outerHeight();\r\n\t\tvar paddingTop = share.$body_ace_outer().find('iframe[name=\"ace_inner\"]').css('padding-top');\r\n\t\tvar aceOuterPadding = parseInt(paddingTop, 10);\r\n\t\tvar offsetTop = Math.ceil($element.offset().top + aceOuterPadding);\r\n\t\treturn offsetTop + height / 2 - 26;\r\n\t}\r\n\r\n\tfunction getHeaderRoomX($element) {\r\n\t\tvar width = $element.outerWidth();\r\n\t\tvar paddingLeft = share.$body_ace_outer().find('iframe[name=\"ace_inner\"]').css('padding-left');\r\n\t\tvar aceOuterPadding = parseInt(paddingLeft, 10);\r\n\t\tvar offsetLeft = Math.ceil(share.$body_ace_outer().find('iframe[name=\"ace_inner\"]').offset().left - aceOuterPadding);\r\n\t\treturn offsetLeft - width - 6;\r\n\t}\r\n\r\n\tfunction activeEventListener() {\r\n\t\tvar $wbrtc_roomBox = share.$body_ace_outer();\r\n\r\n\t\t$wbrtc_roomBox.on('click', '.wbrtc_roomBox .btn_joinChat_text', roomBtnHandler);\r\n\t\t$wbrtc_roomBox.on('click', '.wbrtc_roomBox .btn_joinChat_video', roomBtnHandler);\r\n\t\t$wbrtc_roomBox.on('click', '.wbrtc_roomBox .btn_joinChat_chatRoom', roomBtnHandler);\r\n\r\n\t\t$(document).on('click', '#chattext .wrtc_roomLink', roomBtnHandler);\r\n\r\n\t\t$(document).on('click', '#werc_toolbar .btn_roomHandler, .btn_controllers .btn_roomHandler', roomBtnHandler);\r\n\r\n\t\t// ep_full_hyperlinks link listner\r\n\t\t$wbrtc_roomBox.on('click', 'a.btn_roomHandler', roomBtnHandler)\r\n\t\t$(document).on('click', 'a.btn_roomHandler', roomBtnHandler)\r\n\t\t// share.$body_ace_outer().on('mouseenter', '.wbrtc_roomBox', function mouseenter() {\r\n\t\t// \t$(this).parent().css({ overflow: 'initial' });\r\n\t\t// \t$(this).addClass('active').find('.wrtc_contentBody').css({ display: 'block' });\r\n\t\t// }).on('mouseleave', '.wbrtc_roomBox', function mouseleave() {\r\n\t\t// \t$(this).parent().css({ overflow: 'hidden' });\r\n\t\t// \t$(this).removeClass('active').find('.wrtc_contentBody').css({ display: 'none' });\r\n\t\t// });\r\n\r\n\t\tshare.$body_ace_outer().on('click', '.wbrtc_roomBoxFooter > button.btn_share', function click() {\r\n\t\t\tvar headerURI = $(this).find('input').val();\r\n\t\t\tlink2Clipboard(headerURI);\r\n\t\t});\r\n\r\n\t\t// share.$body_ace_outer().on('mouseenter', '.wrtc_roomInlineAvatar .avatar', function mouseenter() {\r\n\t\t// \tvar id = $(this).parent().parent().attr('id');\r\n\t\t// \tshare.$body_ace_outer().find('#' + id + '.wbrtc_roomBox').trigger('mouseenter');\r\n\t\t// }).on('mouseleave', '.wrtc_roomInlineAvatar .avatar', function mouseleave() {\r\n\t\t// \tvar id = $(this).parent().parent().attr('id');\r\n\t\t// \tshare.$body_ace_outer().find('#' + id + '.wbrtc_roomBox').trigger('mouseleave');\r\n\t\t// });\r\n\r\n\t\t$(document).on('click', '#werc_toolbar p, .textChatToolbar b', function click() {\r\n\t\t\tvar headerId = $(this).attr('data-id');\r\n\t\t\tscroll2Header(headerId);\r\n\t\t});\r\n\r\n\t\t$(document).on('click', '#werc_toolbar .btn_enlarge', function click() {\r\n\t\t\tif (!$(this).attr('active')) return true;\r\n\r\n\t\t\t$(this).toggleClass('large');\r\n\r\n\t\t\t$('#wrtc_modal .video-container .enlarge-btn').each(function trigger() {\r\n\t\t\t\t$(this).trigger('click');\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\t// video interface settings\r\n\t\t$(document).on('click', '#werc_toolbar .btn_videoSetting', function click() {\r\n\t\t\tvar offset = $(this).position();\r\n\t\t\tvar $box = $(document).find('#wrtc_settings');\r\n\t\t\tvar width = $box.outerWidth();\r\n\t\t\t$box.css({left: offset.left - width  + 'px',top: offset.top + 4 + 'px'}).toggleClass('active');\r\n\t\t});\r\n\r\n\t\t\r\n\t}\r\n\r\n\tself = {\r\n\t\tpostAceInit: postAceInit,\r\n\t\tgetHeaderRoomX: getHeaderRoomX,\r\n\t\taceSetAuthorStyle: function aceSetAuthorStyle(context) {\r\n\t\t\tif (context.author) {\r\n\t\t\t\tvar user = share.getUserFromId(context.author);\r\n\t\t\t\tif (user) {\r\n\t\t\t\t\t// sync user info\r\n\t\t\t\t\tshare.$body_ace_outer().find(\".wrtc_content.textChat ul li[data-id='\" + user.userId + \"']\").css({ 'border-color': user.colorId }).text(user.name);\r\n\t\t\t\t\tshare.$body_ace_outer().find(\".wrtc_content.videoChat ul li[data-id='\" + user.userId + \"']\").css({ 'border-color': user.colorId }).text(user.name);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tuserLeave: function userLeave(context, callback) {\r\n\t\t\t// Deprecated, we use socket disconnect\r\n\r\n\t\t\tcallback();\r\n\t\t},\r\n\t\tbulkUpdateRooms: function bulkUpdateRooms(hTagList) {\r\n\t\t\tvideoChat.bulkUpdateRooms(hTagList);\r\n\t\t\ttextChat.bulkUpdateRooms(hTagList);\r\n\t\t},\r\n\t\tadoptHeaderYRoom: function adoptHeaderYRoom() {\r\n\t\t\t// Set all video_heading to be inline with their target REP\r\n\t\t\tvar $padOuter = share.$body_ace_outer();\r\n\t\t\tif (!$padOuter) return;\r\n\r\n\t\t\t$padOuter.find('.wbrtc_roomBox, .wrtc_roomInlineAvatar ').each(function adjustHeaderIconPosition() {\r\n\t\t\t\tvar $el = $(this);\r\n\t\t\t\tvar $boxId = $el.attr('id');\r\n\t\t\t\tvar hClassId = 'headingTagId_' + $boxId;\r\n\t\t\t\tvar $headingEl = $padOuter.find('iframe').contents().find('#innerdocbody').find('.' + hClassId);\r\n\r\n\t\t\t\t// if the H tags does not find, remove chatBox\r\n\t\t\t\t// TODO: and kick out the user form the chatBox\r\n\t\t\t\tif ($headingEl.length <= 0) {\r\n\t\t\t\t\t$el.remove();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ($el.attr('data-box') === 'avatar') $el.css({ left: getHeaderRoomX($el) + 'px' });\r\n\t\t\t\t$el.css({ top: getHeaderRoomY($headingEl) + 'px' });\r\n\t\t\t});\r\n\t\t},\r\n\t\tfindTags: function findTags() {\r\n\t\t\tvar hTagList = [];\r\n\t\t\tvar hTagElements = hElements;\r\n\t\t\tvar hTags = share.$body_ace_outer().find('iframe').contents().find('#innerdocbody').children('div').children(hTagElements);\r\n\t\t\tvar aceInnerOffset = share.$body_ace_outer().find('iframe[name=\"ace_inner\"]').offset();\r\n\t\t\tvar target = share.$body_ace_outer().find('#outerdocbody');\r\n\t\t\tvar newHTagAdded = false;\r\n\r\n\t\t\t$(hTags).each(function createWrtcRoomBox() {\r\n\t\t\t\tvar $el = $(this);\r\n\t\t\t\t// var lineNumber = $el.parent().prevAll().length;\r\n\t\t\t\t// var tag = $(\"#title\")[0].tagName.toLowerCase();\r\n\t\t\t\tvar newY = getHeaderRoomY($el);\r\n\t\t\t\tvar newX = Math.ceil(aceInnerOffset.left);\r\n\t\t\t\tvar headingTagId = $el.find('span').attr('class');\r\n\t\t\t\theadingTagId = /(?:^| )headingTagId_([A-Za-z0-9]*)/.exec(headingTagId);\r\n\r\n\t\t\t\tif (!headingTagId) {\r\n\t\t\t\t\tconsole.warn(\"[wrtc]: couldn't find headingTagId.\")\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar data = {\r\n\t\t\t\t\theadingTagId: headingTagId[1],\r\n\t\t\t\t\t// tag: tag,\r\n\t\t\t\t\tpositionTop: newY,\r\n\t\t\t\t\tpositionLeft: newX,\r\n\t\t\t\t\theadTitle: $el.text(),\r\n\t\t\t\t\t// lineNumber: lineNumber,\r\n\t\t\t\t\tvideoChatLimit: VIDEOCHATLIMIT\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (!share.wrtcStore[data.headingTagId]) share.wrtcStore[data.headingTagId] = { VIDEO: { list: [] }, TEXT: { list: [] }, USERS: {} };\r\n\r\n\t\t\t\t// if the header does not exists then adde to list\r\n\t\t\t\t// otherwise update textHeader\r\n\t\t\t\t// TODO: performance issue\r\n\t\t\t\tif (target.find('#' + data.headingTagId).length <= 0) {\r\n\t\t\t\t\tvar box = $('#wertc_roomBox').tmpl(data);\r\n\t\t\t\t\ttarget.find('#wbrtc_chatBox').append(box);\r\n\t\t\t\t\tvar avatarBox = $('#wertc_inlineAvatar').tmpl(data);\r\n\t\t\t\t\ttarget.find('#wbrtc_avatarCol').append(avatarBox);\r\n\t\t\t\t\tnewHTagAdded = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$(document).find('[data-headid=' + data.headingTagId + '].wrtc_text .wrtc_roomLink, #werc_toolbar p[data-id=' + data.headingTagId + ']').text(data.headTitle);\r\n\t\t\t\t\ttarget.find('.wbrtc_roomBox[id=' + data.headingTagId + '] .titleRoom').text(data.headTitle);\r\n\t\t\t\t\t$(document).find('#wrtc_textChatWrapper[data-id=' + data.headingTagId + '] .nd_title b').text(data.headTitle);\r\n\t\t\t\t}\r\n\r\n\t\t\t\thTagList.push(data);\r\n\t\t\t});\r\n\t\t\t// if a new h tag addedd check all heading again!\r\n\t\t\tif (newHTagAdded) {\r\n\t\t\t\tself.bulkUpdateRooms(hTagList);\r\n\t\t\t\tnewHTagAdded = false;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\treturn self;\r\n})();","/**\r\n * Copyright 2013 j <j@mailb.org>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *      http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n'use strict';\r\n\r\nvar WRTC = (function WRTC() {\r\n\tvar padId = null;\r\n\tvar socket = null;\r\n\tvar videoSizes = { large: '260px', small: '160px' };\r\n\tvar pcConfig = {};\r\n\tvar audioInputSelect = null;\r\n\tvar videoSelect = null;\r\n\tvar audioOutputSelect = null;\r\n\tvar pcConstraints = {\r\n\t\toptional: [{\r\n\t\t\tDtlsSrtpKeyAgreement: true\r\n\t\t}]\r\n\t};\r\n\tvar sdpConstraints = {\r\n\t\tmandatory: {\r\n\t\t\tOfferToReceiveAudio: true,\r\n\t\t\tOfferToReceiveVideo: true\r\n\t\t}\r\n\t};\r\n\tvar localStream;\r\n\tvar remoteStream = {};\r\n\tvar pc = {};\r\n\tvar callQueue = [];\r\n\tvar enlargedVideos = new Set();\r\n\tvar localVideoElement = null;\r\n\tvar gState = null\r\n\r\n\t// create an empty priority queue\r\n// var queue = new TinyQueue();\r\n\r\n\tvar queue = [];\r\n\r\n\tshare.wrtcPubsub.on('WebRTC call', function(data){\r\n\t\tconsole.log('WebRTC call')\r\n\t\tvar userId = data.userId\r\n\t\tvar headerId = data.headerId\r\n\r\n\t\t//put value on end of queue\r\n\t\tqueue.push(data);\r\n\r\n\t})\r\n\r\n\tshare.wrtcPubsub.on('WebRTC accept new call', function(data){\r\n\t\tconsole.log('WebRTC accept new call')\r\n\r\n\t})\r\n\r\n\tfunction postAceInit(hook, context, webSocket, docId) {\r\n\t\tpadId = docId;\r\n\t\tsocket = webSocket;\r\n\r\n\t\t// https://developer.mozilla.org/en-US/docs/Web/API/RTCConfiguration/iceServers\r\n\t\t// Don't forget to use TURN server, The Stun server is not enough.\r\n\t\tpcConfig.iceServers = [\r\n\t\t{'urls': [\r\n\t\t\t\t'stun:stun.l.google.com:19302',\r\n\t\t\t\t'stun:stun1.l.google.com:19302',\r\n\t\t\t\t'stun:stun2.l.google.com:19302',\r\n\t\t\t\t'stun:stun.l.google.com:19302?transport=udp',,\r\n\t\t\t\t\"stun:130.185.122.49:3478\"\r\n\t\t\t]\r\n\t\t},\r\n\t\t{url: [\"turn:130.185.122.49:3478\"], credential: \"docsplus\", username: \"strongPassword\"},\r\n\t\t{\r\n\t\t\t\turl: 'turn:numb.viagenie.ca',\r\n\t\t\t\tcredential: 'muazkh',\r\n\t\t\t\tusername: 'webrtc@live.com'\r\n\t\t},\r\n\t\t{url: \"turn:turn.anyfirewall.com:443?transport=tcp\", credential: \"webrtc\", username: \"webrtc\"}\r\n\t\t];\r\n\r\n\t\tif(clientVars.webrtc && clientVars.webrtc.iceServers) pcConfig.iceServers = clientVars.webrtc.iceServers;\r\n\r\n\t\tif (clientVars.webrtc.video.sizes.large) {\r\n\t\t\tvideoSizes.large = clientVars.webrtc.video.sizes.large + 'px';\r\n\t\t}\r\n\t\tif (clientVars.webrtc.video.sizes.small) {\r\n\t\t\tvideoSizes.small = clientVars.webrtc.video.sizes.small + 'px';\r\n\t\t}\r\n\t\twebSocket.on(\"RTC_MESSAGE\", async function(context){\r\n\r\n\r\n\r\n\r\n\t\t\tif (context.data.payload.data.headerId === window.headerId) {\r\n\t\t\t\t// console.log(\"my oooooooofffffffff, \", context.data.payload.data.type)\r\n\t\t\t\t// if(context.data.payload.data.type!=='offer'){\r\n\t\t\t\t\tawait self.receiveMessage(context.data.payload);\r\n\t\t\t\t// }\r\n\t\t\t} \r\n\t\r\n\t\t\t\r\n\t\r\n\t\r\n\t\t})\r\n\r\n\r\n\t\t// webSocket.on('makeCall', function(userId, headerId) {\r\n\t\t// \tconsole.log(userId, headerId, \"============makeCallmakeCallmakeCall\")\r\n\t\t// \tself.call(userId, headerId);\r\n\t\t// })\r\n\r\n\t\t$(document).on('change', 'select#audioSource', self.audioVideoInputChange);\r\n\t\t$(document).on('change', 'select#videoSource', self.audioVideoInputChange);\r\n\t\t$(document).on('change', 'select#audioOutput', self.changeAudioDestination);\r\n\r\n\t\t$(window).on('unload', function () {\r\n\t\t\tself.hangupAll();\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tfunction aceSetAuthorStyle (context) {\r\n\t\tif (context.author) {\r\n\t\t\tvar user = share.getUserFromId(context.author);\r\n\t\t\tif (user) {\r\n\t\t\t\t$('#video_' + user.userId.replace(/\\./g, '_')).css({\r\n\t\t\t\t\t'border-color': user.colorId\r\n\t\t\t\t}).siblings('.user-name').text(user.name);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tvar self = {\r\n\t\t_pad: window.pad,\r\n\t\tpostAceInit: postAceInit,\r\n\t\taceSetAuthorStyle: aceSetAuthorStyle,\r\n\t\tappendInterfaceLayout: function appendInterfaceLayout() {\r\n\t\t\t// TODO: legacy code, move it to template\r\n\t\t\tvar werc_toolbar = $('#wertc_modal_toolbar').tmpl({\r\n\t\t\t\tvideoChatLimit: clientVars.webrtc.videoChatLimit,\r\n\t\t\t\theaderId: ''\r\n\t\t\t});\r\n\t\t\tvar $wrtc_modal = $('<div id=\"wrtc_modal\"><div class=\"videoWrapper\" class=\"thin-scrollbar\"></div></div');\r\n\t\t\t$wrtc_modal.append(werc_toolbar);\r\n\t\t\t$('body').prepend($wrtc_modal);\r\n\r\n\t\t\t$(document).on('click', '#wrtc_modal .btn_toggle_modal', function click() {\r\n\t\t\t\tvar $parent = $(this).parent().parent();\r\n\t\t\t\tvar action = $(this).attr('data-action');\r\n\t\t\t\tvar videoBox = $('#wrtc_modal .videoWrapper').innerHeight();\r\n\r\n\t\t\t\t$(this).find('.fa_arrow-from-top').toggle();\r\n\t\t\t\t$(this).find('.fa_arrow-to-top').toggle();\r\n\r\n\t\t\t\tif (action === 'collapse') {\r\n\t\t\t\t\t$(this).attr({ 'data-action': 'expand' });\r\n\t\t\t\t\t$parent.find('.btn_enlarge').removeAttr('active');\r\n\t\t\t\t\t$('#wrtc_modal').css({\r\n\t\t\t\t\t\ttransform: 'translate(-50%, -' + videoBox + 'px)'\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$(this).attr({ 'data-action': 'collapse' });\r\n\t\t\t\t\t$parent.find('.btn_enlarge').attr({ active: true });\r\n\t\t\t\t\t$('#wrtc_modal').css({\r\n\t\t\t\t\t\ttransform: 'translate(-50%, 0)'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\r\n\t\t\t$(document).on('click', '#wrtc_settings .btn_info', function click() {\r\n\t\t\t\tvar userID = Object.keys(pc)\r\n\t\t\t\tvar $this =  $(this)\r\n\t\t\t\tvar isActive = $this.attr('data-active')\r\n\t\t\t\tvar $modal = $(document).find(\"#wrtc_settings .wrtc_info\")\r\n\r\n\t\t\t\tif(isActive){\r\n\t\t\t\t\t$modal.hide();\r\n\t\t\t\t\tif(pc[userID[0]]){\r\n\t\t\t\t\t\tgetStats(pc[userID[0]], function(result) {\r\n\t\t\t\t\t\t\tresult.nomore();\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$this.removeAttr(\"data-active\")\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$this.attr({'data-active': true})\r\n\t\t\t\t\t$modal.show()\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(pc[userID[0]] && !isActive){\r\n\t\t\t\t\tfunction bytesToSize(bytes) {\r\n\t\t\t\t\t\t\tvar k = 1000;\r\n\t\t\t\t\t\t\tvar sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\r\n\t\t\t\t\t\t\tif (bytes <= 0) {\r\n\t\t\t\t\t\t\t\t\treturn '0 Bytes';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar i = parseInt(Math.floor(Math.log(bytes) / Math.log(k)), 10);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif(!sizes[i]) {\r\n\t\t\t\t\t\t\t\t\treturn '0 Bytes';\r\n\t\t\t\t\t\t\t}\r\n\t\t\r\n\t\t\t\t\t\t\treturn (bytes / Math.pow(k, i)).toPrecision(3) + ' ' + sizes[i];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgetStats(pc[userID[0]], function(result) {\r\n\t\t\t\t\t\t\tconst statistic ={\r\n\t\t\t\t\t\t\t\t\"speed\": bytesToSize(result.bandwidth.speed),\r\n\t\t\t\t\t\t\t\t\"availableSendBandwidth\": bytesToSize(result.bandwidth.availableSendBandwidth),\r\n\t\t\t\t\t\t\t\t\"video\": {\r\n\t\t\t\t\t\t\t\t\t\"send.codecs\": result.video.send.codecs.join(\", \"),\r\n\t\t\t\t\t\t\t\t\t// \"recv.codecs\": result.video.recv.codecs.join(\", \"),\r\n\t\t\t\t\t\t\t\t\t\"bytesSent\": bytesToSize(result.video.bytesSent),\r\n\t\t\t\t\t\t\t\t\t\"bytesReceived\": bytesToSize(result.video.bytesReceived)\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\"audio\":{\r\n\t\t\t\t\t\t\t\t\t\"send.codecs\": result.audio.send.codecs.join(\", \"),\r\n\t\t\t\t\t\t\t\t\t// \"recv.codecs\": result.audio.recv.codecs.join(\", \"),\r\n\t\t\t\t\t\t\t\t\t\"bytesSent\": bytesToSize(result.audio.bytesSent),\r\n\t\t\t\t\t\t\t\t\t\"bytesReceived\": bytesToSize(result.audio.bytesReceived)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t$(document).find(\"#wrtc_settings .wrtc_info\").html(`<pre>${JSON.stringify(statistic, undefined, 2)}</pre>`)\r\n\t\t\t\t\t}, 1000);\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\r\n\t\t\t\r\n\r\n\t\t\t})\r\n\t\t\r\n\t\t\t$(document).on('click', '#wrtc_settings .btn_close', function click() {\r\n\t\t\t\t$('#wrtc_settings').toggleClass('active');\r\n\t\t\t\tvar $btnInfo = $(\"#wrtc_settings .btn_info\")\r\n\t\t\t\tif($btnInfo.attr('data-active')) $btnInfo.trigger(\"click\")\r\n\t\t\t});\r\n\r\n\t\t},\r\n\t\tuserLeave: function userLeave(userId) {\r\n\t\t\tif (userId && pc[userId]) {\r\n\t\t\t\tgState = \"LEAVING\"\r\n\t\t\t\tself.removeVideoInterface(userId)\r\n\t\t\t\tself.hangup(userId, true);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\tshow: function show() {\r\n\t\t\t$('#pad_title').addClass('f_wrtcActive');\r\n\t\t},\r\n\t\tshowUserMediaError: function showUserMediaError(err) {\r\n\t\t\t// show an error returned from getUserMedia\r\n\t\t\tvar reason;\r\n\t\t\t// For reference on standard errors returned by getUserMedia:\r\n\t\t\t// https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\r\n\t\t\t// However keep in mind that we add our own errors in getUserMediaPolyfill\r\n\t\t\tswitch (err.name) {\r\n\t\t\t\tcase 'CustomNotSupportedError':\r\n\t\t\t\t\treason = 'Sorry, your browser does not support WebRTC. (or you have it disabled in your settings).<br><br>' + 'To participate in this audio/video chat you have to user a browser with WebRTC support like Chrome, Firefox or Opera.' + '<a href=\"http://www.webrtc.org/\" target=\"_new\">Find out more</a>';\r\n\t\t\t\t\tself.sendErrorStat('NotSupported');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'CustomSecureConnectionError':\r\n\t\t\t\t\treason = 'Sorry, you need to install SSL certificates for your Etherpad instance to use WebRTC';\r\n\t\t\t\t\tself.sendErrorStat('SecureConnection');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'NotAllowedError':\r\n\t\t\t\t\t// For certain (I suspect older) browsers, `NotAllowedError` indicates either an insecure connection or the user rejecting camera permissions.\r\n\t\t\t\t\t// The error for both cases appears to be identical, so our best guess at telling them apart is to guess whether we are in a secure context.\r\n\t\t\t\t\t// (webrtc is considered secure for https connections or on localhost)\r\n\t\t\t\t\tif (location.protocol === 'https:' || location.hostname === 'localhost' || location.hostname === '127.0.0.1') {\r\n\t\t\t\t\t\treason = 'Sorry, you need to give us permission to use your camera and microphone';\r\n\t\t\t\t\t\tself.sendErrorStat('Permission');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treason = 'Sorry, you need to install SSL certificates for your Etherpad instance to use WebRTC';\r\n\t\t\t\t\t\tself.sendErrorStat('SecureConnection');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'NotFoundError':\r\n\t\t\t\t\treason = \"Sorry, we couldn't find a suitable camera on your device. If you have a camera, make sure it set up correctly and refresh this website to retry.\";\r\n\t\t\t\t\tself.sendErrorStat('NotFound');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'NotReadableError':\r\n\t\t\t\t\t// `err.message` might give useful info to the user (not necessarily useful for other error messages)\r\n\t\t\t\t\treason = 'Sorry, a hardware error occurred that prevented access to your camera and/or microphone:<br><br>' + err.message;\r\n\t\t\t\t\tself.sendErrorStat('Hardware');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'AbortError':\r\n\t\t\t\t\t// `err.message` might give useful info to the user (not necessarily useful for other error messages)\r\n\t\t\t\t\treason = 'Sorry, an error occurred (probably not hardware related) that prevented access to your camera and/or microphone:<br><br>' + err.message;\r\n\t\t\t\t\tself.sendErrorStat('Abort');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\t// `err` as a string might give useful info to the user (not necessarily useful for other error messages)\r\n\t\t\t\t\treason = 'Sorry, there was an unknown Error:<br><br>' + err;\r\n\t\t\t\t\tself.sendErrorStat('Unknown');\r\n\t\t\t}\r\n\t\t\t$.gritter.add({\r\n\t\t\t\ttitle: 'Error',\r\n\t\t\t\ttext: reason,\r\n\t\t\t\tsticky: true,\r\n\t\t\t\tclass_name: 'error'\r\n\t\t\t});\r\n\t\t\tself.hide();\r\n\t\t},\r\n\t\thide: function hide(userId) {\r\n\t\t\tif (!userId) return false;\r\n\t\t\tuserId = userId.split('.')[1];\r\n\t\t\t$('#rtcbox').find('#video_a_' + userId).parent().remove();\r\n\t\t},\r\n\t\tactivate: function activate(headerId) {\r\n\t\t\tself.show();\r\n\t\t\tisActive = true;\r\n\t\t\treturn self.getUserMedia(headerId);\r\n\t\t},\r\n\t\tdeactivate: function deactivate(userId, headerId) {\r\n\t\t\tif (!userId) return false;\r\n\t\t\tgState = \"DEACTIVE\"\r\n\t\t\tself.hide(userId);\r\n\t\t\tself.hangupAll(headerId);\r\n\t\t\tif(pc[userId]) pc[userId].close();\r\n\t\t\tself.hangup(userId, true, headerId);\r\n\t\t\tif (localStream) {\r\n\t\t\t\tshare.stopStreaming(localStream)\r\n\t\t\t\tlocalStream = null;\r\n\t\t\t}\r\n\t\t},\r\n\t\ttoggleMuted: function toggleMuted() {\r\n\t\t\tvar audioTrack = localStream.getAudioTracks()[0];\r\n\t\t\tif (audioTrack) {\r\n\t\t\t\taudioTrack.enabled = !audioTrack.enabled;\r\n\t\t\t\treturn !audioTrack.enabled;\r\n\t\t\t}\r\n\t\t},\r\n\t\ttoggleVideo: function toggleVideo() {\r\n\t\t\tvar videoTrack = localStream.getVideoTracks()[0];\r\n\t\t\tif (videoTrack) {\r\n\t\t\t\tvideoTrack.enabled = !videoTrack.enabled;\r\n\t\t\t\treturn !videoTrack.enabled;\r\n\t\t\t}\r\n\t\t},\r\n\t\tappendNewVideoInterface: function appendNewVideoInterface (userId, stream) {\r\n\t\t\tif (!userId) return false;\r\n\t\t\tvar isLocal = userId === share.getUserId();\r\n\t\t\tvar videoId = 'video_' + userId.replace(/\\./g, '_');\r\n\t\t\tvar video = $(document).find('#' + videoId)[0];\r\n\t\t\t\r\n\t\t\tvar user = share.getUserFromId(userId) || {name: \"Anonymous\"};\r\n\r\n\t\t\tif (!video) {\r\n\t\t\t\tvar videoContainer = $(\"<div class='video-container'>\")\r\n\t\t\t\t.css({\r\n\t\t\t\t\t'width': videoSizes.small,\r\n\t\t\t\t\t'max-height': videoSizes.small\r\n\t\t\t\t})\r\n\t\t\t\t.append($('<div class=\"user-name\">').text(user.name))\r\n\t\t\t\t.append(`<p class=\"connectionStatus\" style=\"color: #ffff;position: absolute;padding: 0;margin:0\">connecting</p>`)\r\n\t\t\t\t.appendTo($('#wrtc_modal .videoWrapper'));\r\n\r\n\t\t\t\tvideo = $('<video playsinline>')\r\n\t\t\t\t.attr('id', videoId)\r\n\t\t\t\t.css({\r\n\t\t\t\t\t'border-color': user.colorId,\r\n\t\t\t\t\t'width': videoSizes.small,\r\n\t\t\t\t\t'max-height': videoSizes.small\r\n\t\t\t\t})\r\n\t\t\t\t.on({\r\n\t\t\t\t\tloadedmetadata: function loadedmetadata() {\r\n\t\t\t\t\t\tself.addInterface(userId);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.appendTo(videoContainer)[0];\r\n\r\n\t\t\t\tvideo.autoplay = true;\r\n\r\n\t\t\t\tif (isLocal) {\r\n\t\t\t\t\tvideoContainer.addClass('local-user');\r\n\t\t\t\t\tvideo.muted = true;\r\n\t\t\t\t}\r\n\t\t\t\tself.addInterface(userId);\r\n\t\t\t}\r\n\t\t\tif(stream) attachMediaStream(video, stream);\r\n\t\t},\r\n\t\tremoveVideoInterface: function stopStreaming(userId){\r\n\t\t\tif (!userId) return false;\r\n\t\t\tvar videoId = 'video_' + userId.replace(/\\./g, '_');\r\n\t\t\tvar video = $(document).find('#' + videoId)[0];\r\n\t\t\tif (video) $(video).parent().find('.connectionStatus').text(gState);\r\n\t\t\tif(video && gState !== \"RECONNECTING\") $(video).parent().remove();\r\n\t\t},\r\n\t\tsetStream: function setStream(userId, stream) {\r\n\r\n\t\t\tif (!userId) return false;\r\n\t\t\tvar videoId = 'video_' + userId.replace(/\\./g, '_');\r\n\t\t\tvar video = $(document).find('#' + videoId)[0];\r\n\t\t\tif (video) $(video).parent().find('.connectionStatus').text(gState);\r\n\r\n\t\t\tif(!video){\r\n\t\t\t\tself.appendNewVideoInterface(userId, stream)\r\n\t\t\t} else {\r\n\t\t\t\tif(stream) attachMediaStream(video, stream);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t},\r\n\t\taddInterface: function addInterface(userId) {\r\n\t\t\tif (!userId) return false;\r\n\t\t\tvar isLocal = userId === share.getUserId();\r\n\t\t\tvar videoId = 'video_' + userId.replace(/\\./g, '_');\r\n\t\t\tvar $video = $(document).find('#' + videoId);\r\n\t\t\tvar videoEnabled = true;\r\n\t\t\tvar videoEnlarged = false;\r\n\r\n\t\t\tvar $mute = $(\"<span class='interface-btn audio-btn buttonicon'>\")\r\n\t\t\t.attr('title', 'Mute')\r\n\t\t\t.on({\r\n\t\t\t\tclick: function click() {\r\n\t\t\t\t\tvar muted;\r\n\t\t\t\t\tif (isLocal) {\r\n\t\t\t\t\t\tmuted = self.toggleMuted();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$video[0].muted = !$video[0].muted;\r\n\t\t\t\t\t\tmuted = $video[0].muted;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$mute.attr('title', muted ? 'Unmute' : 'Mute').toggleClass('muted', muted);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tvar $disableVideo = isLocal ? $(\"<span class='interface-btn video-btn buttonicon'>\").attr('title', 'Disable video').on({\r\n\t\t\t\tclick: function click() {\r\n\t\t\t\t\tself.toggleVideo();\r\n\t\t\t\t\tvideoEnabled = !videoEnabled;\r\n\t\t\t\t\t$disableVideo.attr('title', videoEnabled ? 'Disable video' : 'Enable video').toggleClass('off', !videoEnabled);\r\n\t\t\t\t}\r\n\t\t\t}) : null;\r\n\r\n\r\n\t\t\tvar $largeVideo = $(\"<span class='interface-btn enlarge-btn buttonicon'>\").attr('title', 'Make video larger').on({\r\n\t\t\t\tclick: function click() {\r\n\t\t\t\t\tvideoEnlarged = !videoEnlarged;\r\n\r\n\t\t\t\t\tif (videoEnlarged) {\r\n\t\t\t\t\t\tenlargedVideos.add(userId);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tenlargedVideos['delete'](userId);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$largeVideo.attr('title', videoEnlarged ? 'Make video smaller' : 'Make video larger').toggleClass('large', videoEnlarged);\r\n\r\n\t\t\t\t\tvar videoSize = $(document).find('#wrtc_modal .ndbtn.btn_enlarge').hasClass('large') ? videoSizes.large : videoSizes.small;\r\n\t\t\t\t\t\r\n\t\t\t\t\t$video.parent().css({ width: videoSize, 'max-height': videoSize });\r\n\t\t\t\t\t$video.css({ width: videoSize, 'max-height': videoSize });\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tif($(document).find('#wrtc_modal .ndbtn.btn_enlarge').hasClass('large')){\r\n\t\t\t\t$video.parent().css({ width: videoSizes.large,  });\r\n\t\t\t\t$video.css({ width: videoSizes.large, });\r\n\t\t\t}\r\n\r\n\t\t\tif(isLocal) localVideoElement = $video;\r\n\r\n\t\t\t$('#interface_' + videoId).remove();\r\n\t\t\t$(\"<div class='interface-container'>\")\r\n\t\t\t.attr('id', 'interface_' + videoId)\r\n\t\t\t.append([$largeVideo, $disableVideo, $mute])\r\n\t\t\t.insertAfter($video);\r\n\r\n\t\t\tself.changeAudioDestination();\r\n\r\n\t\t},\r\n\t\t// Sends a stat to the back end. `statName` must be in the\r\n\t\t// approved list on the server side.\r\n\t\tsendErrorStat: function sendErrorStat(statName) {\r\n\t\t\tvar msg = { component: 'pad', type: 'STATS', data: { statName: statName, type: 'RTC_MESSAGE' } };\r\n\t\t\tconsole.error(\"[wrtc]: \", msg)\r\n\t\t\t// self._pad.socket.json.send(msg);\r\n\t\t},\r\n\t\tsendMessage: function sendMessage(to, data) {\r\n\t\t\tsocket.emit(\"RTC_MESSAGE\", {\r\n\t\t\t\ttype: 'RTC_MESSAGE',\r\n\t\t\t\tclient: {\r\n\t\t\t\t\tuserId: clientVars.userId, \r\n\t\t\t\t\tname: clientVars.userName,\r\n\t\t\t\t\tpadId:clientVars.padId,\r\n\t\t\t\t\theaderId: window.headerId\r\n\t\t\t\t},\r\n\t\t\t\tpayload: { data: data, to: to }\r\n\t\t\t});\r\n\t\t},\r\n\t\treceiveMessage: async function receiveMessage(msg) {\r\n\t\t\tvar peer = msg.from; // userId sender\r\n\t\t\tvar data = msg.data;\r\n\t\t\tvar type = data.type;\r\n\t\t\t// ignore own messages\r\n\t\t\tif (peer === share.getUserId()) return;\r\n\t\t\t// console.log(peer, \"===-===\",share.getUserId(), \"===\", type, new Date().getSeconds())\r\n\t\t\t\r\n\t\t\tif (type === 'hangup') {\r\n\t\t\t\tself.hangup(peer, true);\r\n\t\t\t} else if (type === 'offer') {\r\n\r\n\t\t\t\t\r\n\t\t\t\tif (pc[peer]) {\r\n\t\t\t\t\t// self.hangup(peer, true);\r\n\t\t\t\t\tself.createPeerConnection(peer, data.headerId);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.createPeerConnection(peer, data.headerId);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar offer = new RTCSessionDescription(data.offer);\r\n\r\n\t\t\t\tawait pc[peer].setRemoteDescription(offer).catch(err => logError(err, \"offer:setRemoteDescription\"))\r\n\t\t\t\t\r\n\t\t\t\tif (localStream) {\r\n\t\t\t\t\tif (pc[peer].getLocalStreams) {\r\n\t\t\t\t\t\tif (!pc[peer].getLocalStreams().length) {\r\n\t\t\t\t\t\t\tpc[peer].addStream(localStream);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (pc[peer].localStreams) {\r\n\t\t\t\t\t\tif (!pc[peer].localStreams.length) {\r\n\t\t\t\t\t\t\tpc[peer].addStream(localStream);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\r\n\t\t\t\tlet desc = await pc[peer].createAnswer(sdpConstraints).catch((err) => logError(err, \"offer:createAnswer\"))\r\n\t\t\t\t\r\n\t\t\t\tdesc.sdp = cleanupSdp(desc.sdp);\r\n\r\n\t\t\t\tawait pc[peer].setLocalDescription(desc).catch((err) => logError(err, \"offer:setLocalDescription\"))\r\n\r\n\t\t\t\tself.sendMessage(peer, { type: 'answer', answer: desc, userId: msg.from, headerId: data.headerId });\r\n\t\t\t\tconsole.log(\"Now You can have new connection33333\")\r\n\t\t\t} else if (type === 'answer') {\r\n\t\t\t\t//  console.log(type, \"============\", peer)\r\n\t\t\t\tif (pc[peer]) {\r\n\t\t\t\t\t// console.log(data, \"================\")\r\n\t\t\t\t\tvar answer = new RTCSessionDescription(data.answer);\r\n\t\t\t\t\tawait pc[peer].setRemoteDescription(answer).catch((err) => logError(err, \"answer:setRemoteDescription\", msg))\r\n\t\t\t\t\tconsole.log(\"Now You can have new connection22222222\")\r\n\t\t\t\t}\r\n\t\t\t} else if (type === 'icecandidate') {\r\n\t\t\t\tif (pc[peer]) {\r\n\t\t\t\t\tif(!data.candidate) return false\r\n\t\t\t\t\tvar candidate = new RTCIceCandidate(data.candidate);\r\n\t\t\t\t\t// console.log(candidate)\r\n\t\t\t\t\tawait pc[peer].addIceCandidate(candidate).catch(error => {\r\n\t\t\t\t\t\tconsole.error('Error: Failure during addIceCandidate()', error);\r\n\t\t\t\t\t})\r\n\t\t\t\t\tconsole.log(\"Now You can have new connection11\")\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconsole.error('unknown server message', data);\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\taudioVideoInputChange: function audioVideoInputChange() {\r\n\t\t\tif(!localStream) return false;\r\n\t\t\tlocalStream.getTracks().forEach(function (track) {\r\n\t\t\t\ttrack.stop();\r\n\t\t\t});\r\n\t\t\tself.getUserMedia(window.headerId);\r\n\t\t},\r\n\t\tattachSinkId: function attachSinkId(element, sinkId) {\r\n\t\t\t// Attach audio output device to video element using device/sink ID.\r\n\t\t\tif (element && element[0] && typeof element[0].sinkId !== 'undefined') {\r\n\t\t\t\telement[0].setSinkId(sinkId).then(() => {\r\n\t\t\t\t\t\t\t// console.info(`Success, audio output device attached: ${sinkId}`);\r\n\t\t\t\t\t\t})['catch'](error => {\r\n\t\t\t\t\t\t\tvar errorMessage = error;\r\n\t\t\t\t\t\t\tif (error.name === 'SecurityError') {\r\n\t\t\t\t\t\t\t\terrorMessage = `You need to use HTTPS for selecting audio output device: ${error}`;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconsole.error(errorMessage);\r\n\t\t\t\t\t\t\t// Jump back to first output device in the list as it's the default.\r\n\t\t\t\t\t\t\taudioOutputSelect.selectedIndex = 0;\r\n\t\t\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tconsole.warn('Browser does not support output device selection.');\r\n\t\t\t}\r\n\t\t},\r\n\t\tchangeAudioDestination: function changeAudioDestination() {\r\n\t\t\tvar audioOutputSelect = document.querySelector('select#audioOutput');\r\n\t\t\tvar audioDestination = audioOutputSelect.value;\r\n\t\t\tvar videoElement = localVideoElement\r\n\t\t\tself.attachSinkId(videoElement, audioDestination);\r\n\t\t},\r\n\t\thangupAll: function hangupAll(_headerId) {\r\n\t\t\tObject.keys(pc).forEach(function (userId) {\r\n\t\t\t\tif(userId) self.hangup(userId, true, _headerId);\r\n\t\t\t});\r\n\t\t},\r\n\t\thangup: function hangup(userId, notify, headerId) {\r\n\t\t\tnotify = arguments.length === 1 ? true : notify;\r\n\t\t\t// console.log(\"hangUp\", userId, notify, headerId)\r\n\t\t\tif (pc[userId] && userId !== share.getUserId()) {\r\n\t\t\t\tself.removeVideoInterface(userId)\r\n\t\t\t\tpc[userId].close();\r\n\t\t\t\tdelete pc[userId];\r\n\t\t\t\tif (notify) self.sendMessage(userId, { type: 'hangup', headerId: headerId });\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreatePeerConnection: function createPeerConnection(userId, headerId, targetCreate) {\r\n\t\t\tif (pc[userId]) console.warn('WARNING creating PC connection even though one exists', userId);\r\n\t\t\t// if((pc[userId])) return false\r\n\r\n\t\t\tpc[userId] = new RTCPeerConnection(pcConfig, pcConstraints);\r\n\r\n\t\t\tpc[userId].onicecandidate = function (event) {\r\n\t\t\t\tif (event.candidate) {\r\n\t\t\t\t\tself.appendNewVideoInterface(userId)\r\n\t\t\t\t\tself.sendMessage(userId, {type: 'icecandidate', headerId: headerId, candidate: event.candidate});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsocket.emit('openForCalling', window.pad.getPadId(), window.headerId)\r\n\t\t\t\t\tconsole.log(\"now you can have newconnnection44444444444444444444\")\r\n\t\t\t\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tif(targetCreate === 'local'){\r\n\t\t\t\t\r\n\t\t\t}\r\n\r\n\t\t\tpc[userId].ontrack = function(event) {\r\n\t\t\t\tremoteStream[userId] = event.stream;\r\n\t\t\t\tself.setStream(userId, event.stream);\r\n\t\t\t};\r\n\r\n\t\t\tpc[userId].onaddstream = function (event) {\r\n\t\t\t\tremoteStream[userId] = event.stream;\r\n\t\t\t\tself.setStream(userId, event.stream);\r\n\t\t\t};\r\n\r\n\t\t\tpc[userId].onremovestream = function () {\r\n\t\t\t\tself.removeVideoInterface(userId)\r\n\t\t\t};\r\n\r\n\t\t},\r\n\t\tcall: function call(userId, headerId) {\r\n\t\t\tif (!localStream) return;\r\n\t\t\t\r\n\t\t\tvar constraints = { optional: [], mandatory: {} };\r\n\r\n\t\t\t// TODO: sdpConstraints option are lagecy\r\n\t\t\t// https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/createOffer#RTCOfferOptions_dictionary\r\n\t\t\tconstraints = mergeConstraints(constraints, sdpConstraints);\r\n\r\n\t\t\tif (!pc[userId]) self.createPeerConnection(userId, headerId, 'local');\r\n\t\t\t\r\n\t\t\tpc[userId].addStream(localStream);\r\n\r\n\t\t\tpc[userId].addEventListener(\"negotiationneeded\", ev => {\r\n\r\n\t\t\t\tpc[userId].createOffer(constraints)\r\n\t\t\t\t.then(function(desc) {\r\n\t\t\t\t\tdesc.sdp = cleanupSdp(desc.sdp);\r\n\t\t\t\t\treturn pc[userId].setLocalDescription(desc)\r\n\t\t\t\t})\r\n\t\t\t\t.then(function (){\r\n\t\t\t\t// if (userId !== share.getUserId() ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t// }\r\n\t\t\t\t\tself.sendMessage(userId, { type: 'offer', offer: pc[userId].localDescription, headerId: headerId });\t\t\t\r\n\t\t\t\t}).then(function(){\r\n\t\t\t\t\t\r\n\t\t\t\t})\r\n\t\t\t\t.catch((err) => logError(err, \"call:createOffer\"));\r\n\r\n\t\t\t})\r\n\r\n\r\n\t\t},\r\n\t\tgetUserMedia: function getUserMedia(headerId) {\r\n\t\t\taudioInputSelect = document.querySelector('select#audioSource');\r\n\t\t\tvideoSelect = document.querySelector('select#videoSource');\r\n\t\t\taudioOutputSelect = document.querySelector('select#audioOutput');\r\n\t\t\t\r\n\t\t\tvar audioSource = audioInputSelect.value;\r\n\t\t\tvar videoSource = videoSelect.value;\r\n\t\t\tvar audioOutput = audioOutputSelect.value;\r\n\r\n\t\t\tvar mediaConstraints = {\r\n\t\t\t\taudio: true,\r\n\t\t\t\tvideo: {\r\n\t\t\t\t\toptional: [],\r\n\t\t\t\t\tmandatory: {\r\n\t\t\t\t\t\tmaxWidth: 320,\r\n\t\t\t\t\t\tmaxHeight: 240\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// attach user audio source\r\n\t\t\tif (audioSource) {\r\n\t\t\t\tmediaConstraints.audio = { deviceId: { exact: audioSource } };\r\n\t\t\t}\r\n\r\n\t\t\t// attach user video source\r\n\t\t\tif (videoSource) {\r\n\t\t\t\tmediaConstraints.video = { deviceId: { exact: videoSource } };\r\n\t\t\t}\r\n\r\n\t\t\t// save user default video/audio settings\r\n\t\t\tlocalStorage.setItem('videoSettings', JSON.stringify({ microphone: audioSource, speaker: audioOutput, camera: videoSource }));\r\n\r\n\t\t\twindow.navigator.mediaDevices\r\n\t\t\t.getUserMedia(mediaConstraints)\r\n\t\t\t.then(function (stream) {\r\n\t\t\t\tlocalStream = stream;\r\n\t\t\t\t// create video stream for current pc\r\n\t\t\t\tself.appendNewVideoInterface(share.getUserId(), stream)\r\n\r\n\t\t\t\t\r\n\t\t\t\tsocket.emit('canMakeACall', window.pad.getPadId(),  window.headerId, function(canI){\r\n\t\t\t\t\t// console.log(\"canIcanIcanIcanIcanI\", canI)\r\n\t\t\t\t\t// if(canI === null) {\r\n\t\t\t\t\t// \tsocket.emit('openForCalling', window.pad.getPadId(), window.headerId)\r\n\t\t\t\t\t// \tcanI = true\r\n\t\t\t\t\t// }\r\n\r\n\t\t\t\t\t// if(canI){\r\n\r\n\t\t\t\t\t\tsocket.emit('getHeaderUserlist', padId, window.headerId, function(userList){\r\n\t\t\t\t\t\t\tuserList.forEach(function (userId) {\r\n\t\t\t\t\t\t\t\tif (userId !== share.getUserId() ) {\r\n\t\t\t\t\t\t\t\t\t// if (pc[userId] && gState === \"RECONNECTING\") {\r\n\t\t\t\t\t\t\t\t\t// \tself.hangup(userId, null, headerId);\r\n\t\t\t\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t\t\t\tself.call(userId, headerId);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tif(userList.length > 1)\r\n\t\t\t\t\t\t\t\t\t\tsocket.emit('closeForCalling', window.pad.getPadId(), window.headerId)\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t// }else{\r\n\t\t\t\t\t\r\n\t\t\t\t\t// \t// console.log(\"canIcanIcanIcanIcanIcanIcanIcanI\", canI)\r\n\t\t\t\t\t// }\r\n\t\t\t\t})\r\n\r\n\t\t\t})\r\n\t\t\t.catch(function (err) {\r\n\t\t\t\tself.showUserMediaError(err);\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\t// Normalize RTC implementation between browsers\r\n\t// var getUserMedia = window.navigator.mediaDevices.getUserMedia\r\n\tvar attachMediaStream = function attachMediaStream(element, stream) {\r\n\t\tconsole.log(stream)\r\n\t\tif (!stream){\r\n\t\t\tconsole.error(\"[wrtc]: stream is not exists.\", stream)\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (typeof element.srcObject !== 'undefined') {\r\n\t\t\telement.srcObject = stream;\r\n\t\t} else if (typeof element.mozSrcObject !== 'undefined') {\r\n\t\t\telement.mozSrcObject = stream;\r\n\t\t} else if (typeof element.src !== 'undefined') {\r\n\t\t\telement.src = URL.createObjectURL(stream);\r\n\t\t} else {\r\n\t\t\tconsole.error('Error attaching stream to element.', element);\r\n\t\t}\r\n\t\tif (element) $(element).parent().find('.connectionStatus').text(\"\");\r\n\t};\r\n\r\n\tfunction cleanupSdp(sdp) {\r\n\t\tvar bandwidth = {\r\n\t\t\tscreen: 300, // 300kbits minimum\r\n\t\t\taudio: 70,   // 50kbits  minimum\r\n\t\t\tminVideo: 125, // 125kbits  min\r\n\t\t\tmaxVideo: 125, // 125kbits  max\r\n\t\t\tvideoCodec: clientVars.webrtc.video.codec\r\n\t\t};\r\n\r\n\t\tvar isScreenSharing = false;\r\n\r\n\t\tsdp = BandwidthHandler.setApplicationSpecificBandwidth(sdp, bandwidth, isScreenSharing);\r\n\t\tsdp = BandwidthHandler.setVideoBitrates(sdp, {\r\n\t\t\tmin: bandwidth.minVideo,\r\n\t\t\tmax: bandwidth.maxVideo,\r\n\t\t\tcodec: bandwidth.videoCodec\r\n\t\t});\r\n\t\tsdp = BandwidthHandler.setOpusAttributes(sdp);\r\n\r\n\t\treturn sdp;\r\n\t}\r\n\r\n\tfunction mergeConstraints(cons1, cons2) {\r\n\t\tvar merged = cons1;\r\n\t\tfor (var name in cons2.mandatory) {\r\n\t\t\tmerged.mandatory[name] = cons2.mandatory[name];\r\n\t\t}\r\n\t\tmerged.optional.concat(cons2.optional);\r\n\t\treturn merged;\r\n\t}\r\n\r\n\tfunction logError(error, functionName, data) {\r\n\t\t// attempt to reconnect\r\n\t\tconsole.log(error, functionName, data, \"=========logError\")\r\n\t\tif(error && error.message.includes(\"Failed to set remote answer sdp\")){\r\n\t\t\tconsole.log(\"Try reconnecting\")\r\n\t\t\t//setTimeout(() => {\r\n\t\t\t\tconsole.log(\"reconnecting...\")\r\n\t\t\t\t// self.receiveMessage(data)\r\n\t\t\t\tgState = \"RECONNECTING\"\r\n\t\t\t\t// share.stopStreaming(localStream)\r\n\t\t\t\t// self.getUserMedia(window.headerId)\r\n\r\n\r\n\t\t\t\tsocket.emit('getHeaderUserlist', window.pad.getPadId(), window.headerId, function(userList){\r\n\t\t\t\t\tuserList.forEach(function (userId) {\r\n\t\t\t\t\t\tif (userId !== share.getUserId() ) {\r\n\t\t\t\t\t\t\t// if (pc[userId] && gState === \"RECONNECTING\") {\r\n\t\t\t\t\t\t\t// \tself.hangup(userId, null, headerId);\r\n\t\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t\tself.call(userId, window.headerId);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\r\n\r\n\r\n\t\t\t\t// $(document).find(\"#wrtc_modal .btn_reload.btn_roomHandler\").trigger(\"click\")\r\n\t\t\t//}, 100);\r\n\t\t}\r\n\t\t\r\n\t\tconsole.error('WebRTC ERROR:', error);\r\n\t}\r\n\r\n\tself.pc = pc;\r\n\treturn self;\r\n})();\r\n\r\n\r\n\r\n// Get Start\r\n// action flow\r\n// 1. activate"]}